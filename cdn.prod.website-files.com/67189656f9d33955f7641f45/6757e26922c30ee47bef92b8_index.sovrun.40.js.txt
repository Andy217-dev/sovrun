(()=>{var OA=Object.defineProperty;var IA=(n,e,t)=>e in n?OA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Os=(n,e,t)=>(IA(n,typeof e!="symbol"?e+"":e,t),t);function Is(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function A_(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var Wr={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Cl={duration:.5,overwrite:!1,delay:0},Qm,sr,ti,Mn=1e8,Zt=1/Mn,Vm=Math.PI*2,FA=Vm/4,kA=0,C_=Math.sqrt,UA=Math.cos,zA=Math.sin,Pi=function(e){return typeof e=="string"},pi=function(e){return typeof e=="function"},ks=function(e){return typeof e=="number"},wd=function(e){return typeof e=="undefined"},ms=function(e){return typeof e=="object"},Hr=function(e){return e!==!1},eg=function(){return typeof window!="undefined"},dd=function(e){return pi(e)||Pi(e)},D_=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},or=Array.isArray,Hm=/(?:-?\.?\d|\.)+/gi,tg=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,pa=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Fm=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ig=/[+-]=-?[.\d]+/,P_=/[^,'"\[\]\s]+/gi,BA=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,si,ps,Wm,rg,an={},gd={},R_,L_=function(e){return(gd=da(e,an))&&ar},bd=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},vu=function(e,t){return!t&&console.warn(e)},O_=function(e,t){return e&&(an[e]=t)&&gd&&(gd[e]=t)||an},yu=function(){return 0},NA={suppressEvents:!0,isStart:!0,kill:!1},pd={suppressEvents:!0,kill:!1},GA={suppressEvents:!0},ng={},yo=[],qm={},I_,Gr={},km={},__=30,fd=[],sg="",og=function(e){var t=e[0],i,r;if(ms(t)||pi(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=fd.length;r--&&!fd[r].targetTest(t););i=fd[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new cg(e[r],i)))||e.splice(r,1);return e},xo=function(e){return e._gsap||og(An(e))[0]._gsap},ag=function(e,t,i){return(i=e[t])&&pi(i)?e[t]():wd(i)&&e.getAttribute&&e.getAttribute(t)||i},_r=function(e,t){return(e=e.split(",")).forEach(t)||e},fi=function(e){return Math.round(e*1e5)/1e5||0},Ni=function(e){return Math.round(e*1e7)/1e7||0},fa=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+r:i==="-"?e-r:i==="*"?e*r:e/r},VA=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},vd=function(){var e=yo.length,t=yo.slice(0),i,r;for(qm={},yo.length=0,i=0;i<e;i++)r=t[i],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},F_=function(e,t,i,r){yo.length&&!sr&&vd(),e.render(t,i,r||sr&&t<0&&(e._initted||e._startAt)),yo.length&&!sr&&vd()},k_=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(P_).length<2?t:Pi(e)?e.trim():e},U_=function(e){return e},Cn=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},HA=function(e){return function(t,i){for(var r in i)r in t||r==="duration"&&e||r==="ease"||(t[r]=i[r])}},da=function(e,t){for(var i in t)e[i]=t[i];return e},w_=function n(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=ms(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},yd=function(e,t){var i={},r;for(r in e)r in t||(i[r]=e[r]);return i},fu=function(e){var t=e.parent||si,i=e.keyframes?HA(or(e.keyframes)):Cn;if(Hr(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},WA=function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0},z_=function(e,t,i,r,s){i===void 0&&(i="_first"),r===void 0&&(r="_last");var o=e[r],a;if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},Sd=function(e,t,i,r){i===void 0&&(i="_first"),r===void 0&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[i]===t&&(e[i]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},_o=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},ca=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},qA=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},jm=function(e,t,i,r){return e._startAt&&(sr?e._startAt.revert(pd):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},jA=function n(e){return!e||e._ts&&n(e.parent)},b_=function(e){return e._repeat?Dl(e._tTime,e=e.duration()+e._rDelay)*e:0},Dl=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},xd=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Ed=function(e){return e._end=Ni(e._start+(e._tDur/Math.abs(e._ts||e._rts||Zt)||0))},Td=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=Ni(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Ed(e),i._dirty||ca(i,e)),e},B_=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=xd(e.rawTime(),t),(!t._dur||wu(0,t.totalDuration(),i)-t._tTime>Zt)&&t.render(i,!0)),ca(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-Zt}},fs=function(e,t,i,r){return t.parent&&_o(t),t._start=Ni((ks(i)?i:i||e!==si?Tn(e,i,t):e._time)+t._delay),t._end=Ni(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),z_(e,t,"_first","_last",e._sort?"_start":0),Xm(t)||(e._recent=t),r||B_(e,t),e._ts<0&&Td(e,e._tTime),e},N_=function(e,t){return(an.ScrollTrigger||bd("scrollTrigger",t))&&an.ScrollTrigger.create(t,e)},G_=function(e,t,i,r,s){if(dg(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!sr&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&I_!==Vr.frame)return yo.push(e),e._lazy=[s,r],1},XA=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},Xm=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},YA=function(e,t,i,r){var s=e.ratio,o=t<0||!t&&(!e._start&&XA(e)&&!(!e._initted&&Xm(e))||(e._ts<0||e._dp._ts<0)&&!Xm(e))?0:1,a=e._rDelay,l=0,c,u,h;if(a&&e._repeat&&(l=wu(0,e._tDur,t),u=Dl(l,a),e._yoyo&&u&1&&(o=1-o),u!==Dl(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||sr||r||e._zTime===Zt||!t&&e._zTime){if(!e._initted&&G_(e,t,r,i,l))return;for(h=e._zTime,e._zTime=t||(i?Zt:0),i||(i=t&&!h),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,c=e._pt;c;)c.r(o,c.d),c=c._next;t<0&&jm(e,t,i,!0),e._onUpdate&&!i&&on(e,"onUpdate"),l&&e._repeat&&!i&&e.parent&&on(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&_o(e,1),!i&&!sr&&(on(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},$A=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},Pl=function(e,t,i,r){var s=e._repeat,o=Ni(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:Ni(o*(s+1)+e._rDelay*s):o,a>0&&!r&&Td(e,e._tTime=e._tDur*a),e.parent&&Ed(e),i||ca(e.parent,e),e},S_=function(e){return e instanceof Ki?ca(e):Pl(e,e._dur)},KA={_start:0,endTime:yu,totalDuration:yu},Tn=function n(e,t,i){var r=e.labels,s=e._recent||KA,o=e.duration()>=Mn?s.endTime(!1):e._dur,a,l,c;return Pi(t)&&(isNaN(t)||t in r)?(l=t.charAt(0),c=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(a<0?s:i).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),c&&i&&(l=l/100*(or(i)?i[0]:i).totalDuration()),a>1?n(e,t.substr(0,a-1),i)+l:o+l)):t==null?o:+t},mu=function(e,t,i){var r=ks(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s],a,l;if(r&&(o.duration=t[1]),o.parent=i,e){for(a=o,l=i;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=Hr(l.vars.inherit)&&l.parent;o.immediateRender=Hr(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new yi(t[0],o,t[s+1])},wo=function(e,t){return e||e===0?t(e):t},wu=function(e,t,i){return i<e?e:i>t?t:i},Zi=function(e,t){return!Pi(e)||!(t=BA.exec(e))?"":t[1]},ZA=function(e,t,i){return wo(i,function(r){return wu(e,t,r)})},Ym=[].slice,V_=function(e,t){return e&&ms(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&ms(e[0]))&&!e.nodeType&&e!==ps},JA=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(r){var s;return Pi(r)&&!t||V_(r,1)?(s=i).push.apply(s,An(r)):i.push(r)})||i},An=function(e,t,i){return ti&&!t&&ti.selector?ti.selector(e):Pi(e)&&!i&&(Wm||!Rl())?Ym.call((t||rg).querySelectorAll(e),0):or(e)?JA(e,i):V_(e)?Ym.call(e,0):e?[e]:[]},$m=function(e){return e=An(e)[0]||vu("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return An(t,i.querySelectorAll?i:i===e?vu("Invalid scope")||rg.createElement("div"):e)}},H_=function(e){return e.sort(function(){return .5-Math.random()})},W_=function(e){if(pi(e))return e;var t=ms(e)?e:{each:e},i=ua(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,l=isNaN(r)||a,c=t.axis,u=r,h=r;return Pi(r)?u=h={center:.5,edges:.5,end:1}[r]||0:!a&&l&&(u=r[0],h=r[1]),function(d,p,f){var v=(f||t).length,g=o[v],m,x,y,_,w,b,T,A,S;if(!g){if(S=t.grid==="auto"?0:(t.grid||[1,Mn])[1],!S){for(T=-Mn;T<(T=f[S++].getBoundingClientRect().left)&&S<v;);S<v&&S--}for(g=o[v]=[],m=l?Math.min(S,v)*u-.5:r%S,x=S===Mn?0:l?v*h/S-.5:r/S|0,T=0,A=Mn,b=0;b<v;b++)y=b%S-m,_=x-(b/S|0),g[b]=w=c?Math.abs(c==="y"?_:y):C_(y*y+_*_),w>T&&(T=w),w<A&&(A=w);r==="random"&&H_(g),g.max=T-A,g.min=A,g.v=v=(parseFloat(t.amount)||parseFloat(t.each)*(S>v?v-1:c?c==="y"?v/S:S:Math.max(S,v/S))||0)*(r==="edges"?-1:1),g.b=v<0?s-v:s,g.u=Zi(t.amount||t.each)||0,i=i&&v<0?Q_(i):i}return v=(g[d]-g.min)/g.max||0,Ni(g.b+(i?i(v):v)*g.v)+g.u}},Km=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=Ni(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+(ks(i)?0:Zi(i))}},q_=function(e,t){var i=or(e),r,s;return!i&&ms(e)&&(r=i=e.radius||Mn,e.values?(e=An(e.values),(s=!ks(e[0]))&&(r*=r)):e=Km(e.increment)),wo(t,i?pi(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),c=Mn,u=0,h=e.length,d,p;h--;)s?(d=e[h].x-a,p=e[h].y-l,d=d*d+p*p):d=Math.abs(e[h]-a),d<c&&(c=d,u=h);return u=!r||c<=r?e[u]:o,s||u===o||ks(o)?u:u+Zi(o)}:Km(e))},j_=function(e,t,i,r){return wo(or(e)?!t:i===!0?!!(i=0):!r,function(){return or(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*r)/r})},QA=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(s,o){return o(s)},r)}},eC=function(e,t){return function(i){return e(parseFloat(i))+(t||Zi(i))}},tC=function(e,t,i){return Y_(e,t,0,1,i)},X_=function(e,t,i){return wo(i,function(r){return e[~~t(r)]})},iC=function n(e,t,i){var r=t-e;return or(e)?X_(e,n(0,e.length),t):wo(i,function(s){return(r+(s-e)%r)%r+e})},rC=function n(e,t,i){var r=t-e,s=r*2;return or(e)?X_(e,n(0,e.length-1),t):wo(i,function(o){return o=(s+(o-e)%s)%s||0,e+(o>r?s-o:o)})},Ll=function(e){for(var t=0,i="",r,s,o,a;~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a=e.charAt(r+7)==="[",s=e.substr(r+7,o-r-7).match(a?P_:Hm),i+=e.substr(t,r-t)+j_(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},Y_=function(e,t,i,r,s){var o=t-e,a=r-i;return wo(s,function(l){return i+((l-e)/o*a||0)})},nC=function n(e,t,i,r){var s=isNaN(e+t)?0:function(p){return(1-p)*e+p*t};if(!s){var o=Pi(e),a={},l,c,u,h,d;if(i===!0&&(r=1)&&(i=null),o)e={p:e},t={p:t};else if(or(e)&&!or(t)){for(u=[],h=e.length,d=h-2,c=1;c<h;c++)u.push(n(e[c-1],e[c]));h--,s=function(f){f*=h;var v=Math.min(d,~~f);return u[v](f-v)},i=t}else r||(e=da(or(e)?[]:{},e));if(!u){for(l in t)ug.call(a,e,l,"get",t[l]);s=function(f){return mg(f,a)||(o?e.p:e)}}}return wo(i,s)},E_=function(e,t,i){var r=e.labels,s=Mn,o,a,l;for(o in r)a=r[o]-t,a<0==!!i&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},on=function(e,t,i){var r=e.vars,s=r[t],o=ti,a=e._ctx,l,c,u;if(s)return l=r[t+"Params"],c=r.callbackScope||e,i&&yo.length&&vd(),a&&(ti=a),u=l?s.apply(c,l):s.call(c),ti=o,u},du=function(e){return _o(e),e.scrollTrigger&&e.scrollTrigger.kill(!!sr),e.progress()<1&&on(e,"onInterrupt"),e},Al,$_=[],K_=function(e){if(e)if(e=!e.name&&e.default||e,eg()||e.headless){var t=e.name,i=pi(e),r=t&&!i&&e.init?function(){this._props=[]}:e,s={init:yu,render:mg,add:ug,kill:_C,modifier:xC,rawVars:0},o={targetTest:0,get:0,getSetter:Md,aliases:{},register:0};if(Rl(),e!==r){if(Gr[t])return;Cn(r,Cn(yd(e,s),o)),da(r.prototype,da(s,yd(e,o))),Gr[r.prop=t]=r,e.targetTest&&(fd.push(r),ng[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}O_(t,r),e.register&&e.register(ar,r,wr)}else $_.push(e)},qt=255,pu={aqua:[0,qt,qt],lime:[0,qt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,qt],navy:[0,0,128],white:[qt,qt,qt],olive:[128,128,0],yellow:[qt,qt,0],orange:[qt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[qt,0,0],pink:[qt,192,203],cyan:[0,qt,qt],transparent:[qt,qt,qt,0]},Um=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*qt+.5|0},Z_=function(e,t,i){var r=e?ks(e)?[e>>16,e>>8&qt,e&qt]:0:pu.black,s,o,a,l,c,u,h,d,p,f;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),pu[e])r=pu[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&qt,r&qt,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&qt,e&qt]}else if(e.substr(0,3)==="hsl"){if(r=f=e.match(Hm),!t)l=+r[0]%360/360,c=+r[1]/100,u=+r[2]/100,o=u<=.5?u*(c+1):u+c-u*c,s=u*2-o,r.length>3&&(r[3]*=1),r[0]=Um(l+1/3,s,o),r[1]=Um(l,s,o),r[2]=Um(l-1/3,s,o);else if(~e.indexOf("="))return r=e.match(tg),i&&r.length<4&&(r[3]=1),r}else r=e.match(Hm)||pu.transparent;r=r.map(Number)}return t&&!f&&(s=r[0]/qt,o=r[1]/qt,a=r[2]/qt,h=Math.max(s,o,a),d=Math.min(s,o,a),u=(h+d)/2,h===d?l=c=0:(p=h-d,c=u>.5?p/(2-h-d):p/(h+d),l=h===s?(o-a)/p+(o<a?6:0):h===o?(a-s)/p+2:(s-o)/p+4,l*=60),r[0]=~~(l+.5),r[1]=~~(c*100+.5),r[2]=~~(u*100+.5)),i&&r.length<4&&(r[3]=1),r},J_=function(e){var t=[],i=[],r=-1;return e.split(Fs).forEach(function(s){var o=s.match(pa)||[];t.push.apply(t,o),i.push(r+=o.length+1)}),t.c=i,t},T_=function(e,t,i){var r="",s=(e+r).match(Fs),o=t?"hsla(":"rgba(",a=0,l,c,u,h;if(!s)return e;if(s=s.map(function(d){return(d=Z_(d,t,1))&&o+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(u=J_(e),l=i.c,l.join(r)!==u.c.join(r)))for(c=e.replace(Fs,"1").split(pa),h=c.length-1;a<h;a++)r+=c[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:i).shift());if(!c)for(c=e.split(Fs),h=c.length-1;a<h;a++)r+=c[a]+s[a];return r+c[h]},Fs=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in pu)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),sC=/hsl[a]?\(/,lg=function(e){var t=e.join(" "),i;if(Fs.lastIndex=0,Fs.test(t))return i=sC.test(t),e[1]=T_(e[1],i),e[0]=T_(e[0],i,J_(e[1])),!0},xu,Vr=function(){var n=Date.now,e=500,t=33,i=n(),r=i,s=1e3/240,o=s,a=[],l,c,u,h,d,p,f=function v(g){var m=n()-r,x=g===!0,y,_,w,b;if((m>e||m<0)&&(i+=m-t),r+=m,w=r-i,y=w-o,(y>0||x)&&(b=++h.frame,d=w-h.time*1e3,h.time=w=w/1e3,o+=y+(y>=s?4:s-y),_=1),x||(l=c(v)),_)for(p=0;p<a.length;p++)a[p](w,d,b,g)};return h={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(g){return d/(1e3/(g||60))},wake:function(){R_&&(!Wm&&eg()&&(ps=Wm=window,rg=ps.document||{},an.gsap=ar,(ps.gsapVersions||(ps.gsapVersions=[])).push(ar.version),L_(gd||ps.GreenSockGlobals||!ps.gsap&&ps||{}),$_.forEach(K_)),u=typeof requestAnimationFrame!="undefined"&&requestAnimationFrame,l&&h.sleep(),c=u||function(g){return setTimeout(g,o-h.time*1e3+1|0)},xu=1,f(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(l),xu=0,c=yu},lagSmoothing:function(g,m){e=g||1/0,t=Math.min(m||33,e)},fps:function(g){s=1e3/(g||240),o=h.time*1e3+s},add:function(g,m,x){var y=m?function(_,w,b,T){g(_,w,b,T),h.remove(y)}:g;return h.remove(g),a[x?"unshift":"push"](y),Rl(),y},remove:function(g,m){~(m=a.indexOf(g))&&a.splice(m,1)&&p>=m&&p--},_listeners:a},h}(),Rl=function(){return!xu&&Vr.wake()},Lt={},oC=/^[\d.\-M][\d.\-,\s]/,aC=/["']/g,lC=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),r=i[0],s=1,o=i.length,a,l,c;s<o;s++)l=i[s],a=s!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),t[r]=isNaN(c)?c.replace(aC,"").trim():+c,r=l.substr(a+1).trim();return t},cC=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)},uC=function(e){var t=(e+"").split("("),i=Lt[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[lC(t[1])]:cC(e).split(",").map(k_)):Lt._CE&&oC.test(e)?Lt._CE("",e):i},Q_=function(e){return function(t){return 1-e(1-t)}},ew=function n(e,t){for(var i=e._first,r;i;)i instanceof Ki?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},ua=function(e,t){return e&&(pi(e)?e:Lt[e]||uC(e))||t},ma=function(e,t,i,r){i===void 0&&(i=function(l){return 1-t(1-l)}),r===void 0&&(r=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:r},o;return _r(e,function(a){Lt[a]=an[a]=s,Lt[o=a.toLowerCase()]=i;for(var l in s)Lt[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=Lt[a+"."+l]=s[l]}),s},tw=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},zm=function n(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/Vm*(Math.asin(1/r)||0),a=function(u){return u===1?1:r*Math.pow(2,-10*u)*zA((u-o)*s)+1},l=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:tw(a);return s=Vm/s,l.config=function(c,u){return n(e,c,u)},l},Bm=function n(e,t){t===void 0&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},r=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:tw(i);return r.config=function(s){return n(e,s)},r};_r("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;ma(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});Lt.Linear.easeNone=Lt.none=Lt.Linear.easeIn;ma("Elastic",zm("in"),zm("out"),zm());(function(n,e){var t=1/e,i=2*t,r=2.5*t,s=function(a){return a<t?n*a*a:a<i?n*Math.pow(a-1.5/e,2)+.75:a<r?n*(a-=2.25/e)*a+.9375:n*Math.pow(a-2.625/e,2)+.984375};ma("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);ma("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});ma("Circ",function(n){return-(C_(1-n*n)-1)});ma("Sine",function(n){return n===1?1:-UA(n*FA)+1});ma("Back",Bm("in"),Bm("out"),Bm());Lt.SteppedEase=Lt.steps=an.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,r=e+(t?0:1),s=t?1:0,o=1-Zt;return function(a){return((r*wu(0,o,a)|0)+s)*i}}};Cl.ease=Lt["quad.out"];_r("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return sg+=n+","+n+"Params,"});var cg=function(e,t){this.id=kA++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:ag,this.set=t?t.getSetter:Md},_u=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Pl(this,+t.duration,1,1),this.data=t.data,ti&&(this._ctx=ti,ti.data.push(this)),xu||Vr.wake()}var e=n.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Pl(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(Rl(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Td(this,i),!s._dp||s.parent||B_(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&fs(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Zt||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),F_(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+b_(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+b_(this),r):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,r):this._repeat?Dl(this._tTime,s)+1:1},e.timeScale=function(i,r){if(!arguments.length)return this._rts===-Zt?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?xd(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-Zt?0:this._rts,this.totalTime(wu(-Math.abs(this._delay),this._tDur,s),r!==!1),Ed(this),qA(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Rl(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Zt&&(this._tTime-=Zt)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&fs(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(Hr(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?xd(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=GA);var r=sr;return sr=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),sr=r,this},e.globalTime=function(i){for(var r=this,s=arguments.length?i:r.rawTime();r;)s=r._start+s/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,S_(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,S_(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime(Tn(this,i),Hr(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,Hr(r))},e.play=function(i,r){return i!=null&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return i!=null&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return i!=null&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-Zt:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Zt,this},e.isActive=function(){var i=this.parent||this._dp,r=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=r&&s<this.endTime(!0)-Zt)},e.eventCallback=function(i,r,s){var o=this.vars;return arguments.length>1?(r?(o[i]=r,s&&(o[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=r)):delete o[i],this):o[i]},e.then=function(i){var r=this;return new Promise(function(s){var o=pi(i)?i:U_,a=function(){var c=r.then;r.then=null,pi(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=c),s(o),r.then=c};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){du(this)},n}();Cn(_u.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Zt,_prom:0,_ps:!1,_rts:1});var Ki=function(n){A_(e,n);function e(i,r){var s;return i===void 0&&(i={}),s=n.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=Hr(i.sortChildren),si&&fs(i.parent||si,Is(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&N_(Is(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(r,s,o){return mu(0,arguments,this),this},t.from=function(r,s,o){return mu(1,arguments,this),this},t.fromTo=function(r,s,o,a){return mu(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,fu(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new yi(r,s,Tn(this,o),1),this},t.call=function(r,s,o){return fs(this,yi.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,l,c,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=u,o.parent=this,new yi(r,o,Tn(this,l)),this},t.staggerFrom=function(r,s,o,a,l,c,u){return o.runBackwards=1,fu(o).immediateRender=Hr(o.immediateRender),this.staggerTo(r,s,o,a,l,c,u)},t.staggerFromTo=function(r,s,o,a,l,c,u,h){return a.startAt=o,fu(a).immediateRender=Hr(a.immediateRender),this.staggerTo(r,s,a,l,c,u,h)},t.render=function(r,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,u=r<=0?0:Ni(r),h=this._zTime<0!=r<0&&(this._initted||!c),d,p,f,v,g,m,x,y,_,w,b,T;if(this!==si&&u>l&&r>=0&&(u=l),u!==this._tTime||o||h){if(a!==this._time&&c&&(u+=this._time-a,r+=this._time-a),d=u,_=this._start,y=this._ts,m=!y,h&&(c||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(b=this._yoyo,g=c+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(g*100+r,s,o);if(d=Ni(u%g),u===l?(v=this._repeat,d=c):(v=~~(u/g),v&&v===u/g&&(d=c,v--),d>c&&(d=c)),w=Dl(this._tTime,g),!a&&this._tTime&&w!==v&&this._tTime-w*g-this._dur<=0&&(w=v),b&&v&1&&(d=c-d,T=1),v!==w&&!this._lock){var A=b&&w&1,S=A===(b&&v&1);if(v<w&&(A=!A),a=A?0:u%c?c:u,this._lock=1,this.render(a||(T?0:Ni(v*g)),s,!c)._lock=0,this._tTime=u,!s&&this.parent&&on(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),a&&a!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,S&&(this._lock=2,a=A?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;ew(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(x=$A(this,Ni(a),Ni(d)),x&&(u-=d-(d=x._start))),this._tTime=u,this._time=d,this._act=!y,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!s&&!v&&(on(this,"onStart"),this._tTime!==u))return this;if(d>=a&&r>=0)for(p=this._first;p;){if(f=p._next,(p._act||d>=p._start)&&p._ts&&x!==p){if(p.parent!==this)return this.render(r,s,o);if(p.render(p._ts>0?(d-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(d-p._start)*p._ts,s,o),d!==this._time||!this._ts&&!m){x=0,f&&(u+=this._zTime=-Zt);break}}p=f}else{p=this._last;for(var E=r<0?r:d;p;){if(f=p._prev,(p._act||E<=p._end)&&p._ts&&x!==p){if(p.parent!==this)return this.render(r,s,o);if(p.render(p._ts>0?(E-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(E-p._start)*p._ts,s,o||sr&&(p._initted||p._startAt)),d!==this._time||!this._ts&&!m){x=0,f&&(u+=this._zTime=E?-Zt:Zt);break}}p=f}}if(x&&!s&&(this.pause(),x.render(d>=a?0:-Zt)._zTime=d>=a?1:-1,this._ts))return this._start=_,Ed(this),this.render(r,s,o);this._onUpdate&&!s&&on(this,"onUpdate",!0),(u===l&&this._tTime>=this.totalDuration()||!u&&a)&&(_===this._start||Math.abs(y)!==Math.abs(this._ts))&&(this._lock||((r||!c)&&(u===l&&this._ts>0||!u&&this._ts<0)&&_o(this,1),!s&&!(r<0&&!a)&&(u||a||!l)&&(on(this,u===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(ks(s)||(s=Tn(this,s,r)),!(r instanceof _u)){if(or(r))return r.forEach(function(a){return o.add(a,s)}),this;if(Pi(r))return this.addLabel(r,s);if(pi(r))r=yi.delayedCall(0,r);else return this}return this!==r?fs(this,r,s):this},t.getChildren=function(r,s,o,a){r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-Mn);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof yi?s&&l.push(c):(o&&l.push(c),r&&l.push.apply(l,c.getChildren(!0,s,o)))),c=c._next;return l},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return Pi(r)?this.removeLabel(r):pi(r)?this.killTweensOf(r):(Sd(this,r),r===this._recent&&(this._recent=this._last),ca(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ni(Vr.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=Tn(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=yi.delayedCall(0,s||yu,o);return a.data="isPause",this._hasPause=1,fs(this,a,Tn(this,r))},t.removePause=function(r){var s=this._first;for(r=Tn(this,r);s;)s._start===r&&s.data==="isPause"&&_o(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),l=a.length;l--;)vo!==a[l]&&a[l].kill(r,s);return this},t.getTweensOf=function(r,s){for(var o=[],a=An(r),l=this._first,c=ks(s),u;l;)l instanceof yi?VA(l._targets,a)&&(c?(!vo||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(u=l.getTweensOf(a,s)).length&&o.push.apply(o,u),l=l._next;return o},t.tweenTo=function(r,s){s=s||{};var o=this,a=Tn(o,r),l=s,c=l.startAt,u=l.onStart,h=l.onStartParams,d=l.immediateRender,p,f=yi.to(o,Cn({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||Zt,onStart:function(){if(o.pause(),!p){var g=s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());f._dur!==g&&Pl(f,g,0,1).render(f._time,!0,!0),p=1}u&&u.apply(f,h||[])}},s));return d?f.render(0):f},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,Cn({startAt:{time:Tn(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),E_(this,Tn(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),E_(this,Tn(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Zt)},t.shiftChildren=function(r,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,c;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(c in l)l[c]>=o&&(l[c]+=r);return ca(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),ca(this)},t.totalDuration=function(r){var s=0,o=this,a=o._last,l=Mn,c,u,h;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(h=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,fs(o,a,u-a._delay,1)._lock=0):l=u,u<0&&a._ts&&(s-=u,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=c;Pl(o,o===si&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(si._ts&&(F_(si,xd(r,si)),I_=Vr.frame),Vr.frame>=__){__+=Wr.autoSleep||120;var s=si._first;if((!s||!s._ts)&&Wr.autoSleep&&Vr._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Vr.sleep()}}},e}(_u);Cn(Ki.prototype,{_lock:0,_hasPause:0,_forcing:0});var hC=function(e,t,i,r,s,o,a){var l=new wr(this._pt,e,t,0,1,fg,null,s),c=0,u=0,h,d,p,f,v,g,m,x;for(l.b=i,l.e=r,i+="",r+="",(m=~r.indexOf("random("))&&(r=Ll(r)),o&&(x=[i,r],o(x,e,t),i=x[0],r=x[1]),d=i.match(Fm)||[];h=Fm.exec(r);)f=h[0],v=r.substring(c,h.index),p?p=(p+1)%5:v.substr(-5)==="rgba("&&(p=1),f!==d[u++]&&(g=parseFloat(d[u-1])||0,l._pt={_next:l._pt,p:v||u===1?v:",",s:g,c:f.charAt(1)==="="?fa(g,f)-g:parseFloat(f)-g,m:p&&p<4?Math.round:0},c=Fm.lastIndex);return l.c=c<r.length?r.substring(c,r.length):"",l.fp=a,(ig.test(r)||m)&&(l.e=0),this._pt=l,l},ug=function(e,t,i,r,s,o,a,l,c,u){pi(r)&&(r=r(s||0,e,o));var h=e[t],d=i!=="get"?i:pi(h)?c?e[t.indexOf("set")||!pi(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():h,p=pi(h)?c?gC:nw:pg,f;if(Pi(r)&&(~r.indexOf("random(")&&(r=Ll(r)),r.charAt(1)==="="&&(f=fa(d,r)+(Zi(d)||0),(f||f===0)&&(r=f))),!u||d!==r||Zm)return!isNaN(d*r)&&r!==""?(f=new wr(this._pt,e,t,+d||0,r-(d||0),typeof h=="boolean"?yC:sw,0,p),c&&(f.fp=c),a&&f.modifier(a,this,e),this._pt=f):(!h&&!(t in e)&&bd(t,r),hC.call(this,e,t,d,r,p,l||Wr.stringFilter,c))},dC=function(e,t,i,r,s){if(pi(e)&&(e=gu(e,s,t,i,r)),!ms(e)||e.style&&e.nodeType||or(e)||D_(e))return Pi(e)?gu(e,s,t,i,r):e;var o={},a;for(a in e)o[a]=gu(e[a],s,t,i,r);return o},hg=function(e,t,i,r,s,o){var a,l,c,u;if(Gr[e]&&(a=new Gr[e]).init(s,a.rawVars?t[e]:dC(t[e],r,s,o,i),i,r,o)!==!1&&(i._pt=l=new wr(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==Al))for(c=i._ptLookup[i._targets.indexOf(s)],u=a._props.length;u--;)c[a._props[u]]=l;return a},vo,Zm,dg=function n(e,t,i){var r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,c=r.onUpdate,u=r.runBackwards,h=r.yoyoEase,d=r.keyframes,p=r.autoRevert,f=e._dur,v=e._startAt,g=e._targets,m=e.parent,x=m&&m.data==="nested"?m.vars.targets:g,y=e._overwrite==="auto"&&!Qm,_=e.timeline,w,b,T,A,S,E,R,D,z,L,G,J,X;if(_&&(!d||!s)&&(s="none"),e._ease=ua(s,Cl.ease),e._yEase=h?Q_(ua(h===!0?s:h,Cl.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!_&&!!r.runBackwards,!_||d&&!r.stagger){if(D=g[0]?xo(g[0]).harness:0,J=D&&r[D.prop],w=yd(r,ng),v&&(v._zTime<0&&v.progress(1),t<0&&u&&a&&!p?v.render(-1,!0):v.revert(u&&f?pd:NA),v._lazy=0),o){if(_o(e._startAt=yi.set(g,Cn({data:"isStart",overwrite:!1,parent:m,immediateRender:!0,lazy:!v&&Hr(l),startAt:null,delay:0,onUpdate:c&&function(){return on(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(sr||!a&&!p)&&e._startAt.revert(pd),a&&f&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(u&&f&&!v){if(t&&(a=!1),T=Cn({overwrite:!1,data:"isFromStart",lazy:a&&!v&&Hr(l),immediateRender:a,stagger:0,parent:m},w),J&&(T[D.prop]=J),_o(e._startAt=yi.set(g,T)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(sr?e._startAt.revert(pd):e._startAt.render(-1,!0)),e._zTime=t,!a)n(e._startAt,Zt,Zt);else if(!t)return}for(e._pt=e._ptCache=0,l=f&&Hr(l)||l&&!f,b=0;b<g.length;b++){if(S=g[b],R=S._gsap||og(g)[b]._gsap,e._ptLookup[b]=L={},qm[R.id]&&yo.length&&vd(),G=x===g?b:x.indexOf(S),D&&(z=new D).init(S,J||w,e,G,x)!==!1&&(e._pt=A=new wr(e._pt,S,z.name,0,1,z.render,z,0,z.priority),z._props.forEach(function(N){L[N]=A}),z.priority&&(E=1)),!D||J)for(T in w)Gr[T]&&(z=hg(T,w,e,G,S,x))?z.priority&&(E=1):L[T]=A=ug.call(e,S,T,"get",w[T],G,x,0,r.stringFilter);e._op&&e._op[b]&&e.kill(S,e._op[b]),y&&e._pt&&(vo=e,si.killTweensOf(S,L,e.globalTime(t)),X=!e.parent,vo=0),e._pt&&l&&(qm[R.id]=1)}E&&gg(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!X,d&&t<=0&&_.render(Mn,!0,!0)},pC=function(e,t,i,r,s,o,a,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,h,d,p;if(!c)for(c=e._ptCache[t]=[],d=e._ptLookup,p=e._targets.length;p--;){if(u=d[p][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return Zm=1,e.vars[t]="+=0",dg(e,a),Zm=0,l?vu(t+" not eligible for reset"):1;c.push(u)}for(p=c.length;p--;)h=c[p],u=h._pt||h,u.s=(r||r===0)&&!s?r:u.s+(r||0)+o*u.c,u.c=i-u.s,h.e&&(h.e=fi(i)+Zi(h.e)),h.b&&(h.b=u.s+Zi(h.b))},fC=function(e,t){var i=e[0]?xo(e[0]).harness:0,r=i&&i.aliases,s,o,a,l;if(!r)return t;s=da({},t);for(o in r)if(o in s)for(l=r[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},mC=function(e,t,i,r){var s=t.ease||r||"power1.inOut",o,a;if(or(t))a=i[e]||(i[e]=[]),t.forEach(function(l,c){return a.push({t:c/(t.length-1)*100,v:l,e:s})});else for(o in t)a=i[o]||(i[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:s})},gu=function(e,t,i,r,s){return pi(e)?e.call(t,i,r,s):Pi(e)&&~e.indexOf("random(")?Ll(e):e},iw=sg+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",rw={};_r(iw+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return rw[n]=1});var yi=function(n){A_(e,n);function e(i,r,s,o){var a;typeof r=="number"&&(s.duration=r,r=s,s=null),a=n.call(this,o?r:fu(r))||this;var l=a.vars,c=l.duration,u=l.delay,h=l.immediateRender,d=l.stagger,p=l.overwrite,f=l.keyframes,v=l.defaults,g=l.scrollTrigger,m=l.yoyoEase,x=r.parent||si,y=(or(i)||D_(i)?ks(i[0]):"length"in r)?[i]:An(i),_,w,b,T,A,S,E,R;if(a._targets=y.length?og(y):vu("GSAP target "+i+" not found. https://gsap.com",!Wr.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=p,f||d||dd(c)||dd(u)){if(r=a.vars,_=a.timeline=new Ki({data:"nested",defaults:v||{},targets:x&&x.data==="nested"?x.vars.targets:y}),_.kill(),_.parent=_._dp=Is(a),_._start=0,d||dd(c)||dd(u)){if(T=y.length,E=d&&W_(d),ms(d))for(A in d)~iw.indexOf(A)&&(R||(R={}),R[A]=d[A]);for(w=0;w<T;w++)b=yd(r,rw),b.stagger=0,m&&(b.yoyoEase=m),R&&da(b,R),S=y[w],b.duration=+gu(c,Is(a),w,S,y),b.delay=(+gu(u,Is(a),w,S,y)||0)-a._delay,!d&&T===1&&b.delay&&(a._delay=u=b.delay,a._start+=u,b.delay=0),_.to(S,b,E?E(w,S,y):0),_._ease=Lt.none;_.duration()?c=u=0:a.timeline=0}else if(f){fu(Cn(_.vars.defaults,{ease:"none"})),_._ease=ua(f.ease||r.ease||"none");var D=0,z,L,G;if(or(f))f.forEach(function(J){return _.to(y,J,">")}),_.duration();else{b={};for(A in f)A==="ease"||A==="easeEach"||mC(A,f[A],b,f.easeEach);for(A in b)for(z=b[A].sort(function(J,X){return J.t-X.t}),D=0,w=0;w<z.length;w++)L=z[w],G={ease:L.e,duration:(L.t-(w?z[w-1].t:0))/100*c},G[A]=L.v,_.to(y,G,D),D+=G.duration;_.duration()<c&&_.to({},{duration:c-_.duration()})}}c||a.duration(c=_.duration())}else a.timeline=0;return p===!0&&!Qm&&(vo=Is(a),si.killTweensOf(y),vo=0),fs(x,Is(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(h||!c&&!f&&a._start===Ni(x._time)&&Hr(h)&&jA(Is(a))&&x.data!=="nested")&&(a._tTime=-Zt,a.render(Math.max(0,-u)||0)),g&&N_(Is(a),g),a}var t=e.prototype;return t.render=function(r,s,o){var a=this._time,l=this._tDur,c=this._dur,u=r<0,h=r>l-Zt&&!u?l:r<Zt?0:r,d,p,f,v,g,m,x,y,_;if(!c)YA(this,r,s,o);else if(h!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=h,y=this.timeline,this._repeat){if(v=c+this._rDelay,this._repeat<-1&&u)return this.totalTime(v*100+r,s,o);if(d=Ni(h%v),h===l?(f=this._repeat,d=c):(f=~~(h/v),f&&f===Ni(h/v)&&(d=c,f--),d>c&&(d=c)),m=this._yoyo&&f&1,m&&(_=this._yEase,d=c-d),g=Dl(this._tTime,v),d===a&&!o&&this._initted&&f===g)return this._tTime=h,this;f!==g&&(y&&this._yEase&&ew(y,m),this.vars.repeatRefresh&&!m&&!this._lock&&this._time!==v&&this._initted&&(this._lock=o=1,this.render(Ni(v*f),!0).invalidate()._lock=0))}if(!this._initted){if(G_(this,u?r:d,o,s,h))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&f!==g))return this;if(c!==this._dur)return this.render(r,s,o)}if(this._tTime=h,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=x=(_||this._ease)(d/c),this._from&&(this.ratio=x=1-x),d&&!a&&!s&&!f&&(on(this,"onStart"),this._tTime!==h))return this;for(p=this._pt;p;)p.r(x,p.d),p=p._next;y&&y.render(r<0?r:y._dur*y._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&jm(this,r,s,o),on(this,"onUpdate")),this._repeat&&f!==g&&this.vars.onRepeat&&!s&&this.parent&&on(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&jm(this,r,!0,!0),(r||!c)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&_o(this,1),!s&&!(u&&!a)&&(h||a||m)&&(on(this,h===l?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a,l){xu||Vr.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||dg(this,c),u=this._ease(c/this._dur),pC(this,r,s,o,a,u,c,l)?this.resetTo(r,s,o,a,1):(Td(this,0),this.parent||z_(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?du(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,vo&&vo.vars.overwrite!==!0)._first||du(this),this.parent&&o!==this.timeline.totalDuration()&&Pl(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=r?An(r):a,c=this._ptLookup,u=this._pt,h,d,p,f,v,g,m;if((!s||s==="all")&&WA(a,l))return s==="all"&&(this._pt=0),du(this);for(h=this._op=this._op||[],s!=="all"&&(Pi(s)&&(v={},_r(s,function(x){return v[x]=1}),s=v),s=fC(a,s)),m=a.length;m--;)if(~l.indexOf(a[m])){d=c[m],s==="all"?(h[m]=s,f=d,p={}):(p=h[m]=h[m]||{},f=s);for(v in f)g=d&&d[v],g&&((!("kill"in g.d)||g.d.kill(v)===!0)&&Sd(this,g,"_pt"),delete d[v]),p!=="all"&&(p[v]=1)}return this._initted&&!this._pt&&u&&du(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return mu(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return mu(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return si.killTweensOf(r,s,o)},e}(_u);Cn(yi.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_r("staggerTo,staggerFrom,staggerFromTo",function(n){yi[n]=function(){var e=new Ki,t=Ym.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var pg=function(e,t,i){return e[t]=i},nw=function(e,t,i){return e[t](i)},gC=function(e,t,i,r){return e[t](r.fp,i)},vC=function(e,t,i){return e.setAttribute(t,i)},Md=function(e,t){return pi(e[t])?nw:wd(e[t])&&e.setAttribute?vC:pg},sw=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},yC=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},fg=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},mg=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},xC=function(e,t,i,r){for(var s=this._pt,o;s;)o=s._next,s.p===r&&s.modifier(e,t,i),s=o},_C=function(e){for(var t=this._pt,i,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?Sd(this,t,"_pt"):t.dep||(i=1),t=r;return!i},wC=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},gg=function(e){for(var t=e._pt,i,r,s,o;t;){for(i=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=i}e._pt=s},wr=function(){function n(t,i,r,s,o,a,l,c,u){this.t=i,this.s=s,this.c=o,this.p=r,this.r=a||sw,this.d=l||this,this.set=c||pg,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(i,r,s){this.mSet=this.mSet||this.set,this.set=wC,this.m=i,this.mt=s,this.tween=r},n}();_r(sg+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return ng[n]=1});an.TweenMax=an.TweenLite=yi;an.TimelineLite=an.TimelineMax=Ki;si=new Ki({sortChildren:!1,defaults:Cl,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Wr.stringFilter=lg;var ha=[],md={},bC=[],M_=0,SC=0,Nm=function(e){return(md[e]||bC).map(function(t){return t()})},Jm=function(){var e=Date.now(),t=[];e-M_>2&&(Nm("matchMediaInit"),ha.forEach(function(i){var r=i.queries,s=i.conditions,o,a,l,c;for(a in r)o=ps.matchMedia(r[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,c=1);c&&(i.revert(),l&&t.push(i))}),Nm("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(r){return i.add(null,r)})}),M_=e,Nm("matchMedia"))},ow=function(){function n(t,i){this.selector=i&&$m(i),this.data=[],this._r=[],this.isReverted=!1,this.id=SC++,t&&this.add(t)}var e=n.prototype;return e.add=function(i,r,s){pi(i)&&(s=r,r=i,i=pi);var o=this,a=function(){var c=ti,u=o.selector,h;return c&&c!==o&&c.data.push(o),s&&(o.selector=$m(s)),ti=o,h=r.apply(o,arguments),pi(h)&&o._r.push(h),ti=c,o.selector=u,o.isReverted=!1,h};return o.last=a,i===pi?a(o,function(l){return o.add(null,l)}):i?o[i]=a:a},e.ignore=function(i){var r=ti;ti=null,i(this),ti=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof n?i.push.apply(i,r.getTweens()):r instanceof yi&&!(r.parent&&r.parent.data==="nested")&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var s=this;if(i?function(){for(var a=s.getTweens(),l=s.data.length,c;l--;)c=s.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,h){return h.g-u.g||-1/0}).forEach(function(u){return u.t.revert(i)}),l=s.data.length;l--;)c=s.data[l],c instanceof Ki?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof yi)&&c.revert&&c.revert(i);s._r.forEach(function(u){return u(i,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),r)for(var o=ha.length;o--;)ha[o].id===this.id&&ha.splice(o,1)},e.revert=function(i){this.kill(i||{})},n}(),EC=function(){function n(t){this.contexts=[],this.scope=t,ti&&ti.data.push(this)}var e=n.prototype;return e.add=function(i,r,s){ms(i)||(i={matches:i});var o=new ow(0,s||this.scope),a=o.conditions={},l,c,u;ti&&!o.selector&&(o.selector=ti.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=i;for(c in i)c==="all"?u=1:(l=ps.matchMedia(i[c]),l&&(ha.indexOf(o)<0&&ha.push(o),(a[c]=l.matches)&&(u=1),l.addListener?l.addListener(Jm):l.addEventListener("change",Jm)));return u&&r(o,function(h){return o.add(null,h)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},n}(),_d={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return K_(r)})},timeline:function(e){return new Ki(e)},getTweensOf:function(e,t){return si.getTweensOf(e,t)},getProperty:function(e,t,i,r){Pi(e)&&(e=An(e)[0]);var s=xo(e||{}).get,o=i?U_:k_;return i==="native"&&(i=""),e&&(t?o((Gr[t]&&Gr[t].get||s)(e,t,i,r)):function(a,l,c){return o((Gr[a]&&Gr[a].get||s)(e,a,l,c))})},quickSetter:function(e,t,i){if(e=An(e),e.length>1){var r=e.map(function(u){return ar.quickSetter(u,t,i)}),s=r.length;return function(u){for(var h=s;h--;)r[h](u)}}e=e[0]||{};var o=Gr[t],a=xo(e),l=a.harness&&(a.harness.aliases||{})[t]||t,c=o?function(u){var h=new o;Al._pt=0,h.init(e,i?u+i:u,Al,0,[e]),h.render(1,h),Al._pt&&mg(1,Al)}:a.set(e,l);return o?c:function(u){return c(e,l,i?u+i:u,a,1)}},quickTo:function(e,t,i){var r,s=ar.to(e,da((r={},r[t]="+=0.1",r.paused=!0,r),i||{})),o=function(l,c,u){return s.resetTo(t,l,c,u)};return o.tween=s,o},isTweening:function(e){return si.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=ua(e.ease,Cl.ease)),w_(Cl,e||{})},config:function(e){return w_(Wr,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,r=e.plugins,s=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!Gr[a]&&!an[a]&&vu(t+" effect requires "+a+" plugin.")}),km[t]=function(a,l,c){return i(An(a),Cn(l||{},s),c)},o&&(Ki.prototype[t]=function(a,l,c){return this.add(km[t](a,ms(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){Lt[e]=ua(t)},parseEase:function(e,t){return arguments.length?ua(e,t):Lt},getById:function(e){return si.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new Ki(e),r,s;for(i.smoothChildTiming=Hr(e.smoothChildTiming),si.remove(i),i._dp=0,i._time=i._tTime=si._time,r=si._first;r;)s=r._next,(t||!(!r._dur&&r instanceof yi&&r.vars.onComplete===r._targets[0]))&&fs(i,r,r._start-r._delay),r=s;return fs(si,i,0),i},context:function(e,t){return e?new ow(e,t):ti},matchMedia:function(e){return new EC(e)},matchMediaRefresh:function(){return ha.forEach(function(e){var t=e.conditions,i,r;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||Jm()},addEventListener:function(e,t){var i=md[e]||(md[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=md[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap:iC,wrapYoyo:rC,distribute:W_,random:j_,snap:q_,normalize:tC,getUnit:Zi,clamp:ZA,splitColor:Z_,toArray:An,selector:$m,mapRange:Y_,pipe:QA,unitize:eC,interpolate:nC,shuffle:H_},install:L_,effects:km,ticker:Vr,updateRoot:Ki.updateRoot,plugins:Gr,globalTimeline:si,core:{PropTween:wr,globals:O_,Tween:yi,Timeline:Ki,Animation:_u,getCache:xo,_removeLinkedListItem:Sd,reverting:function(){return sr},context:function(e){return e&&ti&&(ti.data.push(e),e._ctx=ti),ti},suppressOverwrites:function(e){return Qm=e}}};_r("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return _d[n]=yi[n]});Vr.add(Ki.updateRoot);Al=_d.to({},{duration:0});var TC=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},MC=function(e,t){var i=e._targets,r,s,o;for(r in t)for(s=i.length;s--;)o=e._ptLookup[s][r],o&&(o=o.d)&&(o._pt&&(o=TC(o,r)),o&&o.modifier&&o.modifier(t[r],e,i[s],r))},Gm=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var l,c;if(Pi(s)&&(l={},_r(s,function(u){return l[u]=1}),s=l),t){l={};for(c in s)l[c]=t(s[c]);s=l}MC(a,s)}}}},ar=_d.registerPlugin({name:"attr",init:function(e,t,i,r,s){var o,a,l;this.tween=i;for(o in t)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",t[o],r,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)sr?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Gm("roundProps",Km),Gm("modifiers"),Gm("snap",q_))||_d;yi.version=Ki.version=ar.version="3.12.5";R_=1;eg()&&Rl();var AC=Lt.Power0,CC=Lt.Power1,DC=Lt.Power2,PC=Lt.Power3,RC=Lt.Power4,LC=Lt.Linear,OC=Lt.Quad,IC=Lt.Cubic,FC=Lt.Quart,kC=Lt.Quint,UC=Lt.Strong,zC=Lt.Elastic,BC=Lt.Back,NC=Lt.SteppedEase,GC=Lt.Bounce,VC=Lt.Sine,HC=Lt.Expo,WC=Lt.Circ;var aw,bo,Il,Sg,xa,qC,lw,Eg,jC=function(){return typeof window!="undefined"},zs={},ya=180/Math.PI,Fl=Math.PI/180,Ol=Math.atan2,cw=1e8,Tg=/([A-Z])/g,XC=/(left|right|width|margin|padding|x)/i,YC=/[\s,\(]\S/,gs={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},xg=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},$C=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},KC=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},ZC=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},gw=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},vw=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},JC=function(e,t,i){return e.style[t]=i},QC=function(e,t,i){return e.style.setProperty(t,i)},eD=function(e,t,i){return e._gsap[t]=i},tD=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},iD=function(e,t,i,r,s){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(s,o)},rD=function(e,t,i,r,s){var o=e._gsap;o[t]=i,o.renderTransform(s,o)},oi="transform",qr=oi+"Origin",nD=function n(e,t){var i=this,r=this.target,s=r.style,o=r._gsap;if(e in zs&&s){if(this.tfm=this.tfm||{},e!=="transform")e=gs[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return i.tfm[a]=Us(r,a)}):this.tfm[e]=o.x?o[e]:Us(r,e),e===qr&&(this.tfm.zOrigin=o.zOrigin);else return gs.transform.split(",").forEach(function(a){return n.call(i,a,t)});if(this.props.indexOf(oi)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(qr,t,"")),e=oi}(s||t)&&this.props.push(e,t,s[e])},yw=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},sD=function(){var e=this.props,t=this.target,i=t.style,r=t._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(Tg,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=Eg(),(!s||!s.isStart)&&!i[oi]&&(yw(i),r.zOrigin&&i[qr]&&(i[qr]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},xw=function(e,t){var i={target:e,props:[],revert:sD,save:nD};return e._gsap||ar.core.getCache(e),t&&t.split(",").forEach(function(r){return i.save(r)}),i},_w,_g=function(e,t){var i=bo.createElementNS?bo.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):bo.createElement(e);return i&&i.style?i:bo.createElement(e)},vs=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(Tg,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,kl(t)||t,1)||""},uw="O,Moz,ms,Ms,Webkit".split(","),kl=function(e,t,i){var r=t||xa,s=r.style,o=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(uw[o]+e in s););return o<0?null:(o===3?"ms":o>=0?uw[o]:"")+e},wg=function(){jC()&&window.document&&(aw=window,bo=aw.document,Il=bo.documentElement,xa=_g("div")||{style:{}},qC=_g("div"),oi=kl(oi),qr=oi+"Origin",xa.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_w=!!kl("perspective"),Eg=ar.core.reverting,Sg=1)},vg=function n(e){var t=_g("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,s=this.style.cssText,o;if(Il.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),Il.removeChild(t),this.style.cssText=s,o},hw=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},ww=function(e){var t;try{t=e.getBBox()}catch{t=vg.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===vg||(t=vg.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+hw(e,["x","cx","x1"])||0,y:+hw(e,["y","cy","y1"])||0,width:0,height:0}:t},bw=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&ww(e))},_a=function(e,t){if(t){var i=e.style,r;t in zs&&t!==qr&&(t=oi),i.removeProperty?(r=t.substr(0,2),(r==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(r==="--"?t:t.replace(Tg,"-$1").toLowerCase())):i.removeAttribute(t)}},So=function(e,t,i,r,s,o){var a=new wr(e._pt,t,i,0,1,o?vw:gw);return e._pt=a,a.b=r,a.e=s,e._props.push(i),a},dw={deg:1,rad:1,turn:1},oD={grid:1,flex:1},Eo=function n(e,t,i,r){var s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=xa.style,l=XC.test(t),c=e.tagName.toLowerCase()==="svg",u=(c?"client":"offset")+(l?"Width":"Height"),h=100,d=r==="px",p=r==="%",f,v,g,m;if(r===o||!s||dw[r]||dw[o])return s;if(o!=="px"&&!d&&(s=n(e,t,i,"px")),m=e.getCTM&&bw(e),(p||o==="%")&&(zs[t]||~t.indexOf("adius")))return f=m?e.getBBox()[l?"width":"height"]:e[u],fi(p?s/f*h:s/100*f);if(a[l?"width":"height"]=h+(d?o:r),v=~t.indexOf("adius")||r==="em"&&e.appendChild&&!c?e:e.parentNode,m&&(v=(e.ownerSVGElement||{}).parentNode),(!v||v===bo||!v.appendChild)&&(v=bo.body),g=v._gsap,g&&p&&g.width&&l&&g.time===Vr.time&&!g.uncache)return fi(s/g.width*h);if(p&&(t==="height"||t==="width")){var x=e.style[t];e.style[t]=h+r,f=e[u],x?e.style[t]=x:_a(e,t)}else(p||o==="%")&&!oD[vs(v,"display")]&&(a.position=vs(e,"position")),v===e&&(a.position="static"),v.appendChild(xa),f=xa[u],v.removeChild(xa),a.position="absolute";return l&&p&&(g=xo(v),g.time=Vr.time,g.width=v[u]),fi(d?f*s/h:f&&s?h/f*s:0)},Us=function(e,t,i,r){var s;return Sg||wg(),t in gs&&t!=="transform"&&(t=gs[t],~t.indexOf(",")&&(t=t.split(",")[0])),zs[t]&&t!=="transform"?(s=Eu(e,r),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:Cd(vs(e,qr))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=Ad[t]&&Ad[t](e,t,i)||vs(e,t)||ag(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?Eo(e,t,s,i)+i:s},aD=function(e,t,i,r){if(!i||i==="none"){var s=kl(t,e,1),o=s&&vs(e,s,1);o&&o!==i?(t=s,i=o):t==="borderColor"&&(i=vs(e,"borderTopColor"))}var a=new wr(this._pt,e.style,t,0,1,fg),l=0,c=0,u,h,d,p,f,v,g,m,x,y,_,w;if(a.b=i,a.e=r,i+="",r+="",r==="auto"&&(v=e.style[t],e.style[t]=r,r=vs(e,t)||r,v?e.style[t]=v:_a(e,t)),u=[i,r],lg(u),i=u[0],r=u[1],d=i.match(pa)||[],w=r.match(pa)||[],w.length){for(;h=pa.exec(r);)g=h[0],x=r.substring(l,h.index),f?f=(f+1)%5:(x.substr(-5)==="rgba("||x.substr(-5)==="hsla(")&&(f=1),g!==(v=d[c++]||"")&&(p=parseFloat(v)||0,_=v.substr((p+"").length),g.charAt(1)==="="&&(g=fa(p,g)+_),m=parseFloat(g),y=g.substr((m+"").length),l=pa.lastIndex-y.length,y||(y=y||Wr.units[t]||_,l===r.length&&(r+=y,a.e+=y)),_!==y&&(p=Eo(e,t,v,y)||0),a._pt={_next:a._pt,p:x||c===1?x:",",s:p,c:m-p,m:f&&f<4||t==="zIndex"?Math.round:0});a.c=l<r.length?r.substring(l,r.length):""}else a.r=t==="display"&&r==="none"?vw:gw;return ig.test(r)&&(a.e=0),this._pt=a,a},pw={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},lD=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return(i==="top"||i==="bottom"||r==="left"||r==="right")&&(e=i,i=r,r=e),t[0]=pw[i]||i,t[1]=pw[r]||r,t.join(" ")},cD=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,r=i.style,s=t.u,o=i._gsap,a,l,c;if(s==="all"||s===!0)r.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)a=s[c],zs[a]&&(l=1,a=a==="transformOrigin"?qr:oi),_a(i,a);l&&(_a(i,oi),o&&(o.svg&&i.removeAttribute("transform"),Eu(i,1),o.uncache=1,yw(r)))}},Ad={clearProps:function(e,t,i,r,s){if(s.data!=="isFromStart"){var o=e._pt=new wr(e._pt,t,i,0,0,cD);return o.u=r,o.pr=-10,o.tween=s,e._props.push(i),1}}},Su=[1,0,0,1,0,0],Sw={},Ew=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},fw=function(e){var t=vs(e,oi);return Ew(t)?Su:t.substr(7).match(tg).map(fi)},Mg=function(e,t){var i=e._gsap||xo(e),r=e.style,s=fw(e),o,a,l,c;return i.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?Su:s):(s===Su&&!e.offsetParent&&e!==Il&&!i.svg&&(l=r.display,r.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(c=1,a=e.nextElementSibling,Il.appendChild(e)),s=fw(e),l?r.display=l:_a(e,"display"),c&&(a?o.insertBefore(e,a):o?o.appendChild(e):Il.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},bg=function(e,t,i,r,s,o){var a=e._gsap,l=s||Mg(e,!0),c=a.xOrigin||0,u=a.yOrigin||0,h=a.xOffset||0,d=a.yOffset||0,p=l[0],f=l[1],v=l[2],g=l[3],m=l[4],x=l[5],y=t.split(" "),_=parseFloat(y[0])||0,w=parseFloat(y[1])||0,b,T,A,S;i?l!==Su&&(T=p*g-f*v)&&(A=_*(g/T)+w*(-v/T)+(v*x-g*m)/T,S=_*(-f/T)+w*(p/T)-(p*x-f*m)/T,_=A,w=S):(b=ww(e),_=b.x+(~y[0].indexOf("%")?_/100*b.width:_),w=b.y+(~(y[1]||y[0]).indexOf("%")?w/100*b.height:w)),r||r!==!1&&a.smooth?(m=_-c,x=w-u,a.xOffset=h+(m*p+x*v)-m,a.yOffset=d+(m*f+x*g)-x):a.xOffset=a.yOffset=0,a.xOrigin=_,a.yOrigin=w,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!i,e.style[qr]="0px 0px",o&&(So(o,a,"xOrigin",c,_),So(o,a,"yOrigin",u,w),So(o,a,"xOffset",h,a.xOffset),So(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",_+" "+w)},Eu=function(e,t){var i=e._gsap||new cg(e);if("x"in i&&!t&&!i.uncache)return i;var r=e.style,s=i.scaleX<0,o="px",a="deg",l=getComputedStyle(e),c=vs(e,qr)||"0",u,h,d,p,f,v,g,m,x,y,_,w,b,T,A,S,E,R,D,z,L,G,J,X,N,U,O,F,$,P,C,M;return u=h=d=v=g=m=x=y=_=0,p=f=1,i.svg=!!(e.getCTM&&bw(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(r[oi]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[oi]!=="none"?l[oi]:"")),r.scale=r.rotate=r.translate="none"),T=Mg(e,i.svg),i.svg&&(i.uncache?(N=e.getBBox(),c=i.xOrigin-N.x+"px "+(i.yOrigin-N.y)+"px",X=""):X=!t&&e.getAttribute("data-svg-origin"),bg(e,X||c,!!X||i.originIsAbsolute,i.smooth!==!1,T)),w=i.xOrigin||0,b=i.yOrigin||0,T!==Su&&(R=T[0],D=T[1],z=T[2],L=T[3],u=G=T[4],h=J=T[5],T.length===6?(p=Math.sqrt(R*R+D*D),f=Math.sqrt(L*L+z*z),v=R||D?Ol(D,R)*ya:0,x=z||L?Ol(z,L)*ya+v:0,x&&(f*=Math.abs(Math.cos(x*Fl))),i.svg&&(u-=w-(w*R+b*z),h-=b-(w*D+b*L))):(M=T[6],P=T[7],O=T[8],F=T[9],$=T[10],C=T[11],u=T[12],h=T[13],d=T[14],A=Ol(M,$),g=A*ya,A&&(S=Math.cos(-A),E=Math.sin(-A),X=G*S+O*E,N=J*S+F*E,U=M*S+$*E,O=G*-E+O*S,F=J*-E+F*S,$=M*-E+$*S,C=P*-E+C*S,G=X,J=N,M=U),A=Ol(-z,$),m=A*ya,A&&(S=Math.cos(-A),E=Math.sin(-A),X=R*S-O*E,N=D*S-F*E,U=z*S-$*E,C=L*E+C*S,R=X,D=N,z=U),A=Ol(D,R),v=A*ya,A&&(S=Math.cos(A),E=Math.sin(A),X=R*S+D*E,N=G*S+J*E,D=D*S-R*E,J=J*S-G*E,R=X,G=N),g&&Math.abs(g)+Math.abs(v)>359.9&&(g=v=0,m=180-m),p=fi(Math.sqrt(R*R+D*D+z*z)),f=fi(Math.sqrt(J*J+M*M)),A=Ol(G,J),x=Math.abs(A)>2e-4?A*ya:0,_=C?1/(C<0?-C:C):0),i.svg&&(X=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!Ew(vs(e,oi)),X&&e.setAttribute("transform",X))),Math.abs(x)>90&&Math.abs(x)<270&&(s?(p*=-1,x+=v<=0?180:-180,v+=v<=0?180:-180):(f*=-1,x+=x<=0?180:-180)),t=t||i.uncache,i.x=u-((i.xPercent=u&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=h-((i.yPercent=h&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=d+o,i.scaleX=fi(p),i.scaleY=fi(f),i.rotation=fi(v)+a,i.rotationX=fi(g)+a,i.rotationY=fi(m)+a,i.skewX=x+a,i.skewY=y+a,i.transformPerspective=_+o,(i.zOrigin=parseFloat(c.split(" ")[2])||!t&&i.zOrigin||0)&&(r[qr]=Cd(c)),i.xOffset=i.yOffset=0,i.force3D=Wr.force3D,i.renderTransform=i.svg?hD:_w?Tw:uD,i.uncache=0,i},Cd=function(e){return(e=e.split(" "))[0]+" "+e[1]},yg=function(e,t,i){var r=Zi(t);return fi(parseFloat(t)+parseFloat(Eo(e,"x",i+"px",r)))+r},uD=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Tw(e,t)},ga="0deg",bu="0px",va=") ",Tw=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,l=i.z,c=i.rotation,u=i.rotationY,h=i.rotationX,d=i.skewX,p=i.skewY,f=i.scaleX,v=i.scaleY,g=i.transformPerspective,m=i.force3D,x=i.target,y=i.zOrigin,_="",w=m==="auto"&&e&&e!==1||m===!0;if(y&&(h!==ga||u!==ga)){var b=parseFloat(u)*Fl,T=Math.sin(b),A=Math.cos(b),S;b=parseFloat(h)*Fl,S=Math.cos(b),o=yg(x,o,T*S*-y),a=yg(x,a,-Math.sin(b)*-y),l=yg(x,l,A*S*-y+y)}g!==bu&&(_+="perspective("+g+va),(r||s)&&(_+="translate("+r+"%, "+s+"%) "),(w||o!==bu||a!==bu||l!==bu)&&(_+=l!==bu||w?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+va),c!==ga&&(_+="rotate("+c+va),u!==ga&&(_+="rotateY("+u+va),h!==ga&&(_+="rotateX("+h+va),(d!==ga||p!==ga)&&(_+="skew("+d+", "+p+va),(f!==1||v!==1)&&(_+="scale("+f+", "+v+va),x.style[oi]=_||"translate(0, 0)"},hD=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,l=i.rotation,c=i.skewX,u=i.skewY,h=i.scaleX,d=i.scaleY,p=i.target,f=i.xOrigin,v=i.yOrigin,g=i.xOffset,m=i.yOffset,x=i.forceCSS,y=parseFloat(o),_=parseFloat(a),w,b,T,A,S;l=parseFloat(l),c=parseFloat(c),u=parseFloat(u),u&&(u=parseFloat(u),c+=u,l+=u),l||c?(l*=Fl,c*=Fl,w=Math.cos(l)*h,b=Math.sin(l)*h,T=Math.sin(l-c)*-d,A=Math.cos(l-c)*d,c&&(u*=Fl,S=Math.tan(c-u),S=Math.sqrt(1+S*S),T*=S,A*=S,u&&(S=Math.tan(u),S=Math.sqrt(1+S*S),w*=S,b*=S)),w=fi(w),b=fi(b),T=fi(T),A=fi(A)):(w=h,A=d,b=T=0),(y&&!~(o+"").indexOf("px")||_&&!~(a+"").indexOf("px"))&&(y=Eo(p,"x",o,"px"),_=Eo(p,"y",a,"px")),(f||v||g||m)&&(y=fi(y+f-(f*w+v*T)+g),_=fi(_+v-(f*b+v*A)+m)),(r||s)&&(S=p.getBBox(),y=fi(y+r/100*S.width),_=fi(_+s/100*S.height)),S="matrix("+w+","+b+","+T+","+A+","+y+","+_+")",p.setAttribute("transform",S),x&&(p.style[oi]=S)},dD=function(e,t,i,r,s){var o=360,a=Pi(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?ya:1),c=l-r,u=r+c+"deg",h,d;return a&&(h=s.split("_")[1],h==="short"&&(c%=o,c!==c%(o/2)&&(c+=c<0?o:-o)),h==="cw"&&c<0?c=(c+o*cw)%o-~~(c/o)*o:h==="ccw"&&c>0&&(c=(c-o*cw)%o-~~(c/o)*o)),e._pt=d=new wr(e._pt,t,i,r,c,$C),d.e=u,d.u="deg",e._props.push(i),d},mw=function(e,t){for(var i in t)e[i]=t[i];return e},pD=function(e,t,i){var r=mw({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=i.style,a,l,c,u,h,d,p,f;r.svg?(c=i.getAttribute("transform"),i.setAttribute("transform",""),o[oi]=t,a=Eu(i,1),_a(i,oi),i.setAttribute("transform",c)):(c=getComputedStyle(i)[oi],o[oi]=t,a=Eu(i,1),o[oi]=c);for(l in zs)c=r[l],u=a[l],c!==u&&s.indexOf(l)<0&&(p=Zi(c),f=Zi(u),h=p!==f?Eo(i,l,c,f):parseFloat(c),d=parseFloat(u),e._pt=new wr(e._pt,a,l,h,d-h,xg),e._pt.u=f||0,e._props.push(l));mw(a,r)};_r("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",s="Left",o=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(a){return e<2?n+a:"border"+a+n});Ad[e>1?"border"+n:n]=function(a,l,c,u,h){var d,p;if(arguments.length<4)return d=o.map(function(f){return Us(a,f,c)}),p=d.join(" "),p.split(d[0]).length===5?d[0]:p;d=(u+"").split(" "),p={},o.forEach(function(f,v){return p[f]=d[v]=d[v]||d[(v-1)/2|0]}),a.init(l,p,h)}});var Ag={name:"css",register:wg,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,s){var o=this._props,a=e.style,l=i.vars.startAt,c,u,h,d,p,f,v,g,m,x,y,_,w,b,T,A;Sg||wg(),this.styles=this.styles||xw(e),A=this.styles.props,this.tween=i;for(v in t)if(v!=="autoRound"&&(u=t[v],!(Gr[v]&&hg(v,t,i,r,e,s)))){if(p=typeof u,f=Ad[v],p==="function"&&(u=u.call(i,r,e,s),p=typeof u),p==="string"&&~u.indexOf("random(")&&(u=Ll(u)),f)f(this,e,v,u,i)&&(T=1);else if(v.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(v)+"").trim(),u+="",Fs.lastIndex=0,Fs.test(c)||(g=Zi(c),m=Zi(u)),m?g!==m&&(c=Eo(e,v,c,m)+m):g&&(u+=g),this.add(a,"setProperty",c,u,r,s,0,0,v),o.push(v),A.push(v,0,a[v]);else if(p!=="undefined"){if(l&&v in l?(c=typeof l[v]=="function"?l[v].call(i,r,e,s):l[v],Pi(c)&&~c.indexOf("random(")&&(c=Ll(c)),Zi(c+"")||c==="auto"||(c+=Wr.units[v]||Zi(Us(e,v))||""),(c+"").charAt(1)==="="&&(c=Us(e,v))):c=Us(e,v),d=parseFloat(c),x=p==="string"&&u.charAt(1)==="="&&u.substr(0,2),x&&(u=u.substr(2)),h=parseFloat(u),v in gs&&(v==="autoAlpha"&&(d===1&&Us(e,"visibility")==="hidden"&&h&&(d=0),A.push("visibility",0,a.visibility),So(this,a,"visibility",d?"inherit":"hidden",h?"inherit":"hidden",!h)),v!=="scale"&&v!=="transform"&&(v=gs[v],~v.indexOf(",")&&(v=v.split(",")[0]))),y=v in zs,y){if(this.styles.save(v),_||(w=e._gsap,w.renderTransform&&!t.parseTransform||Eu(e,t.parseTransform),b=t.smoothOrigin!==!1&&w.smooth,_=this._pt=new wr(this._pt,a,oi,0,1,w.renderTransform,w,0,-1),_.dep=1),v==="scale")this._pt=new wr(this._pt,w,"scaleY",w.scaleY,(x?fa(w.scaleY,x+h):h)-w.scaleY||0,xg),this._pt.u=0,o.push("scaleY",v),v+="X";else if(v==="transformOrigin"){A.push(qr,0,a[qr]),u=lD(u),w.svg?bg(e,u,0,b,0,this):(m=parseFloat(u.split(" ")[2])||0,m!==w.zOrigin&&So(this,w,"zOrigin",w.zOrigin,m),So(this,a,v,Cd(c),Cd(u)));continue}else if(v==="svgOrigin"){bg(e,u,1,b,0,this);continue}else if(v in Sw){dD(this,w,v,d,x?fa(d,x+u):u);continue}else if(v==="smoothOrigin"){So(this,w,"smooth",w.smooth,u);continue}else if(v==="force3D"){w[v]=u;continue}else if(v==="transform"){pD(this,u,e);continue}}else v in a||(v=kl(v)||v);if(y||(h||h===0)&&(d||d===0)&&!YC.test(u)&&v in a)g=(c+"").substr((d+"").length),h||(h=0),m=Zi(u)||(v in Wr.units?Wr.units[v]:g),g!==m&&(d=Eo(e,v,c,m)),this._pt=new wr(this._pt,y?w:a,v,d,(x?fa(d,x+h):h)-d,!y&&(m==="px"||v==="zIndex")&&t.autoRound!==!1?ZC:xg),this._pt.u=m||0,g!==m&&m!=="%"&&(this._pt.b=c,this._pt.r=KC);else if(v in a)aD.call(this,e,v,c,x?x+u:u);else if(v in e)this.add(e,v,c||e[v],x?x+u:u,r,s);else if(v!=="parseTransform"){bd(v,u);continue}y||(v in a?A.push(v,0,a[v]):A.push(v,1,c||e[v])),o.push(v)}}T&&gg(this)},render:function(e,t){if(t.tween._time||!Eg())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Us,aliases:gs,getSetter:function(e,t,i){var r=gs[t];return r&&r.indexOf(",")<0&&(t=r),t in zs&&t!==qr&&(e._gsap.x||Us(e,"x"))?i&&lw===i?t==="scale"?tD:eD:(lw=i||{})&&(t==="scale"?iD:rD):e.style&&!wd(e.style[t])?JC:~t.indexOf("-")?QC:Md(e,t)},core:{_removeProperty:_a,_getMatrix:Mg}};ar.utils.checkPrefix=kl;ar.core.getStyleSaver=xw;(function(n,e,t,i){var r=_r(n+","+e+","+t,function(s){zs[s]=1});_r(e,function(s){Wr.units[s]="deg",Sw[s]=1}),gs[r[13]]=n+","+e,_r(i,function(s){var o=s.split(":");gs[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_r("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Wr.units[n]="px"});ar.registerPlugin(Ag);var qe=ar.registerPlugin(Ag)||ar,d5=qe.core.Tween;(function(){function n(){for(var i=arguments.length,r=0;r<i;r++){var s=r<0||arguments.length<=r?void 0:arguments[r];s.nodeType===1||s.nodeType===11?this.appendChild(s):this.appendChild(document.createTextNode(String(s)))}}function e(){for(;this.lastChild;)this.removeChild(this.lastChild);arguments.length&&this.append.apply(this,arguments)}function t(){for(var i=this.parentNode,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];var a=s.length;if(i)for(a||i.removeChild(this);a--;){var l=s[a];typeof l!="object"?l=this.ownerDocument.createTextNode(l):l.parentNode&&l.parentNode.removeChild(l),a?i.insertBefore(this.previousSibling,l):i.replaceChild(l,this)}}typeof Element!="undefined"&&(Element.prototype.append||(Element.prototype.append=n,DocumentFragment.prototype.append=n),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=e,DocumentFragment.prototype.replaceChildren=e),Element.prototype.replaceWith||(Element.prototype.replaceWith=t,DocumentFragment.prototype.replaceWith=t))})();function fD(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Mw(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Aw(n,e,t){return e&&Mw(n.prototype,e),t&&Mw(n,t),n}function mD(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Dw(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cw(Object(t),!0).forEach(function(i){mD(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Cw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Rw(n,e){return vD(n)||xD(n,e)||Lw(n,e)||wD()}function br(n){return gD(n)||yD(n)||Lw(n)||_D()}function gD(n){if(Array.isArray(n))return Cg(n)}function vD(n){if(Array.isArray(n))return n}function yD(n){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(n))return Array.from(n)}function xD(n,e){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var t=[],i=!0,r=!1,s=void 0;try{for(var o=n[Symbol.iterator](),a;!(i=(a=o.next()).done)&&(t.push(a.value),!(e&&t.length===e));i=!0);}catch(l){r=!0,s=l}finally{try{!i&&o.return!=null&&o.return()}finally{if(r)throw s}}return t}}function Lw(n,e){if(n){if(typeof n=="string")return Cg(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Cg(n,e)}}function Cg(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function _D(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wa(n,e){return Object.getOwnPropertyNames(Object(n)).reduce(function(t,i){var r=Object.getOwnPropertyDescriptor(Object(n),i),s=Object.getOwnPropertyDescriptor(Object(e),i);return Object.defineProperty(t,i,s||r)},{})}function Tu(n){return typeof n=="string"}function Lg(n){return Array.isArray(n)}function Dd(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=wa(n),t;return e.types!==void 0?t=e.types:e.split!==void 0&&(t=e.split),t!==void 0&&(e.types=(Tu(t)||Lg(t)?String(t):"").split(",").map(function(i){return String(i).trim()}).filter(function(i){return/((line)|(word)|(char))/i.test(i)})),(e.absolute||e.position)&&(e.absolute=e.absolute||/absolute/.test(n.position)),e}function Og(n){var e=Tu(n)||Lg(n)?String(n):"";return{none:!e,lines:/line/i.test(e),words:/word/i.test(e),chars:/char/i.test(e)}}function Rd(n){return n!==null&&typeof n=="object"}function bD(n){return Rd(n)&&/^(1|3|11)$/.test(n.nodeType)}function SD(n){return typeof n=="number"&&n>-1&&n%1===0}function ED(n){return Rd(n)&&SD(n.length)}function Sa(n){return Lg(n)?n:n==null?[]:ED(n)?Array.prototype.slice.call(n):[n]}function Pw(n){var e=n;return Tu(n)&&(/^(#[a-z]\w+)$/.test(n.trim())?e=document.getElementById(n.trim().slice(1)):e=document.querySelectorAll(n)),Sa(e).reduce(function(t,i){return[].concat(br(t),br(Sa(i).filter(bD)))},[])}var TD=Object.entries,Pd="_splittype",Jn={},MD=0;function ys(n,e,t){if(!Rd(n))return console.warn("[data.set] owner is not an object"),null;var i=n[Pd]||(n[Pd]=++MD),r=Jn[i]||(Jn[i]={});return t===void 0?e&&Object.getPrototypeOf(e)===Object.prototype&&(Jn[i]=Dw(Dw({},r),e)):e!==void 0&&(r[e]=t),t}function ba(n,e){var t=Rd(n)?n[Pd]:null,i=t&&Jn[t]||{};return e===void 0?i:i[e]}function Ow(n){var e=n&&n[Pd];e&&(delete n[e],delete Jn[e])}function AD(){Object.keys(Jn).forEach(function(n){delete Jn[n]})}function CD(){TD(Jn).forEach(function(n){var e=Rw(n,2),t=e[0],i=e[1],r=i.isRoot,s=i.isSplit;(!r||!s)&&(Jn[t]=null,delete Jn[t])})}function DD(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ",t=n?String(n):"";return t.trim().replace(/\s+/g," ").split(e)}var Ig="\\ud800-\\udfff",Iw="\\u0300-\\u036f\\ufe20-\\ufe23",Fw="\\u20d0-\\u20f0",kw="\\ufe0e\\ufe0f",PD="[".concat(Ig,"]"),Dg="[".concat(Iw).concat(Fw,"]"),Pg="\\ud83c[\\udffb-\\udfff]",RD="(?:".concat(Dg,"|").concat(Pg,")"),Uw="[^".concat(Ig,"]"),zw="(?:\\ud83c[\\udde6-\\uddff]){2}",Bw="[\\ud800-\\udbff][\\udc00-\\udfff]",Nw="\\u200d",Gw="".concat(RD,"?"),Vw="[".concat(kw,"]?"),LD="(?:"+Nw+"(?:"+[Uw,zw,Bw].join("|")+")"+Vw+Gw+")*",OD=Vw+Gw+LD,ID="(?:".concat(["".concat(Uw).concat(Dg,"?"),Dg,zw,Bw,PD].join("|"),`
)`),FD=RegExp("".concat(Pg,"(?=").concat(Pg,")|").concat(ID).concat(OD),"g"),kD=[Nw,Ig,Iw,Fw,kw],UD=RegExp("[".concat(kD.join(""),"]"));function zD(n){return n.split("")}function Hw(n){return UD.test(n)}function BD(n){return n.match(FD)||[]}function ND(n){return Hw(n)?BD(n):zD(n)}function GD(n){return n==null?"":String(n)}function VD(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return n=GD(n),n&&Tu(n)&&!e&&Hw(n)?ND(n):n.split(e)}function Rg(n,e){var t=document.createElement(n);return e&&Object.keys(e).forEach(function(i){var r=e[i],s=Tu(r)?r.trim():r;s===null||s===""||(i==="children"?t.append.apply(t,br(Sa(s))):t.setAttribute(i,s))}),t}var Fg={splitClass:"",lineClass:"line",wordClass:"word",charClass:"char",types:["lines","words","chars"],absolute:!1,tagName:"div"};function HD(n,e){e=wa(Fg,e);var t=Og(e.types),i=e.tagName,r=n.nodeValue,s=document.createDocumentFragment(),o=[],a=[];return/^\s/.test(r)&&s.append(" "),o=DD(r).reduce(function(l,c,u,h){var d,p;return t.chars&&(p=VD(c).map(function(f){var v=Rg(i,{class:"".concat(e.splitClass," ").concat(e.charClass),style:"display: inline-block;",children:f});return ys(v,"isChar",!0),a=[].concat(br(a),[v]),v})),t.words||t.lines?(d=Rg(i,{class:"".concat(e.wordClass," ").concat(e.splitClass),style:"display: inline-block; ".concat(t.words&&e.absolute?"position: relative;":""),children:t.chars?p:c}),ys(d,{isWord:!0,isWordStart:!0,isWordEnd:!0}),s.appendChild(d)):p.forEach(function(f){s.appendChild(f)}),u<h.length-1&&s.append(" "),t.words?l.concat(d):l},[]),/\s$/.test(r)&&s.append(" "),n.replaceWith(s),{words:o,chars:a}}function Ww(n,e){var t=n.nodeType,i={words:[],chars:[]};if(!/(1|3|11)/.test(t))return i;if(t===3&&/\S/.test(n.nodeValue))return HD(n,e);var r=Sa(n.childNodes);if(r.length&&(ys(n,"isSplit",!0),!ba(n).isRoot)){n.style.display="inline-block",n.style.position="relative";var s=n.nextSibling,o=n.previousSibling,a=n.textContent||"",l=s?s.textContent:" ",c=o?o.textContent:" ";ys(n,{isWordEnd:/\s$/.test(a)||/^\s/.test(l),isWordStart:/^\s/.test(a)||/\s$/.test(c)})}return r.reduce(function(u,h){var d=Ww(h,e),p=d.words,f=d.chars;return{words:[].concat(br(u.words),br(p)),chars:[].concat(br(u.chars),br(f))}},i)}function WD(n,e,t,i){if(!t.absolute)return{top:e?n.offsetTop:null};var r=n.offsetParent,s=Rw(i,2),o=s[0],a=s[1],l=0,c=0;if(r&&r!==document.body){var u=r.getBoundingClientRect();l=u.x+o,c=u.y+a}var h=n.getBoundingClientRect(),d=h.width,p=h.height,f=h.x,v=h.y,g=v+a-c,m=f+o-l;return{width:d,height:p,top:g,left:m}}function qw(n){ba(n).isWord?(Ow(n),n.replaceWith.apply(n,br(n.childNodes))):Sa(n.children).forEach(function(e){return qw(e)})}var qD=function(){return document.createDocumentFragment()};function jD(n,e,t){var i=Og(e.types),r=e.tagName,s=n.getElementsByTagName("*"),o=[],a=[],l=null,c,u,h,d=[],p=n.parentElement,f=n.nextElementSibling,v=qD(),g=window.getComputedStyle(n),m=g.textAlign,x=parseFloat(g.fontSize),y=x*.2;return e.absolute&&(h={left:n.offsetLeft,top:n.offsetTop,width:n.offsetWidth},u=n.offsetWidth,c=n.offsetHeight,ys(n,{cssWidth:n.style.width,cssHeight:n.style.height})),Sa(s).forEach(function(_){var w=_.parentElement===n,b=WD(_,w,e,t),T=b.width,A=b.height,S=b.top,E=b.left;/^br$/i.test(_.nodeName)||(i.lines&&w&&((l===null||S-l>=y)&&(l=S,o.push(a=[])),a.push(_)),e.absolute&&ys(_,{top:S,left:E,width:T,height:A}))}),p&&p.removeChild(n),i.lines&&(d=o.map(function(_){var w=Rg(r,{class:"".concat(e.splitClass," ").concat(e.lineClass),style:"display: block; text-align: ".concat(m,"; width: 100%;")});ys(w,"isLine",!0);var b={height:0,top:1e4};return v.appendChild(w),_.forEach(function(T,A,S){var E=ba(T),R=E.isWordEnd,D=E.top,z=E.height,L=S[A+1];b.height=Math.max(b.height,z),b.top=Math.min(b.top,D),w.appendChild(T),R&&ba(L).isWordStart&&w.append(" ")}),e.absolute&&ys(w,{height:b.height,top:b.top}),w}),i.words||qw(v),n.replaceChildren(v)),e.absolute&&(n.style.width="".concat(n.style.width||u,"px"),n.style.height="".concat(c,"px"),Sa(s).forEach(function(_){var w=ba(_),b=w.isLine,T=w.top,A=w.left,S=w.width,E=w.height,R=ba(_.parentElement),D=!b&&R.isLine;_.style.top="".concat(D?T-R.top:T,"px"),_.style.left=b?"".concat(h.left,"px"):"".concat(A-(D?h.left:0),"px"),_.style.height="".concat(E,"px"),_.style.width=b?"".concat(h.width,"px"):"".concat(S,"px"),_.style.position="absolute"})),p&&(f?p.insertBefore(n,f):p.appendChild(n)),d}var Ul=wa(Fg,{}),jw=function(){Aw(n,null,[{key:"clearData",value:function(){AD()}},{key:"setDefaults",value:function(t){return Ul=wa(Ul,Dd(t)),Fg}},{key:"revert",value:function(t){Pw(t).forEach(function(i){var r=ba(i),s=r.isSplit,o=r.html,a=r.cssWidth,l=r.cssHeight;s&&(i.innerHTML=o,i.style.width=a||"",i.style.height=l||"",Ow(i))})}},{key:"create",value:function(t,i){return new n(t,i)}},{key:"data",get:function(){return Jn}},{key:"defaults",get:function(){return Ul},set:function(t){Ul=wa(Ul,Dd(t))}}]);function n(e,t){fD(this,n),this.isSplit=!1,this.settings=wa(Ul,Dd(t)),this.elements=Pw(e),this.split()}return Aw(n,[{key:"split",value:function(t){var i=this;this.revert(),this.elements.forEach(function(o){ys(o,"html",o.innerHTML)}),this.lines=[],this.words=[],this.chars=[];var r=[window.pageXOffset,window.pageYOffset];t!==void 0&&(this.settings=wa(this.settings,Dd(t)));var s=Og(this.settings.types);s.none||(this.elements.forEach(function(o){ys(o,"isRoot",!0);var a=Ww(o,i.settings),l=a.words,c=a.chars;i.words=[].concat(br(i.words),br(l)),i.chars=[].concat(br(i.chars),br(c))}),this.elements.forEach(function(o){if(s.lines||i.settings.absolute){var a=jD(o,i.settings,r);i.lines=[].concat(br(i.lines),br(a))}}),this.isSplit=!0,window.scrollTo(r[0],r[1]),CD())}},{key:"revert",value:function(){this.isSplit&&(this.lines=null,this.words=null,this.chars=null,this.isSplit=!1),n.revert(this.elements)}}]),n}();function Xw(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function XD(n,e,t){return e&&Xw(n.prototype,e),t&&Xw(n,t),n}var Ji,Id,YD,ln,To,Mo,Bl,$w,Ea,Au,Kw,Bs,Qn,Zw,Jw=function(){return Ji||typeof window!="undefined"&&(Ji=window.gsap)&&Ji.registerPlugin&&Ji},Qw=1,zl=[],Tt=[],es=[],Cu=Date.now,kg=function(e,t){return t},$D=function(){var e=Au.core,t=e.bridge||{},i=e._scrollers,r=e._proxies;i.push.apply(i,Tt),r.push.apply(r,es),Tt=i,es=r,kg=function(o,a){return t[o](a)}},Gs=function(e,t){return~es.indexOf(e)&&es[es.indexOf(e)+1][t]},Du=function(e){return!!~Kw.indexOf(e)},Er=function(e,t,i,r,s){return e.addEventListener(t,i,{passive:r!==!1,capture:!!s})},Sr=function(e,t,i,r){return e.removeEventListener(t,i,!!r)},Ld="scrollLeft",Od="scrollTop",Ug=function(){return Bs&&Bs.isPressed||Tt.cache++},Fd=function(e,t){var i=function r(s){if(s||s===0){Qw&&(ln.history.scrollRestoration="manual");var o=Bs&&Bs.isPressed;s=r.v=Math.round(s)||(Bs&&Bs.iOS?1:0),e(s),r.cacheID=Tt.cache,o&&kg("ss",s)}else(t||Tt.cache!==r.cacheID||kg("ref"))&&(r.cacheID=Tt.cache,r.v=e());return r.v+r.offset};return i.offset=0,e&&i},lr={s:Ld,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:Fd(function(n){return arguments.length?ln.scrollTo(n,Si.sc()):ln.pageXOffset||To[Ld]||Mo[Ld]||Bl[Ld]||0})},Si={s:Od,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:lr,sc:Fd(function(n){return arguments.length?ln.scrollTo(lr.sc(),n):ln.pageYOffset||To[Od]||Mo[Od]||Bl[Od]||0})},Tr=function(e,t){return(t&&t._ctx&&t._ctx.selector||Ji.utils.toArray)(e)[0]||(typeof e=="string"&&Ji.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},Ns=function(e,t){var i=t.s,r=t.sc;Du(e)&&(e=To.scrollingElement||Mo);var s=Tt.indexOf(e),o=r===Si.sc?1:2;!~s&&(s=Tt.push(e)-1),Tt[s+o]||Er(e,"scroll",Ug);var a=Tt[s+o],l=a||(Tt[s+o]=Fd(Gs(e,i),!0)||(Du(e)?r:Fd(function(c){return arguments.length?e[i]=c:e[i]})));return l.target=e,a||(l.smooth=Ji.getProperty(e,"scrollBehavior")==="smooth"),l},kd=function(e,t,i){var r=e,s=e,o=Cu(),a=o,l=t||50,c=Math.max(500,l*3),u=function(f,v){var g=Cu();v||g-o>l?(s=r,r=f,a=o,o=g):i?r+=f:r=s+(f-s)/(g-a)*(o-a)},h=function(){s=r=i?0:r,a=o=0},d=function(f){var v=a,g=s,m=Cu();return(f||f===0)&&f!==r&&u(f),o===a||m-a>c?0:(r+(i?g:-g))/((i?m:o)-v)*1e3};return{update:u,reset:h,getVelocity:d}},Mu=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},Yw=function(e){var t=Math.max.apply(Math,e),i=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(i)?t:i},eb=function(){Au=Ji.core.globals().ScrollTrigger,Au&&Au.core&&$D()},tb=function(e){return Ji=e||Jw(),!Id&&Ji&&typeof document!="undefined"&&document.body&&(ln=window,To=document,Mo=To.documentElement,Bl=To.body,Kw=[ln,To,Mo,Bl],YD=Ji.utils.clamp,Zw=Ji.core.context||function(){},Ea="onpointerenter"in Bl?"pointer":"mouse",$w=mi.isTouch=ln.matchMedia&&ln.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in ln||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,Qn=mi.eventTypes=("ontouchstart"in Mo?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in Mo?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return Qw=0},500),eb(),Id=1),Id};lr.op=Si;Tt.cache=0;var mi=function(){function n(t){this.init(t)}var e=n.prototype;return e.init=function(i){Id||tb(Ji)||console.warn("Please gsap.registerPlugin(Observer)"),Au||eb();var r=i.tolerance,s=i.dragMinimum,o=i.type,a=i.target,l=i.lineHeight,c=i.debounce,u=i.preventDefault,h=i.onStop,d=i.onStopDelay,p=i.ignore,f=i.wheelSpeed,v=i.event,g=i.onDragStart,m=i.onDragEnd,x=i.onDrag,y=i.onPress,_=i.onRelease,w=i.onRight,b=i.onLeft,T=i.onUp,A=i.onDown,S=i.onChangeX,E=i.onChangeY,R=i.onChange,D=i.onToggleX,z=i.onToggleY,L=i.onHover,G=i.onHoverEnd,J=i.onMove,X=i.ignoreCheck,N=i.isNormalizer,U=i.onGestureStart,O=i.onGestureEnd,F=i.onWheel,$=i.onEnable,P=i.onDisable,C=i.onClick,M=i.scrollSpeed,B=i.capture,k=i.allowClicks,Q=i.lockAxis,Y=i.onLockAxis;this.target=a=Tr(a)||Mo,this.vars=i,p&&(p=Ji.utils.toArray(p)),r=r||1e-9,s=s||0,f=f||1,M=M||1,o=o||"wheel,touch,pointer",c=c!==!1,l||(l=parseFloat(ln.getComputedStyle(Bl).lineHeight)||22);var re,Z,V,ne,ie,te,j,W=this,H=0,q=0,I=i.passive||!u,ee=Ns(a,lr),me=Ns(a,Si),pe=ee(),ge=me(),xe=~o.indexOf("touch")&&!~o.indexOf("pointer")&&Qn[0]==="pointerdown",we=Du(a),_e=a.ownerDocument||To,Ie=[0,0,0],Be=[0,0,0],Ae=0,it=function(){return Ae=Cu()},se=function(ce,ue){return(W.event=ce)&&p&&~p.indexOf(ce.target)||ue&&xe&&ce.pointerType!=="touch"||X&&X(ce,ue)},Le=function(){W._vx.reset(),W._vy.reset(),Z.pause(),h&&h(W)},Ee=function(){var ce=W.deltaX=Yw(Ie),ue=W.deltaY=Yw(Be),de=Math.abs(ce)>=r,be=Math.abs(ue)>=r;R&&(de||be)&&R(W,ce,ue,Ie,Be),de&&(w&&W.deltaX>0&&w(W),b&&W.deltaX<0&&b(W),S&&S(W),D&&W.deltaX<0!=H<0&&D(W),H=W.deltaX,Ie[0]=Ie[1]=Ie[2]=0),be&&(A&&W.deltaY>0&&A(W),T&&W.deltaY<0&&T(W),E&&E(W),z&&W.deltaY<0!=q<0&&z(W),q=W.deltaY,Be[0]=Be[1]=Be[2]=0),(ne||V)&&(J&&J(W),V&&(x(W),V=!1),ne=!1),te&&!(te=!1)&&Y&&Y(W),ie&&(F(W),ie=!1),re=0},ke=function(ce,ue,de){Ie[de]+=ce,Be[de]+=ue,W._vx.update(ce),W._vy.update(ue),c?re||(re=requestAnimationFrame(Ee)):Ee()},We=function(ce,ue){Q&&!j&&(W.axis=j=Math.abs(ce)>Math.abs(ue)?"x":"y",te=!0),j!=="y"&&(Ie[2]+=ce,W._vx.update(ce,!0)),j!=="x"&&(Be[2]+=ue,W._vy.update(ue,!0)),c?re||(re=requestAnimationFrame(Ee)):Ee()},Qe=function(ce){if(!se(ce,1)){ce=Mu(ce,u);var ue=ce.clientX,de=ce.clientY,be=ue-W.x,Ue=de-W.y,Re=W.isDragging;W.x=ue,W.y=de,(Re||Math.abs(W.startX-ue)>=s||Math.abs(W.startY-de)>=s)&&(x&&(V=!0),Re||(W.isDragging=!0),We(be,Ue),Re||g&&g(W))}},rt=W.onPress=function(Se){se(Se,1)||Se&&Se.button||(W.axis=j=null,Z.pause(),W.isPressed=!0,Se=Mu(Se),H=q=0,W.startX=W.x=Se.clientX,W.startY=W.y=Se.clientY,W._vx.reset(),W._vy.reset(),Er(N?a:_e,Qn[1],Qe,I,!0),W.deltaX=W.deltaY=0,y&&y(W))},Oe=W.onRelease=function(Se){if(!se(Se,1)){Sr(N?a:_e,Qn[1],Qe,!0);var ce=!isNaN(W.y-W.startY),ue=W.isDragging,de=ue&&(Math.abs(W.x-W.startX)>3||Math.abs(W.y-W.startY)>3),be=Mu(Se);!de&&ce&&(W._vx.reset(),W._vy.reset(),u&&k&&Ji.delayedCall(.08,function(){if(Cu()-Ae>300&&!Se.defaultPrevented){if(Se.target.click)Se.target.click();else if(_e.createEvent){var Ue=_e.createEvent("MouseEvents");Ue.initMouseEvent("click",!0,!0,ln,1,be.screenX,be.screenY,be.clientX,be.clientY,!1,!1,!1,!1,0,null),Se.target.dispatchEvent(Ue)}}})),W.isDragging=W.isGesturing=W.isPressed=!1,h&&ue&&!N&&Z.restart(!0),m&&ue&&m(W),_&&_(W,de)}},Ce=function(ce){return ce.touches&&ce.touches.length>1&&(W.isGesturing=!0)&&U(ce,W.isDragging)},le=function(){return(W.isGesturing=!1)||O(W)},Pe=function(ce){if(!se(ce)){var ue=ee(),de=me();ke((ue-pe)*M,(de-ge)*M,1),pe=ue,ge=de,h&&Z.restart(!0)}},Ve=function(ce){if(!se(ce)){ce=Mu(ce,u),F&&(ie=!0);var ue=(ce.deltaMode===1?l:ce.deltaMode===2?ln.innerHeight:1)*f;ke(ce.deltaX*ue,ce.deltaY*ue,0),h&&!N&&Z.restart(!0)}},et=function(ce){if(!se(ce)){var ue=ce.clientX,de=ce.clientY,be=ue-W.x,Ue=de-W.y;W.x=ue,W.y=de,ne=!0,h&&Z.restart(!0),(be||Ue)&&We(be,Ue)}},Je=function(ce){W.event=ce,L(W)},Te=function(ce){W.event=ce,G(W)},Ze=function(ce){return se(ce)||Mu(ce,u)&&C(W)};Z=W._dc=Ji.delayedCall(d||.25,Le).pause(),W.deltaX=W.deltaY=0,W._vx=kd(0,50,!0),W._vy=kd(0,50,!0),W.scrollX=ee,W.scrollY=me,W.isDragging=W.isGesturing=W.isPressed=!1,Zw(this),W.enable=function(Se){return W.isEnabled||(Er(we?_e:a,"scroll",Ug),o.indexOf("scroll")>=0&&Er(we?_e:a,"scroll",Pe,I,B),o.indexOf("wheel")>=0&&Er(a,"wheel",Ve,I,B),(o.indexOf("touch")>=0&&$w||o.indexOf("pointer")>=0)&&(Er(a,Qn[0],rt,I,B),Er(_e,Qn[2],Oe),Er(_e,Qn[3],Oe),k&&Er(a,"click",it,!0,!0),C&&Er(a,"click",Ze),U&&Er(_e,"gesturestart",Ce),O&&Er(_e,"gestureend",le),L&&Er(a,Ea+"enter",Je),G&&Er(a,Ea+"leave",Te),J&&Er(a,Ea+"move",et)),W.isEnabled=!0,Se&&Se.type&&rt(Se),$&&$(W)),W},W.disable=function(){W.isEnabled&&(zl.filter(function(Se){return Se!==W&&Du(Se.target)}).length||Sr(we?_e:a,"scroll",Ug),W.isPressed&&(W._vx.reset(),W._vy.reset(),Sr(N?a:_e,Qn[1],Qe,!0)),Sr(we?_e:a,"scroll",Pe,B),Sr(a,"wheel",Ve,B),Sr(a,Qn[0],rt,B),Sr(_e,Qn[2],Oe),Sr(_e,Qn[3],Oe),Sr(a,"click",it,!0),Sr(a,"click",Ze),Sr(_e,"gesturestart",Ce),Sr(_e,"gestureend",le),Sr(a,Ea+"enter",Je),Sr(a,Ea+"leave",Te),Sr(a,Ea+"move",et),W.isEnabled=W.isPressed=W.isDragging=!1,P&&P(W))},W.kill=W.revert=function(){W.disable();var Se=zl.indexOf(W);Se>=0&&zl.splice(Se,1),Bs===W&&(Bs=0)},zl.push(W),N&&Du(a)&&(Bs=W),W.enable(v)},XD(n,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),n}();mi.version="3.12.5";mi.create=function(n){return new mi(n)};mi.register=tb;mi.getAll=function(){return zl.slice()};mi.getById=function(n){return zl.filter(function(e){return e.vars.id===n})[0]};Jw()&&Ji.registerPlugin(mi);var ct,Vl,Ot,ai,ts,Jt,xb,Jd,Vu,ku,Ru,Ud,cr,ip,qg,Ar,ib,rb,Hl,_b,zg,wb,Mr,jg,bb,Sb,Ao,Xg,Jg,Wl,Qg,Qd,Yg,Bg,zd=1,ur=Date.now,Ng=ur(),Rn=0,Lu=0,nb=function(e,t,i){var r=un(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return i["_"+t+"Clamp"]=r,r?e.substr(6,e.length-7):e},sb=function(e,t){return t&&(!un(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},KD=function n(){return Lu&&requestAnimationFrame(n)},ob=function(){return ip=1},ab=function(){return ip=0},xs=function(e){return e},Ou=function(e){return Math.round(e*1e5)/1e5||0},Eb=function(){return typeof window!="undefined"},Tb=function(){return ct||Eb()&&(ct=window.gsap)&&ct.registerPlugin&&ct},Pa=function(e){return!!~xb.indexOf(e)},Mb=function(e){return(e==="Height"?Qg:Ot["inner"+e])||ts["client"+e]||Jt["client"+e]},Ab=function(e){return Gs(e,"getBoundingClientRect")||(Pa(e)?function(){return Zd.width=Ot.innerWidth,Zd.height=Qg,Zd}:function(){return Vs(e)})},ZD=function(e,t,i){var r=i.d,s=i.d2,o=i.a;return(o=Gs(e,"getBoundingClientRect"))?function(){return o()[r]}:function(){return(t?Mb(s):e["client"+s])||0}},JD=function(e,t){return!t||~es.indexOf(e)?Ab(e):function(){return Zd}},_s=function(e,t){var i=t.s,r=t.d2,s=t.d,o=t.a;return Math.max(0,(i="scroll"+r)&&(o=Gs(e,i))?o()-Ab(e)()[s]:Pa(e)?(ts[i]||Jt[i])-Mb(r):e[i]-e["offset"+r])},Bd=function(e,t){for(var i=0;i<Hl.length;i+=3)(!t||~t.indexOf(Hl[i+1]))&&e(Hl[i],Hl[i+1],Hl[i+2])},un=function(e){return typeof e=="string"},Dr=function(e){return typeof e=="function"},Iu=function(e){return typeof e=="number"},Ta=function(e){return typeof e=="object"},Pu=function(e,t,i){return e&&e.progress(t?0:1)&&i&&e.pause()},Gg=function(e,t){if(e.enabled){var i=e._ctx?e._ctx.add(function(){return t(e)}):t(e);i&&i.totalTime&&(e.callbackAnimation=i)}},Nl=Math.abs,Cb="left",Db="top",e0="right",t0="bottom",Aa="width",Ca="height",Uu="Right",zu="Left",Bu="Top",Nu="Bottom",Ei="padding",Dn="margin",jl="Width",i0="Height",Ri="px",Pn=function(e){return Ot.getComputedStyle(e)},QD=function(e){var t=Pn(e).position;e.style.position=t==="absolute"||t==="fixed"?t:"relative"},lb=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Vs=function(e,t){var i=t&&Pn(e)[qg]!=="matrix(1, 0, 0, 1, 0, 0)"&&ct.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),r=e.getBoundingClientRect();return i&&i.progress(0).kill(),r},ep=function(e,t){var i=t.d2;return e["offset"+i]||e["client"+i]||0},Pb=function(e){var t=[],i=e.labels,r=e.duration(),s;for(s in i)t.push(i[s]/r);return t},eP=function(e){return function(t){return ct.utils.snap(Pb(e),t)}},r0=function(e){var t=ct.utils.snap(e),i=Array.isArray(e)&&e.slice(0).sort(function(r,s){return r-s});return i?function(r,s,o){o===void 0&&(o=.001);var a;if(!s)return t(r);if(s>0){for(r-=o,a=0;a<i.length;a++)if(i[a]>=r)return i[a];return i[a-1]}else for(a=i.length,r+=o;a--;)if(i[a]<=r)return i[a];return i[0]}:function(r,s,o){o===void 0&&(o=.001);var a=t(r);return!s||Math.abs(a-r)<o||a-r<0==s<0?a:t(s<0?r-e:r+e)}},tP=function(e){return function(t,i){return r0(Pb(e))(t,i.direction)}},Nd=function(e,t,i,r){return i.split(",").forEach(function(s){return e(t,s,r)})},Vi=function(e,t,i,r,s){return e.addEventListener(t,i,{passive:!r,capture:!!s})},Gi=function(e,t,i,r){return e.removeEventListener(t,i,!!r)},Gd=function(e,t,i){i=i&&i.wheelHandler,i&&(e(t,"wheel",i),e(t,"touchmove",i))},cb={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Vd={toggleActions:"play",anticipatePin:0},tp={top:0,left:0,center:.5,bottom:1,right:1},Xd=function(e,t){if(un(e)){var i=e.indexOf("="),r=~i?+(e.charAt(i-1)+1)*parseFloat(e.substr(i+1)):0;~i&&(e.indexOf("%")>i&&(r*=t/100),e=e.substr(0,i-1)),e=r+(e in tp?tp[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},Hd=function(e,t,i,r,s,o,a,l){var c=s.startColor,u=s.endColor,h=s.fontSize,d=s.indent,p=s.fontWeight,f=ai.createElement("div"),v=Pa(i)||Gs(i,"pinType")==="fixed",g=e.indexOf("scroller")!==-1,m=v?Jt:i,x=e.indexOf("start")!==-1,y=x?c:u,_="border-color:"+y+";font-size:"+h+";color:"+y+";font-weight:"+p+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return _+="position:"+((g||l)&&v?"fixed;":"absolute;"),(g||l||!v)&&(_+=(r===Si?e0:t0)+":"+(o+parseFloat(d))+"px;"),a&&(_+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),f._isStart=x,f.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),f.style.cssText=_,f.innerText=t||t===0?e+"-"+t:e,m.children[0]?m.insertBefore(f,m.children[0]):m.appendChild(f),f._offset=f["offset"+r.op.d2],Yd(f,0,r,x),f},Yd=function(e,t,i,r){var s={display:"block"},o=i[r?"os2":"p2"],a=i[r?"p2":"os2"];e._isFlipped=r,s[i.a+"Percent"]=r?-100:0,s[i.a]=r?"1px":0,s["border"+o+jl]=1,s["border"+a+jl]=0,s[i.p]=t+"px",ct.set(e,s)},Mt=[],$g={},Hu,ub=function(){return ur()-Rn>34&&(Hu||(Hu=requestAnimationFrame(Hs)))},Gl=function(){(!Mr||!Mr.isPressed||Mr.startX>Jt.clientWidth)&&(Tt.cache++,Mr?Hu||(Hu=requestAnimationFrame(Hs)):Hs(),Rn||La("scrollStart"),Rn=ur())},Vg=function(){Sb=Ot.innerWidth,bb=Ot.innerHeight},Fu=function(){Tt.cache++,!cr&&!wb&&!ai.fullscreenElement&&!ai.webkitFullscreenElement&&(!jg||Sb!==Ot.innerWidth||Math.abs(Ot.innerHeight-bb)>Ot.innerHeight*.25)&&Jd.restart(!0)},Ra={},iP=[],Rb=function n(){return Gi(ht,"scrollEnd",n)||Ma(!0)},La=function(e){return Ra[e]&&Ra[e].map(function(t){return t()})||iP},cn=[],Lb=function(e){for(var t=0;t<cn.length;t+=5)(!e||cn[t+4]&&cn[t+4].query===e)&&(cn[t].style.cssText=cn[t+1],cn[t].getBBox&&cn[t].setAttribute("transform",cn[t+2]||""),cn[t+3].uncache=1)},n0=function(e,t){var i;for(Ar=0;Ar<Mt.length;Ar++)i=Mt[Ar],i&&(!t||i._ctx===t)&&(e?i.kill(1):i.revert(!0,!0));Qd=!0,t&&Lb(t),t||La("revert")},Ob=function(e,t){Tt.cache++,(t||!Cr)&&Tt.forEach(function(i){return Dr(i)&&i.cacheID++&&(i.rec=0)}),un(e)&&(Ot.history.scrollRestoration=Jg=e)},Cr,Da=0,hb,rP=function(){if(hb!==Da){var e=hb=Da;requestAnimationFrame(function(){return e===Da&&Ma(!0)})}},Ib=function(){Jt.appendChild(Wl),Qg=!Mr&&Wl.offsetHeight||Ot.innerHeight,Jt.removeChild(Wl)},db=function(e){return Vu(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},Ma=function(e,t){if(Rn&&!e&&!Qd){Vi(ht,"scrollEnd",Rb);return}Ib(),Cr=ht.isRefreshing=!0,Tt.forEach(function(r){return Dr(r)&&++r.cacheID&&(r.rec=r())});var i=La("refreshInit");_b&&ht.sort(),t||n0(),Tt.forEach(function(r){Dr(r)&&(r.smooth&&(r.target.style.scrollBehavior="auto"),r(0))}),Mt.slice(0).forEach(function(r){return r.refresh()}),Qd=!1,Mt.forEach(function(r){if(r._subPinOffset&&r.pin){var s=r.vars.horizontal?"offsetWidth":"offsetHeight",o=r.pin[s];r.revert(!0,1),r.adjustPinSpacing(r.pin[s]-o),r.refresh()}}),Yg=1,db(!0),Mt.forEach(function(r){var s=_s(r.scroller,r._dir),o=r.vars.end==="max"||r._endClamp&&r.end>s,a=r._startClamp&&r.start>=s;(o||a)&&r.setPositions(a?s-1:r.start,o?Math.max(a?s:r.start+1,s):r.end,!0)}),db(!1),Yg=0,i.forEach(function(r){return r&&r.render&&r.render(-1)}),Tt.forEach(function(r){Dr(r)&&(r.smooth&&requestAnimationFrame(function(){return r.target.style.scrollBehavior="smooth"}),r.rec&&r(r.rec))}),Ob(Jg,1),Jd.pause(),Da++,Cr=2,Hs(2),Mt.forEach(function(r){return Dr(r.vars.onRefresh)&&r.vars.onRefresh(r)}),Cr=ht.isRefreshing=!1,La("refresh")},Kg=0,$d=1,Gu,Hs=function(e){if(e===2||!Cr&&!Qd){ht.isUpdating=!0,Gu&&Gu.update(0);var t=Mt.length,i=ur(),r=i-Ng>=50,s=t&&Mt[0].scroll();if($d=Kg>s?-1:1,Cr||(Kg=s),r&&(Rn&&!ip&&i-Rn>200&&(Rn=0,La("scrollEnd")),Ru=Ng,Ng=i),$d<0){for(Ar=t;Ar-- >0;)Mt[Ar]&&Mt[Ar].update(0,r);$d=1}else for(Ar=0;Ar<t;Ar++)Mt[Ar]&&Mt[Ar].update(0,r);ht.isUpdating=!1}Hu=0},Zg=[Cb,Db,t0,e0,Dn+Nu,Dn+Uu,Dn+Bu,Dn+zu,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],Kd=Zg.concat([Aa,Ca,"boxSizing","max"+jl,"max"+i0,"position",Dn,Ei,Ei+Bu,Ei+Uu,Ei+Nu,Ei+zu]),nP=function(e,t,i){ql(i);var r=e._gsap;if(r.spacerIsNative)ql(r.spacerState);else if(e._gsap.swappedIn){var s=t.parentNode;s&&(s.insertBefore(e,t),s.removeChild(t))}e._gsap.swappedIn=!1},Hg=function(e,t,i,r){if(!e._gsap.swappedIn){for(var s=Zg.length,o=t.style,a=e.style,l;s--;)l=Zg[s],o[l]=i[l];o.position=i.position==="absolute"?"absolute":"relative",i.display==="inline"&&(o.display="inline-block"),a[t0]=a[e0]="auto",o.flexBasis=i.flexBasis||"auto",o.overflow="visible",o.boxSizing="border-box",o[Aa]=ep(e,lr)+Ri,o[Ca]=ep(e,Si)+Ri,o[Ei]=a[Dn]=a[Db]=a[Cb]="0",ql(r),a[Aa]=a["max"+jl]=i[Aa],a[Ca]=a["max"+i0]=i[Ca],a[Ei]=i[Ei],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},sP=/([A-Z])/g,ql=function(e){if(e){var t=e.t.style,i=e.length,r=0,s,o;for((e.t._gsap||ct.core.getCache(e.t)).uncache=1;r<i;r+=2)o=e[r+1],s=e[r],o?t[s]=o:t[s]&&t.removeProperty(s.replace(sP,"-$1").toLowerCase())}},Wd=function(e){for(var t=Kd.length,i=e.style,r=[],s=0;s<t;s++)r.push(Kd[s],i[Kd[s]]);return r.t=e,r},oP=function(e,t,i){for(var r=[],s=e.length,o=i?8:0,a;o<s;o+=2)a=e[o],r.push(a,a in t?t[a]:e[o+1]);return r.t=e.t,r},Zd={left:0,top:0},pb=function(e,t,i,r,s,o,a,l,c,u,h,d,p,f){Dr(e)&&(e=e(l)),un(e)&&e.substr(0,3)==="max"&&(e=d+(e.charAt(4)==="="?Xd("0"+e.substr(3),i):0));var v=p?p.time():0,g,m,x;if(p&&p.seek(0),isNaN(e)||(e=+e),Iu(e))p&&(e=ct.utils.mapRange(p.scrollTrigger.start,p.scrollTrigger.end,0,d,e)),a&&Yd(a,i,r,!0);else{Dr(t)&&(t=t(l));var y=(e||"0").split(" "),_,w,b,T;x=Tr(t,l)||Jt,_=Vs(x)||{},(!_||!_.left&&!_.top)&&Pn(x).display==="none"&&(T=x.style.display,x.style.display="block",_=Vs(x),T?x.style.display=T:x.style.removeProperty("display")),w=Xd(y[0],_[r.d]),b=Xd(y[1]||"0",i),e=_[r.p]-c[r.p]-u+w+s-b,a&&Yd(a,b,r,i-b<20||a._isStart&&b>20),i-=i-b}if(f&&(l[f]=e||-.001,e<0&&(e=0)),o){var A=e+i,S=o._isStart;g="scroll"+r.d2,Yd(o,A,r,S&&A>20||!S&&(h?Math.max(Jt[g],ts[g]):o.parentNode[g])<=A+1),h&&(c=Vs(a),h&&(o.style[r.op.p]=c[r.op.p]-r.op.m-o._offset+Ri))}return p&&x&&(g=Vs(x),p.seek(d),m=Vs(x),p._caScrollDist=g[r.p]-m[r.p],e=e/p._caScrollDist*d),p&&p.seek(v),p?e:Math.round(e)},aP=/(webkit|moz|length|cssText|inset)/i,fb=function(e,t,i,r){if(e.parentNode!==t){var s=e.style,o,a;if(t===Jt){e._stOrig=s.cssText,a=Pn(e);for(o in a)!+o&&!aP.test(o)&&a[o]&&typeof s[o]=="string"&&o!=="0"&&(s[o]=a[o]);s.top=i,s.left=r}else s.cssText=e._stOrig;ct.core.getCache(e).uncache=1,t.appendChild(e)}},Fb=function(e,t,i){var r=t,s=r;return function(o){var a=Math.round(e());return a!==r&&a!==s&&Math.abs(a-r)>3&&Math.abs(a-s)>3&&(o=a,i&&i()),s=r,r=o,o}},qd=function(e,t,i){var r={};r[t.p]="+="+i,ct.set(e,r)},mb=function(e,t){var i=Ns(e,t),r="_scroll"+t.p2,s=function o(a,l,c,u,h){var d=o.tween,p=l.onComplete,f={};c=c||i();var v=Fb(i,c,function(){d.kill(),o.tween=0});return h=u&&h||0,u=u||a-c,d&&d.kill(),l[r]=a,l.inherit=!1,l.modifiers=f,f[r]=function(){return v(c+u*d.ratio+h*d.ratio*d.ratio)},l.onUpdate=function(){Tt.cache++,o.tween&&Hs()},l.onComplete=function(){o.tween=0,p&&p.call(d)},d=o.tween=ct.to(e,l),d};return e[r]=i,i.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},Vi(e,"wheel",i.wheelHandler),ht.isTouch&&Vi(e,"touchmove",i.wheelHandler),s},ht=function(){function n(t,i){Vl||n.register(ct)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),Xg(this),this.init(t,i)}var e=n.prototype;return e.init=function(i,r){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!Lu){this.update=this.refresh=this.kill=xs;return}i=lb(un(i)||Iu(i)||i.nodeType?{trigger:i}:i,Vd);var s=i,o=s.onUpdate,a=s.toggleClass,l=s.id,c=s.onToggle,u=s.onRefresh,h=s.scrub,d=s.trigger,p=s.pin,f=s.pinSpacing,v=s.invalidateOnRefresh,g=s.anticipatePin,m=s.onScrubComplete,x=s.onSnapComplete,y=s.once,_=s.snap,w=s.pinReparent,b=s.pinSpacer,T=s.containerAnimation,A=s.fastScrollEnd,S=s.preventOverlaps,E=i.horizontal||i.containerAnimation&&i.horizontal!==!1?lr:Si,R=!h&&h!==0,D=Tr(i.scroller||Ot),z=ct.core.getCache(D),L=Pa(D),G=("pinType"in i?i.pinType:Gs(D,"pinType")||L&&"fixed")==="fixed",J=[i.onEnter,i.onLeave,i.onEnterBack,i.onLeaveBack],X=R&&i.toggleActions.split(" "),N="markers"in i?i.markers:Vd.markers,U=L?0:parseFloat(Pn(D)["border"+E.p2+jl])||0,O=this,F=i.onRefreshInit&&function(){return i.onRefreshInit(O)},$=ZD(D,L,E),P=JD(D,L),C=0,M=0,B=0,k=Ns(D,E),Q,Y,re,Z,V,ne,ie,te,j,W,H,q,I,ee,me,pe,ge,xe,we,_e,Ie,Be,Ae,it,se,Le,Ee,ke,We,Qe,rt,Oe,Ce,le,Pe,Ve,et,Je,Te;if(O._startClamp=O._endClamp=!1,O._dir=E,g*=45,O.scroller=D,O.scroll=T?T.time.bind(T):k,Z=k(),O.vars=i,r=r||i.animation,"refreshPriority"in i&&(_b=1,i.refreshPriority===-9999&&(Gu=O)),z.tweenScroll=z.tweenScroll||{top:mb(D,Si),left:mb(D,lr)},O.tweenTo=Q=z.tweenScroll[E.p],O.scrubDuration=function(de){Ce=Iu(de)&&de,Ce?Oe?Oe.duration(de):Oe=ct.to(r,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:Ce,paused:!0,onComplete:function(){return m&&m(O)}}):(Oe&&Oe.progress(1).kill(),Oe=0)},r&&(r.vars.lazy=!1,r._initted&&!O.isReverted||r.vars.immediateRender!==!1&&i.immediateRender!==!1&&r.duration()&&r.render(0,!0,!0),O.animation=r.pause(),r.scrollTrigger=O,O.scrubDuration(h),Qe=0,l||(l=r.vars.id)),_&&((!Ta(_)||_.push)&&(_={snapTo:_}),"scrollBehavior"in Jt.style&&ct.set(L?[Jt,ts]:D,{scrollBehavior:"auto"}),Tt.forEach(function(de){return Dr(de)&&de.target===(L?ai.scrollingElement||ts:D)&&(de.smooth=!1)}),re=Dr(_.snapTo)?_.snapTo:_.snapTo==="labels"?eP(r):_.snapTo==="labelsDirectional"?tP(r):_.directional!==!1?function(de,be){return r0(_.snapTo)(de,ur()-M<500?0:be.direction)}:ct.utils.snap(_.snapTo),le=_.duration||{min:.1,max:2},le=Ta(le)?ku(le.min,le.max):ku(le,le),Pe=ct.delayedCall(_.delay||Ce/2||.1,function(){var de=k(),be=ur()-M<500,Ue=Q.tween;if((be||Math.abs(O.getVelocity())<10)&&!Ue&&!ip&&C!==de){var Re=(de-ne)/ee,Ge=r&&!R?r.totalProgress():Re,ze=be?0:(Ge-rt)/(ur()-Ru)*1e3||0,ve=ct.utils.clamp(-Re,1-Re,Nl(ze/2)*ze/.185),Ne=Re+(_.inertia===!1?0:ve),Ye,$e,He=_,je=He.onStart,K=He.onInterrupt,he=He.onComplete;if(Ye=re(Ne,O),Iu(Ye)||(Ye=Ne),$e=Math.round(ne+Ye*ee),de<=ie&&de>=ne&&$e!==de){if(Ue&&!Ue._initted&&Ue.data<=Nl($e-de))return;_.inertia===!1&&(ve=Ye-Re),Q($e,{duration:le(Nl(Math.max(Nl(Ne-Ge),Nl(Ye-Ge))*.185/ze/.05||0)),ease:_.ease||"power3",data:Nl($e-de),onInterrupt:function(){return Pe.restart(!0)&&K&&K(O)},onComplete:function(){O.update(),C=k(),r&&(Oe?Oe.resetTo("totalProgress",Ye,r._tTime/r._tDur):r.progress(Ye)),Qe=rt=r&&!R?r.totalProgress():O.progress,x&&x(O),he&&he(O)}},de,ve*ee,$e-de-ve*ee),je&&je(O,Q.tween)}}else O.isActive&&C!==de&&Pe.restart(!0)}).pause()),l&&($g[l]=O),d=O.trigger=Tr(d||p!==!0&&p),Te=d&&d._gsap&&d._gsap.stRevert,Te&&(Te=Te(O)),p=p===!0?d:Tr(p),un(a)&&(a={targets:d,className:a}),p&&(f===!1||f===Dn||(f=!f&&p.parentNode&&p.parentNode.style&&Pn(p.parentNode).display==="flex"?!1:Ei),O.pin=p,Y=ct.core.getCache(p),Y.spacer?me=Y.pinState:(b&&(b=Tr(b),b&&!b.nodeType&&(b=b.current||b.nativeElement),Y.spacerIsNative=!!b,b&&(Y.spacerState=Wd(b))),Y.spacer=xe=b||ai.createElement("div"),xe.classList.add("pin-spacer"),l&&xe.classList.add("pin-spacer-"+l),Y.pinState=me=Wd(p)),i.force3D!==!1&&ct.set(p,{force3D:!0}),O.spacer=xe=Y.spacer,We=Pn(p),it=We[f+E.os2],_e=ct.getProperty(p),Ie=ct.quickSetter(p,E.a,Ri),Hg(p,xe,We),ge=Wd(p)),N){q=Ta(N)?lb(N,cb):cb,W=Hd("scroller-start",l,D,E,q,0),H=Hd("scroller-end",l,D,E,q,0,W),we=W["offset"+E.op.d2];var Ze=Tr(Gs(D,"content")||D);te=this.markerStart=Hd("start",l,Ze,E,q,we,0,T),j=this.markerEnd=Hd("end",l,Ze,E,q,we,0,T),T&&(Je=ct.quickSetter([te,j],E.a,Ri)),!G&&!(es.length&&Gs(D,"fixedMarkers")===!0)&&(QD(L?Jt:D),ct.set([W,H],{force3D:!0}),Le=ct.quickSetter(W,E.a,Ri),ke=ct.quickSetter(H,E.a,Ri))}if(T){var Se=T.vars.onUpdate,ce=T.vars.onUpdateParams;T.eventCallback("onUpdate",function(){O.update(0,0,1),Se&&Se.apply(T,ce||[])})}if(O.previous=function(){return Mt[Mt.indexOf(O)-1]},O.next=function(){return Mt[Mt.indexOf(O)+1]},O.revert=function(de,be){if(!be)return O.kill(!0);var Ue=de!==!1||!O.enabled,Re=cr;Ue!==O.isReverted&&(Ue&&(Ve=Math.max(k(),O.scroll.rec||0),B=O.progress,et=r&&r.progress()),te&&[te,j,W,H].forEach(function(Ge){return Ge.style.display=Ue?"none":"block"}),Ue&&(cr=O,O.update(Ue)),p&&(!w||!O.isActive)&&(Ue?nP(p,xe,me):Hg(p,xe,Pn(p),se)),Ue||O.update(Ue),cr=Re,O.isReverted=Ue)},O.refresh=function(de,be,Ue,Re){if(!((cr||!O.enabled)&&!be)){if(p&&de&&Rn){Vi(n,"scrollEnd",Rb);return}!Cr&&F&&F(O),cr=O,Q.tween&&!Ue&&(Q.tween.kill(),Q.tween=0),Oe&&Oe.pause(),v&&r&&r.revert({kill:!1}).invalidate(),O.isReverted||O.revert(!0,!0),O._subPinOffset=!1;var Ge=$(),ze=P(),ve=T?T.duration():_s(D,E),Ne=ee<=.01,Ye=0,$e=Re||0,He=Ta(Ue)?Ue.end:i.end,je=i.endTrigger||d,K=Ta(Ue)?Ue.start:i.start||(i.start===0||!d?0:p?"0 0":"0 100%"),he=O.pinnedContainer=i.pinnedContainer&&Tr(i.pinnedContainer,O),ye=d&&Math.max(0,Mt.indexOf(O))||0,ae=ye,fe,Fe,tt,Ke,De,Xe,st,ut,Ct,bt,yt,ft,St;for(N&&Ta(Ue)&&(ft=ct.getProperty(W,E.p),St=ct.getProperty(H,E.p));ae--;)Xe=Mt[ae],Xe.end||Xe.refresh(0,1)||(cr=O),st=Xe.pin,st&&(st===d||st===p||st===he)&&!Xe.isReverted&&(bt||(bt=[]),bt.unshift(Xe),Xe.revert(!0,!0)),Xe!==Mt[ae]&&(ye--,ae--);for(Dr(K)&&(K=K(O)),K=nb(K,"start",O),ne=pb(K,d,Ge,E,k(),te,W,O,ze,U,G,ve,T,O._startClamp&&"_startClamp")||(p?-.001:0),Dr(He)&&(He=He(O)),un(He)&&!He.indexOf("+=")&&(~He.indexOf(" ")?He=(un(K)?K.split(" ")[0]:"")+He:(Ye=Xd(He.substr(2),Ge),He=un(K)?K:(T?ct.utils.mapRange(0,T.duration(),T.scrollTrigger.start,T.scrollTrigger.end,ne):ne)+Ye,je=d)),He=nb(He,"end",O),ie=Math.max(ne,pb(He||(je?"100% 0":ve),je,Ge,E,k()+Ye,j,H,O,ze,U,G,ve,T,O._endClamp&&"_endClamp"))||-.001,Ye=0,ae=ye;ae--;)Xe=Mt[ae],st=Xe.pin,st&&Xe.start-Xe._pinPush<=ne&&!T&&Xe.end>0&&(fe=Xe.end-(O._startClamp?Math.max(0,Xe.start):Xe.start),(st===d&&Xe.start-Xe._pinPush<ne||st===he)&&isNaN(K)&&(Ye+=fe*(1-Xe.progress)),st===p&&($e+=fe));if(ne+=Ye,ie+=Ye,O._startClamp&&(O._startClamp+=Ye),O._endClamp&&!Cr&&(O._endClamp=ie||-.001,ie=Math.min(ie,_s(D,E))),ee=ie-ne||(ne-=.01)&&.001,Ne&&(B=ct.utils.clamp(0,1,ct.utils.normalize(ne,ie,Ve))),O._pinPush=$e,te&&Ye&&(fe={},fe[E.a]="+="+Ye,he&&(fe[E.p]="-="+k()),ct.set([te,j],fe)),p&&!(Yg&&O.end>=_s(D,E)))fe=Pn(p),Ke=E===Si,tt=k(),Be=parseFloat(_e(E.a))+$e,!ve&&ie>1&&(yt=(L?ai.scrollingElement||ts:D).style,yt={style:yt,value:yt["overflow"+E.a.toUpperCase()]},L&&Pn(Jt)["overflow"+E.a.toUpperCase()]!=="scroll"&&(yt.style["overflow"+E.a.toUpperCase()]="scroll")),Hg(p,xe,fe),ge=Wd(p),Fe=Vs(p,!0),ut=G&&Ns(D,Ke?lr:Si)(),f?(se=[f+E.os2,ee+$e+Ri],se.t=xe,ae=f===Ei?ep(p,E)+ee+$e:0,ae&&(se.push(E.d,ae+Ri),xe.style.flexBasis!=="auto"&&(xe.style.flexBasis=ae+Ri)),ql(se),he&&Mt.forEach(function(ot){ot.pin===he&&ot.vars.pinSpacing!==!1&&(ot._subPinOffset=!0)}),G&&k(Ve)):(ae=ep(p,E),ae&&xe.style.flexBasis!=="auto"&&(xe.style.flexBasis=ae+Ri)),G&&(De={top:Fe.top+(Ke?tt-ne:ut)+Ri,left:Fe.left+(Ke?ut:tt-ne)+Ri,boxSizing:"border-box",position:"fixed"},De[Aa]=De["max"+jl]=Math.ceil(Fe.width)+Ri,De[Ca]=De["max"+i0]=Math.ceil(Fe.height)+Ri,De[Dn]=De[Dn+Bu]=De[Dn+Uu]=De[Dn+Nu]=De[Dn+zu]="0",De[Ei]=fe[Ei],De[Ei+Bu]=fe[Ei+Bu],De[Ei+Uu]=fe[Ei+Uu],De[Ei+Nu]=fe[Ei+Nu],De[Ei+zu]=fe[Ei+zu],pe=oP(me,De,w),Cr&&k(0)),r?(Ct=r._initted,zg(1),r.render(r.duration(),!0,!0),Ae=_e(E.a)-Be+ee+$e,Ee=Math.abs(ee-Ae)>1,G&&Ee&&pe.splice(pe.length-2,2),r.render(0,!0,!0),Ct||r.invalidate(!0),r.parent||r.totalTime(r.totalTime()),zg(0)):Ae=ee,yt&&(yt.value?yt.style["overflow"+E.a.toUpperCase()]=yt.value:yt.style.removeProperty("overflow-"+E.a));else if(d&&k()&&!T)for(Fe=d.parentNode;Fe&&Fe!==Jt;)Fe._pinOffset&&(ne-=Fe._pinOffset,ie-=Fe._pinOffset),Fe=Fe.parentNode;bt&&bt.forEach(function(ot){return ot.revert(!1,!0)}),O.start=ne,O.end=ie,Z=V=Cr?Ve:k(),!T&&!Cr&&(Z<Ve&&k(Ve),O.scroll.rec=0),O.revert(!1,!0),M=ur(),Pe&&(C=-1,Pe.restart(!0)),cr=0,r&&R&&(r._initted||et)&&r.progress()!==et&&r.progress(et||0,!0).render(r.time(),!0,!0),(Ne||B!==O.progress||T||v)&&(r&&!R&&r.totalProgress(T&&ne<-.001&&!B?ct.utils.normalize(ne,ie,0):B,!0),O.progress=Ne||(Z-ne)/ee===B?0:B),p&&f&&(xe._pinOffset=Math.round(O.progress*Ae)),Oe&&Oe.invalidate(),isNaN(ft)||(ft-=ct.getProperty(W,E.p),St-=ct.getProperty(H,E.p),qd(W,E,ft),qd(te,E,ft-(Re||0)),qd(H,E,St),qd(j,E,St-(Re||0))),Ne&&!Cr&&O.update(),u&&!Cr&&!I&&(I=!0,u(O),I=!1)}},O.getVelocity=function(){return(k()-V)/(ur()-Ru)*1e3||0},O.endAnimation=function(){Pu(O.callbackAnimation),r&&(Oe?Oe.progress(1):r.paused()?R||Pu(r,O.direction<0,1):Pu(r,r.reversed()))},O.labelToScroll=function(de){return r&&r.labels&&(ne||O.refresh()||ne)+r.labels[de]/r.duration()*ee||0},O.getTrailing=function(de){var be=Mt.indexOf(O),Ue=O.direction>0?Mt.slice(0,be).reverse():Mt.slice(be+1);return(un(de)?Ue.filter(function(Re){return Re.vars.preventOverlaps===de}):Ue).filter(function(Re){return O.direction>0?Re.end<=ne:Re.start>=ie})},O.update=function(de,be,Ue){if(!(T&&!Ue&&!de)){var Re=Cr===!0?Ve:O.scroll(),Ge=de?0:(Re-ne)/ee,ze=Ge<0?0:Ge>1?1:Ge||0,ve=O.progress,Ne,Ye,$e,He,je,K,he,ye;if(be&&(V=Z,Z=T?k():Re,_&&(rt=Qe,Qe=r&&!R?r.totalProgress():ze)),g&&p&&!cr&&!zd&&Rn&&(!ze&&ne<Re+(Re-V)/(ur()-Ru)*g?ze=1e-4:ze===1&&ie>Re+(Re-V)/(ur()-Ru)*g&&(ze=.9999)),ze!==ve&&O.enabled){if(Ne=O.isActive=!!ze&&ze<1,Ye=!!ve&&ve<1,K=Ne!==Ye,je=K||!!ze!=!!ve,O.direction=ze>ve?1:-1,O.progress=ze,je&&!cr&&($e=ze&&!ve?0:ze===1?1:ve===1?2:3,R&&(He=!K&&X[$e+1]!=="none"&&X[$e+1]||X[$e],ye=r&&(He==="complete"||He==="reset"||He in r))),S&&(K||ye)&&(ye||h||!r)&&(Dr(S)?S(O):O.getTrailing(S).forEach(function(tt){return tt.endAnimation()})),R||(Oe&&!cr&&!zd?(Oe._dp._time-Oe._start!==Oe._time&&Oe.render(Oe._dp._time-Oe._start),Oe.resetTo?Oe.resetTo("totalProgress",ze,r._tTime/r._tDur):(Oe.vars.totalProgress=ze,Oe.invalidate().restart())):r&&r.totalProgress(ze,!!(cr&&(M||de)))),p){if(de&&f&&(xe.style[f+E.os2]=it),!G)Ie(Ou(Be+Ae*ze));else if(je){if(he=!de&&ze>ve&&ie+1>Re&&Re+1>=_s(D,E),w)if(!de&&(Ne||he)){var ae=Vs(p,!0),fe=Re-ne;fb(p,Jt,ae.top+(E===Si?fe:0)+Ri,ae.left+(E===Si?0:fe)+Ri)}else fb(p,xe);ql(Ne||he?pe:ge),Ee&&ze<1&&Ne||Ie(Be+(ze===1&&!he?Ae:0))}}_&&!Q.tween&&!cr&&!zd&&Pe.restart(!0),a&&(K||y&&ze&&(ze<1||!Bg))&&Vu(a.targets).forEach(function(tt){return tt.classList[Ne||y?"add":"remove"](a.className)}),o&&!R&&!de&&o(O),je&&!cr?(R&&(ye&&(He==="complete"?r.pause().totalProgress(1):He==="reset"?r.restart(!0).pause():He==="restart"?r.restart(!0):r[He]()),o&&o(O)),(K||!Bg)&&(c&&K&&Gg(O,c),J[$e]&&Gg(O,J[$e]),y&&(ze===1?O.kill(!1,1):J[$e]=0),K||($e=ze===1?1:3,J[$e]&&Gg(O,J[$e]))),A&&!Ne&&Math.abs(O.getVelocity())>(Iu(A)?A:2500)&&(Pu(O.callbackAnimation),Oe?Oe.progress(1):Pu(r,He==="reverse"?1:!ze,1))):R&&o&&!cr&&o(O)}if(ke){var Fe=T?Re/T.duration()*(T._caScrollDist||0):Re;Le(Fe+(W._isFlipped?1:0)),ke(Fe)}Je&&Je(-Re/T.duration()*(T._caScrollDist||0))}},O.enable=function(de,be){O.enabled||(O.enabled=!0,Vi(D,"resize",Fu),L||Vi(D,"scroll",Gl),F&&Vi(n,"refreshInit",F),de!==!1&&(O.progress=B=0,Z=V=C=k()),be!==!1&&O.refresh())},O.getTween=function(de){return de&&Q?Q.tween:Oe},O.setPositions=function(de,be,Ue,Re){if(T){var Ge=T.scrollTrigger,ze=T.duration(),ve=Ge.end-Ge.start;de=Ge.start+ve*de/ze,be=Ge.start+ve*be/ze}O.refresh(!1,!1,{start:sb(de,Ue&&!!O._startClamp),end:sb(be,Ue&&!!O._endClamp)},Re),O.update()},O.adjustPinSpacing=function(de){if(se&&de){var be=se.indexOf(E.d)+1;se[be]=parseFloat(se[be])+de+Ri,se[1]=parseFloat(se[1])+de+Ri,ql(se)}},O.disable=function(de,be){if(O.enabled&&(de!==!1&&O.revert(!0,!0),O.enabled=O.isActive=!1,be||Oe&&Oe.pause(),Ve=0,Y&&(Y.uncache=1),F&&Gi(n,"refreshInit",F),Pe&&(Pe.pause(),Q.tween&&Q.tween.kill()&&(Q.tween=0)),!L)){for(var Ue=Mt.length;Ue--;)if(Mt[Ue].scroller===D&&Mt[Ue]!==O)return;Gi(D,"resize",Fu),L||Gi(D,"scroll",Gl)}},O.kill=function(de,be){O.disable(de,be),Oe&&!be&&Oe.kill(),l&&delete $g[l];var Ue=Mt.indexOf(O);Ue>=0&&Mt.splice(Ue,1),Ue===Ar&&$d>0&&Ar--,Ue=0,Mt.forEach(function(Re){return Re.scroller===O.scroller&&(Ue=1)}),Ue||Cr||(O.scroll.rec=0),r&&(r.scrollTrigger=null,de&&r.revert({kill:!1}),be||r.kill()),te&&[te,j,W,H].forEach(function(Re){return Re.parentNode&&Re.parentNode.removeChild(Re)}),Gu===O&&(Gu=0),p&&(Y&&(Y.uncache=1),Ue=0,Mt.forEach(function(Re){return Re.pin===p&&Ue++}),Ue||(Y.spacer=0)),i.onKill&&i.onKill(O)},Mt.push(O),O.enable(!1,!1),Te&&Te(O),r&&r.add&&!ee){var ue=O.update;O.update=function(){O.update=ue,ne||ie||O.refresh()},ct.delayedCall(.01,O.update),ee=.01,ne=ie=0}else O.refresh();p&&rP()},n.register=function(i){return Vl||(ct=i||Tb(),Eb()&&window.document&&n.enable(),Vl=Lu),Vl},n.defaults=function(i){if(i)for(var r in i)Vd[r]=i[r];return Vd},n.disable=function(i,r){Lu=0,Mt.forEach(function(o){return o[r?"kill":"disable"](i)}),Gi(Ot,"wheel",Gl),Gi(ai,"scroll",Gl),clearInterval(Ud),Gi(ai,"touchcancel",xs),Gi(Jt,"touchstart",xs),Nd(Gi,ai,"pointerdown,touchstart,mousedown",ob),Nd(Gi,ai,"pointerup,touchend,mouseup",ab),Jd.kill(),Bd(Gi);for(var s=0;s<Tt.length;s+=3)Gd(Gi,Tt[s],Tt[s+1]),Gd(Gi,Tt[s],Tt[s+2])},n.enable=function(){if(Ot=window,ai=document,ts=ai.documentElement,Jt=ai.body,ct&&(Vu=ct.utils.toArray,ku=ct.utils.clamp,Xg=ct.core.context||xs,zg=ct.core.suppressOverwrites||xs,Jg=Ot.history.scrollRestoration||"auto",Kg=Ot.pageYOffset,ct.core.globals("ScrollTrigger",n),Jt)){Lu=1,Wl=document.createElement("div"),Wl.style.height="100vh",Wl.style.position="absolute",Ib(),KD(),mi.register(ct),n.isTouch=mi.isTouch,Ao=mi.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),jg=mi.isTouch===1,Vi(Ot,"wheel",Gl),xb=[Ot,ai,ts,Jt],ct.matchMedia?(n.matchMedia=function(l){var c=ct.matchMedia(),u;for(u in l)c.add(u,l[u]);return c},ct.addEventListener("matchMediaInit",function(){return n0()}),ct.addEventListener("matchMediaRevert",function(){return Lb()}),ct.addEventListener("matchMedia",function(){Ma(0,1),La("matchMedia")}),ct.matchMedia("(orientation: portrait)",function(){return Vg(),Vg})):console.warn("Requires GSAP 3.11.0 or later"),Vg(),Vi(ai,"scroll",Gl);var i=Jt.style,r=i.borderTopStyle,s=ct.core.Animation.prototype,o,a;for(s.revert||Object.defineProperty(s,"revert",{value:function(){return this.time(-.01,!0)}}),i.borderTopStyle="solid",o=Vs(Jt),Si.m=Math.round(o.top+Si.sc())||0,lr.m=Math.round(o.left+lr.sc())||0,r?i.borderTopStyle=r:i.removeProperty("border-top-style"),Ud=setInterval(ub,250),ct.delayedCall(.5,function(){return zd=0}),Vi(ai,"touchcancel",xs),Vi(Jt,"touchstart",xs),Nd(Vi,ai,"pointerdown,touchstart,mousedown",ob),Nd(Vi,ai,"pointerup,touchend,mouseup",ab),qg=ct.utils.checkPrefix("transform"),Kd.push(qg),Vl=ur(),Jd=ct.delayedCall(.2,Ma).pause(),Hl=[ai,"visibilitychange",function(){var l=Ot.innerWidth,c=Ot.innerHeight;ai.hidden?(ib=l,rb=c):(ib!==l||rb!==c)&&Fu()},ai,"DOMContentLoaded",Ma,Ot,"load",Ma,Ot,"resize",Fu],Bd(Vi),Mt.forEach(function(l){return l.enable(0,1)}),a=0;a<Tt.length;a+=3)Gd(Gi,Tt[a],Tt[a+1]),Gd(Gi,Tt[a],Tt[a+2])}},n.config=function(i){"limitCallbacks"in i&&(Bg=!!i.limitCallbacks);var r=i.syncInterval;r&&clearInterval(Ud)||(Ud=r)&&setInterval(ub,r),"ignoreMobileResize"in i&&(jg=n.isTouch===1&&i.ignoreMobileResize),"autoRefreshEvents"in i&&(Bd(Gi)||Bd(Vi,i.autoRefreshEvents||"none"),wb=(i.autoRefreshEvents+"").indexOf("resize")===-1)},n.scrollerProxy=function(i,r){var s=Tr(i),o=Tt.indexOf(s),a=Pa(s);~o&&Tt.splice(o,a?6:2),r&&(a?es.unshift(Ot,r,Jt,r,ts,r):es.unshift(s,r))},n.clearMatchMedia=function(i){Mt.forEach(function(r){return r._ctx&&r._ctx.query===i&&r._ctx.kill(!0,!0)})},n.isInViewport=function(i,r,s){var o=(un(i)?Tr(i):i).getBoundingClientRect(),a=o[s?Aa:Ca]*r||0;return s?o.right-a>0&&o.left+a<Ot.innerWidth:o.bottom-a>0&&o.top+a<Ot.innerHeight},n.positionInViewport=function(i,r,s){un(i)&&(i=Tr(i));var o=i.getBoundingClientRect(),a=o[s?Aa:Ca],l=r==null?a/2:r in tp?tp[r]*a:~r.indexOf("%")?parseFloat(r)*a/100:parseFloat(r)||0;return s?(o.left+l)/Ot.innerWidth:(o.top+l)/Ot.innerHeight},n.killAll=function(i){if(Mt.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),i!==!0){var r=Ra.killAll||[];Ra={},r.forEach(function(s){return s()})}},n}();ht.version="3.12.5";ht.saveStyles=function(n){return n?Vu(n).forEach(function(e){if(e&&e.style){var t=cn.indexOf(e);t>=0&&cn.splice(t,5),cn.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),ct.core.getCache(e),Xg())}}):cn};ht.revert=function(n,e){return n0(!n,e)};ht.create=function(n,e){return new ht(n,e)};ht.refresh=function(n){return n?Fu():(Vl||ht.register())&&Ma(!0)};ht.update=function(n){return++Tt.cache&&Hs(n===!0?2:0)};ht.clearScrollMemory=Ob;ht.maxScroll=function(n,e){return _s(n,e?lr:Si)};ht.getScrollFunc=function(n,e){return Ns(Tr(n),e?lr:Si)};ht.getById=function(n){return $g[n]};ht.getAll=function(){return Mt.filter(function(n){return n.vars.id!=="ScrollSmoother"})};ht.isScrolling=function(){return!!Rn};ht.snapDirectional=r0;ht.addEventListener=function(n,e){var t=Ra[n]||(Ra[n]=[]);~t.indexOf(e)||t.push(e)};ht.removeEventListener=function(n,e){var t=Ra[n],i=t&&t.indexOf(e);i>=0&&t.splice(i,1)};ht.batch=function(n,e){var t=[],i={},r=e.interval||.016,s=e.batchMax||1e9,o=function(c,u){var h=[],d=[],p=ct.delayedCall(r,function(){u(h,d),h=[],d=[]}).pause();return function(f){h.length||p.restart(!0),h.push(f.trigger),d.push(f),s<=h.length&&p.progress(1)}},a;for(a in e)i[a]=a.substr(0,2)==="on"&&Dr(e[a])&&a!=="onRefreshInit"?o(a,e[a]):e[a];return Dr(s)&&(s=s(),Vi(ht,"refresh",function(){return s=e.batchMax()})),Vu(n).forEach(function(l){var c={};for(a in i)c[a]=i[a];c.trigger=l,t.push(ht.create(c))}),t};var gb=function(e,t,i,r){return t>r?e(r):t<0&&e(0),i>r?(r-t)/(i-t):i<0?t/(t-i):1},Wg=function n(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(mi.isTouch?" pinch-zoom":""):"none",e===ts&&n(Jt,t)},jd={auto:1,scroll:1},lP=function(e){var t=e.event,i=e.target,r=e.axis,s=(t.changedTouches?t.changedTouches[0]:t).target,o=s._gsap||ct.core.getCache(s),a=ur(),l;if(!o._isScrollT||a-o._isScrollT>2e3){for(;s&&s!==Jt&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(jd[(l=Pn(s)).overflowY]||jd[l.overflowX]));)s=s.parentNode;o._isScroll=s&&s!==i&&!Pa(s)&&(jd[(l=Pn(s)).overflowY]||jd[l.overflowX]),o._isScrollT=a}(o._isScroll||r==="x")&&(t.stopPropagation(),t._gsapAllow=!0)},kb=function(e,t,i,r){return mi.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:r=r&&lP,onPress:r,onDrag:r,onScroll:r,onEnable:function(){return i&&Vi(ai,mi.eventTypes[0],yb,!1,!0)},onDisable:function(){return Gi(ai,mi.eventTypes[0],yb,!0)}})},cP=/(input|label|select|textarea)/i,vb,yb=function(e){var t=cP.test(e.target.tagName);(t||vb)&&(e._gsapAllow=!0,vb=t)},uP=function(e){Ta(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t=e,i=t.normalizeScrollX,r=t.momentum,s=t.allowNestedScroll,o=t.onRelease,a,l,c=Tr(e.target)||ts,u=ct.core.globals().ScrollSmoother,h=u&&u.get(),d=Ao&&(e.content&&Tr(e.content)||h&&e.content!==!1&&!h.smooth()&&h.content()),p=Ns(c,Si),f=Ns(c,lr),v=1,g=(mi.isTouch&&Ot.visualViewport?Ot.visualViewport.scale*Ot.visualViewport.width:Ot.outerWidth)/Ot.innerWidth,m=0,x=Dr(r)?function(){return r(a)}:function(){return r||2.8},y,_,w=kb(c,e.type,!0,s),b=function(){return _=!1},T=xs,A=xs,S=function(){l=_s(c,Si),A=ku(Ao?1:0,l),i&&(T=ku(0,_s(c,lr))),y=Da},E=function(){d._gsap.y=Ou(parseFloat(d._gsap.y)+p.offset)+"px",d.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(d._gsap.y)+", 0, 1)",p.offset=p.cacheID=0},R=function(){if(_){requestAnimationFrame(b);var N=Ou(a.deltaY/2),U=A(p.v-N);if(d&&U!==p.v+p.offset){p.offset=U-p.v;var O=Ou((parseFloat(d&&d._gsap.y)||0)-p.offset);d.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+O+", 0, 1)",d._gsap.y=O+"px",p.cacheID=Tt.cache,Hs()}return!0}p.offset&&E(),_=!0},D,z,L,G,J=function(){S(),D.isActive()&&D.vars.scrollY>l&&(p()>l?D.progress(1)&&p(l):D.resetTo("scrollY",l))};return d&&ct.set(d,{y:"+=0"}),e.ignoreCheck=function(X){return Ao&&X.type==="touchmove"&&R(X)||v>1.05&&X.type!=="touchstart"||a.isGesturing||X.touches&&X.touches.length>1},e.onPress=function(){_=!1;var X=v;v=Ou((Ot.visualViewport&&Ot.visualViewport.scale||1)/g),D.pause(),X!==v&&Wg(c,v>1.01?!0:i?!1:"x"),z=f(),L=p(),S(),y=Da},e.onRelease=e.onGestureStart=function(X,N){if(p.offset&&E(),!N)G.restart(!0);else{Tt.cache++;var U=x(),O,F;i&&(O=f(),F=O+U*.05*-X.velocityX/.227,U*=gb(f,O,F,_s(c,lr)),D.vars.scrollX=T(F)),O=p(),F=O+U*.05*-X.velocityY/.227,U*=gb(p,O,F,_s(c,Si)),D.vars.scrollY=A(F),D.invalidate().duration(U).play(.01),(Ao&&D.vars.scrollY>=l||O>=l-1)&&ct.to({},{onUpdate:J,duration:U})}o&&o(X)},e.onWheel=function(){D._ts&&D.pause(),ur()-m>1e3&&(y=0,m=ur())},e.onChange=function(X,N,U,O,F){if(Da!==y&&S(),N&&i&&f(T(O[2]===N?z+(X.startX-X.x):f()+N-O[1])),U){p.offset&&E();var $=F[2]===U,P=$?L+X.startY-X.y:p()+U-F[1],C=A(P);$&&P!==C&&(L+=C-P),p(C)}(U||N)&&Hs()},e.onEnable=function(){Wg(c,i?!1:"x"),ht.addEventListener("refresh",J),Vi(Ot,"resize",J),p.smooth&&(p.target.style.scrollBehavior="auto",p.smooth=f.smooth=!1),w.enable()},e.onDisable=function(){Wg(c,!0),Gi(Ot,"resize",J),ht.removeEventListener("refresh",J),w.kill()},e.lockAxis=e.lockAxis!==!1,a=new mi(e),a.iOS=Ao,Ao&&!p()&&p(1),Ao&&ct.ticker.add(xs),G=a._dc,D=ct.to(a,{ease:"power4",paused:!0,inherit:!1,scrollX:i?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:Fb(p,p(),function(){return D.pause()})},onUpdate:Hs,onComplete:G.vars.onComplete}),a};ht.sort=function(n){return Mt.sort(n||function(e,t){return(e.vars.refreshPriority||0)*-1e6+e.start-(t.start+(t.vars.refreshPriority||0)*-1e6)})};ht.observe=function(n){return new mi(n)};ht.normalizeScroll=function(n){if(typeof n=="undefined")return Mr;if(n===!0&&Mr)return Mr.enable();if(n===!1){Mr&&Mr.kill(),Mr=n;return}var e=n instanceof mi?n:uP(n);return Mr&&Mr.target===e.target&&Mr.kill(),Pa(e.target)&&(Mr=e),e};ht.core={_getVelocityProp:kd,_inputObserver:kb,_scrollers:Tt,_proxies:es,bridge:{ss:function(){Rn||La("scrollStart"),Rn=ur()},ref:function(){return cr}}};Tb()&&ct.registerPlugin(ht);qe.registerPlugin(ht);function zb(n,e){return new jw(n,{types:e})}var Ub=[];function hP(){Ub.forEach(n=>{n.revert()}),Ub=[],s0()}function dP(n,e,t){let i;return function(){let s=this,o=arguments,a=function(){i=null,t||n.apply(s,o)},l=t&&!i;clearTimeout(i),i=setTimeout(a,e),l&&n.apply(s,o)}}var Bb=dP(hP,250);function s0(){zb("[split-text]","lines, words")}function Nb(){zb("[split-code]","lines, words")}function Gb(){let n=window.innerWidth;window.onresize=function(){let e=window.innerWidth;(n<991&&e>=991||n>=991&&e<991)&&location.reload(),n=e}}function Vb(){ht.refresh()}function Hb(){function n(){document.querySelectorAll("[data-video-load]").forEach(t=>{let i=t.querySelector("video"),r=i.dataset.videoUrl;if(r){let s=i.querySelector("source");s.src=r,i.load(),i.play().catch(o=>{console.error("Auto-play was prevented: ",o)})}})}n()}function Wb(){let n="%c \u2629 Site built by, https://itsoffbrand.com \u2629",e=["font-size: 12px","color: #fffce1","font-family: monospace","background: #0e100f","display: inline-block","padding: 1rem 3rem","border: 1px solid #fffce1","border-radius: 4px;"].join(";");console.log(n,e)}var pP=/(?:^\s+|\s+$)/g,fP=/([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/;function rp(n){var e=n.nodeType,t="";if(e===1||e===9||e===11){if(typeof n.textContent=="string")return n.textContent;for(n=n.firstChild;n;n=n.nextSibling)t+=rp(n)}else if(e===3||e===4)return n.nodeValue;return t}function is(n,e,t,i){if(n+="",t&&(n=n.trim?n.trim():n.replace(pP,"")),e&&e!=="")return n.replace(/>/g,"&gt;").replace(/</g,"&lt;").split(e);for(var r=[],s=n.length,o=0,a,l;o<s;o++)l=n.charAt(o),(l.charCodeAt(0)>=55296&&l.charCodeAt(0)<=56319||n.charCodeAt(o+1)>=65024&&n.charCodeAt(o+1)<=65039)&&(a=((n.substr(o,12).split(fP)||[])[1]||"").length||2,l=n.substr(o,a),r.emoji=1,o+=a-1),r.push(l===">"?"&gt;":l==="<"?"&lt;":i&&l===" "&&(n.charAt(o-1)===" "||n.charAt(o+1)===" ")?"&nbsp;":l);return r}var np=function(){function n(t){this.chars=is(t),this.sets=[],this.length=50;for(var i=0;i<20;i++)this.sets[i]=jb(80,this.chars)}var e=n.prototype;return e.grow=function(i){for(var r=0;r<20;r++)this.sets[r]+=jb(i-this.length,this.chars);this.length=i},n}(),Oa,$b,Kb=function(){return Oa||typeof window!="undefined"&&(Oa=window.gsap)&&Oa.registerPlugin&&Oa},mP=1,qb=/\s+/g,jb=function(e,t){for(var i=t.length,r="";--e>-1;)r+=t[~~(Math.random()*i)];return r},o0="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Xb=o0.toLowerCase(),gP={upperCase:new np(o0),lowerCase:new np(Xb),upperAndLowerCase:new np(o0+Xb)},Yb=function(){$b=Oa=Kb()},Ia={version:"3.12.5",name:"scrambleText",register:function(e,t,i){Oa=e,Yb()},init:function(e,t,i,r,s){if($b||Yb(),this.prop="innerHTML"in e?"innerHTML":"textContent"in e?"textContent":0,!!this.prop){this.target=e,typeof t!="object"&&(t={text:t});var o=t.text||t.value||"",a=t.trim!==!1,l=this,c,u,h,d;return l.delimiter=c=t.delimiter||"",l.original=is(rp(e).replace(qb," ").split("&nbsp;").join(""),c,a),(o==="{original}"||o===!0||o==null)&&(o=l.original.join(c)),l.text=is((o||"").replace(qb," "),c,a),l.hasClass=!!(t.newClass||t.oldClass),l.newClass=t.newClass,l.oldClass=t.oldClass,d=c==="",l.textHasEmoji=d&&!!l.text.emoji,l.charsHaveEmoji=!!t.chars&&!!is(t.chars).emoji,l.length=d?l.original.length:l.original.join(c).length,l.lengthDif=(d?l.text.length:l.text.join(c).length)-l.length,l.fillChar=t.fillChar||t.chars&&~t.chars.indexOf(" ")?"&nbsp;":"",l.charSet=h=gP[t.chars||"upperCase"]||new np(t.chars),l.speed=.05/(t.speed||1),l.prevScrambleTime=0,l.setIndex=Math.random()*20|0,u=l.length+Math.max(l.lengthDif,0),u>h.length&&h.grow(u),l.chars=h.sets[l.setIndex],l.revealDelay=t.revealDelay||0,l.tweenLength=t.tweenLength!==!1,l.tween=i,l.rightToLeft=!!t.rightToLeft,l._props.push("scrambleText","text"),mP}},render:function(e,t){var i=t.target,r=t.prop,s=t.text,o=t.delimiter,a=t.tween,l=t.prevScrambleTime,c=t.revealDelay,u=t.setIndex,h=t.chars,d=t.charSet,p=t.length,f=t.textHasEmoji,v=t.charsHaveEmoji,g=t.lengthDif,m=t.tweenLength,x=t.oldClass,y=t.newClass,_=t.rightToLeft,w=t.fillChar,b=t.speed,T=t.original,A=t.hasClass,S=s.length,E=a._time,R=E-l,D,z,L,G,J,X,N,U,O,F,$;c&&(a._from&&(E=a._dur-E),e=E===0?0:E<c?1e-6:E===a._dur?1:a._ease((E-c)/(a._dur-c))),e<0?e=0:e>1&&(e=1),_&&(e=1-e),D=~~(e*S+.5),e?((R>b||R<-b)&&(t.setIndex=u=(u+(Math.random()*19|0))%20,t.chars=d.sets[u],t.prevScrambleTime+=R),G=h):G=T.join(o),$=a._from?e:1-e,F=p+(m?a._from?$*$*$:1-$*$*$:1)*g,_?e===1&&(a._from||a.data==="isFromStart")?(L="",G=T.join(o)):(N=s.slice(D).join(o),v?L=is(G).slice(0,F-(f?is(N):N).length+.5|0).join(""):L=G.substr(0,F-(f?is(N):N).length+.5|0),G=N):(L=s.slice(0,D).join(o),z=(f?is(L):L).length,v?G=is(G).slice(z,F+.5|0).join(""):G=G.substr(z,F-z+.5|0)),A?(U=_?x:y,O=_?y:x,J=U&&D!==0,X=O&&D!==S,N=(J?"<span class='"+U+"'>":"")+L+(J?"</span>":"")+(X?"<span class='"+O+"'>":"")+o+G+(X?"</span>":"")):N=L+o+G,i[r]=w==="&nbsp;"&&~N.indexOf("  ")?N.split("  ").join("&nbsp;&nbsp;"):N}};Ia.emojiSafeSplit=is;Ia.getText=rp;Kb()&&Oa.registerPlugin(Ia);qe.registerPlugin(ht);function vP(){document.querySelectorAll("[data-mason-w]").forEach(e=>{let t=e.querySelectorAll(".mason__line.is--top, .mason__line.is--btm"),i=e.querySelectorAll(".mason__line.is--left, .mason__line.is--right"),r=1;t.length===0&&i.length===0||(t.length>0&&qe.set(t,{scaleX:0}),i.length>0&&qe.set(i,{scaleY:0}),ht.create({trigger:e,start:"top 80%",onEnter:()=>{t.length>0&&qe.to(t,{scaleX:1,duration:r,ease:"power2.inOut",stagger:.1}),i.length>0&&qe.to(i,{scaleY:1,duration:r,ease:"power2.inOut",stagger:.1})}}))})}function yP(){let n=document.querySelectorAll("[data-flash]"),e=.1;n.length!==0&&n.forEach(t=>{let i=Math.random()<.5?"x":"y",r=Math.random()<.5?"-4rem":"4rem",s={autoAlpha:0};s[i]=r,qe.set(t,s);let o=Math.floor(Math.random()*3)+2;ht.create({trigger:t,start:"top 80%",onEnter:()=>{qe.to(t,{autoAlpha:1,duration:e,repeat:o,ease:"none",onComplete:()=>{qe.set(t,{x:"0rem",y:"0rem"})}})}})})}function xP(){let n=document.querySelectorAll("[data-vision-slide], [data-blog-slide]"),e=.1;n.length!==0&&n.forEach(t=>{let i=Math.random()<.5?"x":"y",r=Math.random()<.5?"-4rem":"4rem",s={autoAlpha:0};s[i]=r,qe.set(t,s);let o=Math.floor(Math.random()*3)+2;ht.create({trigger:t,start:"top 80%",onEnter:()=>{qe.to(t,{autoAlpha:1,duration:e,repeat:o,ease:"none",onComplete:()=>{qe.set(t,{x:"0rem",y:"0rem"})}})}})})}function _P(){let n=document.querySelectorAll("[data-ip-parent]");if(!n.length)return;let e=.1,t=[.5,.8,1];n.forEach(i=>{let r=i.querySelectorAll(".ip__logo--item");qe.set(r,{autoAlpha:0,y:"4rem"}),ht.create({trigger:i,start:"top 80%",onEnter:()=>{r.forEach(s=>{let o=s.querySelector(".ip__logo--ol"),a=Math.floor(Math.random()*3)+2,l=t[Math.floor(Math.random()*t.length)];qe.to(s,{delay:l,autoAlpha:1,duration:e,repeat:a,ease:"none",onComplete:()=>{s.style.removeProperty("transform")}}),qe.to(o,{delay:l+.1,autoAlpha:0,duration:e,repeat:a,ease:"none",onComplete:()=>{s.style.removeProperty("transform")}})})}})})}function wP(){document.querySelector("[data-ip-section]").querySelectorAll(".ip__logo--item").forEach(t=>{t.addEventListener("mouseenter",function(){let i=this.querySelector(".ip__logo--ol");i&&qe.to(i,{autoAlpha:1,duration:.1,repeat:1,onComplete:function(){qe.set(i,{autoAlpha:0})}})}),t.addEventListener("mouseleave",function(){let i=this.querySelector(".ip__logo--ol");i&&qe.set(i,{autoAlpha:0})})})}function bP(){let n=document.querySelectorAll("[data-flash-parent]");if(!n.length)return;let e=.1,t=[.5,.8,1];n.forEach(i=>{let r=i.querySelectorAll("[data-flash-child]");qe.set(r,{autoAlpha:0,y:"4rem"}),ht.create({trigger:i,start:"top 80%",onEnter:()=>{r.forEach(s=>{let o=Math.floor(Math.random()*3)+2,a=t[Math.floor(Math.random()*t.length)];qe.to(s,{delay:a,autoAlpha:1,duration:e,repeat:o,ease:"none",onComplete:()=>{s.style.removeProperty("transform")}})})}})})}function SP(){let n=document.querySelectorAll("[data-text-flash]");n.length&&qe.utils.toArray(n).forEach(e=>{let t=qe.utils.toArray(e.querySelectorAll(".word"));if(!t.length)return;let i=e.getAttribute("data-text-flash")==="parent",r=s=>{let o=Math.random()<.5?"x":"y",a=Math.random()<.5?"-4rem":"4rem",l=Math.floor(Math.random()*3)+2;qe.set(s,{autoAlpha:0,[o]:a}),qe.to(s,{autoAlpha:1,duration:.1,repeat:l,ease:"none",onComplete:()=>{s.style.removeProperty("transform")}})};ht.create({trigger:i?e:t,start:"top 90%",onEnter:()=>{i?t.forEach(r):t.forEach(s=>{ht.create({trigger:s,start:"top 90%",onEnter:()=>r(s)})})}})})}function EP(){let n=document.querySelectorAll("[data-code-in]"),e=1,t="\u2591\u2592\u2593\u2588\u2580\u2584?";n.forEach(i=>{i.dataset.originalText=i.textContent,i.textContent="",qe.to(i,{scrollTrigger:{trigger:i,start:"top 80%",onEnter:()=>{qe.to(i,{duration:e,scrambleText:{text:i.dataset.originalText,chars:t,revealDelay:0,delimiter:"",speed:.3}})}}})})}function Zb(){setTimeout(()=>xP(),500),_P(),wP(),vP(),yP(),bP(),SP(),EP(),window.isTabletOrBelow}function Jb(n){return n!==null&&typeof n=="object"&&"constructor"in n&&n.constructor===Object}function a0(n,e){n===void 0&&(n={}),e===void 0&&(e={}),Object.keys(e).forEach(t=>{typeof n[t]=="undefined"?n[t]=e[t]:Jb(e[t])&&Jb(n[t])&&Object.keys(e[t]).length>0&&a0(n[t],e[t])})}var Qb={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function Pr(){let n=typeof document!="undefined"?document:{};return a0(n,Qb),n}var TP={document:Qb,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(n){return typeof setTimeout=="undefined"?(n(),null):setTimeout(n,0)},cancelAnimationFrame(n){typeof setTimeout!="undefined"&&clearTimeout(n)}};function Ti(){let n=typeof window!="undefined"?window:{};return a0(n,TP),n}function eS(n){return n===void 0&&(n=""),n.trim().split(" ").filter(e=>!!e.trim())}function tS(n){let e=n;Object.keys(e).forEach(t=>{try{e[t]=null}catch{}try{delete e[t]}catch{}})}function Fa(n,e){return e===void 0&&(e=0),setTimeout(n,e)}function ka(){return Date.now()}function MP(n){let e=Ti(),t;return e.getComputedStyle&&(t=e.getComputedStyle(n,null)),!t&&n.currentStyle&&(t=n.currentStyle),t||(t=n.style),t}function l0(n,e){e===void 0&&(e="x");let t=Ti(),i,r,s,o=MP(n);return t.WebKitCSSMatrix?(r=o.transform||o.webkitTransform,r.split(",").length>6&&(r=r.split(", ").map(a=>a.replace(",",".")).join(", ")),s=new t.WebKitCSSMatrix(r==="none"?"":r)):(s=o.MozTransform||o.OTransform||o.MsTransform||o.msTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=s.toString().split(",")),e==="x"&&(t.WebKitCSSMatrix?r=s.m41:i.length===16?r=parseFloat(i[12]):r=parseFloat(i[4])),e==="y"&&(t.WebKitCSSMatrix?r=s.m42:i.length===16?r=parseFloat(i[13]):r=parseFloat(i[5])),r||0}function Wu(n){return typeof n=="object"&&n!==null&&n.constructor&&Object.prototype.toString.call(n).slice(8,-1)==="Object"}function AP(n){return typeof window!="undefined"&&typeof window.HTMLElement!="undefined"?n instanceof HTMLElement:n&&(n.nodeType===1||n.nodeType===11)}function jr(){let n=Object(arguments.length<=0?void 0:arguments[0]),e=["__proto__","constructor","prototype"];for(let t=1;t<arguments.length;t+=1){let i=t<0||arguments.length<=t?void 0:arguments[t];if(i!=null&&!AP(i)){let r=Object.keys(Object(i)).filter(s=>e.indexOf(s)<0);for(let s=0,o=r.length;s<o;s+=1){let a=r[s],l=Object.getOwnPropertyDescriptor(i,a);l!==void 0&&l.enumerable&&(Wu(n[a])&&Wu(i[a])?i[a].__swiper__?n[a]=i[a]:jr(n[a],i[a]):!Wu(n[a])&&Wu(i[a])?(n[a]={},i[a].__swiper__?n[a]=i[a]:jr(n[a],i[a])):n[a]=i[a])}}}return n}function Xl(n,e,t){n.style.setProperty(e,t)}function c0(n){let{swiper:e,targetPosition:t,side:i}=n,r=Ti(),s=-e.translate,o=null,a,l=e.params.speed;e.wrapperEl.style.scrollSnapType="none",r.cancelAnimationFrame(e.cssModeFrameID);let c=t>s?"next":"prev",u=(d,p)=>c==="next"&&d>=p||c==="prev"&&d<=p,h=()=>{a=new Date().getTime(),o===null&&(o=a);let d=Math.max(Math.min((a-o)/l,1),0),p=.5-Math.cos(d*Math.PI)/2,f=s+p*(t-s);if(u(f,t)&&(f=t),e.wrapperEl.scrollTo({[i]:f}),u(f,t)){e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout(()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[i]:f})}),r.cancelAnimationFrame(e.cssModeFrameID);return}e.cssModeFrameID=r.requestAnimationFrame(h)};h()}function Li(n,e){e===void 0&&(e="");let t=[...n.children];return n instanceof HTMLSlotElement&&t.push(...n.assignedElements()),e?t.filter(i=>i.matches(e)):t}function iS(n,e){let t=e.contains(n);return!t&&e instanceof HTMLSlotElement?[...e.assignedElements()].includes(n):t}function qu(n){try{console.warn(n);return}catch{}}function rs(n,e){e===void 0&&(e=[]);let t=document.createElement(n);return t.classList.add(...Array.isArray(e)?e:eS(e)),t}function rS(n,e){let t=[];for(;n.previousElementSibling;){let i=n.previousElementSibling;e?i.matches(e)&&t.push(i):t.push(i),n=i}return t}function nS(n,e){let t=[];for(;n.nextElementSibling;){let i=n.nextElementSibling;e?i.matches(e)&&t.push(i):t.push(i),n=i}return t}function Ws(n,e){return Ti().getComputedStyle(n,null).getPropertyValue(e)}function Ua(n){let e=n,t;if(e){for(t=0;(e=e.previousSibling)!==null;)e.nodeType===1&&(t+=1);return t}}function Yl(n,e){let t=[],i=n.parentElement;for(;i;)e?i.matches(e)&&t.push(i):t.push(i),i=i.parentElement;return t}function ju(n,e,t){let i=Ti();return t?n[e==="width"?"offsetWidth":"offsetHeight"]+parseFloat(i.getComputedStyle(n,null).getPropertyValue(e==="width"?"margin-right":"margin-top"))+parseFloat(i.getComputedStyle(n,null).getPropertyValue(e==="width"?"margin-left":"margin-bottom")):n.offsetWidth}function hn(n){return(Array.isArray(n)?n:[n]).filter(e=>!!e)}var u0;function CP(){let n=Ti(),e=Pr();return{smoothScroll:e.documentElement&&e.documentElement.style&&"scrollBehavior"in e.documentElement.style,touch:!!("ontouchstart"in n||n.DocumentTouch&&e instanceof n.DocumentTouch)}}function uS(){return u0||(u0=CP()),u0}var h0;function DP(n){let{userAgent:e}=n===void 0?{}:n,t=uS(),i=Ti(),r=i.navigator.platform,s=e||i.navigator.userAgent,o={ios:!1,android:!1},a=i.screen.width,l=i.screen.height,c=s.match(/(Android);?[\s\/]+([\d.]+)?/),u=s.match(/(iPad).*OS\s([\d_]+)/),h=s.match(/(iPod)(.*OS\s([\d_]+))?/),d=!u&&s.match(/(iPhone\sOS|iOS)\s([\d_]+)/),p=r==="Win32",f=r==="MacIntel",v=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!u&&f&&t.touch&&v.indexOf(`${a}x${l}`)>=0&&(u=s.match(/(Version)\/([\d.]+)/),u||(u=[0,1,"13_0_0"]),f=!1),c&&!p&&(o.os="android",o.android=!0),(u||d||h)&&(o.os="ios",o.ios=!0),o}function hS(n){return n===void 0&&(n={}),h0||(h0=DP(n)),h0}var d0;function PP(){let n=Ti(),e=hS(),t=!1;function i(){let a=n.navigator.userAgent.toLowerCase();return a.indexOf("safari")>=0&&a.indexOf("chrome")<0&&a.indexOf("android")<0}if(i()){let a=String(n.navigator.userAgent);if(a.includes("Version/")){let[l,c]=a.split("Version/")[1].split(" ")[0].split(".").map(u=>Number(u));t=l<16||l===16&&c<2}}let r=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(n.navigator.userAgent),s=i(),o=s||r&&e.ios;return{isSafari:t||s,needPerspectiveFix:t,need3dFix:o,isWebView:r}}function RP(){return d0||(d0=PP()),d0}function LP(n){let{swiper:e,on:t,emit:i}=n,r=Ti(),s=null,o=null,a=()=>{!e||e.destroyed||!e.initialized||(i("beforeResize"),i("resize"))},l=()=>{!e||e.destroyed||!e.initialized||(s=new ResizeObserver(h=>{o=r.requestAnimationFrame(()=>{let{width:d,height:p}=e,f=d,v=p;h.forEach(g=>{let{contentBoxSize:m,contentRect:x,target:y}=g;y&&y!==e.el||(f=x?x.width:(m[0]||m).inlineSize,v=x?x.height:(m[0]||m).blockSize)}),(f!==d||v!==p)&&a()})}),s.observe(e.el))},c=()=>{o&&r.cancelAnimationFrame(o),s&&s.unobserve&&e.el&&(s.unobserve(e.el),s=null)},u=()=>{!e||e.destroyed||!e.initialized||i("orientationchange")};t("init",()=>{if(e.params.resizeObserver&&typeof r.ResizeObserver!="undefined"){l();return}r.addEventListener("resize",a),r.addEventListener("orientationchange",u)}),t("destroy",()=>{c(),r.removeEventListener("resize",a),r.removeEventListener("orientationchange",u)})}function OP(n){let{swiper:e,extendParams:t,on:i,emit:r}=n,s=[],o=Ti(),a=function(u,h){h===void 0&&(h={});let d=o.MutationObserver||o.WebkitMutationObserver,p=new d(f=>{if(e.__preventObserver__)return;if(f.length===1){r("observerUpdate",f[0]);return}let v=function(){r("observerUpdate",f[0])};o.requestAnimationFrame?o.requestAnimationFrame(v):o.setTimeout(v,0)});p.observe(u,{attributes:typeof h.attributes=="undefined"?!0:h.attributes,childList:e.isElement||(typeof h.childList=="undefined"?!0:h).childList,characterData:typeof h.characterData=="undefined"?!0:h.characterData}),s.push(p)},l=()=>{if(e.params.observer){if(e.params.observeParents){let u=Yl(e.hostEl);for(let h=0;h<u.length;h+=1)a(u[h])}a(e.hostEl,{childList:e.params.observeSlideChildren}),a(e.wrapperEl,{attributes:!1})}},c=()=>{s.forEach(u=>{u.disconnect()}),s.splice(0,s.length)};t({observer:!1,observeParents:!1,observeSlideChildren:!1}),i("init",l),i("destroy",c)}var IP={on(n,e,t){let i=this;if(!i.eventsListeners||i.destroyed||typeof e!="function")return i;let r=t?"unshift":"push";return n.split(" ").forEach(s=>{i.eventsListeners[s]||(i.eventsListeners[s]=[]),i.eventsListeners[s][r](e)}),i},once(n,e,t){let i=this;if(!i.eventsListeners||i.destroyed||typeof e!="function")return i;function r(){i.off(n,r),r.__emitterProxy&&delete r.__emitterProxy;for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];e.apply(i,o)}return r.__emitterProxy=e,i.on(n,r,t)},onAny(n,e){let t=this;if(!t.eventsListeners||t.destroyed||typeof n!="function")return t;let i=e?"unshift":"push";return t.eventsAnyListeners.indexOf(n)<0&&t.eventsAnyListeners[i](n),t},offAny(n){let e=this;if(!e.eventsListeners||e.destroyed||!e.eventsAnyListeners)return e;let t=e.eventsAnyListeners.indexOf(n);return t>=0&&e.eventsAnyListeners.splice(t,1),e},off(n,e){let t=this;return!t.eventsListeners||t.destroyed||!t.eventsListeners||n.split(" ").forEach(i=>{typeof e=="undefined"?t.eventsListeners[i]=[]:t.eventsListeners[i]&&t.eventsListeners[i].forEach((r,s)=>{(r===e||r.__emitterProxy&&r.__emitterProxy===e)&&t.eventsListeners[i].splice(s,1)})}),t},emit(){let n=this;if(!n.eventsListeners||n.destroyed||!n.eventsListeners)return n;let e,t,i;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return typeof s[0]=="string"||Array.isArray(s[0])?(e=s[0],t=s.slice(1,s.length),i=n):(e=s[0].events,t=s[0].data,i=s[0].context||n),t.unshift(i),(Array.isArray(e)?e:e.split(" ")).forEach(l=>{n.eventsAnyListeners&&n.eventsAnyListeners.length&&n.eventsAnyListeners.forEach(c=>{c.apply(i,[l,...t])}),n.eventsListeners&&n.eventsListeners[l]&&n.eventsListeners[l].forEach(c=>{c.apply(i,t)})}),n}};function FP(){let n=this,e,t,i=n.el;typeof n.params.width!="undefined"&&n.params.width!==null?e=n.params.width:e=i.clientWidth,typeof n.params.height!="undefined"&&n.params.height!==null?t=n.params.height:t=i.clientHeight,!(e===0&&n.isHorizontal()||t===0&&n.isVertical())&&(e=e-parseInt(Ws(i,"padding-left")||0,10)-parseInt(Ws(i,"padding-right")||0,10),t=t-parseInt(Ws(i,"padding-top")||0,10)-parseInt(Ws(i,"padding-bottom")||0,10),Number.isNaN(e)&&(e=0),Number.isNaN(t)&&(t=0),Object.assign(n,{width:e,height:t,size:n.isHorizontal()?e:t}))}function kP(){let n=this;function e(E,R){return parseFloat(E.getPropertyValue(n.getDirectionLabel(R))||0)}let t=n.params,{wrapperEl:i,slidesEl:r,size:s,rtlTranslate:o,wrongRTL:a}=n,l=n.virtual&&t.virtual.enabled,c=l?n.virtual.slides.length:n.slides.length,u=Li(r,`.${n.params.slideClass}, swiper-slide`),h=l?n.virtual.slides.length:u.length,d=[],p=[],f=[],v=t.slidesOffsetBefore;typeof v=="function"&&(v=t.slidesOffsetBefore.call(n));let g=t.slidesOffsetAfter;typeof g=="function"&&(g=t.slidesOffsetAfter.call(n));let m=n.snapGrid.length,x=n.slidesGrid.length,y=t.spaceBetween,_=-v,w=0,b=0;if(typeof s=="undefined")return;typeof y=="string"&&y.indexOf("%")>=0?y=parseFloat(y.replace("%",""))/100*s:typeof y=="string"&&(y=parseFloat(y)),n.virtualSize=-y,u.forEach(E=>{o?E.style.marginLeft="":E.style.marginRight="",E.style.marginBottom="",E.style.marginTop=""}),t.centeredSlides&&t.cssMode&&(Xl(i,"--swiper-centered-offset-before",""),Xl(i,"--swiper-centered-offset-after",""));let T=t.grid&&t.grid.rows>1&&n.grid;T?n.grid.initSlides(u):n.grid&&n.grid.unsetSlides();let A,S=t.slidesPerView==="auto"&&t.breakpoints&&Object.keys(t.breakpoints).filter(E=>typeof t.breakpoints[E].slidesPerView!="undefined").length>0;for(let E=0;E<h;E+=1){A=0;let R;if(u[E]&&(R=u[E]),T&&n.grid.updateSlide(E,R,u),!(u[E]&&Ws(R,"display")==="none")){if(t.slidesPerView==="auto"){S&&(u[E].style[n.getDirectionLabel("width")]="");let D=getComputedStyle(R),z=R.style.transform,L=R.style.webkitTransform;if(z&&(R.style.transform="none"),L&&(R.style.webkitTransform="none"),t.roundLengths)A=n.isHorizontal()?ju(R,"width",!0):ju(R,"height",!0);else{let G=e(D,"width"),J=e(D,"padding-left"),X=e(D,"padding-right"),N=e(D,"margin-left"),U=e(D,"margin-right"),O=D.getPropertyValue("box-sizing");if(O&&O==="border-box")A=G+N+U;else{let{clientWidth:F,offsetWidth:$}=R;A=G+J+X+N+U+($-F)}}z&&(R.style.transform=z),L&&(R.style.webkitTransform=L),t.roundLengths&&(A=Math.floor(A))}else A=(s-(t.slidesPerView-1)*y)/t.slidesPerView,t.roundLengths&&(A=Math.floor(A)),u[E]&&(u[E].style[n.getDirectionLabel("width")]=`${A}px`);u[E]&&(u[E].swiperSlideSize=A),f.push(A),t.centeredSlides?(_=_+A/2+w/2+y,w===0&&E!==0&&(_=_-s/2-y),E===0&&(_=_-s/2-y),Math.abs(_)<1/1e3&&(_=0),t.roundLengths&&(_=Math.floor(_)),b%t.slidesPerGroup===0&&d.push(_),p.push(_)):(t.roundLengths&&(_=Math.floor(_)),(b-Math.min(n.params.slidesPerGroupSkip,b))%n.params.slidesPerGroup===0&&d.push(_),p.push(_),_=_+A+y),n.virtualSize+=A+y,w=A,b+=1}}if(n.virtualSize=Math.max(n.virtualSize,s)+g,o&&a&&(t.effect==="slide"||t.effect==="coverflow")&&(i.style.width=`${n.virtualSize+y}px`),t.setWrapperSize&&(i.style[n.getDirectionLabel("width")]=`${n.virtualSize+y}px`),T&&n.grid.updateWrapperSize(A,d),!t.centeredSlides){let E=[];for(let R=0;R<d.length;R+=1){let D=d[R];t.roundLengths&&(D=Math.floor(D)),d[R]<=n.virtualSize-s&&E.push(D)}d=E,Math.floor(n.virtualSize-s)-Math.floor(d[d.length-1])>1&&d.push(n.virtualSize-s)}if(l&&t.loop){let E=f[0]+y;if(t.slidesPerGroup>1){let R=Math.ceil((n.virtual.slidesBefore+n.virtual.slidesAfter)/t.slidesPerGroup),D=E*t.slidesPerGroup;for(let z=0;z<R;z+=1)d.push(d[d.length-1]+D)}for(let R=0;R<n.virtual.slidesBefore+n.virtual.slidesAfter;R+=1)t.slidesPerGroup===1&&d.push(d[d.length-1]+E),p.push(p[p.length-1]+E),n.virtualSize+=E}if(d.length===0&&(d=[0]),y!==0){let E=n.isHorizontal()&&o?"marginLeft":n.getDirectionLabel("marginRight");u.filter((R,D)=>!t.cssMode||t.loop?!0:D!==u.length-1).forEach(R=>{R.style[E]=`${y}px`})}if(t.centeredSlides&&t.centeredSlidesBounds){let E=0;f.forEach(D=>{E+=D+(y||0)}),E-=y;let R=E>s?E-s:0;d=d.map(D=>D<=0?-v:D>R?R+g:D)}if(t.centerInsufficientSlides){let E=0;f.forEach(D=>{E+=D+(y||0)}),E-=y;let R=(t.slidesOffsetBefore||0)+(t.slidesOffsetAfter||0);if(E+R<s){let D=(s-E-R)/2;d.forEach((z,L)=>{d[L]=z-D}),p.forEach((z,L)=>{p[L]=z+D})}}if(Object.assign(n,{slides:u,snapGrid:d,slidesGrid:p,slidesSizesGrid:f}),t.centeredSlides&&t.cssMode&&!t.centeredSlidesBounds){Xl(i,"--swiper-centered-offset-before",`${-d[0]}px`),Xl(i,"--swiper-centered-offset-after",`${n.size/2-f[f.length-1]/2}px`);let E=-n.snapGrid[0],R=-n.slidesGrid[0];n.snapGrid=n.snapGrid.map(D=>D+E),n.slidesGrid=n.slidesGrid.map(D=>D+R)}if(h!==c&&n.emit("slidesLengthChange"),d.length!==m&&(n.params.watchOverflow&&n.checkOverflow(),n.emit("snapGridLengthChange")),p.length!==x&&n.emit("slidesGridLengthChange"),t.watchSlidesProgress&&n.updateSlidesOffset(),n.emit("slidesUpdated"),!l&&!t.cssMode&&(t.effect==="slide"||t.effect==="fade")){let E=`${t.containerModifierClass}backface-hidden`,R=n.el.classList.contains(E);h<=t.maxBackfaceHiddenSlides?R||n.el.classList.add(E):R&&n.el.classList.remove(E)}}function UP(n){let e=this,t=[],i=e.virtual&&e.params.virtual.enabled,r=0,s;typeof n=="number"?e.setTransition(n):n===!0&&e.setTransition(e.params.speed);let o=a=>i?e.slides[e.getSlideIndexByData(a)]:e.slides[a];if(e.params.slidesPerView!=="auto"&&e.params.slidesPerView>1)if(e.params.centeredSlides)(e.visibleSlides||[]).forEach(a=>{t.push(a)});else for(s=0;s<Math.ceil(e.params.slidesPerView);s+=1){let a=e.activeIndex+s;if(a>e.slides.length&&!i)break;t.push(o(a))}else t.push(o(e.activeIndex));for(s=0;s<t.length;s+=1)if(typeof t[s]!="undefined"){let a=t[s].offsetHeight;r=a>r?a:r}(r||r===0)&&(e.wrapperEl.style.height=`${r}px`)}function zP(){let n=this,e=n.slides,t=n.isElement?n.isHorizontal()?n.wrapperEl.offsetLeft:n.wrapperEl.offsetTop:0;for(let i=0;i<e.length;i+=1)e[i].swiperSlideOffset=(n.isHorizontal()?e[i].offsetLeft:e[i].offsetTop)-t-n.cssOverflowAdjustment()}var sS=(n,e,t)=>{e&&!n.classList.contains(t)?n.classList.add(t):!e&&n.classList.contains(t)&&n.classList.remove(t)};function BP(n){n===void 0&&(n=this&&this.translate||0);let e=this,t=e.params,{slides:i,rtlTranslate:r,snapGrid:s}=e;if(i.length===0)return;typeof i[0].swiperSlideOffset=="undefined"&&e.updateSlidesOffset();let o=-n;r&&(o=n),e.visibleSlidesIndexes=[],e.visibleSlides=[];let a=t.spaceBetween;typeof a=="string"&&a.indexOf("%")>=0?a=parseFloat(a.replace("%",""))/100*e.size:typeof a=="string"&&(a=parseFloat(a));for(let l=0;l<i.length;l+=1){let c=i[l],u=c.swiperSlideOffset;t.cssMode&&t.centeredSlides&&(u-=i[0].swiperSlideOffset);let h=(o+(t.centeredSlides?e.minTranslate():0)-u)/(c.swiperSlideSize+a),d=(o-s[0]+(t.centeredSlides?e.minTranslate():0)-u)/(c.swiperSlideSize+a),p=-(o-u),f=p+e.slidesSizesGrid[l],v=p>=0&&p<=e.size-e.slidesSizesGrid[l],g=p>=0&&p<e.size-1||f>1&&f<=e.size||p<=0&&f>=e.size;g&&(e.visibleSlides.push(c),e.visibleSlidesIndexes.push(l)),sS(c,g,t.slideVisibleClass),sS(c,v,t.slideFullyVisibleClass),c.progress=r?-h:h,c.originalProgress=r?-d:d}}function NP(n){let e=this;if(typeof n=="undefined"){let u=e.rtlTranslate?-1:1;n=e&&e.translate&&e.translate*u||0}let t=e.params,i=e.maxTranslate()-e.minTranslate(),{progress:r,isBeginning:s,isEnd:o,progressLoop:a}=e,l=s,c=o;if(i===0)r=0,s=!0,o=!0;else{r=(n-e.minTranslate())/i;let u=Math.abs(n-e.minTranslate())<1,h=Math.abs(n-e.maxTranslate())<1;s=u||r<=0,o=h||r>=1,u&&(r=0),h&&(r=1)}if(t.loop){let u=e.getSlideIndexByData(0),h=e.getSlideIndexByData(e.slides.length-1),d=e.slidesGrid[u],p=e.slidesGrid[h],f=e.slidesGrid[e.slidesGrid.length-1],v=Math.abs(n);v>=d?a=(v-d)/f:a=(v+f-p)/f,a>1&&(a-=1)}Object.assign(e,{progress:r,progressLoop:a,isBeginning:s,isEnd:o}),(t.watchSlidesProgress||t.centeredSlides&&t.autoHeight)&&e.updateSlidesProgress(n),s&&!l&&e.emit("reachBeginning toEdge"),o&&!c&&e.emit("reachEnd toEdge"),(l&&!s||c&&!o)&&e.emit("fromEdge"),e.emit("progress",r)}var p0=(n,e,t)=>{e&&!n.classList.contains(t)?n.classList.add(t):!e&&n.classList.contains(t)&&n.classList.remove(t)};function GP(){let n=this,{slides:e,params:t,slidesEl:i,activeIndex:r}=n,s=n.virtual&&t.virtual.enabled,o=n.grid&&t.grid&&t.grid.rows>1,a=h=>Li(i,`.${t.slideClass}${h}, swiper-slide${h}`)[0],l,c,u;if(s)if(t.loop){let h=r-n.virtual.slidesBefore;h<0&&(h=n.virtual.slides.length+h),h>=n.virtual.slides.length&&(h-=n.virtual.slides.length),l=a(`[data-swiper-slide-index="${h}"]`)}else l=a(`[data-swiper-slide-index="${r}"]`);else o?(l=e.filter(h=>h.column===r)[0],u=e.filter(h=>h.column===r+1)[0],c=e.filter(h=>h.column===r-1)[0]):l=e[r];l&&(o||(u=nS(l,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!u&&(u=e[0]),c=rS(l,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!c===0&&(c=e[e.length-1]))),e.forEach(h=>{p0(h,h===l,t.slideActiveClass),p0(h,h===u,t.slideNextClass),p0(h,h===c,t.slidePrevClass)}),n.emitSlidesClasses()}var sp=(n,e)=>{if(!n||n.destroyed||!n.params)return;let t=()=>n.isElement?"swiper-slide":`.${n.params.slideClass}`,i=e.closest(t());if(i){let r=i.querySelector(`.${n.params.lazyPreloaderClass}`);!r&&n.isElement&&(i.shadowRoot?r=i.shadowRoot.querySelector(`.${n.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{i.shadowRoot&&(r=i.shadowRoot.querySelector(`.${n.params.lazyPreloaderClass}`),r&&r.remove())})),r&&r.remove()}},f0=(n,e)=>{if(!n.slides[e])return;let t=n.slides[e].querySelector('[loading="lazy"]');t&&t.removeAttribute("loading")},v0=n=>{if(!n||n.destroyed||!n.params)return;let e=n.params.lazyPreloadPrevNext,t=n.slides.length;if(!t||!e||e<0)return;e=Math.min(e,t);let i=n.params.slidesPerView==="auto"?n.slidesPerViewDynamic():Math.ceil(n.params.slidesPerView),r=n.activeIndex;if(n.params.grid&&n.params.grid.rows>1){let o=r,a=[o-e];a.push(...Array.from({length:e}).map((l,c)=>o+i+c)),n.slides.forEach((l,c)=>{a.includes(l.column)&&f0(n,c)});return}let s=r+i-1;if(n.params.rewind||n.params.loop)for(let o=r-e;o<=s+e;o+=1){let a=(o%t+t)%t;(a<r||a>s)&&f0(n,a)}else for(let o=Math.max(r-e,0);o<=Math.min(s+e,t-1);o+=1)o!==r&&(o>s||o<r)&&f0(n,o)};function VP(n){let{slidesGrid:e,params:t}=n,i=n.rtlTranslate?n.translate:-n.translate,r;for(let s=0;s<e.length;s+=1)typeof e[s+1]!="undefined"?i>=e[s]&&i<e[s+1]-(e[s+1]-e[s])/2?r=s:i>=e[s]&&i<e[s+1]&&(r=s+1):i>=e[s]&&(r=s);return t.normalizeSlideIndex&&(r<0||typeof r=="undefined")&&(r=0),r}function HP(n){let e=this,t=e.rtlTranslate?e.translate:-e.translate,{snapGrid:i,params:r,activeIndex:s,realIndex:o,snapIndex:a}=e,l=n,c,u=p=>{let f=p-e.virtual.slidesBefore;return f<0&&(f=e.virtual.slides.length+f),f>=e.virtual.slides.length&&(f-=e.virtual.slides.length),f};if(typeof l=="undefined"&&(l=VP(e)),i.indexOf(t)>=0)c=i.indexOf(t);else{let p=Math.min(r.slidesPerGroupSkip,l);c=p+Math.floor((l-p)/r.slidesPerGroup)}if(c>=i.length&&(c=i.length-1),l===s&&!e.params.loop){c!==a&&(e.snapIndex=c,e.emit("snapIndexChange"));return}if(l===s&&e.params.loop&&e.virtual&&e.params.virtual.enabled){e.realIndex=u(l);return}let h=e.grid&&r.grid&&r.grid.rows>1,d;if(e.virtual&&r.virtual.enabled&&r.loop)d=u(l);else if(h){let p=e.slides.filter(v=>v.column===l)[0],f=parseInt(p.getAttribute("data-swiper-slide-index"),10);Number.isNaN(f)&&(f=Math.max(e.slides.indexOf(p),0)),d=Math.floor(f/r.grid.rows)}else if(e.slides[l]){let p=e.slides[l].getAttribute("data-swiper-slide-index");p?d=parseInt(p,10):d=l}else d=l;Object.assign(e,{previousSnapIndex:a,snapIndex:c,previousRealIndex:o,realIndex:d,previousIndex:s,activeIndex:l}),e.initialized&&v0(e),e.emit("activeIndexChange"),e.emit("snapIndexChange"),(e.initialized||e.params.runCallbacksOnInit)&&(o!==d&&e.emit("realIndexChange"),e.emit("slideChange"))}function WP(n,e){let t=this,i=t.params,r=n.closest(`.${i.slideClass}, swiper-slide`);!r&&t.isElement&&e&&e.length>1&&e.includes(n)&&[...e.slice(e.indexOf(n)+1,e.length)].forEach(a=>{!r&&a.matches&&a.matches(`.${i.slideClass}, swiper-slide`)&&(r=a)});let s=!1,o;if(r){for(let a=0;a<t.slides.length;a+=1)if(t.slides[a]===r){s=!0,o=a;break}}if(r&&s)t.clickedSlide=r,t.virtual&&t.params.virtual.enabled?t.clickedIndex=parseInt(r.getAttribute("data-swiper-slide-index"),10):t.clickedIndex=o;else{t.clickedSlide=void 0,t.clickedIndex=void 0;return}i.slideToClickedSlide&&t.clickedIndex!==void 0&&t.clickedIndex!==t.activeIndex&&t.slideToClickedSlide()}var qP={updateSize:FP,updateSlides:kP,updateAutoHeight:UP,updateSlidesOffset:zP,updateSlidesProgress:BP,updateProgress:NP,updateSlidesClasses:GP,updateActiveIndex:HP,updateClickedSlide:WP};function jP(n){n===void 0&&(n=this.isHorizontal()?"x":"y");let e=this,{params:t,rtlTranslate:i,translate:r,wrapperEl:s}=e;if(t.virtualTranslate)return i?-r:r;if(t.cssMode)return r;let o=l0(s,n);return o+=e.cssOverflowAdjustment(),i&&(o=-o),o||0}function XP(n,e){let t=this,{rtlTranslate:i,params:r,wrapperEl:s,progress:o}=t,a=0,l=0,c=0;t.isHorizontal()?a=i?-n:n:l=n,r.roundLengths&&(a=Math.floor(a),l=Math.floor(l)),t.previousTranslate=t.translate,t.translate=t.isHorizontal()?a:l,r.cssMode?s[t.isHorizontal()?"scrollLeft":"scrollTop"]=t.isHorizontal()?-a:-l:r.virtualTranslate||(t.isHorizontal()?a-=t.cssOverflowAdjustment():l-=t.cssOverflowAdjustment(),s.style.transform=`translate3d(${a}px, ${l}px, ${c}px)`);let u,h=t.maxTranslate()-t.minTranslate();h===0?u=0:u=(n-t.minTranslate())/h,u!==o&&t.updateProgress(n),t.emit("setTranslate",t.translate,e)}function YP(){return-this.snapGrid[0]}function $P(){return-this.snapGrid[this.snapGrid.length-1]}function KP(n,e,t,i,r){n===void 0&&(n=0),e===void 0&&(e=this.params.speed),t===void 0&&(t=!0),i===void 0&&(i=!0);let s=this,{params:o,wrapperEl:a}=s;if(s.animating&&o.preventInteractionOnTransition)return!1;let l=s.minTranslate(),c=s.maxTranslate(),u;if(i&&n>l?u=l:i&&n<c?u=c:u=n,s.updateProgress(u),o.cssMode){let h=s.isHorizontal();if(e===0)a[h?"scrollLeft":"scrollTop"]=-u;else{if(!s.support.smoothScroll)return c0({swiper:s,targetPosition:-u,side:h?"left":"top"}),!0;a.scrollTo({[h?"left":"top"]:-u,behavior:"smooth"})}return!0}return e===0?(s.setTransition(0),s.setTranslate(u),t&&(s.emit("beforeTransitionStart",e,r),s.emit("transitionEnd"))):(s.setTransition(e),s.setTranslate(u),t&&(s.emit("beforeTransitionStart",e,r),s.emit("transitionStart")),s.animating||(s.animating=!0,s.onTranslateToWrapperTransitionEnd||(s.onTranslateToWrapperTransitionEnd=function(d){!s||s.destroyed||d.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onTranslateToWrapperTransitionEnd),s.onTranslateToWrapperTransitionEnd=null,delete s.onTranslateToWrapperTransitionEnd,s.animating=!1,t&&s.emit("transitionEnd"))}),s.wrapperEl.addEventListener("transitionend",s.onTranslateToWrapperTransitionEnd))),!0}var ZP={getTranslate:jP,setTranslate:XP,minTranslate:YP,maxTranslate:$P,translateTo:KP};function JP(n,e){let t=this;t.params.cssMode||(t.wrapperEl.style.transitionDuration=`${n}ms`,t.wrapperEl.style.transitionDelay=n===0?"0ms":""),t.emit("setTransition",n,e)}function dS(n){let{swiper:e,runCallbacks:t,direction:i,step:r}=n,{activeIndex:s,previousIndex:o}=e,a=i;if(a||(s>o?a="next":s<o?a="prev":a="reset"),e.emit(`transition${r}`),t&&s!==o){if(a==="reset"){e.emit(`slideResetTransition${r}`);return}e.emit(`slideChangeTransition${r}`),a==="next"?e.emit(`slideNextTransition${r}`):e.emit(`slidePrevTransition${r}`)}}function QP(n,e){n===void 0&&(n=!0);let t=this,{params:i}=t;i.cssMode||(i.autoHeight&&t.updateAutoHeight(),dS({swiper:t,runCallbacks:n,direction:e,step:"Start"}))}function e3(n,e){n===void 0&&(n=!0);let t=this,{params:i}=t;t.animating=!1,!i.cssMode&&(t.setTransition(0),dS({swiper:t,runCallbacks:n,direction:e,step:"End"}))}var t3={setTransition:JP,transitionStart:QP,transitionEnd:e3};function i3(n,e,t,i,r){n===void 0&&(n=0),t===void 0&&(t=!0),typeof n=="string"&&(n=parseInt(n,10));let s=this,o=n;o<0&&(o=0);let{params:a,snapGrid:l,slidesGrid:c,previousIndex:u,activeIndex:h,rtlTranslate:d,wrapperEl:p,enabled:f}=s;if(!f&&!i&&!r||s.destroyed||s.animating&&a.preventInteractionOnTransition)return!1;typeof e=="undefined"&&(e=s.params.speed);let v=Math.min(s.params.slidesPerGroupSkip,o),g=v+Math.floor((o-v)/s.params.slidesPerGroup);g>=l.length&&(g=l.length-1);let m=-l[g];if(a.normalizeSlideIndex)for(let w=0;w<c.length;w+=1){let b=-Math.floor(m*100),T=Math.floor(c[w]*100),A=Math.floor(c[w+1]*100);typeof c[w+1]!="undefined"?b>=T&&b<A-(A-T)/2?o=w:b>=T&&b<A&&(o=w+1):b>=T&&(o=w)}if(s.initialized&&o!==h&&(!s.allowSlideNext&&(d?m>s.translate&&m>s.minTranslate():m<s.translate&&m<s.minTranslate())||!s.allowSlidePrev&&m>s.translate&&m>s.maxTranslate()&&(h||0)!==o))return!1;o!==(u||0)&&t&&s.emit("beforeSlideChangeStart"),s.updateProgress(m);let x;o>h?x="next":o<h?x="prev":x="reset";let y=s.virtual&&s.params.virtual.enabled;if(!(y&&r)&&(d&&-m===s.translate||!d&&m===s.translate))return s.updateActiveIndex(o),a.autoHeight&&s.updateAutoHeight(),s.updateSlidesClasses(),a.effect!=="slide"&&s.setTranslate(m),x!=="reset"&&(s.transitionStart(t,x),s.transitionEnd(t,x)),!1;if(a.cssMode){let w=s.isHorizontal(),b=d?m:-m;if(e===0)y&&(s.wrapperEl.style.scrollSnapType="none",s._immediateVirtual=!0),y&&!s._cssModeVirtualInitialSet&&s.params.initialSlide>0?(s._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{p[w?"scrollLeft":"scrollTop"]=b})):p[w?"scrollLeft":"scrollTop"]=b,y&&requestAnimationFrame(()=>{s.wrapperEl.style.scrollSnapType="",s._immediateVirtual=!1});else{if(!s.support.smoothScroll)return c0({swiper:s,targetPosition:b,side:w?"left":"top"}),!0;p.scrollTo({[w?"left":"top"]:b,behavior:"smooth"})}return!0}return s.setTransition(e),s.setTranslate(m),s.updateActiveIndex(o),s.updateSlidesClasses(),s.emit("beforeTransitionStart",e,i),s.transitionStart(t,x),e===0?s.transitionEnd(t,x):s.animating||(s.animating=!0,s.onSlideToWrapperTransitionEnd||(s.onSlideToWrapperTransitionEnd=function(b){!s||s.destroyed||b.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onSlideToWrapperTransitionEnd),s.onSlideToWrapperTransitionEnd=null,delete s.onSlideToWrapperTransitionEnd,s.transitionEnd(t,x))}),s.wrapperEl.addEventListener("transitionend",s.onSlideToWrapperTransitionEnd)),!0}function r3(n,e,t,i){n===void 0&&(n=0),t===void 0&&(t=!0),typeof n=="string"&&(n=parseInt(n,10));let r=this;if(r.destroyed)return;typeof e=="undefined"&&(e=r.params.speed);let s=r.grid&&r.params.grid&&r.params.grid.rows>1,o=n;if(r.params.loop)if(r.virtual&&r.params.virtual.enabled)o=o+r.virtual.slidesBefore;else{let a;if(s){let d=o*r.params.grid.rows;a=r.slides.filter(p=>p.getAttribute("data-swiper-slide-index")*1===d)[0].column}else a=r.getSlideIndexByData(o);let l=s?Math.ceil(r.slides.length/r.params.grid.rows):r.slides.length,{centeredSlides:c}=r.params,u=r.params.slidesPerView;u==="auto"?u=r.slidesPerViewDynamic():(u=Math.ceil(parseFloat(r.params.slidesPerView,10)),c&&u%2===0&&(u=u+1));let h=l-a<u;if(c&&(h=h||a<Math.ceil(u/2)),i&&c&&r.params.slidesPerView!=="auto"&&!s&&(h=!1),h){let d=c?a<r.activeIndex?"prev":"next":a-r.activeIndex-1<r.params.slidesPerView?"next":"prev";r.loopFix({direction:d,slideTo:!0,activeSlideIndex:d==="next"?a+1:a-l+1,slideRealIndex:d==="next"?r.realIndex:void 0})}if(s){let d=o*r.params.grid.rows;o=r.slides.filter(p=>p.getAttribute("data-swiper-slide-index")*1===d)[0].column}else o=r.getSlideIndexByData(o)}return requestAnimationFrame(()=>{r.slideTo(o,e,t,i)}),r}function n3(n,e,t){e===void 0&&(e=!0);let i=this,{enabled:r,params:s,animating:o}=i;if(!r||i.destroyed)return i;typeof n=="undefined"&&(n=i.params.speed);let a=s.slidesPerGroup;s.slidesPerView==="auto"&&s.slidesPerGroup===1&&s.slidesPerGroupAuto&&(a=Math.max(i.slidesPerViewDynamic("current",!0),1));let l=i.activeIndex<s.slidesPerGroupSkip?1:a,c=i.virtual&&s.virtual.enabled;if(s.loop){if(o&&!c&&s.loopPreventsSliding)return!1;if(i.loopFix({direction:"next"}),i._clientLeft=i.wrapperEl.clientLeft,i.activeIndex===i.slides.length-1&&s.cssMode)return requestAnimationFrame(()=>{i.slideTo(i.activeIndex+l,n,e,t)}),!0}return s.rewind&&i.isEnd?i.slideTo(0,n,e,t):i.slideTo(i.activeIndex+l,n,e,t)}function s3(n,e,t){e===void 0&&(e=!0);let i=this,{params:r,snapGrid:s,slidesGrid:o,rtlTranslate:a,enabled:l,animating:c}=i;if(!l||i.destroyed)return i;typeof n=="undefined"&&(n=i.params.speed);let u=i.virtual&&r.virtual.enabled;if(r.loop){if(c&&!u&&r.loopPreventsSliding)return!1;i.loopFix({direction:"prev"}),i._clientLeft=i.wrapperEl.clientLeft}let h=a?i.translate:-i.translate;function d(m){return m<0?-Math.floor(Math.abs(m)):Math.floor(m)}let p=d(h),f=s.map(m=>d(m)),v=s[f.indexOf(p)-1];if(typeof v=="undefined"&&r.cssMode){let m;s.forEach((x,y)=>{p>=x&&(m=y)}),typeof m!="undefined"&&(v=s[m>0?m-1:m])}let g=0;if(typeof v!="undefined"&&(g=o.indexOf(v),g<0&&(g=i.activeIndex-1),r.slidesPerView==="auto"&&r.slidesPerGroup===1&&r.slidesPerGroupAuto&&(g=g-i.slidesPerViewDynamic("previous",!0)+1,g=Math.max(g,0))),r.rewind&&i.isBeginning){let m=i.params.virtual&&i.params.virtual.enabled&&i.virtual?i.virtual.slides.length-1:i.slides.length-1;return i.slideTo(m,n,e,t)}else if(r.loop&&i.activeIndex===0&&r.cssMode)return requestAnimationFrame(()=>{i.slideTo(g,n,e,t)}),!0;return i.slideTo(g,n,e,t)}function o3(n,e,t){e===void 0&&(e=!0);let i=this;if(!i.destroyed)return typeof n=="undefined"&&(n=i.params.speed),i.slideTo(i.activeIndex,n,e,t)}function a3(n,e,t,i){e===void 0&&(e=!0),i===void 0&&(i=.5);let r=this;if(r.destroyed)return;typeof n=="undefined"&&(n=r.params.speed);let s=r.activeIndex,o=Math.min(r.params.slidesPerGroupSkip,s),a=o+Math.floor((s-o)/r.params.slidesPerGroup),l=r.rtlTranslate?r.translate:-r.translate;if(l>=r.snapGrid[a]){let c=r.snapGrid[a],u=r.snapGrid[a+1];l-c>(u-c)*i&&(s+=r.params.slidesPerGroup)}else{let c=r.snapGrid[a-1],u=r.snapGrid[a];l-c<=(u-c)*i&&(s-=r.params.slidesPerGroup)}return s=Math.max(s,0),s=Math.min(s,r.slidesGrid.length-1),r.slideTo(s,n,e,t)}function l3(){let n=this;if(n.destroyed)return;let{params:e,slidesEl:t}=n,i=e.slidesPerView==="auto"?n.slidesPerViewDynamic():e.slidesPerView,r=n.clickedIndex,s,o=n.isElement?"swiper-slide":`.${e.slideClass}`;if(e.loop){if(n.animating)return;s=parseInt(n.clickedSlide.getAttribute("data-swiper-slide-index"),10),e.centeredSlides?r<n.loopedSlides-i/2||r>n.slides.length-n.loopedSlides+i/2?(n.loopFix(),r=n.getSlideIndex(Li(t,`${o}[data-swiper-slide-index="${s}"]`)[0]),Fa(()=>{n.slideTo(r)})):n.slideTo(r):r>n.slides.length-i?(n.loopFix(),r=n.getSlideIndex(Li(t,`${o}[data-swiper-slide-index="${s}"]`)[0]),Fa(()=>{n.slideTo(r)})):n.slideTo(r)}else n.slideTo(r)}var c3={slideTo:i3,slideToLoop:r3,slideNext:n3,slidePrev:s3,slideReset:o3,slideToClosest:a3,slideToClickedSlide:l3};function u3(n){let e=this,{params:t,slidesEl:i}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;let r=()=>{Li(i,`.${t.slideClass}, swiper-slide`).forEach((h,d)=>{h.setAttribute("data-swiper-slide-index",d)})},s=e.grid&&t.grid&&t.grid.rows>1,o=t.slidesPerGroup*(s?t.grid.rows:1),a=e.slides.length%o!==0,l=s&&e.slides.length%t.grid.rows!==0,c=u=>{for(let h=0;h<u;h+=1){let d=e.isElement?rs("swiper-slide",[t.slideBlankClass]):rs("div",[t.slideClass,t.slideBlankClass]);e.slidesEl.append(d)}};if(a){if(t.loopAddBlankSlides){let u=o-e.slides.length%o;c(u),e.recalcSlides(),e.updateSlides()}else qu("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else if(l){if(t.loopAddBlankSlides){let u=t.grid.rows-e.slides.length%t.grid.rows;c(u),e.recalcSlides(),e.updateSlides()}else qu("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else r();e.loopFix({slideRealIndex:n,direction:t.centeredSlides?void 0:"next"})}function h3(n){let{slideRealIndex:e,slideTo:t=!0,direction:i,setTranslate:r,activeSlideIndex:s,byController:o,byMousewheel:a}=n===void 0?{}:n,l=this;if(!l.params.loop)return;l.emit("beforeLoopFix");let{slides:c,allowSlidePrev:u,allowSlideNext:h,slidesEl:d,params:p}=l,{centeredSlides:f}=p;if(l.allowSlidePrev=!0,l.allowSlideNext=!0,l.virtual&&p.virtual.enabled){t&&(!p.centeredSlides&&l.snapIndex===0?l.slideTo(l.virtual.slides.length,0,!1,!0):p.centeredSlides&&l.snapIndex<p.slidesPerView?l.slideTo(l.virtual.slides.length+l.snapIndex,0,!1,!0):l.snapIndex===l.snapGrid.length-1&&l.slideTo(l.virtual.slidesBefore,0,!1,!0)),l.allowSlidePrev=u,l.allowSlideNext=h,l.emit("loopFix");return}let v=p.slidesPerView;v==="auto"?v=l.slidesPerViewDynamic():(v=Math.ceil(parseFloat(p.slidesPerView,10)),f&&v%2===0&&(v=v+1));let g=p.slidesPerGroupAuto?v:p.slidesPerGroup,m=g;m%g!==0&&(m+=g-m%g),m+=p.loopAdditionalSlides,l.loopedSlides=m;let x=l.grid&&p.grid&&p.grid.rows>1;c.length<v+m?qu("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):x&&p.grid.fill==="row"&&qu("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");let y=[],_=[],w=l.activeIndex;typeof s=="undefined"?s=l.getSlideIndex(c.filter(z=>z.classList.contains(p.slideActiveClass))[0]):w=s;let b=i==="next"||!i,T=i==="prev"||!i,A=0,S=0,E=x?Math.ceil(c.length/p.grid.rows):c.length,D=(x?c[s].column:s)+(f&&typeof r=="undefined"?-v/2+.5:0);if(D<m){A=Math.max(m-D,g);for(let z=0;z<m-D;z+=1){let L=z-Math.floor(z/E)*E;if(x){let G=E-L-1;for(let J=c.length-1;J>=0;J-=1)c[J].column===G&&y.push(J)}else y.push(E-L-1)}}else if(D+v>E-m){S=Math.max(D-(E-m*2),g);for(let z=0;z<S;z+=1){let L=z-Math.floor(z/E)*E;x?c.forEach((G,J)=>{G.column===L&&_.push(J)}):_.push(L)}}if(l.__preventObserver__=!0,requestAnimationFrame(()=>{l.__preventObserver__=!1}),T&&y.forEach(z=>{c[z].swiperLoopMoveDOM=!0,d.prepend(c[z]),c[z].swiperLoopMoveDOM=!1}),b&&_.forEach(z=>{c[z].swiperLoopMoveDOM=!0,d.append(c[z]),c[z].swiperLoopMoveDOM=!1}),l.recalcSlides(),p.slidesPerView==="auto"?l.updateSlides():x&&(y.length>0&&T||_.length>0&&b)&&l.slides.forEach((z,L)=>{l.grid.updateSlide(L,z,l.slides)}),p.watchSlidesProgress&&l.updateSlidesOffset(),t){if(y.length>0&&T){if(typeof e=="undefined"){let z=l.slidesGrid[w],G=l.slidesGrid[w+A]-z;a?l.setTranslate(l.translate-G):(l.slideTo(w+Math.ceil(A),0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-G,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-G))}else if(r){let z=x?y.length/p.grid.rows:y.length;l.slideTo(l.activeIndex+z,0,!1,!0),l.touchEventsData.currentTranslate=l.translate}}else if(_.length>0&&b)if(typeof e=="undefined"){let z=l.slidesGrid[w],G=l.slidesGrid[w-S]-z;a?l.setTranslate(l.translate-G):(l.slideTo(w-S,0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-G,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-G))}else{let z=x?_.length/p.grid.rows:_.length;l.slideTo(l.activeIndex-z,0,!1,!0)}}if(l.allowSlidePrev=u,l.allowSlideNext=h,l.controller&&l.controller.control&&!o){let z={slideRealIndex:e,direction:i,setTranslate:r,activeSlideIndex:s,byController:!0};Array.isArray(l.controller.control)?l.controller.control.forEach(L=>{!L.destroyed&&L.params.loop&&L.loopFix({...z,slideTo:L.params.slidesPerView===p.slidesPerView?t:!1})}):l.controller.control instanceof l.constructor&&l.controller.control.params.loop&&l.controller.control.loopFix({...z,slideTo:l.controller.control.params.slidesPerView===p.slidesPerView?t:!1})}l.emit("loopFix")}function d3(){let n=this,{params:e,slidesEl:t}=n;if(!e.loop||n.virtual&&n.params.virtual.enabled)return;n.recalcSlides();let i=[];n.slides.forEach(r=>{let s=typeof r.swiperSlideIndex=="undefined"?r.getAttribute("data-swiper-slide-index")*1:r.swiperSlideIndex;i[s]=r}),n.slides.forEach(r=>{r.removeAttribute("data-swiper-slide-index")}),i.forEach(r=>{t.append(r)}),n.recalcSlides(),n.slideTo(n.realIndex,0)}var p3={loopCreate:u3,loopFix:h3,loopDestroy:d3};function f3(n){let e=this;if(!e.params.simulateTouch||e.params.watchOverflow&&e.isLocked||e.params.cssMode)return;let t=e.params.touchEventsTarget==="container"?e.el:e.wrapperEl;e.isElement&&(e.__preventObserver__=!0),t.style.cursor="move",t.style.cursor=n?"grabbing":"grab",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1})}function m3(){let n=this;n.params.watchOverflow&&n.isLocked||n.params.cssMode||(n.isElement&&(n.__preventObserver__=!0),n[n.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",n.isElement&&requestAnimationFrame(()=>{n.__preventObserver__=!1}))}var g3={setGrabCursor:f3,unsetGrabCursor:m3};function v3(n,e){e===void 0&&(e=this);function t(i){if(!i||i===Pr()||i===Ti())return null;i.assignedSlot&&(i=i.assignedSlot);let r=i.closest(n);return!r&&!i.getRootNode?null:r||t(i.getRootNode().host)}return t(e)}function oS(n,e,t){let i=Ti(),{params:r}=n,s=r.edgeSwipeDetection,o=r.edgeSwipeThreshold;return s&&(t<=o||t>=i.innerWidth-o)?s==="prevent"?(e.preventDefault(),!0):!1:!0}function y3(n){let e=this,t=Pr(),i=n;i.originalEvent&&(i=i.originalEvent);let r=e.touchEventsData;if(i.type==="pointerdown"){if(r.pointerId!==null&&r.pointerId!==i.pointerId)return;r.pointerId=i.pointerId}else i.type==="touchstart"&&i.targetTouches.length===1&&(r.touchId=i.targetTouches[0].identifier);if(i.type==="touchstart"){oS(e,i,i.targetTouches[0].pageX);return}let{params:s,touches:o,enabled:a}=e;if(!a||!s.simulateTouch&&i.pointerType==="mouse"||e.animating&&s.preventInteractionOnTransition)return;!e.animating&&s.cssMode&&s.loop&&e.loopFix();let l=i.target;if(s.touchEventsTarget==="wrapper"&&!iS(l,e.wrapperEl)||"which"in i&&i.which===3||"button"in i&&i.button>0||r.isTouched&&r.isMoved)return;let c=!!s.noSwipingClass&&s.noSwipingClass!=="",u=i.composedPath?i.composedPath():i.path;c&&i.target&&i.target.shadowRoot&&u&&(l=u[0]);let h=s.noSwipingSelector?s.noSwipingSelector:`.${s.noSwipingClass}`,d=!!(i.target&&i.target.shadowRoot);if(s.noSwiping&&(d?v3(h,l):l.closest(h))){e.allowClick=!0;return}if(s.swipeHandler&&!l.closest(s.swipeHandler))return;o.currentX=i.pageX,o.currentY=i.pageY;let p=o.currentX,f=o.currentY;if(!oS(e,i,p))return;Object.assign(r,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),o.startX=p,o.startY=f,r.touchStartTime=ka(),e.allowClick=!0,e.updateSize(),e.swipeDirection=void 0,s.threshold>0&&(r.allowThresholdMove=!1);let v=!0;l.matches(r.focusableElements)&&(v=!1,l.nodeName==="SELECT"&&(r.isTouched=!1)),t.activeElement&&t.activeElement.matches(r.focusableElements)&&t.activeElement!==l&&(i.pointerType==="mouse"||i.pointerType!=="mouse"&&!l.matches(r.focusableElements))&&t.activeElement.blur();let g=v&&e.allowTouchMove&&s.touchStartPreventDefault;(s.touchStartForcePreventDefault||g)&&!l.isContentEditable&&i.preventDefault(),s.freeMode&&s.freeMode.enabled&&e.freeMode&&e.animating&&!s.cssMode&&e.freeMode.onTouchStart(),e.emit("touchStart",i)}function x3(n){let e=Pr(),t=this,i=t.touchEventsData,{params:r,touches:s,rtlTranslate:o,enabled:a}=t;if(!a||!r.simulateTouch&&n.pointerType==="mouse")return;let l=n;if(l.originalEvent&&(l=l.originalEvent),l.type==="pointermove"&&(i.touchId!==null||l.pointerId!==i.pointerId))return;let c;if(l.type==="touchmove"){if(c=[...l.changedTouches].filter(b=>b.identifier===i.touchId)[0],!c||c.identifier!==i.touchId)return}else c=l;if(!i.isTouched){i.startMoving&&i.isScrolling&&t.emit("touchMoveOpposite",l);return}let u=c.pageX,h=c.pageY;if(l.preventedByNestedSwiper){s.startX=u,s.startY=h;return}if(!t.allowTouchMove){l.target.matches(i.focusableElements)||(t.allowClick=!1),i.isTouched&&(Object.assign(s,{startX:u,startY:h,currentX:u,currentY:h}),i.touchStartTime=ka());return}if(r.touchReleaseOnEdges&&!r.loop){if(t.isVertical()){if(h<s.startY&&t.translate<=t.maxTranslate()||h>s.startY&&t.translate>=t.minTranslate()){i.isTouched=!1,i.isMoved=!1;return}}else if(u<s.startX&&t.translate<=t.maxTranslate()||u>s.startX&&t.translate>=t.minTranslate())return}if(e.activeElement&&e.activeElement.matches(i.focusableElements)&&e.activeElement!==l.target&&l.pointerType!=="mouse"&&e.activeElement.blur(),e.activeElement&&l.target===e.activeElement&&l.target.matches(i.focusableElements)){i.isMoved=!0,t.allowClick=!1;return}i.allowTouchCallbacks&&t.emit("touchMove",l),s.previousX=s.currentX,s.previousY=s.currentY,s.currentX=u,s.currentY=h;let d=s.currentX-s.startX,p=s.currentY-s.startY;if(t.params.threshold&&Math.sqrt(d**2+p**2)<t.params.threshold)return;if(typeof i.isScrolling=="undefined"){let b;t.isHorizontal()&&s.currentY===s.startY||t.isVertical()&&s.currentX===s.startX?i.isScrolling=!1:d*d+p*p>=25&&(b=Math.atan2(Math.abs(p),Math.abs(d))*180/Math.PI,i.isScrolling=t.isHorizontal()?b>r.touchAngle:90-b>r.touchAngle)}if(i.isScrolling&&t.emit("touchMoveOpposite",l),typeof i.startMoving=="undefined"&&(s.currentX!==s.startX||s.currentY!==s.startY)&&(i.startMoving=!0),i.isScrolling||l.type==="touchmove"&&i.preventTouchMoveFromPointerMove){i.isTouched=!1;return}if(!i.startMoving)return;t.allowClick=!1,!r.cssMode&&l.cancelable&&l.preventDefault(),r.touchMoveStopPropagation&&!r.nested&&l.stopPropagation();let f=t.isHorizontal()?d:p,v=t.isHorizontal()?s.currentX-s.previousX:s.currentY-s.previousY;r.oneWayMovement&&(f=Math.abs(f)*(o?1:-1),v=Math.abs(v)*(o?1:-1)),s.diff=f,f*=r.touchRatio,o&&(f=-f,v=-v);let g=t.touchesDirection;t.swipeDirection=f>0?"prev":"next",t.touchesDirection=v>0?"prev":"next";let m=t.params.loop&&!r.cssMode,x=t.touchesDirection==="next"&&t.allowSlideNext||t.touchesDirection==="prev"&&t.allowSlidePrev;if(!i.isMoved){if(m&&x&&t.loopFix({direction:t.swipeDirection}),i.startTranslate=t.getTranslate(),t.setTransition(0),t.animating){let b=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});t.wrapperEl.dispatchEvent(b)}i.allowMomentumBounce=!1,r.grabCursor&&(t.allowSlideNext===!0||t.allowSlidePrev===!0)&&t.setGrabCursor(!0),t.emit("sliderFirstMove",l)}let y;if(new Date().getTime(),i.isMoved&&i.allowThresholdMove&&g!==t.touchesDirection&&m&&x&&Math.abs(f)>=1){Object.assign(s,{startX:u,startY:h,currentX:u,currentY:h,startTranslate:i.currentTranslate}),i.loopSwapReset=!0,i.startTranslate=i.currentTranslate;return}t.emit("sliderMove",l),i.isMoved=!0,i.currentTranslate=f+i.startTranslate;let _=!0,w=r.resistanceRatio;if(r.touchReleaseOnEdges&&(w=0),f>0?(m&&x&&!y&&i.allowThresholdMove&&i.currentTranslate>(r.centeredSlides?t.minTranslate()-t.slidesSizesGrid[t.activeIndex+1]-(r.slidesPerView!=="auto"&&t.slides.length-r.slidesPerView>=2?t.slidesSizesGrid[t.activeIndex+1]+t.params.spaceBetween:0)-t.params.spaceBetween:t.minTranslate())&&t.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),i.currentTranslate>t.minTranslate()&&(_=!1,r.resistance&&(i.currentTranslate=t.minTranslate()-1+(-t.minTranslate()+i.startTranslate+f)**w))):f<0&&(m&&x&&!y&&i.allowThresholdMove&&i.currentTranslate<(r.centeredSlides?t.maxTranslate()+t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween+(r.slidesPerView!=="auto"&&t.slides.length-r.slidesPerView>=2?t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween:0):t.maxTranslate())&&t.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:t.slides.length-(r.slidesPerView==="auto"?t.slidesPerViewDynamic():Math.ceil(parseFloat(r.slidesPerView,10)))}),i.currentTranslate<t.maxTranslate()&&(_=!1,r.resistance&&(i.currentTranslate=t.maxTranslate()+1-(t.maxTranslate()-i.startTranslate-f)**w))),_&&(l.preventedByNestedSwiper=!0),!t.allowSlideNext&&t.swipeDirection==="next"&&i.currentTranslate<i.startTranslate&&(i.currentTranslate=i.startTranslate),!t.allowSlidePrev&&t.swipeDirection==="prev"&&i.currentTranslate>i.startTranslate&&(i.currentTranslate=i.startTranslate),!t.allowSlidePrev&&!t.allowSlideNext&&(i.currentTranslate=i.startTranslate),r.threshold>0)if(Math.abs(f)>r.threshold||i.allowThresholdMove){if(!i.allowThresholdMove){i.allowThresholdMove=!0,s.startX=s.currentX,s.startY=s.currentY,i.currentTranslate=i.startTranslate,s.diff=t.isHorizontal()?s.currentX-s.startX:s.currentY-s.startY;return}}else{i.currentTranslate=i.startTranslate;return}!r.followFinger||r.cssMode||((r.freeMode&&r.freeMode.enabled&&t.freeMode||r.watchSlidesProgress)&&(t.updateActiveIndex(),t.updateSlidesClasses()),r.freeMode&&r.freeMode.enabled&&t.freeMode&&t.freeMode.onTouchMove(),t.updateProgress(i.currentTranslate),t.setTranslate(i.currentTranslate))}function _3(n){let e=this,t=e.touchEventsData,i=n;i.originalEvent&&(i=i.originalEvent);let r;if(i.type==="touchend"||i.type==="touchcancel"){if(r=[...i.changedTouches].filter(w=>w.identifier===t.touchId)[0],!r||r.identifier!==t.touchId)return}else{if(t.touchId!==null||i.pointerId!==t.pointerId)return;r=i}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(i.type)&&!(["pointercancel","contextmenu"].includes(i.type)&&(e.browser.isSafari||e.browser.isWebView)))return;t.pointerId=null,t.touchId=null;let{params:o,touches:a,rtlTranslate:l,slidesGrid:c,enabled:u}=e;if(!u||!o.simulateTouch&&i.pointerType==="mouse")return;if(t.allowTouchCallbacks&&e.emit("touchEnd",i),t.allowTouchCallbacks=!1,!t.isTouched){t.isMoved&&o.grabCursor&&e.setGrabCursor(!1),t.isMoved=!1,t.startMoving=!1;return}o.grabCursor&&t.isMoved&&t.isTouched&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!1);let h=ka(),d=h-t.touchStartTime;if(e.allowClick){let w=i.path||i.composedPath&&i.composedPath();e.updateClickedSlide(w&&w[0]||i.target,w),e.emit("tap click",i),d<300&&h-t.lastClickTime<300&&e.emit("doubleTap doubleClick",i)}if(t.lastClickTime=ka(),Fa(()=>{e.destroyed||(e.allowClick=!0)}),!t.isTouched||!t.isMoved||!e.swipeDirection||a.diff===0&&!t.loopSwapReset||t.currentTranslate===t.startTranslate&&!t.loopSwapReset){t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;return}t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;let p;if(o.followFinger?p=l?e.translate:-e.translate:p=-t.currentTranslate,o.cssMode)return;if(o.freeMode&&o.freeMode.enabled){e.freeMode.onTouchEnd({currentPos:p});return}let f=p>=-e.maxTranslate()&&!e.params.loop,v=0,g=e.slidesSizesGrid[0];for(let w=0;w<c.length;w+=w<o.slidesPerGroupSkip?1:o.slidesPerGroup){let b=w<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;typeof c[w+b]!="undefined"?(f||p>=c[w]&&p<c[w+b])&&(v=w,g=c[w+b]-c[w]):(f||p>=c[w])&&(v=w,g=c[c.length-1]-c[c.length-2])}let m=null,x=null;o.rewind&&(e.isBeginning?x=o.virtual&&o.virtual.enabled&&e.virtual?e.virtual.slides.length-1:e.slides.length-1:e.isEnd&&(m=0));let y=(p-c[v])/g,_=v<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;if(d>o.longSwipesMs){if(!o.longSwipes){e.slideTo(e.activeIndex);return}e.swipeDirection==="next"&&(y>=o.longSwipesRatio?e.slideTo(o.rewind&&e.isEnd?m:v+_):e.slideTo(v)),e.swipeDirection==="prev"&&(y>1-o.longSwipesRatio?e.slideTo(v+_):x!==null&&y<0&&Math.abs(y)>o.longSwipesRatio?e.slideTo(x):e.slideTo(v))}else{if(!o.shortSwipes){e.slideTo(e.activeIndex);return}e.navigation&&(i.target===e.navigation.nextEl||i.target===e.navigation.prevEl)?i.target===e.navigation.nextEl?e.slideTo(v+_):e.slideTo(v):(e.swipeDirection==="next"&&e.slideTo(m!==null?m:v+_),e.swipeDirection==="prev"&&e.slideTo(x!==null?x:v))}}function aS(){let n=this,{params:e,el:t}=n;if(t&&t.offsetWidth===0)return;e.breakpoints&&n.setBreakpoint();let{allowSlideNext:i,allowSlidePrev:r,snapGrid:s}=n,o=n.virtual&&n.params.virtual.enabled;n.allowSlideNext=!0,n.allowSlidePrev=!0,n.updateSize(),n.updateSlides(),n.updateSlidesClasses();let a=o&&e.loop;(e.slidesPerView==="auto"||e.slidesPerView>1)&&n.isEnd&&!n.isBeginning&&!n.params.centeredSlides&&!a?n.slideTo(n.slides.length-1,0,!1,!0):n.params.loop&&!o?n.slideToLoop(n.realIndex,0,!1,!0):n.slideTo(n.activeIndex,0,!1,!0),n.autoplay&&n.autoplay.running&&n.autoplay.paused&&(clearTimeout(n.autoplay.resizeTimeout),n.autoplay.resizeTimeout=setTimeout(()=>{n.autoplay&&n.autoplay.running&&n.autoplay.paused&&n.autoplay.resume()},500)),n.allowSlidePrev=r,n.allowSlideNext=i,n.params.watchOverflow&&s!==n.snapGrid&&n.checkOverflow()}function w3(n){let e=this;e.enabled&&(e.allowClick||(e.params.preventClicks&&n.preventDefault(),e.params.preventClicksPropagation&&e.animating&&(n.stopPropagation(),n.stopImmediatePropagation())))}function b3(){let n=this,{wrapperEl:e,rtlTranslate:t,enabled:i}=n;if(!i)return;n.previousTranslate=n.translate,n.isHorizontal()?n.translate=-e.scrollLeft:n.translate=-e.scrollTop,n.translate===0&&(n.translate=0),n.updateActiveIndex(),n.updateSlidesClasses();let r,s=n.maxTranslate()-n.minTranslate();s===0?r=0:r=(n.translate-n.minTranslate())/s,r!==n.progress&&n.updateProgress(t?-n.translate:n.translate),n.emit("setTranslate",n.translate,!1)}function S3(n){let e=this;sp(e,n.target),!(e.params.cssMode||e.params.slidesPerView!=="auto"&&!e.params.autoHeight)&&e.update()}function E3(){let n=this;n.documentTouchHandlerProceeded||(n.documentTouchHandlerProceeded=!0,n.params.touchReleaseOnEdges&&(n.el.style.touchAction="auto"))}var pS=(n,e)=>{let t=Pr(),{params:i,el:r,wrapperEl:s,device:o}=n,a=!!i.nested,l=e==="on"?"addEventListener":"removeEventListener",c=e;!r||typeof r=="string"||(t[l]("touchstart",n.onDocumentTouchStart,{passive:!1,capture:a}),r[l]("touchstart",n.onTouchStart,{passive:!1}),r[l]("pointerdown",n.onTouchStart,{passive:!1}),t[l]("touchmove",n.onTouchMove,{passive:!1,capture:a}),t[l]("pointermove",n.onTouchMove,{passive:!1,capture:a}),t[l]("touchend",n.onTouchEnd,{passive:!0}),t[l]("pointerup",n.onTouchEnd,{passive:!0}),t[l]("pointercancel",n.onTouchEnd,{passive:!0}),t[l]("touchcancel",n.onTouchEnd,{passive:!0}),t[l]("pointerout",n.onTouchEnd,{passive:!0}),t[l]("pointerleave",n.onTouchEnd,{passive:!0}),t[l]("contextmenu",n.onTouchEnd,{passive:!0}),(i.preventClicks||i.preventClicksPropagation)&&r[l]("click",n.onClick,!0),i.cssMode&&s[l]("scroll",n.onScroll),i.updateOnWindowResize?n[c](o.ios||o.android?"resize orientationchange observerUpdate":"resize observerUpdate",aS,!0):n[c]("observerUpdate",aS,!0),r[l]("load",n.onLoad,{capture:!0}))};function T3(){let n=this,{params:e}=n;n.onTouchStart=y3.bind(n),n.onTouchMove=x3.bind(n),n.onTouchEnd=_3.bind(n),n.onDocumentTouchStart=E3.bind(n),e.cssMode&&(n.onScroll=b3.bind(n)),n.onClick=w3.bind(n),n.onLoad=S3.bind(n),pS(n,"on")}function M3(){pS(this,"off")}var A3={attachEvents:T3,detachEvents:M3},lS=(n,e)=>n.grid&&e.grid&&e.grid.rows>1;function C3(){let n=this,{realIndex:e,initialized:t,params:i,el:r}=n,s=i.breakpoints;if(!s||s&&Object.keys(s).length===0)return;let o=n.getBreakpoint(s,n.params.breakpointsBase,n.el);if(!o||n.currentBreakpoint===o)return;let l=(o in s?s[o]:void 0)||n.originalParams,c=lS(n,i),u=lS(n,l),h=n.params.grabCursor,d=l.grabCursor,p=i.enabled;c&&!u?(r.classList.remove(`${i.containerModifierClass}grid`,`${i.containerModifierClass}grid-column`),n.emitContainerClasses()):!c&&u&&(r.classList.add(`${i.containerModifierClass}grid`),(l.grid.fill&&l.grid.fill==="column"||!l.grid.fill&&i.grid.fill==="column")&&r.classList.add(`${i.containerModifierClass}grid-column`),n.emitContainerClasses()),h&&!d?n.unsetGrabCursor():!h&&d&&n.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(y=>{if(typeof l[y]=="undefined")return;let _=i[y]&&i[y].enabled,w=l[y]&&l[y].enabled;_&&!w&&n[y].disable(),!_&&w&&n[y].enable()});let f=l.direction&&l.direction!==i.direction,v=i.loop&&(l.slidesPerView!==i.slidesPerView||f),g=i.loop;f&&t&&n.changeDirection(),jr(n.params,l);let m=n.params.enabled,x=n.params.loop;Object.assign(n,{allowTouchMove:n.params.allowTouchMove,allowSlideNext:n.params.allowSlideNext,allowSlidePrev:n.params.allowSlidePrev}),p&&!m?n.disable():!p&&m&&n.enable(),n.currentBreakpoint=o,n.emit("_beforeBreakpoint",l),t&&(v?(n.loopDestroy(),n.loopCreate(e),n.updateSlides()):!g&&x?(n.loopCreate(e),n.updateSlides()):g&&!x&&n.loopDestroy()),n.emit("breakpoint",l)}function D3(n,e,t){if(e===void 0&&(e="window"),!n||e==="container"&&!t)return;let i=!1,r=Ti(),s=e==="window"?r.innerHeight:t.clientHeight,o=Object.keys(n).map(a=>{if(typeof a=="string"&&a.indexOf("@")===0){let l=parseFloat(a.substr(1));return{value:s*l,point:a}}return{value:a,point:a}});o.sort((a,l)=>parseInt(a.value,10)-parseInt(l.value,10));for(let a=0;a<o.length;a+=1){let{point:l,value:c}=o[a];e==="window"?r.matchMedia(`(min-width: ${c}px)`).matches&&(i=l):c<=t.clientWidth&&(i=l)}return i||"max"}var P3={setBreakpoint:C3,getBreakpoint:D3};function R3(n,e){let t=[];return n.forEach(i=>{typeof i=="object"?Object.keys(i).forEach(r=>{i[r]&&t.push(e+r)}):typeof i=="string"&&t.push(e+i)}),t}function L3(){let n=this,{classNames:e,params:t,rtl:i,el:r,device:s}=n,o=R3(["initialized",t.direction,{"free-mode":n.params.freeMode&&t.freeMode.enabled},{autoheight:t.autoHeight},{rtl:i},{grid:t.grid&&t.grid.rows>1},{"grid-column":t.grid&&t.grid.rows>1&&t.grid.fill==="column"},{android:s.android},{ios:s.ios},{"css-mode":t.cssMode},{centered:t.cssMode&&t.centeredSlides},{"watch-progress":t.watchSlidesProgress}],t.containerModifierClass);e.push(...o),r.classList.add(...e),n.emitContainerClasses()}function O3(){let n=this,{el:e,classNames:t}=n;!e||typeof e=="string"||(e.classList.remove(...t),n.emitContainerClasses())}var I3={addClasses:L3,removeClasses:O3};function F3(){let n=this,{isLocked:e,params:t}=n,{slidesOffsetBefore:i}=t;if(i){let r=n.slides.length-1,s=n.slidesGrid[r]+n.slidesSizesGrid[r]+i*2;n.isLocked=n.size>s}else n.isLocked=n.snapGrid.length===1;t.allowSlideNext===!0&&(n.allowSlideNext=!n.isLocked),t.allowSlidePrev===!0&&(n.allowSlidePrev=!n.isLocked),e&&e!==n.isLocked&&(n.isEnd=!1),e!==n.isLocked&&n.emit(n.isLocked?"lock":"unlock")}var k3={checkOverflow:F3},cS={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function U3(n,e){return function(i){i===void 0&&(i={});let r=Object.keys(i)[0],s=i[r];if(typeof s!="object"||s===null){jr(e,i);return}if(n[r]===!0&&(n[r]={enabled:!0}),r==="navigation"&&n[r]&&n[r].enabled&&!n[r].prevEl&&!n[r].nextEl&&(n[r].auto=!0),["pagination","scrollbar"].indexOf(r)>=0&&n[r]&&n[r].enabled&&!n[r].el&&(n[r].auto=!0),!(r in n&&"enabled"in s)){jr(e,i);return}typeof n[r]=="object"&&!("enabled"in n[r])&&(n[r].enabled=!0),n[r]||(n[r]={enabled:!1}),jr(e,i)}}var m0={eventsEmitter:IP,update:qP,translate:ZP,transition:t3,slide:c3,loop:p3,grabCursor:g3,events:A3,breakpoints:P3,checkOverflow:k3,classes:I3},g0={},Ln=class n{constructor(){let e,t;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];r.length===1&&r[0].constructor&&Object.prototype.toString.call(r[0]).slice(8,-1)==="Object"?t=r[0]:[e,t]=r,t||(t={}),t=jr({},t),e&&!t.el&&(t.el=e);let o=Pr();if(t.el&&typeof t.el=="string"&&o.querySelectorAll(t.el).length>1){let u=[];return o.querySelectorAll(t.el).forEach(h=>{let d=jr({},t,{el:h});u.push(new n(d))}),u}let a=this;a.__swiper__=!0,a.support=uS(),a.device=hS({userAgent:t.userAgent}),a.browser=RP(),a.eventsListeners={},a.eventsAnyListeners=[],a.modules=[...a.__modules__],t.modules&&Array.isArray(t.modules)&&a.modules.push(...t.modules);let l={};a.modules.forEach(u=>{u({params:t,swiper:a,extendParams:U3(t,l),on:a.on.bind(a),once:a.once.bind(a),off:a.off.bind(a),emit:a.emit.bind(a)})});let c=jr({},cS,l);return a.params=jr({},c,g0,t),a.originalParams=jr({},a.params),a.passedParams=jr({},t),a.params&&a.params.on&&Object.keys(a.params.on).forEach(u=>{a.on(u,a.params.on[u])}),a.params&&a.params.onAny&&a.onAny(a.params.onAny),Object.assign(a,{enabled:a.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return a.params.direction==="horizontal"},isVertical(){return a.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:a.params.allowSlideNext,allowSlidePrev:a.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:a.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:a.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),a.emit("_swiper"),a.params.init&&a.init(),a}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){let{slidesEl:t,params:i}=this,r=Li(t,`.${i.slideClass}, swiper-slide`),s=Ua(r[0]);return Ua(e)-s}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter(t=>t.getAttribute("data-swiper-slide-index")*1===e)[0])}recalcSlides(){let e=this,{slidesEl:t,params:i}=e;e.slides=Li(t,`.${i.slideClass}, swiper-slide`)}enable(){let e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){let e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){let i=this;e=Math.min(Math.max(e,0),1);let r=i.minTranslate(),o=(i.maxTranslate()-r)*e+r;i.translateTo(o,typeof t=="undefined"?0:t),i.updateActiveIndex(),i.updateSlidesClasses()}emitContainerClasses(){let e=this;if(!e.params._emitClasses||!e.el)return;let t=e.el.className.split(" ").filter(i=>i.indexOf("swiper")===0||i.indexOf(e.params.containerModifierClass)===0);e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){let t=this;return t.destroyed?"":e.className.split(" ").filter(i=>i.indexOf("swiper-slide")===0||i.indexOf(t.params.slideClass)===0).join(" ")}emitSlidesClasses(){let e=this;if(!e.params._emitClasses||!e.el)return;let t=[];e.slides.forEach(i=>{let r=e.getSlideClasses(i);t.push({slideEl:i,classNames:r}),e.emit("_slideClass",i,r)}),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){e===void 0&&(e="current"),t===void 0&&(t=!1);let i=this,{params:r,slides:s,slidesGrid:o,slidesSizesGrid:a,size:l,activeIndex:c}=i,u=1;if(typeof r.slidesPerView=="number")return r.slidesPerView;if(r.centeredSlides){let h=s[c]?Math.ceil(s[c].swiperSlideSize):0,d;for(let p=c+1;p<s.length;p+=1)s[p]&&!d&&(h+=Math.ceil(s[p].swiperSlideSize),u+=1,h>l&&(d=!0));for(let p=c-1;p>=0;p-=1)s[p]&&!d&&(h+=s[p].swiperSlideSize,u+=1,h>l&&(d=!0))}else if(e==="current")for(let h=c+1;h<s.length;h+=1)(t?o[h]+a[h]-o[c]<l:o[h]-o[c]<l)&&(u+=1);else for(let h=c-1;h>=0;h-=1)o[c]-o[h]<l&&(u+=1);return u}update(){let e=this;if(!e||e.destroyed)return;let{snapGrid:t,params:i}=e;i.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach(o=>{o.complete&&sp(e,o)}),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses();function r(){let o=e.rtlTranslate?e.translate*-1:e.translate,a=Math.min(Math.max(o,e.maxTranslate()),e.minTranslate());e.setTranslate(a),e.updateActiveIndex(),e.updateSlidesClasses()}let s;if(i.freeMode&&i.freeMode.enabled&&!i.cssMode)r(),i.autoHeight&&e.updateAutoHeight();else{if((i.slidesPerView==="auto"||i.slidesPerView>1)&&e.isEnd&&!i.centeredSlides){let o=e.virtual&&i.virtual.enabled?e.virtual.slides:e.slides;s=e.slideTo(o.length-1,0,!1,!0)}else s=e.slideTo(e.activeIndex,0,!1,!0);s||r()}i.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){t===void 0&&(t=!0);let i=this,r=i.params.direction;return e||(e=r==="horizontal"?"vertical":"horizontal"),e===r||e!=="horizontal"&&e!=="vertical"||(i.el.classList.remove(`${i.params.containerModifierClass}${r}`),i.el.classList.add(`${i.params.containerModifierClass}${e}`),i.emitContainerClasses(),i.params.direction=e,i.slides.forEach(s=>{e==="vertical"?s.style.width="":s.style.height=""}),i.emit("changeDirection"),t&&i.update()),i}changeLanguageDirection(e){let t=this;t.rtl&&e==="rtl"||!t.rtl&&e==="ltr"||(t.rtl=e==="rtl",t.rtlTranslate=t.params.direction==="horizontal"&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){let t=this;if(t.mounted)return!0;let i=e||t.params.el;if(typeof i=="string"&&(i=document.querySelector(i)),!i)return!1;i.swiper=t,i.parentNode&&i.parentNode.host&&i.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);let r=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`,o=i&&i.shadowRoot&&i.shadowRoot.querySelector?i.shadowRoot.querySelector(r()):Li(i,r())[0];return!o&&t.params.createElements&&(o=rs("div",t.params.wrapperClass),i.append(o),Li(i,`.${t.params.slideClass}`).forEach(a=>{o.append(a)})),Object.assign(t,{el:i,wrapperEl:o,slidesEl:t.isElement&&!i.parentNode.host.slideSlots?i.parentNode.host:o,hostEl:t.isElement?i.parentNode.host:i,mounted:!0,rtl:i.dir.toLowerCase()==="rtl"||Ws(i,"direction")==="rtl",rtlTranslate:t.params.direction==="horizontal"&&(i.dir.toLowerCase()==="rtl"||Ws(i,"direction")==="rtl"),wrongRTL:Ws(o,"display")==="-webkit-box"}),!0}init(e){let t=this;if(t.initialized||t.mount(e)===!1)return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(),t.attachEvents();let r=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&r.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),r.forEach(s=>{s.complete?sp(t,s):s.addEventListener("load",o=>{sp(t,o.target)})}),v0(t),t.initialized=!0,v0(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);let i=this,{params:r,el:s,wrapperEl:o,slides:a}=i;return typeof i.params=="undefined"||i.destroyed||(i.emit("beforeDestroy"),i.initialized=!1,i.detachEvents(),r.loop&&i.loopDestroy(),t&&(i.removeClasses(),s&&typeof s!="string"&&s.removeAttribute("style"),o&&o.removeAttribute("style"),a&&a.length&&a.forEach(l=>{l.classList.remove(r.slideVisibleClass,r.slideFullyVisibleClass,r.slideActiveClass,r.slideNextClass,r.slidePrevClass),l.removeAttribute("style"),l.removeAttribute("data-swiper-slide-index")})),i.emit("destroy"),Object.keys(i.eventsListeners).forEach(l=>{i.off(l)}),e!==!1&&(i.el&&typeof i.el!="string"&&(i.el.swiper=null),tS(i)),i.destroyed=!0),null}static extendDefaults(e){jr(g0,e)}static get extendedDefaults(){return g0}static get defaults(){return cS}static installModule(e){n.prototype.__modules__||(n.prototype.__modules__=[]);let t=n.prototype.__modules__;typeof e=="function"&&t.indexOf(e)<0&&t.push(e)}static use(e){return Array.isArray(e)?(e.forEach(t=>n.installModule(t)),n):(n.installModule(e),n)}};Object.keys(m0).forEach(n=>{Object.keys(m0[n]).forEach(e=>{Ln.prototype[e]=m0[n][e]})});Ln.use([LP,OP]);function op(n,e,t,i){return n.params.createElements&&Object.keys(i).forEach(r=>{if(!t[r]&&t.auto===!0){let s=Li(n.el,`.${i[r]}`)[0];s||(s=rs("div",i[r]),s.className=i[r],n.el.append(s)),t[r]=s,e[r]=s}}),t}function Co(n){return n===void 0&&(n=""),`.${n.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function ap(n){let{swiper:e,extendParams:t,on:i,emit:r}=n,s="swiper-pagination";t({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:x=>x,formatFractionTotal:x=>x,bulletClass:`${s}-bullet`,bulletActiveClass:`${s}-bullet-active`,modifierClass:`${s}-`,currentClass:`${s}-current`,totalClass:`${s}-total`,hiddenClass:`${s}-hidden`,progressbarFillClass:`${s}-progressbar-fill`,progressbarOppositeClass:`${s}-progressbar-opposite`,clickableClass:`${s}-clickable`,lockClass:`${s}-lock`,horizontalClass:`${s}-horizontal`,verticalClass:`${s}-vertical`,paginationDisabledClass:`${s}-disabled`}}),e.pagination={el:null,bullets:[]};let o,a=0;function l(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function c(x,y){let{bulletActiveClass:_}=e.params.pagination;x&&(x=x[`${y==="prev"?"previous":"next"}ElementSibling`],x&&(x.classList.add(`${_}-${y}`),x=x[`${y==="prev"?"previous":"next"}ElementSibling`],x&&x.classList.add(`${_}-${y}-${y}`)))}function u(x,y,_){if(x=x%_,y=y%_,y===x+1)return"next";if(y===x-1)return"previous"}function h(x){let y=x.target.closest(Co(e.params.pagination.bulletClass));if(!y)return;x.preventDefault();let _=Ua(y)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===_)return;let w=u(e.realIndex,_,e.slides.length);w==="next"?e.slideNext():w==="previous"?e.slidePrev():e.slideToLoop(_)}else e.slideTo(_)}function d(){let x=e.rtl,y=e.params.pagination;if(l())return;let _=e.pagination.el;_=hn(_);let w,b,T=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,A=e.params.loop?Math.ceil(T/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(b=e.previousRealIndex||0,w=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex!="undefined"?(w=e.snapIndex,b=e.previousSnapIndex):(b=e.previousIndex||0,w=e.activeIndex||0),y.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){let S=e.pagination.bullets,E,R,D;if(y.dynamicBullets&&(o=ju(S[0],e.isHorizontal()?"width":"height",!0),_.forEach(z=>{z.style[e.isHorizontal()?"width":"height"]=`${o*(y.dynamicMainBullets+4)}px`}),y.dynamicMainBullets>1&&b!==void 0&&(a+=w-(b||0),a>y.dynamicMainBullets-1?a=y.dynamicMainBullets-1:a<0&&(a=0)),E=Math.max(w-a,0),R=E+(Math.min(S.length,y.dynamicMainBullets)-1),D=(R+E)/2),S.forEach(z=>{let L=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(G=>`${y.bulletActiveClass}${G}`)].map(G=>typeof G=="string"&&G.includes(" ")?G.split(" "):G).flat();z.classList.remove(...L)}),_.length>1)S.forEach(z=>{let L=Ua(z);L===w?z.classList.add(...y.bulletActiveClass.split(" ")):e.isElement&&z.setAttribute("part","bullet"),y.dynamicBullets&&(L>=E&&L<=R&&z.classList.add(...`${y.bulletActiveClass}-main`.split(" ")),L===E&&c(z,"prev"),L===R&&c(z,"next"))});else{let z=S[w];if(z&&z.classList.add(...y.bulletActiveClass.split(" ")),e.isElement&&S.forEach((L,G)=>{L.setAttribute("part",G===w?"bullet-active":"bullet")}),y.dynamicBullets){let L=S[E],G=S[R];for(let J=E;J<=R;J+=1)S[J]&&S[J].classList.add(...`${y.bulletActiveClass}-main`.split(" "));c(L,"prev"),c(G,"next")}}if(y.dynamicBullets){let z=Math.min(S.length,y.dynamicMainBullets+4),L=(o*z-o)/2-D*o,G=x?"right":"left";S.forEach(J=>{J.style[e.isHorizontal()?G:"top"]=`${L}px`})}}_.forEach((S,E)=>{if(y.type==="fraction"&&(S.querySelectorAll(Co(y.currentClass)).forEach(R=>{R.textContent=y.formatFractionCurrent(w+1)}),S.querySelectorAll(Co(y.totalClass)).forEach(R=>{R.textContent=y.formatFractionTotal(A)})),y.type==="progressbar"){let R;y.progressbarOpposite?R=e.isHorizontal()?"vertical":"horizontal":R=e.isHorizontal()?"horizontal":"vertical";let D=(w+1)/A,z=1,L=1;R==="horizontal"?z=D:L=D,S.querySelectorAll(Co(y.progressbarFillClass)).forEach(G=>{G.style.transform=`translate3d(0,0,0) scaleX(${z}) scaleY(${L})`,G.style.transitionDuration=`${e.params.speed}ms`})}y.type==="custom"&&y.renderCustom?(S.innerHTML=y.renderCustom(e,w+1,A),E===0&&r("paginationRender",S)):(E===0&&r("paginationRender",S),r("paginationUpdate",S)),e.params.watchOverflow&&e.enabled&&S.classList[e.isLocked?"add":"remove"](y.lockClass)})}function p(){let x=e.params.pagination;if(l())return;let y=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.grid&&e.params.grid.rows>1?e.slides.length/Math.ceil(e.params.grid.rows):e.slides.length,_=e.pagination.el;_=hn(_);let w="";if(x.type==="bullets"){let b=e.params.loop?Math.ceil(y/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&b>y&&(b=y);for(let T=0;T<b;T+=1)x.renderBullet?w+=x.renderBullet.call(e,T,x.bulletClass):w+=`<${x.bulletElement} ${e.isElement?'part="bullet"':""} class="${x.bulletClass}"></${x.bulletElement}>`}x.type==="fraction"&&(x.renderFraction?w=x.renderFraction.call(e,x.currentClass,x.totalClass):w=`<span class="${x.currentClass}"></span> / <span class="${x.totalClass}"></span>`),x.type==="progressbar"&&(x.renderProgressbar?w=x.renderProgressbar.call(e,x.progressbarFillClass):w=`<span class="${x.progressbarFillClass}"></span>`),e.pagination.bullets=[],_.forEach(b=>{x.type!=="custom"&&(b.innerHTML=w||""),x.type==="bullets"&&e.pagination.bullets.push(...b.querySelectorAll(Co(x.bulletClass)))}),x.type!=="custom"&&r("paginationRender",_[0])}function f(){e.params.pagination=op(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});let x=e.params.pagination;if(!x.el)return;let y;typeof x.el=="string"&&e.isElement&&(y=e.el.querySelector(x.el)),!y&&typeof x.el=="string"&&(y=[...document.querySelectorAll(x.el)]),y||(y=x.el),!(!y||y.length===0)&&(e.params.uniqueNavElements&&typeof x.el=="string"&&Array.isArray(y)&&y.length>1&&(y=[...e.el.querySelectorAll(x.el)],y.length>1&&(y=y.filter(_=>Yl(_,".swiper")[0]===e.el)[0])),Array.isArray(y)&&y.length===1&&(y=y[0]),Object.assign(e.pagination,{el:y}),y=hn(y),y.forEach(_=>{x.type==="bullets"&&x.clickable&&_.classList.add(...(x.clickableClass||"").split(" ")),_.classList.add(x.modifierClass+x.type),_.classList.add(e.isHorizontal()?x.horizontalClass:x.verticalClass),x.type==="bullets"&&x.dynamicBullets&&(_.classList.add(`${x.modifierClass}${x.type}-dynamic`),a=0,x.dynamicMainBullets<1&&(x.dynamicMainBullets=1)),x.type==="progressbar"&&x.progressbarOpposite&&_.classList.add(x.progressbarOppositeClass),x.clickable&&_.addEventListener("click",h),e.enabled||_.classList.add(x.lockClass)}))}function v(){let x=e.params.pagination;if(l())return;let y=e.pagination.el;y&&(y=hn(y),y.forEach(_=>{_.classList.remove(x.hiddenClass),_.classList.remove(x.modifierClass+x.type),_.classList.remove(e.isHorizontal()?x.horizontalClass:x.verticalClass),x.clickable&&(_.classList.remove(...(x.clickableClass||"").split(" ")),_.removeEventListener("click",h))})),e.pagination.bullets&&e.pagination.bullets.forEach(_=>_.classList.remove(...x.bulletActiveClass.split(" ")))}i("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;let x=e.params.pagination,{el:y}=e.pagination;y=hn(y),y.forEach(_=>{_.classList.remove(x.horizontalClass,x.verticalClass),_.classList.add(e.isHorizontal()?x.horizontalClass:x.verticalClass)})}),i("init",()=>{e.params.pagination.enabled===!1?m():(f(),p(),d())}),i("activeIndexChange",()=>{typeof e.snapIndex=="undefined"&&d()}),i("snapIndexChange",()=>{d()}),i("snapGridLengthChange",()=>{p(),d()}),i("destroy",()=>{v()}),i("enable disable",()=>{let{el:x}=e.pagination;x&&(x=hn(x),x.forEach(y=>y.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),i("lock unlock",()=>{d()}),i("click",(x,y)=>{let _=y.target,w=hn(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&w&&w.length>0&&!_.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&_===e.navigation.nextEl||e.navigation.prevEl&&_===e.navigation.prevEl))return;let b=w[0].classList.contains(e.params.pagination.hiddenClass);r(b===!0?"paginationShow":"paginationHide"),w.forEach(T=>T.classList.toggle(e.params.pagination.hiddenClass))}});let g=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:x}=e.pagination;x&&(x=hn(x),x.forEach(y=>y.classList.remove(e.params.pagination.paginationDisabledClass))),f(),p(),d()},m=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:x}=e.pagination;x&&(x=hn(x),x.forEach(y=>y.classList.add(e.params.pagination.paginationDisabledClass))),v()};Object.assign(e.pagination,{enable:g,disable:m,render:p,update:d,init:f,destroy:v})}function y0(n){let{swiper:e,extendParams:t,on:i}=n;t({parallax:{enabled:!1}});let r="[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]",s=(l,c)=>{let{rtl:u}=e,h=u?-1:1,d=l.getAttribute("data-swiper-parallax")||"0",p=l.getAttribute("data-swiper-parallax-x"),f=l.getAttribute("data-swiper-parallax-y"),v=l.getAttribute("data-swiper-parallax-scale"),g=l.getAttribute("data-swiper-parallax-opacity"),m=l.getAttribute("data-swiper-parallax-rotate");if(p||f?(p=p||"0",f=f||"0"):e.isHorizontal()?(p=d,f="0"):(f=d,p="0"),p.indexOf("%")>=0?p=`${parseInt(p,10)*c*h}%`:p=`${p*c*h}px`,f.indexOf("%")>=0?f=`${parseInt(f,10)*c}%`:f=`${f*c}px`,typeof g!="undefined"&&g!==null){let y=g-(g-1)*(1-Math.abs(c));l.style.opacity=y}let x=`translate3d(${p}, ${f}, 0px)`;if(typeof v!="undefined"&&v!==null){let y=v-(v-1)*(1-Math.abs(c));x+=` scale(${y})`}if(m&&typeof m!="undefined"&&m!==null){let y=m*c*-1;x+=` rotate(${y}deg)`}l.style.transform=x},o=()=>{let{el:l,slides:c,progress:u,snapGrid:h,isElement:d}=e,p=Li(l,r);e.isElement&&p.push(...Li(e.hostEl,r)),p.forEach(f=>{s(f,u)}),c.forEach((f,v)=>{let g=f.progress;e.params.slidesPerGroup>1&&e.params.slidesPerView!=="auto"&&(g+=Math.ceil(v/2)-u*(h.length-1)),g=Math.min(Math.max(g,-1),1),f.querySelectorAll(`${r}, [data-swiper-parallax-rotate]`).forEach(m=>{s(m,g)})})},a=function(l){l===void 0&&(l=e.params.speed);let{el:c,hostEl:u}=e,h=[...c.querySelectorAll(r)];e.isElement&&h.push(...u.querySelectorAll(r)),h.forEach(d=>{let p=parseInt(d.getAttribute("data-swiper-parallax-duration"),10)||l;l===0&&(p=0),d.style.transitionDuration=`${p}ms`})};i("beforeInit",()=>{e.params.parallax.enabled&&(e.params.watchSlidesProgress=!0,e.originalParams.watchSlidesProgress=!0)}),i("init",()=>{e.params.parallax.enabled&&o()}),i("setTranslate",()=>{e.params.parallax.enabled&&o()}),i("setTransition",(l,c)=>{e.params.parallax.enabled&&a(c)})}qe.registerPlugin(ht);function z3(){let n=document.querySelector("[data-asset-section]");if(!n)return;let e=n.querySelector(".swiper");if(!e)return;let t=2.5;window.isTabletOrBelow&&(t="auto");let i=n.querySelector("[data-pagi-w]"),s=n.querySelector("[data-slider-slide-links]").querySelectorAll("[data-slider-slide-link]"),o=new Ln(e,{modules:[ap],slidesPerView:t,spaceBetween:0,loop:!0,centeredSlides:!1,slideActiveClass:"is--active",keyboard:{enabled:!0,onlyInViewport:!0},pagination:{el:i,type:"bullets",clickable:!0,bulletClass:"asset__pagination",bulletActiveClass:"is--active"}});o.on("slideChange",()=>{let a=o.realIndex;s.forEach((l,c)=>{l.classList.toggle("is--active",c===a)})}),s.forEach((a,l)=>{a.setAttribute("data-slide-to",l),a.addEventListener("click",()=>{let c=parseInt(a.getAttribute("data-slide-to"),10);o.slideToLoop(c)})})}function B3(){let n=document.querySelector("[data-cards-section]");if(!n)return;let e=n.querySelector(".swiper");if(!e)return;let t=e.querySelectorAll(".swiper-slide").length,i=Math.floor(t/2),r=new Ln(e,{slidesPerView:"auto",spaceBetween:16,loop:!1,centeredSlides:!0,slideActiveClass:"is--active",touchStartPreventDefault:!1,keyboard:{enabled:!0,onlyInViewport:!0},initialSlide:i,on:{init:function(){gS(this)},slideChange:function(){gS(this)}}});function s(){let a=document.querySelectorAll("[data-vision-slide]"),l="power3.out",c="power2.out",u=.6,h=.6;a.forEach(d=>{let p=d.querySelector(".vc__trans--w");function f(){if(d.classList.contains("is--active")){let m=Math.random()>.5?180:540;qe.killTweensOf(p),qe.to(p,{rotationY:`+=${m}`,ease:l,duration:u}),d.dataset.facing=m===180?"back":"front"}}function v(){if(d.classList.contains("is--active")){qe.killTweensOf(p);let m=d.dataset.facing==="back"?360:0;qe.to(p,{rotationY:m,ease:c,duration:h})}}d.addEventListener("mouseenter",f),d.addEventListener("mouseleave",v),new MutationObserver(m=>{m.forEach(x=>{x.attributeName==="class"&&!d.classList.contains("is--active")&&(qe.killTweensOf(p),qe.to(p,{rotationY:0,ease:c,duration:h}))})}).observe(d,{attributes:!0})}),r.on("slideChange",function(){let p=r.slides[r.activeIndex].getAttribute("data-vision-slide");p?window.app.slideGradient(p):console.warn("nae hex")})}function o(){ht.create({trigger:n,start:"top bottom",onEnter:()=>setTimeout(()=>r.slideTo(0),1500)})}o(),s()}function gS(n){n.slides.forEach(t=>{qe.to(t,{scale:.85,duration:.3})});let e=n.realIndex;qe.to(n.slides[e],{scale:1,duration:.3,autoAlpha:1}),e>0&&qe.to(n.slides[e-1],{scale:.9,duration:.3,autoAlpha:.8}),e>1&&qe.to(n.slides[e-2],{scale:.8,duration:.3,autoAlpha:.6}),e>2&&qe.to(n.slides[e-3],{scale:.7,duration:.3,autoAlpha:.4}),e>3&&qe.to(n.slides[e-4],{scale:.6,duration:.3,autoAlpha:.2}),e<n.slides.length-1&&qe.to(n.slides[e+1],{scale:.9,duration:.3,autoAlpha:.8}),e<n.slides.length-2&&qe.to(n.slides[e+2],{scale:.8,duration:.3,autoAlpha:.6}),e<n.slides.length-3&&qe.to(n.slides[e+3],{scale:.7,duration:.3,autoAlpha:.4}),e<n.slides.length-4&&qe.to(n.slides[e+4],{scale:.6,duration:.3,autoAlpha:.2})}function N3(){let n=document.querySelector("[data-adv-section]");if(!n)return;let e=n.querySelector(".swiper");if(!e)return;let t=n.querySelector("[data-pagi-w]"),r=n.querySelector("[data-slider-slide-links]").querySelectorAll("[data-slider-slide-link]"),s=0;window.isTabletOrBelow&&(s=16);let o=new Ln(e,{modules:[ap],slidesPerView:"auto",spaceBetween:s,loop:!0,centeredSlides:!1,slideActiveClass:"is--active",keyboard:{enabled:!0,onlyInViewport:!0},pagination:{el:t,type:"bullets",clickable:!0,bulletClass:"adv__pagi--dot",bulletActiveClass:"is--active"}});o.on("slideChange",()=>{let a=o.realIndex;r.forEach((l,c)=>{l.classList.toggle("is--active",c===a)})}),r.forEach((a,l)=>{a.setAttribute("data-slide-to",l),a.addEventListener("click",()=>{let c=parseInt(a.getAttribute("data-slide-to"),10);o.slideToLoop(c)})})}function G3(){let n=document.querySelector("[data-blog-section]");if(!n)return;let e=n.querySelector(".swiper");if(!e)return;let t=!0;window.isTabletOrBelow&&(t=!1);let i=new Ln(e,{modules:[y0],slidesPerView:"auto",spaceBetween:0,loop:!0,speed:600,centeredSlides:t,parallax:!0,slideActiveClass:"is--active",keyboard:{enabled:!0,onlyInViewport:!0}})}function V3(){let n=document.querySelector("[data-team-section]");if(!n)return;let e=n.querySelector(".swiper");if(!e)return;let t=new Ln(e,{slidesPerView:"auto",spaceBetween:32,loop:!1,speed:300,centeredSlides:!1,slideActiveClass:"is--active",keyboard:{enabled:!0,onlyInViewport:!0}})}function vS(){z3(),N3(),B3(),G3(),V3(),window.isTabletOrBelow}function xS(n,e,t){return Math.max(n,Math.min(e,t))}var b0=class{advance(e){var a;if(!this.isRunning)return;let t=!1;if(this.lerp)this.value=(i=this.value,r=this.to,s=60*this.lerp,o=e,function(l,c,u){return(1-u)*l+u*c}(i,r,1-Math.exp(-s*o))),Math.round(this.value)===this.to&&(this.value=this.to,t=!0);else{this.currentTime+=e;let l=xS(0,this.currentTime/this.duration,1);t=l>=1;let c=t?1:this.easing(l);this.value=this.from+(this.to-this.from)*c}var i,r,s,o;(a=this.onUpdate)==null||a.call(this,this.value,t),t&&this.stop()}stop(){this.isRunning=!1}fromTo(e,t,{lerp:i=.1,duration:r=1,easing:s=l=>l,onStart:o,onUpdate:a}){this.from=this.value=e,this.to=t,this.lerp=i,this.duration=r,this.easing=s,this.currentTime=0,this.isRunning=!0,o==null||o(),this.onUpdate=a}},S0=class{constructor({wrapper:e,content:t,autoResize:i=!0,debounce:r=250}={}){Os(this,"resize",()=>{this.onWrapperResize(),this.onContentResize()});Os(this,"onWrapperResize",()=>{this.wrapper===window?(this.width=window.innerWidth,this.height=window.innerHeight):(this.width=this.wrapper.clientWidth,this.height=this.wrapper.clientHeight)});Os(this,"onContentResize",()=>{this.wrapper===window?(this.scrollHeight=this.content.scrollHeight,this.scrollWidth=this.content.scrollWidth):(this.scrollHeight=this.wrapper.scrollHeight,this.scrollWidth=this.wrapper.scrollWidth)});this.wrapper=e,this.content=t,i&&(this.debouncedResize=function(s,o){let a;return function(){let l=arguments,c=this;clearTimeout(a),a=setTimeout(function(){s.apply(c,l)},o)}}(this.resize,r),this.wrapper===window?window.addEventListener("resize",this.debouncedResize,!1):(this.wrapperResizeObserver=new ResizeObserver(this.debouncedResize),this.wrapperResizeObserver.observe(this.wrapper)),this.contentResizeObserver=new ResizeObserver(this.debouncedResize),this.contentResizeObserver.observe(this.content)),this.resize()}destroy(){var e,t;(e=this.wrapperResizeObserver)==null||e.disconnect(),(t=this.contentResizeObserver)==null||t.disconnect(),window.removeEventListener("resize",this.debouncedResize,!1)}get limit(){return{x:this.scrollWidth-this.width,y:this.scrollHeight-this.height}}},cp=class{constructor(){this.events={}}emit(e,...t){let i=this.events[e]||[];for(let r=0,s=i.length;r<s;r++)i[r](...t)}on(e,t){var i;return(i=this.events[e])!=null&&i.push(t)||(this.events[e]=[t]),()=>{var r;this.events[e]=(r=this.events[e])==null?void 0:r.filter(s=>t!==s)}}off(e,t){var i;this.events[e]=(i=this.events[e])==null?void 0:i.filter(r=>t!==r)}destroy(){this.events={}}},yS=100/6,E0=class{constructor(e,{wheelMultiplier:t=1,touchMultiplier:i=1}){Os(this,"onTouchStart",e=>{let{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:0,y:0},this.emitter.emit("scroll",{deltaX:0,deltaY:0,event:e})});Os(this,"onTouchMove",e=>{let{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e,r=-(t-this.touchStart.x)*this.touchMultiplier,s=-(i-this.touchStart.y)*this.touchMultiplier;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:r,y:s},this.emitter.emit("scroll",{deltaX:r,deltaY:s,event:e})});Os(this,"onTouchEnd",e=>{this.emitter.emit("scroll",{deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:e})});Os(this,"onWheel",e=>{let{deltaX:t,deltaY:i,deltaMode:r}=e;t*=r===1?yS:r===2?this.windowWidth:1,i*=r===1?yS:r===2?this.windowHeight:1,t*=this.wheelMultiplier,i*=this.wheelMultiplier,this.emitter.emit("scroll",{deltaX:t,deltaY:i,event:e})});Os(this,"onWindowResize",()=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight});this.element=e,this.wheelMultiplier=t,this.touchMultiplier=i,this.touchStart={x:null,y:null},this.emitter=new cp,window.addEventListener("resize",this.onWindowResize,!1),this.onWindowResize(),this.element.addEventListener("wheel",this.onWheel,{passive:!1}),this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd,{passive:!1})}on(e,t){return this.emitter.on(e,t)}destroy(){this.emitter.destroy(),window.removeEventListener("resize",this.onWindowResize,!1),this.element.removeEventListener("wheel",this.onWheel,{passive:!1}),this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.removeEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.removeEventListener("touchend",this.onTouchEnd,{passive:!1})}},up=class{constructor({wrapper:e=window,content:t=document.documentElement,wheelEventsTarget:i=e,eventsTarget:r=i,smoothWheel:s=!0,syncTouch:o=!1,syncTouchLerp:a=.075,touchInertiaMultiplier:l=35,duration:c,easing:u=y=>Math.min(1,1.001-Math.pow(2,-10*y)),lerp:h=!c&&.1,infinite:d=!1,orientation:p="vertical",gestureOrientation:f="vertical",touchMultiplier:v=1,wheelMultiplier:g=1,autoResize:m=!0,__experimental__naiveDimensions:x=!1}={}){this.__isSmooth=!1,this.__isScrolling=!1,this.__isStopped=!1,this.__isLocked=!1,this.onVirtualScroll=({deltaX:y,deltaY:_,event:w})=>{if(w.ctrlKey)return;let b=w.type.includes("touch"),T=w.type.includes("wheel");if(this.options.syncTouch&&b&&w.type==="touchstart"&&!this.isStopped&&!this.isLocked)return void this.reset();let A=y===0&&_===0,S=this.options.gestureOrientation==="vertical"&&_===0||this.options.gestureOrientation==="horizontal"&&y===0;if(A||S)return;let E=w.composedPath();if(E=E.slice(0,E.indexOf(this.rootElement)),E.find(L=>{var G,J,X,N,U;return((G=L.hasAttribute)===null||G===void 0?void 0:G.call(L,"data-lenis-prevent"))||b&&((J=L.hasAttribute)===null||J===void 0?void 0:J.call(L,"data-lenis-prevent-touch"))||T&&((X=L.hasAttribute)===null||X===void 0?void 0:X.call(L,"data-lenis-prevent-wheel"))||((N=L.classList)===null||N===void 0?void 0:N.contains("lenis"))&&!(!((U=L.classList)===null||U===void 0)&&U.contains("lenis-stopped"))}))return;if(this.isStopped||this.isLocked)return void w.preventDefault();if(this.isSmooth=this.options.syncTouch&&b||this.options.smoothWheel&&T,!this.isSmooth)return this.isScrolling=!1,void this.animate.stop();w.preventDefault();let R=_;this.options.gestureOrientation==="both"?R=Math.abs(_)>Math.abs(y)?_:y:this.options.gestureOrientation==="horizontal"&&(R=y);let D=b&&this.options.syncTouch,z=b&&w.type==="touchend"&&Math.abs(R)>5;z&&(R=this.velocity*this.options.touchInertiaMultiplier),this.scrollTo(this.targetScroll+R,Object.assign({programmatic:!1},D?{lerp:z?this.options.syncTouchLerp:1}:{lerp:this.options.lerp,duration:this.options.duration,easing:this.options.easing}))},this.onNativeScroll=()=>{if(!this.__preventNextScrollEvent&&!this.isScrolling){let y=this.animatedScroll;this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.direction=Math.sign(this.animatedScroll-y),this.emit()}},window.lenisVersion="1.0.42",e!==document.documentElement&&e!==document.body||(e=window),this.options={wrapper:e,content:t,wheelEventsTarget:i,eventsTarget:r,smoothWheel:s,syncTouch:o,syncTouchLerp:a,touchInertiaMultiplier:l,duration:c,easing:u,lerp:h,infinite:d,gestureOrientation:f,orientation:p,touchMultiplier:v,wheelMultiplier:g,autoResize:m,__experimental__naiveDimensions:x},this.animate=new b0,this.emitter=new cp,this.dimensions=new S0({wrapper:e,content:t,autoResize:m}),this.toggleClassName("lenis",!0),this.velocity=0,this.isLocked=!1,this.isStopped=!1,this.isSmooth=o||s,this.isScrolling=!1,this.targetScroll=this.animatedScroll=this.actualScroll,this.options.wrapper.addEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll=new E0(r,{touchMultiplier:v,wheelMultiplier:g}),this.virtualScroll.on("scroll",this.onVirtualScroll)}destroy(){this.emitter.destroy(),this.options.wrapper.removeEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll.destroy(),this.dimensions.destroy(),this.toggleClassName("lenis",!1),this.toggleClassName("lenis-smooth",!1),this.toggleClassName("lenis-scrolling",!1),this.toggleClassName("lenis-stopped",!1),this.toggleClassName("lenis-locked",!1)}on(e,t){return this.emitter.on(e,t)}off(e,t){return this.emitter.off(e,t)}setScroll(e){this.isHorizontal?this.rootElement.scrollLeft=e:this.rootElement.scrollTop=e}resize(){this.dimensions.resize()}emit(){this.emitter.emit("scroll",this)}reset(){this.isLocked=!1,this.isScrolling=!1,this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.animate.stop()}start(){this.isStopped&&(this.isStopped=!1,this.reset())}stop(){this.isStopped||(this.isStopped=!0,this.animate.stop(),this.reset())}raf(e){let t=e-(this.time||e);this.time=e,this.animate.advance(.001*t)}scrollTo(e,{offset:t=0,immediate:i=!1,lock:r=!1,duration:s=this.options.duration,easing:o=this.options.easing,lerp:a=!s&&this.options.lerp,onComplete:l,force:c=!1,programmatic:u=!0}={}){if(!this.isStopped&&!this.isLocked||c){if(["top","left","start"].includes(e))e=0;else if(["bottom","right","end"].includes(e))e=this.limit;else{let h;if(typeof e=="string"?h=document.querySelector(e):e!=null&&e.nodeType&&(h=e),h){if(this.options.wrapper!==window){let p=this.options.wrapper.getBoundingClientRect();t-=this.isHorizontal?p.left:p.top}let d=h.getBoundingClientRect();e=(this.isHorizontal?d.left:d.top)+this.animatedScroll}}if(typeof e=="number"){if(e+=t,e=Math.round(e),this.options.infinite?u&&(this.targetScroll=this.animatedScroll=this.scroll):e=xS(0,e,this.limit),i)return this.animatedScroll=this.targetScroll=e,this.setScroll(this.scroll),this.reset(),void(l==null||l(this));if(!u){if(e===this.targetScroll)return;this.targetScroll=e}this.animate.fromTo(this.animatedScroll,e,{duration:s,easing:o,lerp:a,onStart:()=>{r&&(this.isLocked=!0),this.isScrolling=!0},onUpdate:(h,d)=>{this.isScrolling=!0,this.velocity=h-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=h,this.setScroll(this.scroll),u&&(this.targetScroll=h),d||this.emit(),d&&(this.reset(),this.emit(),l==null||l(this),this.__preventNextScrollEvent=!0,requestAnimationFrame(()=>{delete this.__preventNextScrollEvent}))}})}}}get rootElement(){return this.options.wrapper===window?document.documentElement:this.options.wrapper}get limit(){return this.options.__experimental__naiveDimensions?this.isHorizontal?this.rootElement.scrollWidth-this.rootElement.clientWidth:this.rootElement.scrollHeight-this.rootElement.clientHeight:this.dimensions.limit[this.isHorizontal?"x":"y"]}get isHorizontal(){return this.options.orientation==="horizontal"}get actualScroll(){return this.isHorizontal?this.rootElement.scrollLeft:this.rootElement.scrollTop}get scroll(){return this.options.infinite?(e=this.animatedScroll,t=this.limit,(e%t+t)%t):this.animatedScroll;var e,t}get progress(){return this.limit===0?1:this.scroll/this.limit}get isSmooth(){return this.__isSmooth}set isSmooth(e){this.__isSmooth!==e&&(this.__isSmooth=e,this.toggleClassName("lenis-smooth",e))}get isScrolling(){return this.__isScrolling}set isScrolling(e){this.__isScrolling!==e&&(this.__isScrolling=e,this.toggleClassName("lenis-scrolling",e))}get isStopped(){return this.__isStopped}set isStopped(e){this.__isStopped!==e&&(this.__isStopped=e,this.toggleClassName("lenis-stopped",e))}get isLocked(){return this.__isLocked}set isLocked(e){this.__isLocked!==e&&(this.__isLocked=e,this.toggleClassName("lenis-locked",e))}get className(){let e="lenis";return this.isStopped&&(e+=" lenis-stopped"),this.isLocked&&(e+=" lenis-locked"),this.isScrolling&&(e+=" lenis-scrolling"),this.isSmooth&&(e+=" lenis-smooth"),e}toggleClassName(e,t){this.rootElement.classList.toggle(e,t),this.emitter.emit("className change",this)}};function H3(n=null){return Webflow.env("editor")!==void 0?(n!==null&&n(),console.log("Webflow Editor View"),!0):!1}function W3(n){let e=document.createElement("style");e.textContent=n,document.head.append(e)}var m6=W3(`
    .lenis.lenis-smooth {
      scroll-behavior: auto;  
    }
    html.lenis {
      height: auto;
    }
`),q3={wrapper:window,duration:.825,easing:n=>Math.min(1,1.001-Math.pow(2,-10*n)),orientation:"vertical",smoothWheel:!0,syncTouch:!0,touchMultiplier:.1,touchInertiaMultiplier:10,infinite:!1,useOverscroll:!0,useControls:!0,useAnchor:!0,useRaf:!0,autoResize:!1},T0=class extends up{constructor(e){super({params:e}),this.params=e,this.isActive=!0,this.init(),this.call={stop:()=>this.stop(),start:()=>this.start()}}init(){this.config(),this.render(),this.params.useRaf&&(this.y=window.scrollY,this.max=window.innerHeight,this.speed=0,this.percent=this.y/(document.body.scrollHeight-window.innerHeight),this.direction=0,this.on("scroll",e=>this.outScroll(e))),H3(this.destroy.bind(this))}reconfig(){this.scrollinks&&this.scrollinks.forEach(e=>e.onclick=null),this.config()}config(){this.params.useAnchor&&(this.scrolllinks=[...document.querySelectorAll("[data-scrolllink]")].map(e=>{let t=document.querySelector(e.dataset.scrolllink);return t&&(e.onclick=i=>{i.preventDefault(),this.scrollTo(t)}),e})),this.params.useOverscroll&&[...document.querySelectorAll('[data-scroll="overscroll"]')].forEach(e=>e.setAttribute("onwheel","event.stopPropagation()")),this.params.useControls&&([...document.querySelectorAll('[data-scroll="stop"]')].forEach(e=>{e.onclick=()=>{this.stop(),this.isActive=!1}}),[...document.querySelectorAll('[data-scroll="start"]')].forEach(e=>{e.onclick=()=>{this.start(),this.isActive=!0}}),[...document.querySelectorAll('[data-scroll="toggle"]')].forEach(e=>{e.onclick=()=>{this.isActive?(this.stop(),this.isActive=!1):(this.start(),this.isActive=!0)}}))}render(e){this.raf(e),window.requestAnimationFrame(this.render.bind(this))}outScroll({scroll:e,limit:t,velocity:i,progress:r,direction:s}){this.y=e||0,this.max=t||window.innerHeight,this.speed=i||0,this.percent=r||0,this.direction=0,this.params.useRaf&&window.dispatchEvent(new CustomEvent("sscroll",{detail:{y:this.y,max:this.max,speed:this.speed,percent:this.percent,direction:this.direction}}))}renderWebflow(e){}};window.SScroll=new T0(q3);function _S(){window.SScroll.resize()}qe.registerPlugin(ht,Ia);function j3(){let n,e=document.querySelector("[data-hud-slash]");function t(){let u=document.querySelectorAll("[data-load-text]");qe.set(u,{autoAlpha:0}),qe.set(e,{autoAlpha:0})}function i(){qe.to(e,{duration:.1,autoAlpha:1,repeat:2})}function r(){qe.to(e,{duration:.1,autoAlpha:0,repeat:1})}function s(){let u=document.querySelectorAll("[data-load-text]"),h=0;u.forEach(d=>{let p=d.querySelectorAll(".line");p.forEach((f,v)=>{let g=f.querySelectorAll(".word"),m=h+v*.05;g.forEach((x,y)=>{x.dataset.originalText||(x.dataset.originalText=x.textContent),x.textContent="",qe.to(x,{duration:1,scrambleText:{text:x.dataset.originalText,chars:"\u2591\u2592\u2593\u2580\u2584",revealDelay:.01,delimiter:"",speed:1},delay:m+y*.05})})}),h+=-.5+p.length*.05})}function o(){let u=document.querySelectorAll("[data-load-text]"),h=0;u.forEach(d=>{let p=d.querySelectorAll(".line");p.forEach((f,v)=>{let g=f.querySelectorAll(".word"),m=h+v*.05;g.forEach((x,y)=>{qe.to(x,{duration:1,scrambleText:{text:" ",chars:"\u2591\u2592\u2593\u2588\u2580\u2584?",revealDelay:.01,delimiter:"",speed:1},delay:m+y*.05})})}),h+=-.5+p.length*.05})}function a(){clearInterval(n);let u=document.querySelectorAll("[data-load-text] .word"),h=1,d="\u2591\u2592\u2593\u2588\u2580\u2584?";n=setInterval(()=>{Array.from(u).sort(()=>.5-Math.random()).slice(0,Math.ceil(u.length*.1)).forEach(f=>{let v=f.dataset.originalText||f.textContent;qe.to(f,{duration:h,scrambleText:{text:v,chars:d,revealDelay:0,delimiter:"",speed:.3}})})},2e3)}function l(){clearInterval(n)}function c(){let u=document.querySelectorAll("[data-load-scrolltrigger]");window.isMobile?u.forEach(h=>{ht.create({trigger:h,start:"top center",end:"bottom 90%",onEnter:()=>{let d=document.querySelectorAll("[data-load-text]");qe.set(d,{autoAlpha:1}),s(),a()}})}):u.forEach(h=>{ht.create({trigger:h,start:"top center",end:"bottom 90%",onEnter:()=>{let d=document.querySelectorAll("[data-load-text]");qe.set(d,{autoAlpha:1}),i(),s(),a()},onLeave:()=>{r(),l(),o()},onEnterBack:()=>{i(),s(),a()},onLeaveBack:()=>{r(),l(),o()}})})}t(),setTimeout(()=>{window.app.loader.on("loader-finished",()=>{Hb(),c(),qe.to("[data-load-number]",{delay:.5,duration:1,scrambleText:{text:"ASSETS LOADED",chars:"\u2591\u2592\u2593\u2580\u2584",revealDelay:.01,delimiter:"",speed:1},onComplete:()=>{i(),qe.to("[data-load-number]",{delay:2,scrambleText:{text:"SCROLL ENABLED",chars:"\u2591\u2592\u2593\u2580\u2584",revealDelay:.01,delimiter:"",speed:1},onComplete:()=>{window.isMobile&&(l(),o()),qe.to("[data-load-number]",{autoAlpha:0,duration:.1,yoyo:!0,repeat:10,onComplete:()=>{qe.to("[data-load-number]",{autoAlpha:1,duration:.2,onComplete:()=>{qe.to("[data-load-number]",{delay:2,scrambleText:{text:" ",chars:"\u2591\u2592\u2593\u2580\u2584",revealDelay:.01,delimiter:"",speed:1}})}})}})}})}})})},1500)}function X3(){let n=document.querySelector("[data-emp-tabs-w]");if(!n){console.error("Tab wrapper not found");return}let e=n.querySelectorAll(".emp__tab--btn"),t=n.querySelectorAll("[data-tab-trigger]"),i=n.querySelectorAll("[data-tab-target]"),r=n.querySelectorAll(".epm__sub-btn--w");ht.create({trigger:n,start:"top center",end:"bottom 90%",onEnter:()=>{window.app.transitionBarSceneIn()},once:!0}),t.forEach(a=>{a.addEventListener("click",()=>{let l=a.getAttribute("data-tab-trigger");i.forEach(c=>{c.getAttribute("data-tab-target")===l&&(c.click(),setTimeout(Vb,500),setTimeout(_S,1e3))})})}),e.forEach(a=>{a.addEventListener("click",()=>{a.classList.add("is--active"),e.forEach(c=>{c!==a&&c.classList.remove("is--active")});let l=a.parentElement;l&&l.classList.add("is--active"),e.forEach(c=>{let u=c.parentElement;u&&u!==l&&u.classList.remove("is--active")})})}),r.forEach(a=>{a.addEventListener("click",()=>{a.classList.add("is--active"),r.forEach(l=>{l!==a&&l.classList.remove("is--active")})})});function s(){let a=Array.from(document.querySelectorAll(".emp__tab--w")),l=[.2,.3,.5];a.forEach(h=>{h.classList.contains("w--tab-active")||h.querySelectorAll(".emp__sub-img--w, .emp__side-anim--w, .emp__para--w").forEach(p=>{let f=Math.random()<.5?"x":"y",v=Math.random()<.5?"-4rem":"4rem";qe.set(p,{autoAlpha:0,[f]:v})})});let c=h=>{for(let d of h)d.type==="attributes"&&d.attributeName==="class"&&a.forEach(p=>{let f=p.classList.contains("w--tab-active"),v=p.querySelectorAll(".emp__sub-img--w, .emp__side-anim--w, .emp__para--w");if(f){let g=Math.floor(Math.random()*3)+2;v.forEach(m=>{let x=l[Math.floor(Math.random()*l.length)];qe.to(m,{delay:x,autoAlpha:1,duration:.1,repeat:g,ease:"none",onComplete:()=>{m.style.removeProperty("transform")}})})}else{let g=Math.random()<.5?"x":"y",m=Math.random()<.5?"-4rem":"4rem";qe.set(v,{autoAlpha:0,[g]:m})}})},u=new MutationObserver(c);a.forEach(h=>u.observe(h,{attributes:!0}))}function o(){let a=document.querySelector("[data-bar-gl='hide']"),l=document.querySelector("[data-bar-gl='show']");!a||!l||(a.addEventListener("click",()=>{window.app.transitionBarSceneOut()}),l.addEventListener("click",()=>{window.app.transitionBarSceneIn()}))}s(),o()}function Y3(){function n(){document.querySelectorAll("[data-ip-section]").forEach(a=>{let l=a.querySelector("[data-ip-track]");if(l){let c=l.offsetWidth;a.style.height=`${c}px`}})}n(),window.addEventListener("resize",n);let e=qe.timeline({scrollTrigger:{trigger:"[data-ip-section]",start:"top top",end:"98% bottom",scrub:1}}).to("[data-ip-track]",{xPercent:-100,ease:"none"}),t=.1,i=[.5,.8,1],r=document.querySelectorAll("[data-gp-parent] .ip__logo--item");qe.set(r,{autoAlpha:0,y:"4rem"}),ht.create({trigger:"[data-gp-parent]",containerAnimation:e,start:"left 85%",onEnter:()=>{r.forEach(a=>{let l=a.querySelector(".ip__logo--ol"),c=Math.floor(Math.random()*3)+2,u=i[Math.floor(Math.random()*i.length)];qe.to(a,{delay:u,autoAlpha:1,duration:t,repeat:c,ease:"none",onComplete:()=>{a.style.removeProperty("transform")}}),qe.to(l,{delay:u+.1,autoAlpha:0,duration:t,repeat:c,ease:"none",onComplete:()=>{a.style.removeProperty("transform")}})})}});let o=document.querySelector("[data-gp-flash]").querySelectorAll(".word");qe.set(o,{autoAlpha:0}),ht.create({trigger:"[data-gp-flash]",containerAnimation:e,start:"left 85%",once:!0,onEnter:()=>{o.forEach(a=>{let l=Math.random()<.5?"x":"y",c=Math.random()<.5?"-4rem":"4rem",u=Math.floor(Math.random()*3)+2;qe.set(a,{autoAlpha:0,[l]:c}),ht.create({trigger:a,start:"top 80%",onEnter:()=>{qe.to(a,{autoAlpha:1,duration:.1,repeat:u,ease:"none",onComplete:()=>{a.style.removeProperty("transform")}})}})})}})}function wS(){window.isTabletOrBelow||Y3(),j3(),X3(),Zb(),vS()}qe.registerPlugin(Ia);function bS(){let n=document.querySelector("[data-cursor-wrap]"),e=document.querySelector('[data-curs="trans"]'),t=document.querySelectorAll('[data-curs="rings"]'),i=document.querySelector('[data-curs="outer"]'),r=document.querySelector('[data-curs="inner"]'),s=document.querySelector('[data-curs="text"]'),o=document.querySelector('[data-curs="scale"]'),a=document.querySelector('[data-curs="text-wrap"]'),l=!1,c={x:0,y:0,previousX:0,previousY:0},u=0,h=0;function d(){qe.set(n,{autoAlpha:0})}function p(y){let _=e.offsetWidth/2,w=e.offsetHeight/2;qe.to(e,{x:y.clientX-_,y:y.clientY-w,duration:.2,ease:"power3",overwrite:"auto"}),c.x=y.clientX,c.y=y.clientY}function f(){document.addEventListener("mousemove",y=>{p(y)}),document.addEventListener("mouseover",()=>{qe.to(n,{autoAlpha:1,duration:.3})}),document.addEventListener("mouseleave",()=>{qe.to(n,{autoAlpha:0,duration:.3})})}function v(){let _=c.x-c.previousX,w=c.y-c.previousY,b=Math.sqrt(_*_+w*w),T=1+(b>1?b*.01:0);u+=(T-u)*.1;let A=Math.atan2(w,_)*(180/Math.PI);h+=(A-h)*.1,o.style.transform=`scale(${u}) rotate(${h}deg)`,c.previousX=c.x,c.previousY=c.y,requestAnimationFrame(v)}function g(){qe.to(r.querySelector("path"),{strokeDashoffset:30,duration:3,repeat:-1,yoyo:!0}),qe.to(r,{rotation:180,duration:6,repeat:-1,yoyo:!0,transformOrigin:"50% 50%"}),qe.to(i.querySelector("path"),{strokeDashoffset:70,duration:3,repeat:-1,yoyo:!0}),qe.to(i,{rotation:-180,duration:10,repeat:-1,yoyo:!0,transformOrigin:"50% 50%"})}function m(){let y=document.querySelectorAll("[data-curs-hover]"),_=!1,w=.4;y.forEach(b=>{b.addEventListener("mouseenter",()=>{_=!0;let T=b.getAttribute("data-curs-hover");qe.to(s,{duration:1,scrambleText:{text:T,chars:"\u2591\u2592\u2593\u2580\u2584",revealDelay:.01,delimiter:"",speed:1}}),qe.to(t,{scale:1.5,duration:.2}),qe.to(r.querySelector("path"),{strokeWidth:2,duration:.5}),qe.to(i.querySelector("path"),{strokeWidth:2,duration:.5}),qe.killTweensOf([r.querySelector("path"),i.querySelector("path"),r,i]),qe.to(r.querySelector("path"),{strokeDashoffset:0,duration:w}),qe.to(i.querySelector("path"),{strokeDashoffset:0,duration:w}),qe.to(i,{rotation:0,duration:w,transformOrigin:"50% 50%"}),qe.to(r,{rotation:0,duration:w,transformOrigin:"50% 50%"})}),b.addEventListener("mouseleave",()=>{_=!1,qe.to(s,{duration:1,scrambleText:{text:"+",chars:"\u2591\u2592\u2593\u2580\u2584",revealDelay:.01,delimiter:"",speed:1}}),qe.to(t,{scale:1,duration:.2}),qe.to(i,{strokeWidth:4,duration:.5}),qe.to(r,{strokeWidth:4,duration:.5}),g()})})}function x(){let y=.4;document.addEventListener("mousedown",()=>{l||(qe.killTweensOf([r.querySelector("path"),i.querySelector("path"),r,i]),qe.to(r.querySelector("path"),{strokeDashoffset:0,duration:y}),qe.to(i.querySelector("path"),{strokeDashoffset:0,duration:y}),qe.to(i,{rotation:0,duration:y,transformOrigin:"50% 50%"}),qe.to(r,{rotation:0,duration:y,transformOrigin:"50% 50%"}),qe.to(t,{scale:.6,duration:.5}),qe.to(r.querySelector("path"),{strokeWidth:6,duration:y}),qe.to(i.querySelector("path"),{strokeWidth:6,duration:y}))}),document.addEventListener("mouseup",()=>{l||(qe.to(t,{scale:1,duration:.5}),qe.to(r.querySelector("path"),{strokeWidth:4,duration:y}),qe.to(i.querySelector("path"),{strokeWidth:4,duration:y})),g()}),document.querySelectorAll('a, button, [role="button"]').forEach(w=>{w.addEventListener("mouseenter",()=>{l=!0,qe.killTweensOf([r.querySelector("path"),i.querySelector("path"),r,i]),qe.to(r.querySelector("path"),{strokeDashoffset:0,duration:y}),qe.to(i.querySelector("path"),{strokeDashoffset:0,duration:y}),qe.to(i,{rotation:0,duration:y,transformOrigin:"50% 50%"}),qe.to(r,{rotation:0,duration:y,transformOrigin:"50% 50%"}),qe.to(t,{scale:.6,duration:.5}),qe.to(r.querySelector("path"),{strokeWidth:6,duration:.5}),qe.to(i.querySelector("path"),{strokeWidth:6,duration:.5})}),w.addEventListener("mouseleave",()=>{l=!1,qe.to(t,{scale:1,duration:.5}),qe.to(r.querySelector("path"),{strokeWidth:4,duration:.5}),qe.to(i.querySelector("path"),{strokeWidth:4,duration:.5}),g()})})}d(),f(),g(),m(),x(),v()}qe.registerPlugin(ht);function $3(){let n=document.querySelector("[data-footer]"),e=n.querySelectorAll(".footer__large--svg"),t=n.querySelectorAll(".footer__mask--w");qe.set(e,{y:"100%",rotateX:-100,rotateY:-100}),ht.create({trigger:n,start:"top center",onEnter:()=>qe.to(e,{y:"0%",rotateX:0,rotateY:0,stagger:.1,duration:1.5,ease:"power3.out",onComplete:()=>{n.addEventListener("mousemove",s),n.addEventListener("mouseleave",o)}}),onLeaveBack:()=>qe.to(e,{y:"100%",rotateX:-100,rotateY:-100,stagger:.1,duration:1.5,ease:"power3.out"}),onEnterBack:()=>qe.to(e,{y:"0%",rotateX:0,rotateY:0,stagger:.1,duration:1.5,ease:"power3.out"})});function i(){qe.to(t,{x:(a,l)=>{let c=Math.floor(Math.abs(a-t.length/2));return`${1*(a<t.length/2?-1:1)}rem`},stagger:{each:.05,from:"edges"},ease:"power3.out"})}function r(){qe.to(t,{x:0,stagger:.1,ease:"power3.in",overwrite:!0})}function s(a){let l=n.getBoundingClientRect(),c=(a.clientX-l.left)/l.width,u=(a.clientY-l.top)/l.height,h=5,d=h*(c-.5)*2,p=h*(u-.5)*2,f=u*20-10,v=c*20-10,g=.9+.1*(1-Math.max(Math.abs(c-.5),Math.abs(u-.5))*2);qe.to(e,{x:`${d}rem`,y:`${p}rem`,rotateX:f,rotateY:v,scale:g,stagger:.1,duration:.5,ease:"power1.out"})}function o(){qe.to(e,{x:0,y:0,rotateX:0,rotateY:0,scale:1,stagger:.01,duration:.5,ease:"power1.in",overwrite:!0})}}function SS(){$3()}window.prm=window.matchMedia("(prefers-reduced-motion: reduce)").matches;var M0=window.matchMedia("(max-width: 991px)");window.isTabletOrBelow=M0.matches;M0.addEventListener("change",n=>{window.isTabletOrBelow=n.matches});var K3=window.matchMedia("(max-width: 479px)");window.isMobile=M0.matches;K3.addEventListener("change",n=>{window.isMobile=n.matches});async function Z3(){let n=document.querySelector("[data-page]").dataset.page,e=document.querySelector('[data-start="hidden"]');await document.fonts.ready,s0(),Nb(),n==="home"&&wS(),qe.to(e,{autoAlpha:1,duration:.3})}function ES(){Wb(),Z3(),Gb(),bS(),window.isTabletOrBelow||(window.addEventListener("resize",Bb),SS())}function TS(){window.appStart=function(n){new n(document.querySelector("canvas.webgl"),[{name:"svg7",type:"svg",path:"/assets.itsoffbrand.io/breeder2024/svg/centered-scaled-svg.svg"},{name:"logoSimple",type:"svg",path:"/assets.itsoffbrand.io/breeder2024/svg/newLogoSimple.svg"},{name:"font",type:"font",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/fonts/Archivo_Expanded-Bold.ttf"},{name:"token",type:"gltfModel",path:"/assets.itsoffbrand.io/breeder2024/models/newToken.glb"},{name:"barDepthMap",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/barSceneDarkDepth2.webp"},{name:"barTexture",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/barSceneDarkTexture.webp"},{name:"spaceTexture",type:"texture",path:"/assets.itsoffbrand.io/breeder2024/textures/spaceNew/spaceScene.webp"},{name:"spaceDepthMap",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f515a576ad61485c66e5d2_spaceSceneDepth.webp"},{name:"spaceSceneAlpha",type:"texture",path:"/assets.itsoffbrand.io/breeder2024/textures/spaceNew/spaceSceneAlpha.webp"},{name:"leftLiftDoor",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f297de9ca3658c4a5f2d90_sov-elev-left-no-fill-v3.webp"},{name:"rightLiftDoor",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f297de0b2b56ea1eadc071_sov-elev-right-no-fill-v3.webp"},{name:"text",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f5157b07f0eef01a1365e9_led-marquee-fix.webp"},{name:"backdrop1",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f3c03f54d2fadf5eada06a_sovrun-hero-1.webp"},{name:"backdrop2",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f3c03f7e9c6c041048de55_sovrun-hero-2.webp"},{name:"backdrop3",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f3c03f6b31e9f8d238e9eb_sovrun-hero-3.webp"},{name:"backdrop4",type:"texture",path:"/cdn.prod.website-files.com/6617bb5f148294d058310076/66f3c03f17c35eb32024fd1d_sovrun-hero-4.webp"},{name:"backdrop1Depth",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/backdrop1Depth.webp"},{name:"backdrop2Depth",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/backdrop2Depth.webp"},{name:"backdrop3Depth",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/backdrop3Depth.webp"},{name:"backdrop4Depth",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/backdrop4Depth.webp"},{name:"shapeMaskOne",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/squareMaskOneShape.webp"},{name:"shapeMaskTwo",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/squareMaskTwoShape.webp"},{name:"squareMaskOne",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/squareMaskOneSquare.webp"},{name:"squareMaskTwo",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/squareMaskTwoSquare.webp"},{name:"barSceneAlpha",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/barSceneAlpha.webp"},{name:"barA",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/breederBarAlpha.webp"},{name:"spaceA",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/breederLiftAlpha.webp"},{name:"backView",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/view/back.webp"},{name:"midView",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/view/mid.webp"},{name:"frontView",type:"texture",path:"https://breederdao-site-prod.s3.ap-southeast-1.amazonaws.com/textures/view/front.webp"},{name:"envMap",type:"cubeTexture",path:["/assets.itsoffbrand.io/breeder2024/textures/environmentMap/px.webp","/assets.itsoffbrand.io/breeder2024/textures/environmentMap/nx.webp","/assets.itsoffbrand.io/breeder2024/textures/environmentMap/py.webp","/assets.itsoffbrand.io/breeder2024/textures/environmentMap/ny.webp","/assets.itsoffbrand.io/breeder2024/textures/environmentMap/pz.webp","/assets.itsoffbrand.io/breeder2024/textures/environmentMap/nz.webp"]}]).resources.on("ready",()=>{let t=document.getElementById("app");t.style.cssText="display: inherit",t.style.margin="0",t.style.padding="0"})},window.SScroll.start()}var J3=Object.defineProperty,Q3=(n,e,t)=>e in n?J3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,eR=(n,e,t)=>(Q3(n,typeof e!="symbol"?e+"":e,t),t);(function(){let n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(let i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(let r of i)if(r.type==="childList")for(let s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function e(i){let r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(i){if(i.ep)return;i.ep=!0;let r=e(i);fetch(i.href,r)}})();var T1="160",Kl={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Zl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},tR=0,MS=1,iR=2,wM=1,rR=2,Zs=3,Di=0,Br=1,Kr=2,Wo=0,Cc=1,AS=2,CS=3,DS=4,nR=5,Ka=100,sR=101,oR=102,PS=103,RS=104,aR=200,lR=201,cR=202,uR=203,kv=204,Uv=205,hR=206,dR=207,pR=208,fR=209,mR=210,gR=211,vR=212,yR=213,xR=214,_R=0,wR=1,bR=2,Ef=3,SR=4,ER=5,TR=6,MR=7,M1=0,AR=1,CR=2,qo=0,DR=1,PR=2,RR=3,LR=4,OR=5,IR=6,LS="attached",FR="detached",bM=300,zc=301,Bc=302,zv=303,Bv=304,gm=306,Nc=1e3,zn=1001,Tf=1002,ji=1003,Nv=1004,uf=1005,fr=1006,SM=1007,ml=1008,jo=1009,kR=1010,UR=1011,A1=1012,EM=1013,Uo=1014,ro=1015,Lh=1016,TM=1017,MM=1018,il=1020,zR=1021,Bn=1023,BR=1024,NR=1025,rl=1026,Gc=1027,GR=1028,AM=1029,VR=1030,CM=1031,DM=1033,A0=33776,C0=33777,D0=33778,P0=33779,OS=35840,IS=35841,FS=35842,kS=35843,PM=36196,US=37492,zS=37496,BS=37808,NS=37809,GS=37810,VS=37811,HS=37812,WS=37813,qS=37814,jS=37815,XS=37816,YS=37817,$S=37818,KS=37819,ZS=37820,JS=37821,R0=36492,QS=36494,eE=36495,HR=36283,tE=36284,iE=36285,rE=36286,Oh=2300,Vc=2301,L0=2302,nE=2400,sE=2401,oE=2402,WR=2500,qR=0,RM=1,Gv=2,LM=3e3,nl=3001,jR=3200,OM=3201,C1=0,XR=1,Nn="",Ht="srgb",Ui="srgb-linear",D1="display-p3",vm="display-p3-linear",Mf="linear",Qt="srgb",Af="rec709",Cf="p3",ja=7680,IM=7681,P1=514,Vv=519,YR=512,$R=513,KR=514,FM=515,ZR=516,JR=517,QR=518,eL=519,Hv=35044,aE="300 es",Wv=1035,no=2e3,Df=2001,lo=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let i=this._listeners[e];if(i!==void 0){let r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let i=t.slice(0);for(let r=0,s=i.length;r<s;r++)i[r].call(this,e);e.target=null}}},hr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],lE=1234567,Dc=Math.PI/180,Hc=180/Math.PI;function Wn(){let n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(hr[n&255]+hr[n>>8&255]+hr[n>>16&255]+hr[n>>24&255]+"-"+hr[e&255]+hr[e>>8&255]+"-"+hr[e>>16&15|64]+hr[e>>24&255]+"-"+hr[t&63|128]+hr[t>>8&255]+"-"+hr[t>>16&255]+hr[t>>24&255]+hr[i&255]+hr[i>>8&255]+hr[i>>16&255]+hr[i>>24&255]).toLowerCase()}function Fi(n,e,t){return Math.max(e,Math.min(t,n))}function R1(n,e){return(n%e+e)%e}function tL(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function iL(n,e,t){return n!==e?(t-n)/(e-n):0}function dh(n,e,t){return(1-t)*n+t*e}function rL(n,e,t,i){return dh(n,e,1-Math.exp(-t*i))}function nL(n,e=1){return e-Math.abs(R1(n,e*2)-e)}function sL(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function oL(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function aL(n,e){return n+Math.floor(Math.random()*(e-n+1))}function lL(n,e){return n+Math.random()*(e-n)}function cL(n){return n*(.5-Math.random())}function uL(n){n!==void 0&&(lE=n);let e=lE+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function hL(n){return n*Dc}function dL(n){return n*Hc}function qv(n){return(n&n-1)===0&&n!==0}function pL(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Pf(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function fL(n,e,t,i,r){let s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),h=s((e-i)/2),d=o((e-i)/2),p=s((i-e)/2),f=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*h,l*d,a*c);break;case"YZY":n.set(l*d,a*u,l*h,a*c);break;case"ZXZ":n.set(l*h,l*d,a*u,a*c);break;case"XZX":n.set(a*u,l*f,l*p,a*c);break;case"YXY":n.set(l*p,a*u,l*f,a*c);break;case"ZYZ":n.set(l*f,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Ts(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Vt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var kM={DEG2RAD:Dc,RAD2DEG:Hc,generateUUID:Wn,clamp:Fi,euclideanModulo:R1,mapLinear:tL,inverseLerp:iL,lerp:dh,damp:rL,pingpong:nL,smoothstep:sL,smootherstep:oL,randInt:aL,randFloat:lL,randFloatSpread:cL,seededRandom:uL,degToRad:hL,radToDeg:dL,isPowerOfTwo:qv,ceilPowerOfTwo:pL,floorPowerOfTwo:Pf,setQuaternionFromProperEuler:fL,normalize:Vt,denormalize:Ts},Me=class n{constructor(e=0,t=0){n.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Fi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},gt=class n{constructor(e,t,i,r,s,o,a,l,c){n.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){let u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],h=i[7],d=i[2],p=i[5],f=i[8],v=r[0],g=r[3],m=r[6],x=r[1],y=r[4],_=r[7],w=r[2],b=r[5],T=r[8];return s[0]=o*v+a*x+l*w,s[3]=o*g+a*y+l*b,s[6]=o*m+a*_+l*T,s[1]=c*v+u*x+h*w,s[4]=c*g+u*y+h*b,s[7]=c*m+u*_+h*T,s[2]=d*v+p*x+f*w,s[5]=d*g+p*y+f*b,s[8]=d*m+p*_+f*T,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,p=c*s-o*l,f=t*h+i*d+r*p;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let v=1/f;return e[0]=h*v,e[1]=(r*c-u*i)*v,e[2]=(a*i-r*o)*v,e[3]=d*v,e[4]=(u*t-r*l)*v,e[5]=(r*s-a*t)*v,e[6]=p*v,e[7]=(i*l-c*t)*v,e[8]=(o*t-i*s)*v,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){let l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(O0.makeScale(e,t)),this}rotate(e){return this.premultiply(O0.makeRotation(-e)),this}translate(e,t){return this.premultiply(O0.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},O0=new gt;function UM(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Ih(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function mL(){let n=Ih("canvas");return n.style.display="block",n}var cE={};function ph(n){n in cE||(cE[n]=!0,console.warn(n))}var uE=new gt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),hE=new gt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),hp={[Ui]:{transfer:Mf,primaries:Af,toReference:n=>n,fromReference:n=>n},[Ht]:{transfer:Qt,primaries:Af,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[vm]:{transfer:Mf,primaries:Cf,toReference:n=>n.applyMatrix3(hE),fromReference:n=>n.applyMatrix3(uE)},[D1]:{transfer:Qt,primaries:Cf,toReference:n=>n.convertSRGBToLinear().applyMatrix3(hE),fromReference:n=>n.applyMatrix3(uE).convertLinearToSRGB()}},gL=new Set([Ui,vm]),Ut={enabled:!0,_workingColorSpace:Ui,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!gL.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;let i=hp[e].toReference,r=hp[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return hp[n].primaries},getTransfer:function(n){return n===Nn?Mf:hp[n].transfer}};function Pc(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function I0(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}var Jl,Rf=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Jl===void 0&&(Jl=Ih("canvas")),Jl.width=e.width,Jl.height=e.height;let i=Jl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Jl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Ih("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Pc(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Pc(t[i]/255)*255):t[i]=Pc(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},vL=0,Lf=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:vL++}),this.uuid=Wn(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(F0(r[o].image)):s.push(F0(r[o]))}else s=F0(r);i.url=s}return t||(e.images[this.uuid]=i),i}};function F0(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Rf.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var yL=0,xr=class n extends lo{constructor(e=n.DEFAULT_IMAGE,t=n.DEFAULT_MAPPING,i=zn,r=zn,s=fr,o=ml,a=Bn,l=jo,c=n.DEFAULT_ANISOTROPY,u=Nn){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yL++}),this.uuid=Wn(),this.name="",this.source=new Lf(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Me(0,0),this.repeat=new Me(1,1),this.center=new Me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new gt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(ph("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===nl?Ht:Nn),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==bM)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Nc:e.x=e.x-Math.floor(e.x);break;case zn:e.x=e.x<0?0:1;break;case Tf:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Nc:e.y=e.y-Math.floor(e.y);break;case zn:e.y=e.y<0?0:1;break;case Tf:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return ph("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Ht?nl:LM}set encoding(e){ph("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===nl?Ht:Nn}};xr.DEFAULT_IMAGE=null;xr.DEFAULT_MAPPING=bM;xr.DEFAULT_ANISOTROPY=1;var zt=class n{constructor(e=0,t=0,i=0,r=1){n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s,o=e.elements,a=o[0],l=o[4],c=o[8],u=o[1],h=o[5],d=o[9],p=o[2],f=o[6],v=o[10];if(Math.abs(l-u)<.01&&Math.abs(c-p)<.01&&Math.abs(d-f)<.01){if(Math.abs(l+u)<.1&&Math.abs(c+p)<.1&&Math.abs(d+f)<.1&&Math.abs(a+h+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let m=(a+1)/2,x=(h+1)/2,y=(v+1)/2,_=(l+u)/4,w=(c+p)/4,b=(d+f)/4;return m>x&&m>y?m<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(m),r=_/i,s=w/i):x>y?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=_/r,s=b/r):y<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(y),i=w/s,r=b/s),this.set(i,r,s,t),this}let g=Math.sqrt((f-d)*(f-d)+(c-p)*(c-p)+(u-l)*(u-l));return Math.abs(g)<.001&&(g=1),this.x=(f-d)/g,this.y=(c-p)/g,this.z=(u-l)/g,this.w=Math.acos((a+h+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},jv=class extends lo{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new zt(0,0,e,t),this.scissorTest=!1,this.viewport=new zt(0,0,e,t);let r={width:e,height:t,depth:1};i.encoding!==void 0&&(ph("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===nl?Ht:Nn),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:fr,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new xr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Lf(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},co=class extends jv{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}},Of=class extends xr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ji,this.minFilter=ji,this.wrapR=zn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Xv=class extends xr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ji,this.minFilter=ji,this.wrapR=zn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},jn=class{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],h=i[r+3],d=s[o+0],p=s[o+1],f=s[o+2],v=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h;return}if(a===1){e[t+0]=d,e[t+1]=p,e[t+2]=f,e[t+3]=v;return}if(h!==v||l!==d||c!==p||u!==f){let g=1-a,m=l*d+c*p+u*f+h*v,x=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){let w=Math.sqrt(y),b=Math.atan2(w,m*x);g=Math.sin(g*b)/w,a=Math.sin(a*b)/w}let _=a*x;if(l=l*g+d*_,c=c*g+p*_,u=u*g+f*_,h=h*g+v*_,g===1-a){let w=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=w,c*=w,u*=w,h*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){let a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],h=s[o],d=s[o+1],p=s[o+2],f=s[o+3];return e[t]=a*f+u*h+l*p-c*d,e[t+1]=l*f+u*d+c*h-a*p,e[t+2]=c*f+u*p+a*d-l*h,e[t+3]=u*f-a*h-l*d-c*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),h=a(s/2),d=l(i/2),p=l(r/2),f=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h-d*p*f;break;case"YXZ":this._x=d*u*h+c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h+d*p*f;break;case"ZXY":this._x=d*u*h-c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h-d*p*f;break;case"ZYX":this._x=d*u*h-c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h+d*p*f;break;case"YZX":this._x=d*u*h+c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h-d*p*f;break;case"XZY":this._x=d*u*h-c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h+d*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=i+a+h;if(d>0){let p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(u-l)*p,this._y=(s-c)*p,this._z=(o-r)*p}else if(i>a&&i>h){let p=2*Math.sqrt(1+i-a-h);this._w=(u-l)/p,this._x=.25*p,this._y=(r+o)/p,this._z=(s+c)/p}else if(a>h){let p=2*Math.sqrt(1+a-i-h);this._w=(s-c)/p,this._x=(r+o)/p,this._y=.25*p,this._z=(l+u)/p}else{let p=2*Math.sqrt(1+h-i-a);this._w=(o-r)/p,this._x=(s+c)/p,this._y=(l+u)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Fi(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,r=this._y,s=this._z,o=this._w,a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;let l=1-a*a;if(l<=Number.EPSILON){let p=1-t;return this._w=p*o+t*this._w,this._x=p*i+t*this._x,this._y=p*r+t*this._y,this._z=p*s+t*this._z,this.normalize(),this}let c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},oe=class n{constructor(e=0,t=0,i=0){n.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(dE.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(dE.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){let t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*i),u=2*(a*t-s*r),h=2*(s*i-o*t);return this.x=t+l*c+o*h-a*u,this.y=i+l*u+a*c-s*h,this.z=r+l*h+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return k0.copy(this).projectOnVector(e),this.sub(k0)}reflect(e){return this.sub(k0.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Fi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},k0=new oe,dE=new jn,tn=class{constructor(e=new oe(1/0,1/0,1/0),t=new oe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(ns.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(ns.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=ns.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,ns):ns.fromBufferAttribute(s,o),ns.applyMatrix4(e.matrixWorld),this.expandByPoint(ns);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),dp.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),dp.copy(i.boundingBox)),dp.applyMatrix4(e.matrixWorld),this.union(dp)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ns),ns.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Yu),pp.subVectors(this.max,Yu),Ql.subVectors(e.a,Yu),ec.subVectors(e.b,Yu),tc.subVectors(e.c,Yu),Do.subVectors(ec,Ql),Po.subVectors(tc,ec),za.subVectors(Ql,tc);let t=[0,-Do.z,Do.y,0,-Po.z,Po.y,0,-za.z,za.y,Do.z,0,-Do.x,Po.z,0,-Po.x,za.z,0,-za.x,-Do.y,Do.x,0,-Po.y,Po.x,0,-za.y,za.x,0];return!U0(t,Ql,ec,tc,pp)||(t=[1,0,0,0,1,0,0,0,1],!U0(t,Ql,ec,tc,pp))?!1:(fp.crossVectors(Do,Po),t=[fp.x,fp.y,fp.z],U0(t,Ql,ec,tc,pp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ns).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ns).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(qs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),qs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),qs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),qs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),qs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),qs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),qs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),qs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(qs),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},qs=[new oe,new oe,new oe,new oe,new oe,new oe,new oe,new oe],ns=new oe,dp=new tn,Ql=new oe,ec=new oe,tc=new oe,Do=new oe,Po=new oe,za=new oe,Yu=new oe,pp=new oe,fp=new oe,Ba=new oe;function U0(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Ba.fromArray(n,s);let a=r.x*Math.abs(Ba.x)+r.y*Math.abs(Ba.y)+r.z*Math.abs(Ba.z),l=e.dot(Ba),c=t.dot(Ba),u=i.dot(Ba);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}var xL=new tn,$u=new oe,z0=new oe,bn=class{constructor(e=new oe,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):xL.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$u.subVectors(e,this.center);let t=$u.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector($u,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(z0.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($u.copy(e.center).add(z0)),this.expandByPoint($u.copy(e.center).sub(z0))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},js=new oe,B0=new oe,mp=new oe,Ro=new oe,N0=new oe,gp=new oe,G0=new oe,Jo=class{constructor(e=new oe,t=new oe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,js)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=js.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(js.copy(this.origin).addScaledVector(this.direction,t),js.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){B0.copy(e).add(t).multiplyScalar(.5),mp.copy(t).sub(e).normalize(),Ro.copy(this.origin).sub(B0);let s=e.distanceTo(t)*.5,o=-this.direction.dot(mp),a=Ro.dot(this.direction),l=-Ro.dot(mp),c=Ro.lengthSq(),u=Math.abs(1-o*o),h,d,p,f;if(u>0)if(h=o*l-a,d=o*a-l,f=s*u,h>=0)if(d>=-f)if(d<=f){let v=1/u;h*=v,d*=v,p=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),p=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),p=-h*h+d*(d+2*l)+c;else d<=-f?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),p=-h*h+d*(d+2*l)+c):d<=f?(h=0,d=Math.min(Math.max(-s,-l),s),p=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),p=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),p=-h*h+d*(d+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(B0).addScaledVector(mp,d),p}intersectSphere(e,t){js.subVectors(e.center,this.origin);let i=js.dot(this.direction),r=js.dot(js)-i*i,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l,c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(i=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(i=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,js)!==null}intersectTriangle(e,t,i,r,s){N0.subVectors(t,e),gp.subVectors(i,e),G0.crossVectors(N0,gp);let o=this.direction.dot(G0),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ro.subVectors(this.origin,e);let l=a*this.direction.dot(gp.crossVectors(Ro,gp));if(l<0)return null;let c=a*this.direction.dot(N0.cross(Ro));if(c<0||l+c>o)return null;let u=-a*Ro.dot(G0);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Et=class n{constructor(e,t,i,r,s,o,a,l,c,u,h,d,p,f,v,g){n.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c,u,h,d,p,f,v,g)}set(e,t,i,r,s,o,a,l,c,u,h,d,p,f,v,g){let m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=u,m[10]=h,m[14]=d,m[3]=p,m[7]=f,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new n().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,r=1/ic.setFromMatrixColumn(e,0).length(),s=1/ic.setFromMatrixColumn(e,1).length(),o=1/ic.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){let d=o*u,p=o*h,f=a*u,v=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=p+f*c,t[5]=d-v*c,t[9]=-a*l,t[2]=v-d*c,t[6]=f+p*c,t[10]=o*l}else if(e.order==="YXZ"){let d=l*u,p=l*h,f=c*u,v=c*h;t[0]=d+v*a,t[4]=f*a-p,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=p*a-f,t[6]=v+d*a,t[10]=o*l}else if(e.order==="ZXY"){let d=l*u,p=l*h,f=c*u,v=c*h;t[0]=d-v*a,t[4]=-o*h,t[8]=f+p*a,t[1]=p+f*a,t[5]=o*u,t[9]=v-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){let d=o*u,p=o*h,f=a*u,v=a*h;t[0]=l*u,t[4]=f*c-p,t[8]=d*c+v,t[1]=l*h,t[5]=v*c+d,t[9]=p*c-f,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){let d=o*l,p=o*c,f=a*l,v=a*c;t[0]=l*u,t[4]=v-d*h,t[8]=f*h+p,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=p*h+f,t[10]=d-v*h}else if(e.order==="XZY"){let d=o*l,p=o*c,f=a*l,v=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+v,t[5]=o*u,t[9]=p*h-f,t[2]=f*h-p,t[6]=a*u,t[10]=v*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(_L,e,wL)}lookAt(e,t,i){let r=this.elements;return dn.subVectors(e,t),dn.lengthSq()===0&&(dn.z=1),dn.normalize(),Lo.crossVectors(i,dn),Lo.lengthSq()===0&&(Math.abs(i.z)===1?dn.x+=1e-4:dn.z+=1e-4,dn.normalize(),Lo.crossVectors(i,dn)),Lo.normalize(),vp.crossVectors(dn,Lo),r[0]=Lo.x,r[4]=vp.x,r[8]=dn.x,r[1]=Lo.y,r[5]=vp.y,r[9]=dn.y,r[2]=Lo.z,r[6]=vp.z,r[10]=dn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],h=i[5],d=i[9],p=i[13],f=i[2],v=i[6],g=i[10],m=i[14],x=i[3],y=i[7],_=i[11],w=i[15],b=r[0],T=r[4],A=r[8],S=r[12],E=r[1],R=r[5],D=r[9],z=r[13],L=r[2],G=r[6],J=r[10],X=r[14],N=r[3],U=r[7],O=r[11],F=r[15];return s[0]=o*b+a*E+l*L+c*N,s[4]=o*T+a*R+l*G+c*U,s[8]=o*A+a*D+l*J+c*O,s[12]=o*S+a*z+l*X+c*F,s[1]=u*b+h*E+d*L+p*N,s[5]=u*T+h*R+d*G+p*U,s[9]=u*A+h*D+d*J+p*O,s[13]=u*S+h*z+d*X+p*F,s[2]=f*b+v*E+g*L+m*N,s[6]=f*T+v*R+g*G+m*U,s[10]=f*A+v*D+g*J+m*O,s[14]=f*S+v*z+g*X+m*F,s[3]=x*b+y*E+_*L+w*N,s[7]=x*T+y*R+_*G+w*U,s[11]=x*A+y*D+_*J+w*O,s[15]=x*S+y*z+_*X+w*F,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],p=e[14],f=e[3],v=e[7],g=e[11],m=e[15];return f*(+s*l*h-r*c*h-s*a*d+i*c*d+r*a*p-i*l*p)+v*(+t*l*p-t*c*d+s*o*d-r*o*p+r*c*u-s*l*u)+g*(+t*c*h-t*a*p-s*o*h+i*o*p+s*a*u-i*c*u)+m*(-r*a*u-t*l*h+t*a*d+r*o*h-i*o*d+i*l*u)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],v=e[13],g=e[14],m=e[15],x=h*g*c-v*d*c+v*l*p-a*g*p-h*l*m+a*d*m,y=f*d*c-u*g*c-f*l*p+o*g*p+u*l*m-o*d*m,_=u*v*c-f*h*c+f*a*p-o*v*p-u*a*m+o*h*m,w=f*h*l-u*v*l-f*a*d+o*v*d+u*a*g-o*h*g,b=t*x+i*y+r*_+s*w;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let T=1/b;return e[0]=x*T,e[1]=(v*d*s-h*g*s-v*r*p+i*g*p+h*r*m-i*d*m)*T,e[2]=(a*g*s-v*l*s+v*r*c-i*g*c-a*r*m+i*l*m)*T,e[3]=(h*l*s-a*d*s-h*r*c+i*d*c+a*r*p-i*l*p)*T,e[4]=y*T,e[5]=(u*g*s-f*d*s+f*r*p-t*g*p-u*r*m+t*d*m)*T,e[6]=(f*l*s-o*g*s-f*r*c+t*g*c+o*r*m-t*l*m)*T,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*p+t*l*p)*T,e[8]=_*T,e[9]=(f*h*s-u*v*s-f*i*p+t*v*p+u*i*m-t*h*m)*T,e[10]=(o*v*s-f*a*s+f*i*c-t*v*c-o*i*m+t*a*m)*T,e[11]=(u*a*s-o*h*s-u*i*c+t*h*c+o*i*p-t*a*p)*T,e[12]=w*T,e[13]=(u*v*r-f*h*r+f*i*d-t*v*d-u*i*g+t*h*g)*T,e[14]=(f*a*r-o*v*r-f*i*l+t*v*l+o*i*g-t*a*g)*T,e[15]=(o*h*r-u*a*r+u*i*l-t*h*l-o*i*d+t*a*d)*T,this}scale(e){let t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){let r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,p=s*u,f=s*h,v=o*u,g=o*h,m=a*h,x=l*c,y=l*u,_=l*h,w=i.x,b=i.y,T=i.z;return r[0]=(1-(v+m))*w,r[1]=(p+_)*w,r[2]=(f-y)*w,r[3]=0,r[4]=(p-_)*b,r[5]=(1-(d+m))*b,r[6]=(g+x)*b,r[7]=0,r[8]=(f+y)*T,r[9]=(g-x)*T,r[10]=(1-(d+v))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){let r=this.elements,s=ic.set(r[0],r[1],r[2]).length(),o=ic.set(r[4],r[5],r[6]).length(),a=ic.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ss.copy(this);let l=1/s,c=1/o,u=1/a;return ss.elements[0]*=l,ss.elements[1]*=l,ss.elements[2]*=l,ss.elements[4]*=c,ss.elements[5]*=c,ss.elements[6]*=c,ss.elements[8]*=u,ss.elements[9]*=u,ss.elements[10]*=u,t.setFromRotationMatrix(ss),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=no){let l=this.elements,c=2*s/(t-e),u=2*s/(i-r),h=(t+e)/(t-e),d=(i+r)/(i-r),p,f;if(a===no)p=-(o+s)/(o-s),f=-2*o*s/(o-s);else if(a===Df)p=-o/(o-s),f=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=no){let l=this.elements,c=1/(t-e),u=1/(i-r),h=1/(o-s),d=(t+e)*c,p=(i+r)*u,f,v;if(a===no)f=(o+s)*h,v=-2*h;else if(a===Df)f=s*h,v=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=v,l[14]=-f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},ic=new oe,ss=new Et,_L=new oe(0,0,0),wL=new oe(1,1,1),Lo=new oe,vp=new oe,dn=new oe,pE=new Et,fE=new jn,If=class n{constructor(e=0,t=0,i=0,r=n.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){let r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],p=r[10];switch(t){case"XYZ":this._y=Math.asin(Fi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Fi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Fi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Fi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Fi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-Fi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return pE.makeRotationFromQuaternion(e),this.setFromRotationMatrix(pE,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return fE.setFromEuler(this),this.setFromQuaternion(fE,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};If.DEFAULT_ORDER="XYZ";var Fh=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},bL=0,mE=new oe,rc=new jn,Xs=new Et,yp=new oe,Ku=new oe,SL=new oe,EL=new jn,gE=new oe(1,0,0),vE=new oe(0,1,0),yE=new oe(0,0,1),TL={type:"added"},ML={type:"removed"},bi=class n extends lo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:bL++}),this.uuid=Wn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();let e=new oe,t=new If,i=new jn,r=new oe(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Et},normalMatrix:{value:new gt}}),this.matrix=new Et,this.matrixWorld=new Et,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Fh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return rc.setFromAxisAngle(e,t),this.quaternion.multiply(rc),this}rotateOnWorldAxis(e,t){return rc.setFromAxisAngle(e,t),this.quaternion.premultiply(rc),this}rotateX(e){return this.rotateOnAxis(gE,e)}rotateY(e){return this.rotateOnAxis(vE,e)}rotateZ(e){return this.rotateOnAxis(yE,e)}translateOnAxis(e,t){return mE.copy(e).applyQuaternion(this.quaternion),this.position.add(mE.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(gE,e)}translateY(e){return this.translateOnAxis(vE,e)}translateZ(e){return this.translateOnAxis(yE,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Xs.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?yp.copy(e):yp.set(e,t,i);let r=this.parent;this.updateWorldMatrix(!0,!1),Ku.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Xs.lookAt(Ku,yp,this.up):Xs.lookAt(yp,Ku,this.up),this.quaternion.setFromRotationMatrix(Xs),r&&(Xs.extractRotation(r.matrixWorld),rc.setFromRotationMatrix(Xs),this.quaternion.premultiply(rc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(TL)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ML)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Xs.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Xs.multiply(e.parent.matrixWorld)),e.applyMatrix4(Xs),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){let s=this.children[i].getObjectByProperty(e,t);if(s!==void 0)return s}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);let r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ku,e,SL),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ku,EL,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let i=0,r=t.length;i<r;i++){let s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let r=this.children;for(let s=0,o=r.length;s<o;s++){let a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){let h=l[c];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){let l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){let a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),d=o(e.skeletons),p=o(e.animations),f=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),p.length>0&&(i.animations=p),f.length>0&&(i.nodes=f)}return i.object=r,i;function o(a){let l=[];for(let c in a){let u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){let r=e.children[i];this.add(r.clone())}return this}};bi.DEFAULT_UP=new oe(0,1,0);bi.DEFAULT_MATRIX_AUTO_UPDATE=!0;bi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var os=new oe,Ys=new oe,V0=new oe,$s=new oe,nc=new oe,sc=new oe,xE=new oe,H0=new oe,W0=new oe,q0=new oe,xp=!1,Qa=class n{constructor(e=new oe,t=new oe,i=new oe){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),os.subVectors(e,t),r.cross(os);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){os.subVectors(r,t),Ys.subVectors(i,t),V0.subVectors(e,t);let o=os.dot(os),a=os.dot(Ys),l=os.dot(V0),c=Ys.dot(Ys),u=Ys.dot(V0),h=o*c-a*a;if(h===0)return s.set(0,0,0),null;let d=1/h,p=(c*l-a*u)*d,f=(o*u-a*l)*d;return s.set(1-p-f,f,p)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,$s)===null?!1:$s.x>=0&&$s.y>=0&&$s.x+$s.y<=1}static getUV(e,t,i,r,s,o,a,l){return xp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),xp=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,$s)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,$s.x),l.addScaledVector(o,$s.y),l.addScaledVector(a,$s.z),l)}static isFrontFacing(e,t,i,r){return os.subVectors(i,t),Ys.subVectors(e,t),os.cross(Ys).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return os.subVectors(this.c,this.b),Ys.subVectors(this.a,this.b),os.cross(Ys).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return n.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return n.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return xp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),xp=!0),n.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return n.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return n.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return n.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,r=this.b,s=this.c,o,a;nc.subVectors(r,i),sc.subVectors(s,i),H0.subVectors(e,i);let l=nc.dot(H0),c=sc.dot(H0);if(l<=0&&c<=0)return t.copy(i);W0.subVectors(e,r);let u=nc.dot(W0),h=sc.dot(W0);if(u>=0&&h<=u)return t.copy(r);let d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(nc,o);q0.subVectors(e,s);let p=nc.dot(q0),f=sc.dot(q0);if(f>=0&&p<=f)return t.copy(s);let v=p*c-l*f;if(v<=0&&c>=0&&f<=0)return a=c/(c-f),t.copy(i).addScaledVector(sc,a);let g=u*f-p*h;if(g<=0&&h-u>=0&&p-f>=0)return xE.subVectors(s,r),a=(h-u)/(h-u+(p-f)),t.copy(r).addScaledVector(xE,a);let m=1/(g+v+d);return o=v*m,a=d*m,t.copy(i).addScaledVector(nc,o).addScaledVector(sc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},zM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Oo={h:0,s:0,l:0},_p={h:0,s:0,l:0};function j0(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}var at=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ht){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ut.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Ut.workingColorSpace){return this.r=e,this.g=t,this.b=i,Ut.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Ut.workingColorSpace){if(e=R1(e,1),t=Fi(t,0,1),i=Fi(i,0,1),t===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=j0(o,s,e+1/3),this.g=j0(o,s,e),this.b=j0(o,s,e-1/3)}return Ut.toWorkingColorSpace(this,r),this}setStyle(e,t=Ht){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ht){let i=zM[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pc(e.r),this.g=Pc(e.g),this.b=Pc(e.b),this}copyLinearToSRGB(e){return this.r=I0(e.r),this.g=I0(e.g),this.b=I0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ht){return Ut.fromWorkingColorSpace(dr.copy(this),e),Math.round(Fi(dr.r*255,0,255))*65536+Math.round(Fi(dr.g*255,0,255))*256+Math.round(Fi(dr.b*255,0,255))}getHexString(e=Ht){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ut.workingColorSpace){Ut.fromWorkingColorSpace(dr.copy(this),t);let i=dr.r,r=dr.g,s=dr.b,o=Math.max(i,r,s),a=Math.min(i,r,s),l,c,u=(a+o)/2;if(a===o)l=0,c=0;else{let h=o-a;switch(c=u<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Ut.workingColorSpace){return Ut.fromWorkingColorSpace(dr.copy(this),t),e.r=dr.r,e.g=dr.g,e.b=dr.b,e}getStyle(e=Ht){Ut.fromWorkingColorSpace(dr.copy(this),e);let t=dr.r,i=dr.g,r=dr.b;return e!==Ht?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(Oo),this.setHSL(Oo.h+e,Oo.s+t,Oo.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Oo),e.getHSL(_p);let i=dh(Oo.h,_p.h,t),r=dh(Oo.s,_p.s,t),s=dh(Oo.l,_p.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},dr=new at;at.NAMES=zM;var AL=0,_n=class extends lo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:AL++}),this.uuid=Wn(),this.name="",this.type="Material",this.blending=Cc,this.side=Di,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=kv,this.blendDst=Uv,this.blendEquation=Ka,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new at(0,0,0),this.blendAlpha=0,this.depthFunc=Ef,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Vv,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ja,this.stencilZFail=ja,this.stencilZPass=ja,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Cc&&(i.blending=this.blending),this.side!==Di&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==kv&&(i.blendSrc=this.blendSrc),this.blendDst!==Uv&&(i.blendDst=this.blendDst),this.blendEquation!==Ka&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ef&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Vv&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ja&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ja&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ja&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){let o=[];for(let a in s){let l=s[a];delete l.metadata,o.push(l)}return o}if(t){let s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},gr=class extends _n{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new at(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=M1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Mi=new oe,wp=new Me,wi=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Hv,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ro,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)wp.fromBufferAttribute(this,t),wp.applyMatrix3(e),this.setXY(t,wp.x,wp.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Mi.fromBufferAttribute(this,t),Mi.applyMatrix3(e),this.setXYZ(t,Mi.x,Mi.y,Mi.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Mi.fromBufferAttribute(this,t),Mi.applyMatrix4(e),this.setXYZ(t,Mi.x,Mi.y,Mi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Mi.fromBufferAttribute(this,t),Mi.applyNormalMatrix(e),this.setXYZ(t,Mi.x,Mi.y,Mi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Mi.fromBufferAttribute(this,t),Mi.transformDirection(e),this.setXYZ(t,Mi.x,Mi.y,Mi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Ts(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Vt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ts(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ts(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ts(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ts(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array),s=Vt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Hv&&(e.usage=this.usage),e}},Ff=class extends wi{constructor(e,t,i){super(new Uint16Array(e),t,i)}},kf=class extends wi{constructor(e,t,i){super(new Uint32Array(e),t,i)}},Xi=class extends wi{constructor(e,t,i){super(new Float32Array(e),t,i)}},CL=0,On=new Et,X0=new bi,oc=new oe,pn=new tn,Zu=new tn,Hi=new oe,ki=class n extends lo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:CL++}),this.uuid=Wn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(UM(e)?kf:Ff)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new gt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return On.makeRotationFromQuaternion(e),this.applyMatrix4(On),this}rotateX(e){return On.makeRotationX(e),this.applyMatrix4(On),this}rotateY(e){return On.makeRotationY(e),this.applyMatrix4(On),this}rotateZ(e){return On.makeRotationZ(e),this.applyMatrix4(On),this}translate(e,t,i){return On.makeTranslation(e,t,i),this.applyMatrix4(On),this}scale(e,t,i){return On.makeScale(e,t,i),this.applyMatrix4(On),this}lookAt(e){return X0.lookAt(e),X0.updateMatrix(),this.applyMatrix4(X0.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(oc).negate(),this.translate(oc.x,oc.y,oc.z),this}setFromPoints(e){let t=[];for(let i=0,r=e.length;i<r;i++){let s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Xi(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new tn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new oe(-1/0,-1/0,-1/0),new oe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){let s=t[i];pn.setFromBufferAttribute(s),this.morphTargetsRelative?(Hi.addVectors(this.boundingBox.min,pn.min),this.boundingBox.expandByPoint(Hi),Hi.addVectors(this.boundingBox.max,pn.max),this.boundingBox.expandByPoint(Hi)):(this.boundingBox.expandByPoint(pn.min),this.boundingBox.expandByPoint(pn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new oe,1/0);return}if(e){let i=this.boundingSphere.center;if(pn.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){let a=t[s];Zu.setFromBufferAttribute(a),this.morphTargetsRelative?(Hi.addVectors(pn.min,Zu.min),pn.expandByPoint(Hi),Hi.addVectors(pn.max,Zu.max),pn.expandByPoint(Hi)):(pn.expandByPoint(Zu.min),pn.expandByPoint(Zu.max))}pn.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Hi.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Hi));if(t)for(let s=0,o=t.length;s<o;s++){let a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Hi.fromBufferAttribute(a,c),l&&(oc.fromBufferAttribute(e,c),Hi.add(oc)),r=Math.max(r,i.distanceToSquared(Hi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new wi(new Float32Array(4*a),4));let l=this.getAttribute("tangent").array,c=[],u=[];for(let E=0;E<a;E++)c[E]=new oe,u[E]=new oe;let h=new oe,d=new oe,p=new oe,f=new Me,v=new Me,g=new Me,m=new oe,x=new oe;function y(E,R,D){h.fromArray(r,E*3),d.fromArray(r,R*3),p.fromArray(r,D*3),f.fromArray(o,E*2),v.fromArray(o,R*2),g.fromArray(o,D*2),d.sub(h),p.sub(h),v.sub(f),g.sub(f);let z=1/(v.x*g.y-g.x*v.y);isFinite(z)&&(m.copy(d).multiplyScalar(g.y).addScaledVector(p,-v.y).multiplyScalar(z),x.copy(p).multiplyScalar(v.x).addScaledVector(d,-g.x).multiplyScalar(z),c[E].add(m),c[R].add(m),c[D].add(m),u[E].add(x),u[R].add(x),u[D].add(x))}let _=this.groups;_.length===0&&(_=[{start:0,count:i.length}]);for(let E=0,R=_.length;E<R;++E){let D=_[E],z=D.start,L=D.count;for(let G=z,J=z+L;G<J;G+=3)y(i[G+0],i[G+1],i[G+2])}let w=new oe,b=new oe,T=new oe,A=new oe;function S(E){T.fromArray(s,E*3),A.copy(T);let R=c[E];w.copy(R),w.sub(T.multiplyScalar(T.dot(R))).normalize(),b.crossVectors(A,R);let D=b.dot(u[E])<0?-1:1;l[E*4]=w.x,l[E*4+1]=w.y,l[E*4+2]=w.z,l[E*4+3]=D}for(let E=0,R=_.length;E<R;++E){let D=_[E],z=D.start,L=D.count;for(let G=z,J=z+L;G<J;G+=3)S(i[G+0]),S(i[G+1]),S(i[G+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new wi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let d=0,p=i.count;d<p;d++)i.setXYZ(d,0,0,0);let r=new oe,s=new oe,o=new oe,a=new oe,l=new oe,c=new oe,u=new oe,h=new oe;if(e)for(let d=0,p=e.count;d<p;d+=3){let f=e.getX(d+0),v=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,f),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,g),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(i,f),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(f,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,p=t.count;d<p;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Hi.fromBufferAttribute(e,t),Hi.normalize(),e.setXYZ(t,Hi.x,Hi.y,Hi.z)}toNonIndexed(){function e(a,l){let c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u),p=0,f=0;for(let v=0,g=l.length;v<g;v++){a.isInterleavedBufferAttribute?p=l[v]*a.data.stride+a.offset:p=l[v]*u;for(let m=0;m<u;m++)d[f++]=c[p++]}return new wi(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new n,i=this.index.array,r=this.attributes;for(let a in r){let l=r[a],c=e(l,i);t.setAttribute(a,c)}let s=this.morphAttributes;for(let a in s){let l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){let d=c[u],p=e(d,i);l.push(p)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,l=o.length;a<l;a++){let c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let l in i){let c=i[l];e.data.attributes[l]=c.toJSON(e.data)}let r={},s=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++){let p=c[h];u.push(p.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let r=e.attributes;for(let c in r){let u=r[c];this.setAttribute(c,u.clone(t))}let s=e.morphAttributes;for(let c in s){let u=[],h=s[c];for(let d=0,p=h.length;d<p;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let c=0,u=o.length;c<u;c++){let h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},_E=new Et,Na=new Jo,bp=new bn,wE=new oe,ac=new oe,lc=new oe,cc=new oe,Y0=new oe,Sp=new oe,Ep=new Me,Tp=new Me,Mp=new Me,bE=new oe,SE=new oe,EE=new oe,Ap=new oe,Cp=new oe,wt=class extends bi{constructor(e=new ki,t=new gr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){let o=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}getVertexPosition(e,t){let i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){Sp.set(0,0,0);for(let l=0,c=s.length;l<c;l++){let u=a[l],h=s[l];u!==0&&(Y0.fromBufferAttribute(h,e),o?Sp.addScaledVector(Y0,u):Sp.addScaledVector(Y0.sub(t),u))}t.add(Sp)}return t}raycast(e,t){let i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),bp.copy(i.boundingSphere),bp.applyMatrix4(s),Na.copy(e.ray).recast(e.near),!(bp.containsPoint(Na.origin)===!1&&(Na.intersectSphere(bp,wE)===null||Na.origin.distanceToSquared(wE)>(e.far-e.near)**2))&&(_E.copy(s).invert(),Na.copy(e.ray).applyMatrix4(_E),!(i.boundingBox!==null&&Na.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Na)))}_computeIntersections(e,t,i){let r,s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,p=s.drawRange;if(a!==null)if(Array.isArray(o))for(let f=0,v=d.length;f<v;f++){let g=d[f],m=o[g.materialIndex],x=Math.max(g.start,p.start),y=Math.min(a.count,Math.min(g.start+g.count,p.start+p.count));for(let _=x,w=y;_<w;_+=3){let b=a.getX(_),T=a.getX(_+1),A=a.getX(_+2);r=Dp(this,m,e,i,c,u,h,b,T,A),r&&(r.faceIndex=Math.floor(_/3),r.face.materialIndex=g.materialIndex,t.push(r))}}else{let f=Math.max(0,p.start),v=Math.min(a.count,p.start+p.count);for(let g=f,m=v;g<m;g+=3){let x=a.getX(g),y=a.getX(g+1),_=a.getX(g+2);r=Dp(this,o,e,i,c,u,h,x,y,_),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let f=0,v=d.length;f<v;f++){let g=d[f],m=o[g.materialIndex],x=Math.max(g.start,p.start),y=Math.min(l.count,Math.min(g.start+g.count,p.start+p.count));for(let _=x,w=y;_<w;_+=3){let b=_,T=_+1,A=_+2;r=Dp(this,m,e,i,c,u,h,b,T,A),r&&(r.faceIndex=Math.floor(_/3),r.face.materialIndex=g.materialIndex,t.push(r))}}else{let f=Math.max(0,p.start),v=Math.min(l.count,p.start+p.count);for(let g=f,m=v;g<m;g+=3){let x=g,y=g+1,_=g+2;r=Dp(this,o,e,i,c,u,h,x,y,_),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}}};function DL(n,e,t,i,r,s,o,a){let l;if(e.side===Br?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Di,a),l===null)return null;Cp.copy(a),Cp.applyMatrix4(n.matrixWorld);let c=t.ray.origin.distanceTo(Cp);return c<t.near||c>t.far?null:{distance:c,point:Cp.clone(),object:n}}function Dp(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,ac),n.getVertexPosition(l,lc),n.getVertexPosition(c,cc);let u=DL(n,e,t,i,ac,lc,cc,Ap);if(u){r&&(Ep.fromBufferAttribute(r,a),Tp.fromBufferAttribute(r,l),Mp.fromBufferAttribute(r,c),u.uv=Qa.getInterpolation(Ap,ac,lc,cc,Ep,Tp,Mp,new Me)),s&&(Ep.fromBufferAttribute(s,a),Tp.fromBufferAttribute(s,l),Mp.fromBufferAttribute(s,c),u.uv1=Qa.getInterpolation(Ap,ac,lc,cc,Ep,Tp,Mp,new Me),u.uv2=u.uv1),o&&(bE.fromBufferAttribute(o,a),SE.fromBufferAttribute(o,l),EE.fromBufferAttribute(o,c),u.normal=Qa.getInterpolation(Ap,ac,lc,cc,bE,SE,EE,new oe),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));let h={a,b:l,c,normal:new oe,materialIndex:0};Qa.getNormal(ac,lc,cc,h.normal),u.face=h}return u}var gl=class n extends ki{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let l=[],c=[],u=[],h=[],d=0,p=0;f("z","y","x",-1,-1,i,t,e,o,s,0),f("z","y","x",1,-1,i,t,-e,o,s,1),f("x","z","y",1,1,e,i,t,r,o,2),f("x","z","y",1,-1,e,i,-t,r,o,3),f("x","y","z",1,-1,e,t,i,r,s,4),f("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Xi(c,3)),this.setAttribute("normal",new Xi(u,3)),this.setAttribute("uv",new Xi(h,2));function f(v,g,m,x,y,_,w,b,T,A,S){let E=_/T,R=w/A,D=_/2,z=w/2,L=b/2,G=T+1,J=A+1,X=0,N=0,U=new oe;for(let O=0;O<J;O++){let F=O*R-z;for(let $=0;$<G;$++){let P=$*E-D;U[v]=P*x,U[g]=F*y,U[m]=L,c.push(U.x,U.y,U.z),U[v]=0,U[g]=0,U[m]=b>0?1:-1,u.push(U.x,U.y,U.z),h.push($/T),h.push(1-O/A),X+=1}}for(let O=0;O<A;O++)for(let F=0;F<T;F++){let $=d+F+G*O,P=d+F+G*(O+1),C=d+(F+1)+G*(O+1),M=d+(F+1)+G*O;l.push($,P,M),l.push(P,C,M),N+=6}a.addGroup(p,N,S),p+=N,d+=X}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Wc(n){let e={};for(let t in n){e[t]={};for(let i in n[t]){let r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Or(n){let e={};for(let t=0;t<n.length;t++){let i=Wc(n[t]);for(let r in i)e[r]=i[r]}return e}function PL(n){let e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function BM(n){return n.getRenderTarget()===null?n.outputColorSpace:Ut.workingColorSpace}var NM={clone:Wc,merge:Or},RL=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,LL=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,ri=class extends _n{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=RL,this.fragmentShader=LL,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Wc(e.uniforms),this.uniformsGroups=PL(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let s=this.uniforms[r].value;s&&s.isTexture?t.uniforms[r]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[r]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[r]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[r]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[r]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[r]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[r]={type:"m4",value:s.toArray()}:t.uniforms[r]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},L1=class extends bi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Et,this.projectionMatrix=new Et,this.projectionMatrixInverse=new Et,this.coordinateSystem=no}copy(n,e){return super.copy(n,e),this.matrixWorldInverse.copy(n.matrixWorldInverse),this.projectionMatrix.copy(n.projectionMatrix),this.projectionMatrixInverse.copy(n.projectionMatrixInverse),this.coordinateSystem=n.coordinateSystem,this}getWorldDirection(n){return super.getWorldDirection(n).negate()}updateMatrixWorld(n){super.updateMatrixWorld(n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(n,e){super.updateWorldMatrix(n,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},tr=class extends L1{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Hc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Dc*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Hc*2*Math.atan(Math.tan(Dc*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Dc*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},uc=-90,hc=1,Yv=class extends bi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new tr(uc,hc,e,t);r.layers=this.layers,this.add(r);let s=new tr(uc,hc,e,t);s.layers=this.layers,this.add(s);let o=new tr(uc,hc,e,t);o.layers=this.layers,this.add(o);let a=new tr(uc,hc,e,t);a.layers=this.layers,this.add(a);let l=new tr(uc,hc,e,t);l.layers=this.layers,this.add(l);let c=new tr(uc,hc,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(let c of t)this.remove(c);if(e===no)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Df)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,l,c,u]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;let v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(h,d,p),e.xr.enabled=f,i.texture.needsPMREMUpdate=!0}},kh=class extends xr{constructor(e,t,i,r,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:zc,super(e,t,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},$v=class extends co{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(ph("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===nl?Ht:Nn),this.texture=new kh(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:fr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new gl(5,5,5),s=new ri({name:"CubemapFromEquirect",uniforms:Wc(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Br,blending:Wo});s.uniforms.tEquirect.value=t;let o=new wt(r,s),a=t.minFilter;return t.minFilter===ml&&(t.minFilter=fr),new Yv(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}},$0=new oe,OL=new oe,IL=new gt,Ss=class{constructor(e=new oe(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let r=$0.subVectors(i,t).cross(OL.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let i=e.delta($0),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||IL.getNormalMatrix(e),r=this.coplanarPoint($0).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Ga=new bn,Pp=new oe,Uh=class{constructor(e=new Ss,t=new Ss,i=new Ss,r=new Ss,s=new Ss,o=new Ss){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=no){let i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],h=r[6],d=r[7],p=r[8],f=r[9],v=r[10],g=r[11],m=r[12],x=r[13],y=r[14],_=r[15];if(i[0].setComponents(l-s,d-c,g-p,_-m).normalize(),i[1].setComponents(l+s,d+c,g+p,_+m).normalize(),i[2].setComponents(l+o,d+u,g+f,_+x).normalize(),i[3].setComponents(l-o,d-u,g-f,_-x).normalize(),i[4].setComponents(l-a,d-h,g-v,_-y).normalize(),t===no)i[5].setComponents(l+a,d+h,g+v,_+y).normalize();else if(t===Df)i[5].setComponents(a,h,v,y).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Ga.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Ga.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ga)}intersectsSprite(e){return Ga.center.set(0,0,0),Ga.radius=.7071067811865476,Ga.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ga)}intersectsSphere(e){let t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let r=t[i];if(Pp.x=r.normal.x>0?e.max.x:e.min.x,Pp.y=r.normal.y>0?e.max.y:e.min.y,Pp.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Pp)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function GM(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function FL(n,e){let t=e.isWebGL2,i=new WeakMap;function r(c,u){let h=c.array,d=c.usage,p=h.byteLength,f=n.createBuffer();n.bindBuffer(u,f),n.bufferData(u,h,d),c.onUploadCallback();let v;if(h instanceof Float32Array)v=n.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)v=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else v=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)v=n.SHORT;else if(h instanceof Uint32Array)v=n.UNSIGNED_INT;else if(h instanceof Int32Array)v=n.INT;else if(h instanceof Int8Array)v=n.BYTE;else if(h instanceof Uint8Array)v=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)v=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:f,type:v,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version,size:p}}function s(c,u,h){let d=u.array,p=u._updateRange,f=u.updateRanges;if(n.bindBuffer(h,c),p.count===-1&&f.length===0&&n.bufferSubData(h,0,d),f.length!==0){for(let v=0,g=f.length;v<g;v++){let m=f[v];t?n.bufferSubData(h,m.start*d.BYTES_PER_ELEMENT,d,m.start,m.count):n.bufferSubData(h,m.start*d.BYTES_PER_ELEMENT,d.subarray(m.start,m.start+m.count))}u.clearUpdateRanges()}p.count!==-1&&(t?n.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):n.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let h=i.get(c);if(h===void 0)i.set(c,r(c,u));else if(h.version<c.version){if(h.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(h.buffer,c,u),h.version=c.version}}return{get:o,remove:a,update:l}}var hi=class n extends ki{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};let s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=t/l,p=[],f=[],v=[],g=[];for(let m=0;m<u;m++){let x=m*d-o;for(let y=0;y<c;y++){let _=y*h-s;f.push(_,-x,0),v.push(0,0,1),g.push(y/a),g.push(1-m/l)}}for(let m=0;m<l;m++)for(let x=0;x<a;x++){let y=x+c*m,_=x+c*(m+1),w=x+1+c*(m+1),b=x+1+c*m;p.push(y,_,b),p.push(_,w,b)}this.setIndex(p),this.setAttribute("position",new Xi(f,3)),this.setAttribute("normal",new Xi(v,3)),this.setAttribute("uv",new Xi(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}},kL=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,UL=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,zL=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,BL=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,NL=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,GL=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,VL=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,HL=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,WL=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,qL=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,jL=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,XL=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,YL=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,$L=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,KL=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,ZL=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,JL=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,QL=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,eO=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,tO=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,iO=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,rO=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,nO=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,sO=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,oO=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,aO=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,lO=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,cO=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,uO=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,hO=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,dO="gl_FragColor = linearToOutputTexel( gl_FragColor );",pO=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,fO=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,mO=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,gO=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,vO=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,yO=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,xO=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,_O=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,wO=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,bO=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,SO=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,EO=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,TO=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,MO=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,AO=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,CO=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,DO=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,PO=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,RO=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,LO=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,OO=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,IO=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,FO=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,kO=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,UO=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,zO=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,BO=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,NO=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,GO=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,VO=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,HO=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,WO=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,qO=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,jO=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,XO=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,YO=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,$O=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,KO=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,ZO=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,JO=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,QO=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,eI=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,tI=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,iI=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,rI=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,nI=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,sI=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,oI=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,aI=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,lI=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,cI=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,uI=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,hI=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,dI=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,pI=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,fI=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,mI=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,gI=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,vI=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,yI=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,xI=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,_I=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,wI=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,bI=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,SI=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,EI=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,TI=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,MI=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,AI=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,CI=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,DI=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,PI=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,RI=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,LI=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,OI=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,II=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,FI=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,kI=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,UI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,zI=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,BI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,NI=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,GI=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,VI=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,HI=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,WI=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,qI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,jI=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,XI=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,YI=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$I=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,KI=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZI=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,JI=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QI=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,eF=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tF=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,iF=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,rF=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nF=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sF=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,oF=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aF=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lF=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cF=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,uF=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,hF=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dF=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,pF=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fF=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,xt={alphahash_fragment:kL,alphahash_pars_fragment:UL,alphamap_fragment:zL,alphamap_pars_fragment:BL,alphatest_fragment:NL,alphatest_pars_fragment:GL,aomap_fragment:VL,aomap_pars_fragment:HL,batching_pars_vertex:WL,batching_vertex:qL,begin_vertex:jL,beginnormal_vertex:XL,bsdfs:YL,iridescence_fragment:$L,bumpmap_pars_fragment:KL,clipping_planes_fragment:ZL,clipping_planes_pars_fragment:JL,clipping_planes_pars_vertex:QL,clipping_planes_vertex:eO,color_fragment:tO,color_pars_fragment:iO,color_pars_vertex:rO,color_vertex:nO,common:sO,cube_uv_reflection_fragment:oO,defaultnormal_vertex:aO,displacementmap_pars_vertex:lO,displacementmap_vertex:cO,emissivemap_fragment:uO,emissivemap_pars_fragment:hO,colorspace_fragment:dO,colorspace_pars_fragment:pO,envmap_fragment:fO,envmap_common_pars_fragment:mO,envmap_pars_fragment:gO,envmap_pars_vertex:vO,envmap_physical_pars_fragment:DO,envmap_vertex:yO,fog_vertex:xO,fog_pars_vertex:_O,fog_fragment:wO,fog_pars_fragment:bO,gradientmap_pars_fragment:SO,lightmap_fragment:EO,lightmap_pars_fragment:TO,lights_lambert_fragment:MO,lights_lambert_pars_fragment:AO,lights_pars_begin:CO,lights_toon_fragment:PO,lights_toon_pars_fragment:RO,lights_phong_fragment:LO,lights_phong_pars_fragment:OO,lights_physical_fragment:IO,lights_physical_pars_fragment:FO,lights_fragment_begin:kO,lights_fragment_maps:UO,lights_fragment_end:zO,logdepthbuf_fragment:BO,logdepthbuf_pars_fragment:NO,logdepthbuf_pars_vertex:GO,logdepthbuf_vertex:VO,map_fragment:HO,map_pars_fragment:WO,map_particle_fragment:qO,map_particle_pars_fragment:jO,metalnessmap_fragment:XO,metalnessmap_pars_fragment:YO,morphcolor_vertex:$O,morphnormal_vertex:KO,morphtarget_pars_vertex:ZO,morphtarget_vertex:JO,normal_fragment_begin:QO,normal_fragment_maps:eI,normal_pars_fragment:tI,normal_pars_vertex:iI,normal_vertex:rI,normalmap_pars_fragment:nI,clearcoat_normal_fragment_begin:sI,clearcoat_normal_fragment_maps:oI,clearcoat_pars_fragment:aI,iridescence_pars_fragment:lI,opaque_fragment:cI,packing:uI,premultiplied_alpha_fragment:hI,project_vertex:dI,dithering_fragment:pI,dithering_pars_fragment:fI,roughnessmap_fragment:mI,roughnessmap_pars_fragment:gI,shadowmap_pars_fragment:vI,shadowmap_pars_vertex:yI,shadowmap_vertex:xI,shadowmask_pars_fragment:_I,skinbase_vertex:wI,skinning_pars_vertex:bI,skinning_vertex:SI,skinnormal_vertex:EI,specularmap_fragment:TI,specularmap_pars_fragment:MI,tonemapping_fragment:AI,tonemapping_pars_fragment:CI,transmission_fragment:DI,transmission_pars_fragment:PI,uv_pars_fragment:RI,uv_pars_vertex:LI,uv_vertex:OI,worldpos_vertex:II,background_vert:FI,background_frag:kI,backgroundCube_vert:UI,backgroundCube_frag:zI,cube_vert:BI,cube_frag:NI,depth_vert:GI,depth_frag:VI,distanceRGBA_vert:HI,distanceRGBA_frag:WI,equirect_vert:qI,equirect_frag:jI,linedashed_vert:XI,linedashed_frag:YI,meshbasic_vert:$I,meshbasic_frag:KI,meshlambert_vert:ZI,meshlambert_frag:JI,meshmatcap_vert:QI,meshmatcap_frag:eF,meshnormal_vert:tF,meshnormal_frag:iF,meshphong_vert:rF,meshphong_frag:nF,meshphysical_vert:sF,meshphysical_frag:oF,meshtoon_vert:aF,meshtoon_frag:lF,points_vert:cF,points_frag:uF,shadow_vert:hF,shadow_frag:dF,sprite_vert:pF,sprite_frag:fF},nt={common:{diffuse:{value:new at(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new gt},alphaMap:{value:null},alphaMapTransform:{value:new gt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new gt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new gt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new gt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new gt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new gt},normalScale:{value:new Me(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new gt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new gt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new gt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new gt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new at(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new at(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new gt},alphaTest:{value:0},uvTransform:{value:new gt}},sprite:{diffuse:{value:new at(16777215)},opacity:{value:1},center:{value:new Me(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new gt},alphaMap:{value:null},alphaMapTransform:{value:new gt},alphaTest:{value:0}}},Es={basic:{uniforms:Or([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.fog]),vertexShader:xt.meshbasic_vert,fragmentShader:xt.meshbasic_frag},lambert:{uniforms:Or([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,nt.lights,{emissive:{value:new at(0)}}]),vertexShader:xt.meshlambert_vert,fragmentShader:xt.meshlambert_frag},phong:{uniforms:Or([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,nt.lights,{emissive:{value:new at(0)},specular:{value:new at(1118481)},shininess:{value:30}}]),vertexShader:xt.meshphong_vert,fragmentShader:xt.meshphong_frag},standard:{uniforms:Or([nt.common,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.roughnessmap,nt.metalnessmap,nt.fog,nt.lights,{emissive:{value:new at(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:xt.meshphysical_vert,fragmentShader:xt.meshphysical_frag},toon:{uniforms:Or([nt.common,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.gradientmap,nt.fog,nt.lights,{emissive:{value:new at(0)}}]),vertexShader:xt.meshtoon_vert,fragmentShader:xt.meshtoon_frag},matcap:{uniforms:Or([nt.common,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,{matcap:{value:null}}]),vertexShader:xt.meshmatcap_vert,fragmentShader:xt.meshmatcap_frag},points:{uniforms:Or([nt.points,nt.fog]),vertexShader:xt.points_vert,fragmentShader:xt.points_frag},dashed:{uniforms:Or([nt.common,nt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xt.linedashed_vert,fragmentShader:xt.linedashed_frag},depth:{uniforms:Or([nt.common,nt.displacementmap]),vertexShader:xt.depth_vert,fragmentShader:xt.depth_frag},normal:{uniforms:Or([nt.common,nt.bumpmap,nt.normalmap,nt.displacementmap,{opacity:{value:1}}]),vertexShader:xt.meshnormal_vert,fragmentShader:xt.meshnormal_frag},sprite:{uniforms:Or([nt.sprite,nt.fog]),vertexShader:xt.sprite_vert,fragmentShader:xt.sprite_frag},background:{uniforms:{uvTransform:{value:new gt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:xt.background_vert,fragmentShader:xt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:xt.backgroundCube_vert,fragmentShader:xt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:xt.cube_vert,fragmentShader:xt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xt.equirect_vert,fragmentShader:xt.equirect_frag},distanceRGBA:{uniforms:Or([nt.common,nt.displacementmap,{referencePosition:{value:new oe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xt.distanceRGBA_vert,fragmentShader:xt.distanceRGBA_frag},shadow:{uniforms:Or([nt.lights,nt.fog,{color:{value:new at(0)},opacity:{value:1}}]),vertexShader:xt.shadow_vert,fragmentShader:xt.shadow_frag}};Es.physical={uniforms:Or([Es.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new gt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new gt},clearcoatNormalScale:{value:new Me(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new gt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new gt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new gt},sheen:{value:0},sheenColor:{value:new at(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new gt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new gt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new gt},transmissionSamplerSize:{value:new Me},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new gt},attenuationDistance:{value:0},attenuationColor:{value:new at(0)},specularColor:{value:new at(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new gt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new gt},anisotropyVector:{value:new Me},anisotropyMap:{value:null},anisotropyMapTransform:{value:new gt}}]),vertexShader:xt.meshphysical_vert,fragmentShader:xt.meshphysical_frag};var Rp={r:0,b:0,g:0};function mF(n,e,t,i,r,s,o){let a=new at(0),l=s===!0?0:1,c,u,h=null,d=0,p=null;function f(g,m){let x=!1,y=m.isScene===!0?m.background:null;y&&y.isTexture&&(y=(m.backgroundBlurriness>0?t:e).get(y)),y===null?v(a,l):y&&y.isColor&&(v(y,1),x=!0);let _=n.xr.getEnvironmentBlendMode();_==="additive"?i.buffers.color.setClear(0,0,0,1,o):_==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||x)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===gm)?(u===void 0&&(u=new wt(new gl(1,1,1),new ri({name:"BackgroundCubeMaterial",uniforms:Wc(Es.backgroundCube.uniforms),vertexShader:Es.backgroundCube.vertexShader,fragmentShader:Es.backgroundCube.fragmentShader,side:Br,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(w,b,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=Ut.getTransfer(y.colorSpace)!==Qt,(h!==y||d!==y.version||p!==n.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,p=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(c===void 0&&(c=new wt(new hi(2,2),new ri({name:"BackgroundMaterial",uniforms:Wc(Es.background.uniforms),vertexShader:Es.background.vertexShader,fragmentShader:Es.background.fragmentShader,side:Di,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=y,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=Ut.getTransfer(y.colorSpace)!==Qt,y.matrixAutoUpdate===!0&&y.updateMatrix(),c.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||p!==n.toneMapping)&&(c.material.needsUpdate=!0,h=y,d=y.version,p=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function v(g,m){g.getRGB(Rp,BM(n)),i.buffers.color.setClear(Rp.r,Rp.g,Rp.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),l=m,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,v(a,l)},render:f}}function gF(n,e,t,i){let r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=g(null),c=l,u=!1;function h(L,G,J,X,N){let U=!1;if(o){let O=v(X,J,G);c!==O&&(c=O,p(c.object)),U=m(L,X,J,N),U&&x(L,X,J,N)}else{let O=G.wireframe===!0;(c.geometry!==X.id||c.program!==J.id||c.wireframe!==O)&&(c.geometry=X.id,c.program=J.id,c.wireframe=O,U=!0)}N!==null&&t.update(N,n.ELEMENT_ARRAY_BUFFER),(U||u)&&(u=!1,A(L,G,J,X),N!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(N).buffer))}function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function p(L){return i.isWebGL2?n.bindVertexArray(L):s.bindVertexArrayOES(L)}function f(L){return i.isWebGL2?n.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function v(L,G,J){let X=J.wireframe===!0,N=a[L.id];N===void 0&&(N={},a[L.id]=N);let U=N[G.id];U===void 0&&(U={},N[G.id]=U);let O=U[X];return O===void 0&&(O=g(d()),U[X]=O),O}function g(L){let G=[],J=[],X=[];for(let N=0;N<r;N++)G[N]=0,J[N]=0,X[N]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:G,enabledAttributes:J,attributeDivisors:X,object:L,attributes:{},index:null}}function m(L,G,J,X){let N=c.attributes,U=G.attributes,O=0,F=J.getAttributes();for(let $ in F)if(F[$].location>=0){let P=N[$],C=U[$];if(C===void 0&&($==="instanceMatrix"&&L.instanceMatrix&&(C=L.instanceMatrix),$==="instanceColor"&&L.instanceColor&&(C=L.instanceColor)),P===void 0||P.attribute!==C||C&&P.data!==C.data)return!0;O++}return c.attributesNum!==O||c.index!==X}function x(L,G,J,X){let N={},U=G.attributes,O=0,F=J.getAttributes();for(let $ in F)if(F[$].location>=0){let P=U[$];P===void 0&&($==="instanceMatrix"&&L.instanceMatrix&&(P=L.instanceMatrix),$==="instanceColor"&&L.instanceColor&&(P=L.instanceColor));let C={};C.attribute=P,P&&P.data&&(C.data=P.data),N[$]=C,O++}c.attributes=N,c.attributesNum=O,c.index=X}function y(){let L=c.newAttributes;for(let G=0,J=L.length;G<J;G++)L[G]=0}function _(L){w(L,0)}function w(L,G){let J=c.newAttributes,X=c.enabledAttributes,N=c.attributeDivisors;J[L]=1,X[L]===0&&(n.enableVertexAttribArray(L),X[L]=1),N[L]!==G&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,G),N[L]=G)}function b(){let L=c.newAttributes,G=c.enabledAttributes;for(let J=0,X=G.length;J<X;J++)G[J]!==L[J]&&(n.disableVertexAttribArray(J),G[J]=0)}function T(L,G,J,X,N,U,O){O===!0?n.vertexAttribIPointer(L,G,J,N,U):n.vertexAttribPointer(L,G,J,X,N,U)}function A(L,G,J,X){if(i.isWebGL2===!1&&(L.isInstancedMesh||X.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;y();let N=X.attributes,U=J.getAttributes(),O=G.defaultAttributeValues;for(let F in U){let $=U[F];if($.location>=0){let P=N[F];if(P===void 0&&(F==="instanceMatrix"&&L.instanceMatrix&&(P=L.instanceMatrix),F==="instanceColor"&&L.instanceColor&&(P=L.instanceColor)),P!==void 0){let C=P.normalized,M=P.itemSize,B=t.get(P);if(B===void 0)continue;let k=B.buffer,Q=B.type,Y=B.bytesPerElement,re=i.isWebGL2===!0&&(Q===n.INT||Q===n.UNSIGNED_INT||P.gpuType===EM);if(P.isInterleavedBufferAttribute){let Z=P.data,V=Z.stride,ne=P.offset;if(Z.isInstancedInterleavedBuffer){for(let ie=0;ie<$.locationSize;ie++)w($.location+ie,Z.meshPerAttribute);L.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=Z.meshPerAttribute*Z.count)}else for(let ie=0;ie<$.locationSize;ie++)_($.location+ie);n.bindBuffer(n.ARRAY_BUFFER,k);for(let ie=0;ie<$.locationSize;ie++)T($.location+ie,M/$.locationSize,Q,C,V*Y,(ne+M/$.locationSize*ie)*Y,re)}else{if(P.isInstancedBufferAttribute){for(let Z=0;Z<$.locationSize;Z++)w($.location+Z,P.meshPerAttribute);L.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=P.meshPerAttribute*P.count)}else for(let Z=0;Z<$.locationSize;Z++)_($.location+Z);n.bindBuffer(n.ARRAY_BUFFER,k);for(let Z=0;Z<$.locationSize;Z++)T($.location+Z,M/$.locationSize,Q,C,M*Y,M/$.locationSize*Z*Y,re)}}else if(O!==void 0){let C=O[F];if(C!==void 0)switch(C.length){case 2:n.vertexAttrib2fv($.location,C);break;case 3:n.vertexAttrib3fv($.location,C);break;case 4:n.vertexAttrib4fv($.location,C);break;default:n.vertexAttrib1fv($.location,C)}}}}b()}function S(){D();for(let L in a){let G=a[L];for(let J in G){let X=G[J];for(let N in X)f(X[N].object),delete X[N];delete G[J]}delete a[L]}}function E(L){if(a[L.id]===void 0)return;let G=a[L.id];for(let J in G){let X=G[J];for(let N in X)f(X[N].object),delete X[N];delete G[J]}delete a[L.id]}function R(L){for(let G in a){let J=a[G];if(J[L.id]===void 0)continue;let X=J[L.id];for(let N in X)f(X[N].object),delete X[N];delete J[L.id]}}function D(){z(),u=!0,c!==l&&(c=l,p(c.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:D,resetDefaultState:z,dispose:S,releaseStatesOfGeometry:E,releaseStatesOfProgram:R,initAttributes:y,enableAttribute:_,disableUnusedAttributes:b}}function vF(n,e,t,i){let r=i.isWebGL2,s;function o(u){s=u}function a(u,h){n.drawArrays(s,u,h),t.update(h,s,1)}function l(u,h,d){if(d===0)return;let p,f;if(r)p=n,f="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[f](s,u,h,d),t.update(h,s,d)}function c(u,h,d){if(d===0)return;let p=e.get("WEBGL_multi_draw");if(p===null)for(let f=0;f<d;f++)this.render(u[f],h[f]);else{p.multiDrawArraysWEBGL(s,u,0,h,0,d);let f=0;for(let v=0;v<d;v++)f+=h[v];t.update(f,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=c}function yF(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let T=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext",a=t.precision!==void 0?t.precision:"highp",l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let c=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_TEXTURE_SIZE),f=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),g=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),x=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,_=o||e.has("OES_texture_float"),w=y&&_,b=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:v,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:x,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:w,maxSamples:b}}function xF(n){let e=this,t=null,i=0,r=!1,s=!1,o=new Ss,a=new gt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let p=h.length!==0||d||i!==0||r;return r=d,i=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=u(h,d,0)},this.setState=function(h,d,p){let f=h.clippingPlanes,v=h.clipIntersection,g=h.clipShadows,m=n.get(h);if(!r||f===null||f.length===0||s&&!g)s?u(null):c();else{let x=s?0:i,y=x*4,_=m.clippingState||null;l.value=_,_=u(f,d,y,p);for(let w=0;w!==y;++w)_[w]=t[w];m.clippingState=_,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,d,p,f){let v=h!==null?h.length:0,g=null;if(v!==0){if(g=l.value,f!==!0||g===null){let m=p+v*4,x=d.matrixWorldInverse;a.getNormalMatrix(x),(g===null||g.length<m)&&(g=new Float32Array(m));for(let y=0,_=p;y!==v;++y,_+=4)o.copy(h[y]).applyMatrix4(x,a),o.normal.toArray(g,_),g[_+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function _F(n){let e=new WeakMap;function t(o,a){return a===zv?o.mapping=zc:a===Bv&&(o.mapping=Bc),o}function i(o){if(o&&o.isTexture){let a=o.mapping;if(a===zv||a===Bv)if(e.has(o)){let l=e.get(o).texture;return t(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new $v(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}var zh=class extends L1{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},wc=4,TE=[.125,.215,.35,.446,.526,.582],Za=20,K0=new zh,ME=new at,Z0=null,J0=0,Q0=0,Xa=(1+Math.sqrt(5))/2,dc=1/Xa,AE=[new oe(1,1,1),new oe(-1,1,1),new oe(1,1,-1),new oe(-1,1,-1),new oe(0,Xa,dc),new oe(0,Xa,-dc),new oe(dc,0,Xa),new oe(-dc,0,Xa),new oe(Xa,dc,0),new oe(-Xa,dc,0)],Uf=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Z0=this._renderer.getRenderTarget(),J0=this._renderer.getActiveCubeFace(),Q0=this._renderer.getActiveMipmapLevel(),this._setSize(256);let s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=PE(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=DE(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Z0,J0,Q0),e.scissorTest=!1,Lp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===zc||e.mapping===Bc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Z0=this._renderer.getRenderTarget(),J0=this._renderer.getActiveCubeFace(),Q0=this._renderer.getActiveMipmapLevel();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:fr,minFilter:fr,generateMipmaps:!1,type:Lh,format:Bn,colorSpace:Ui,depthBuffer:!1},r=CE(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=CE(e,t,i);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=wF(s)),this._blurMaterial=bF(s,e,t)}return r}_compileMaterial(e){let t=new wt(this._lodPlanes[0],e);this._renderer.compile(t,K0)}_sceneToCubeUV(e,t,i,r){let s=new tr(90,1,t,i),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(ME),l.toneMapping=qo,l.autoClear=!1;let h=new gr({name:"PMREM.Background",side:Br,depthWrite:!1,depthTest:!1}),d=new wt(new gl,h),p=!1,f=e.background;f?f.isColor&&(h.color.copy(f),e.background=null,p=!0):(h.color.copy(ME),p=!0);for(let v=0;v<6;v++){let g=v%3;g===0?(s.up.set(0,o[v],0),s.lookAt(a[v],0,0)):g===1?(s.up.set(0,0,o[v]),s.lookAt(0,a[v],0)):(s.up.set(0,o[v],0),s.lookAt(0,0,a[v]));let m=this._cubeSize;Lp(r,g*m,v>2?m:0,m,m),l.setRenderTarget(r),p&&l.render(d,s),l.render(e,s)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=u,l.autoClear=c,e.background=f}_textureToCubeUV(e,t){let i=this._renderer,r=e.mapping===zc||e.mapping===Bc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=PE()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=DE());let s=r?this._cubemapMaterial:this._equirectMaterial,o=new wt(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;let l=this._cubeSize;Lp(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,K0)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){let s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=AE[(r-1)%AE.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){let l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,h=new wt(this._lodPlanes[r],c),d=c.uniforms,p=this._sizeLods[i]-1,f=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*Za-1),v=s/f,g=isFinite(s)?1+Math.floor(u*v):Za;g>Za&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Za}`);let m=[],x=0;for(let T=0;T<Za;++T){let A=T/v,S=Math.exp(-A*A/2);m.push(S),T===0?x+=S:T<g&&(x+=2*S)}for(let T=0;T<m.length;T++)m[T]=m[T]/x;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=m,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);let{_lodMax:y}=this;d.dTheta.value=f,d.mipInt.value=y-i;let _=this._sizeLods[r],w=3*_*(r>y-wc?r-y+wc:0),b=4*(this._cubeSize-_);Lp(t,w,b,3*_,2*_),l.setRenderTarget(t),l.render(h,K0)}};function wF(n){let e=[],t=[],i=[],r=n,s=n-wc+1+TE.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);t.push(a);let l=1/a;o>n-wc?l=TE[o-n+wc-1]:o===0&&(l=0),i.push(l);let c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,f=6,v=3,g=2,m=1,x=new Float32Array(v*f*p),y=new Float32Array(g*f*p),_=new Float32Array(m*f*p);for(let b=0;b<p;b++){let T=b%3*2/3-1,A=b>2?0:-1,S=[T,A,0,T+2/3,A,0,T+2/3,A+1,0,T,A,0,T+2/3,A+1,0,T,A+1,0];x.set(S,v*f*b),y.set(d,g*f*b);let E=[b,b,b,b,b,b];_.set(E,m*f*b)}let w=new ki;w.setAttribute("position",new wi(x,v)),w.setAttribute("uv",new wi(y,g)),w.setAttribute("faceIndex",new wi(_,m)),e.push(w),r>wc&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function CE(n,e,t){let i=new co(n,e,t);return i.texture.mapping=gm,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Lp(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function bF(n,e,t){let i=new Float32Array(Za),r=new oe(0,1,0);return new ri({name:"SphericalGaussianBlur",defines:{n:Za,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:O1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Wo,depthTest:!1,depthWrite:!1})}function DE(){return new ri({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:O1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Wo,depthTest:!1,depthWrite:!1})}function PE(){return new ri({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:O1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Wo,depthTest:!1,depthWrite:!1})}function O1(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function SF(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){let l=a.mapping,c=l===zv||l===Bv,u=l===zc||l===Bc;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return t===null&&(t=new Uf(n)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{let h=a.image;if(c&&h&&h.height>0||u&&h&&r(h)){t===null&&(t=new Uf(n));let d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0,c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function EF(n){let e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){let r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function TF(n,e,t,i){let r={},s=new WeakMap;function o(h){let d=h.target;d.index!==null&&e.remove(d.index);for(let f in d.attributes)e.remove(d.attributes[f]);for(let f in d.morphAttributes){let v=d.morphAttributes[f];for(let g=0,m=v.length;g<m;g++)e.remove(v[g])}d.removeEventListener("dispose",o),delete r[d.id];let p=s.get(d);p&&(e.remove(p),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(h,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d}function l(h){let d=h.attributes;for(let f in d)e.update(d[f],n.ARRAY_BUFFER);let p=h.morphAttributes;for(let f in p){let v=p[f];for(let g=0,m=v.length;g<m;g++)e.update(v[g],n.ARRAY_BUFFER)}}function c(h){let d=[],p=h.index,f=h.attributes.position,v=0;if(p!==null){let x=p.array;v=p.version;for(let y=0,_=x.length;y<_;y+=3){let w=x[y+0],b=x[y+1],T=x[y+2];d.push(w,b,b,T,T,w)}}else if(f!==void 0){let x=f.array;v=f.version;for(let y=0,_=x.length/3-1;y<_;y+=3){let w=y+0,b=y+1,T=y+2;d.push(w,b,b,T,T,w)}}else return;let g=new(UM(d)?kf:Ff)(d,1);g.version=v;let m=s.get(h);m&&e.remove(m),s.set(h,g)}function u(h){let d=s.get(h);if(d){let p=h.index;p!==null&&d.version<p.version&&c(h)}else c(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:u}}function MF(n,e,t,i){let r=i.isWebGL2,s;function o(p){s=p}let a,l;function c(p){a=p.type,l=p.bytesPerElement}function u(p,f){n.drawElements(s,f,a,p*l),t.update(f,s,1)}function h(p,f,v){if(v===0)return;let g,m;if(r)g=n,m="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[m](s,f,a,p*l,v),t.update(f,s,v)}function d(p,f,v){if(v===0)return;let g=e.get("WEBGL_multi_draw");if(g===null)for(let m=0;m<v;m++)this.render(p[m]/l,f[m]);else{g.multiDrawElementsWEBGL(s,f,0,a,p,0,v);let m=0;for(let x=0;x<v;x++)m+=f[x];t.update(m,s,1)}}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=h,this.renderMultiDraw=d}function AF(n){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function CF(n,e){return n[0]-e[0]}function DF(n,e){return Math.abs(e[1])-Math.abs(n[1])}function PF(n,e,t){let i={},r=new Float32Array(8),s=new WeakMap,o=new zt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,h){let d=c.morphTargetInfluences;if(e.isWebGL2===!0){let f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=f!==void 0?f.length:0,g=s.get(u);if(g===void 0||g.count!==v){let y=function(){L.dispose(),s.delete(u),u.removeEventListener("dispose",y)};var p=y;g!==void 0&&g.texture.dispose();let _=u.morphAttributes.position!==void 0,w=u.morphAttributes.normal!==void 0,b=u.morphAttributes.color!==void 0,T=u.morphAttributes.position||[],A=u.morphAttributes.normal||[],S=u.morphAttributes.color||[],E=0;_===!0&&(E=1),w===!0&&(E=2),b===!0&&(E=3);let R=u.attributes.position.count*E,D=1;R>e.maxTextureSize&&(D=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);let z=new Float32Array(R*D*4*v),L=new Of(z,R,D,v);L.type=ro,L.needsUpdate=!0;let G=E*4;for(let J=0;J<v;J++){let X=T[J],N=A[J],U=S[J],O=R*D*4*J;for(let F=0;F<X.count;F++){let $=F*G;_===!0&&(o.fromBufferAttribute(X,F),z[O+$+0]=o.x,z[O+$+1]=o.y,z[O+$+2]=o.z,z[O+$+3]=0),w===!0&&(o.fromBufferAttribute(N,F),z[O+$+4]=o.x,z[O+$+5]=o.y,z[O+$+6]=o.z,z[O+$+7]=0),b===!0&&(o.fromBufferAttribute(U,F),z[O+$+8]=o.x,z[O+$+9]=o.y,z[O+$+10]=o.z,z[O+$+11]=U.itemSize===4?o.w:1)}}g={count:v,texture:L,size:new Me(R,D)},s.set(u,g),u.addEventListener("dispose",y)}let m=0;for(let y=0;y<d.length;y++)m+=d[y];let x=u.morphTargetsRelative?1:1-m;h.getUniforms().setValue(n,"morphTargetBaseInfluence",x),h.getUniforms().setValue(n,"morphTargetInfluences",d),h.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{let f=d===void 0?0:d.length,v=i[u.id];if(v===void 0||v.length!==f){v=[];for(let _=0;_<f;_++)v[_]=[_,0];i[u.id]=v}for(let _=0;_<f;_++){let w=v[_];w[0]=_,w[1]=d[_]}v.sort(DF);for(let _=0;_<8;_++)_<f&&v[_][1]?(a[_][0]=v[_][0],a[_][1]=v[_][1]):(a[_][0]=Number.MAX_SAFE_INTEGER,a[_][1]=0);a.sort(CF);let g=u.morphAttributes.position,m=u.morphAttributes.normal,x=0;for(let _=0;_<8;_++){let w=a[_],b=w[0],T=w[1];b!==Number.MAX_SAFE_INTEGER&&T?(g&&u.getAttribute("morphTarget"+_)!==g[b]&&u.setAttribute("morphTarget"+_,g[b]),m&&u.getAttribute("morphNormal"+_)!==m[b]&&u.setAttribute("morphNormal"+_,m[b]),r[_]=T,x+=T):(g&&u.hasAttribute("morphTarget"+_)===!0&&u.deleteAttribute("morphTarget"+_),m&&u.hasAttribute("morphNormal"+_)===!0&&u.deleteAttribute("morphNormal"+_),r[_]=0)}let y=u.morphTargetsRelative?1:1-x;h.getUniforms().setValue(n,"morphTargetBaseInfluence",y),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function RF(n,e,t,i){let r=new WeakMap;function s(l){let c=i.render.frame,u=l.geometry,h=e.get(l,u);if(r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){let d=l.skeleton;r.get(d)!==c&&(d.update(),r.set(d,c))}return h}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}var zf=class extends xr{constructor(e,t,i,r,s,o,a,l,c,u){if(u=u!==void 0?u:rl,u!==rl&&u!==Gc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&u===rl&&(i=Uo),i===void 0&&u===Gc&&(i=il),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:ji,this.minFilter=l!==void 0?l:ji,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},VM=new xr,HM=new zf(1,1);HM.compareFunction=FM;var WM=new Of,qM=new Xv,jM=new kh,RE=[],LE=[],OE=new Float32Array(16),IE=new Float32Array(9),FE=new Float32Array(4);function iu(n,e,t){let i=n[0];if(i<=0||i>0)return n;let r=e*t,s=RE[r];if(s===void 0&&(s=new Float32Array(r),RE[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function zi(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Bi(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function ym(n,e){let t=LE[e];t===void 0&&(t=new Int32Array(e),LE[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function LF(n,e){let t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function OF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(zi(t,e))return;n.uniform2fv(this.addr,e),Bi(t,e)}}function IF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(zi(t,e))return;n.uniform3fv(this.addr,e),Bi(t,e)}}function FF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(zi(t,e))return;n.uniform4fv(this.addr,e),Bi(t,e)}}function kF(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(zi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Bi(t,e)}else{if(zi(t,i))return;FE.set(i),n.uniformMatrix2fv(this.addr,!1,FE),Bi(t,i)}}function UF(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(zi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Bi(t,e)}else{if(zi(t,i))return;IE.set(i),n.uniformMatrix3fv(this.addr,!1,IE),Bi(t,i)}}function zF(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(zi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Bi(t,e)}else{if(zi(t,i))return;OE.set(i),n.uniformMatrix4fv(this.addr,!1,OE),Bi(t,i)}}function BF(n,e){let t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function NF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(zi(t,e))return;n.uniform2iv(this.addr,e),Bi(t,e)}}function GF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(zi(t,e))return;n.uniform3iv(this.addr,e),Bi(t,e)}}function VF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(zi(t,e))return;n.uniform4iv(this.addr,e),Bi(t,e)}}function HF(n,e){let t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function WF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(zi(t,e))return;n.uniform2uiv(this.addr,e),Bi(t,e)}}function qF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(zi(t,e))return;n.uniform3uiv(this.addr,e),Bi(t,e)}}function jF(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(zi(t,e))return;n.uniform4uiv(this.addr,e),Bi(t,e)}}function XF(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s=this.type===n.SAMPLER_2D_SHADOW?HM:VM;t.setTexture2D(e||s,r)}function YF(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||qM,r)}function $F(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||jM,r)}function KF(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||WM,r)}function ZF(n){switch(n){case 5126:return LF;case 35664:return OF;case 35665:return IF;case 35666:return FF;case 35674:return kF;case 35675:return UF;case 35676:return zF;case 5124:case 35670:return BF;case 35667:case 35671:return NF;case 35668:case 35672:return GF;case 35669:case 35673:return VF;case 5125:return HF;case 36294:return WF;case 36295:return qF;case 36296:return jF;case 35678:case 36198:case 36298:case 36306:case 35682:return XF;case 35679:case 36299:case 36307:return YF;case 35680:case 36300:case 36308:case 36293:return $F;case 36289:case 36303:case 36311:case 36292:return KF}}function JF(n,e){n.uniform1fv(this.addr,e)}function QF(n,e){let t=iu(e,this.size,2);n.uniform2fv(this.addr,t)}function ek(n,e){let t=iu(e,this.size,3);n.uniform3fv(this.addr,t)}function tk(n,e){let t=iu(e,this.size,4);n.uniform4fv(this.addr,t)}function ik(n,e){let t=iu(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function rk(n,e){let t=iu(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function nk(n,e){let t=iu(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function sk(n,e){n.uniform1iv(this.addr,e)}function ok(n,e){n.uniform2iv(this.addr,e)}function ak(n,e){n.uniform3iv(this.addr,e)}function lk(n,e){n.uniform4iv(this.addr,e)}function ck(n,e){n.uniform1uiv(this.addr,e)}function uk(n,e){n.uniform2uiv(this.addr,e)}function hk(n,e){n.uniform3uiv(this.addr,e)}function dk(n,e){n.uniform4uiv(this.addr,e)}function pk(n,e,t){let i=this.cache,r=e.length,s=ym(t,r);zi(i,s)||(n.uniform1iv(this.addr,s),Bi(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||VM,s[o])}function fk(n,e,t){let i=this.cache,r=e.length,s=ym(t,r);zi(i,s)||(n.uniform1iv(this.addr,s),Bi(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||qM,s[o])}function mk(n,e,t){let i=this.cache,r=e.length,s=ym(t,r);zi(i,s)||(n.uniform1iv(this.addr,s),Bi(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||jM,s[o])}function gk(n,e,t){let i=this.cache,r=e.length,s=ym(t,r);zi(i,s)||(n.uniform1iv(this.addr,s),Bi(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||WM,s[o])}function vk(n){switch(n){case 5126:return JF;case 35664:return QF;case 35665:return ek;case 35666:return tk;case 35674:return ik;case 35675:return rk;case 35676:return nk;case 5124:case 35670:return sk;case 35667:case 35671:return ok;case 35668:case 35672:return ak;case 35669:case 35673:return lk;case 5125:return ck;case 36294:return uk;case 36295:return hk;case 36296:return dk;case 35678:case 36198:case 36298:case 36306:case 35682:return pk;case 35679:case 36299:case 36307:return fk;case 35680:case 36300:case 36308:case 36293:return mk;case 36289:case 36303:case 36311:case 36292:return gk}}var Kv=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=ZF(t.type)}},Zv=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=vk(t.type)}},Jv=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,t[a.id],i)}}},ev=/(\w+)(\])?(\[|\.)?/g;function kE(n,e){n.seq.push(e),n.map[e.id]=e}function yk(n,e,t){let i=n.name,r=i.length;for(ev.lastIndex=0;;){let s=ev.exec(i),o=ev.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){kE(t,c===void 0?new Kv(a,n,e):new Zv(a,n,e));break}else{let u=t.map[a];u===void 0&&(u=new Jv(a),kE(t,u)),t=u}}}var Rc=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){let s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);yk(s,o,this)}}setValue(e,t,i,r){let s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){let r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){let a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){let i=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in t&&i.push(o)}return i}};function UE(n,e,t){let i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}var xk=37297,_k=0;function wk(n,e){let t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){let a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function bk(n){let e=Ut.getPrimaries(Ut.workingColorSpace),t=Ut.getPrimaries(n),i;switch(e===t?i="":e===Cf&&t===Af?i="LinearDisplayP3ToLinearSRGB":e===Af&&t===Cf&&(i="LinearSRGBToLinearDisplayP3"),n){case Ui:case vm:return[i,"LinearTransferOETF"];case Ht:case D1:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function zE(n,e,t){let i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+wk(n.getShaderSource(e),o)}else return r}function Sk(n,e){let t=bk(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Ek(n,e){let t;switch(e){case DR:t="Linear";break;case PR:t="Reinhard";break;case RR:t="OptimizedCineon";break;case LR:t="ACESFilmic";break;case IR:t="AgX";break;case OR:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Tk(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(bc).join(`
`)}function Mk(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(bc).join(`
`)}function Ak(n){let e=[];for(let t in n){let i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function Ck(n,e){let t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){let s=n.getActiveAttrib(e,r),o=s.name,a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function bc(n){return n!==""}function BE(n,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function NE(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Dk=/^[ \t]*#include +<([\w\d./]+)>/gm;function Qv(n){return n.replace(Dk,Rk)}var Pk=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Rk(n,e){let t=xt[e];if(t===void 0){let i=Pk.get(e);if(i!==void 0)t=xt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Qv(t)}var Lk=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function GE(n){return n.replace(Lk,Ok)}function Ok(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function VE(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Ik(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===wM?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===rR?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Zs&&(e="SHADOWMAP_TYPE_VSM"),e}function Fk(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case zc:case Bc:e="ENVMAP_TYPE_CUBE";break;case gm:e="ENVMAP_TYPE_CUBE_UV";break}return e}function kk(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Bc:e="ENVMAP_MODE_REFRACTION";break}return e}function Uk(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case M1:e="ENVMAP_BLENDING_MULTIPLY";break;case AR:e="ENVMAP_BLENDING_MIX";break;case CR:e="ENVMAP_BLENDING_ADD";break}return e}function zk(n){let e=n.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function Bk(n,e,t,i){let r=n.getContext(),s=t.defines,o=t.vertexShader,a=t.fragmentShader,l=Ik(t),c=Fk(t),u=kk(t),h=Uk(t),d=zk(t),p=t.isWebGL2?"":Tk(t),f=Mk(t),v=Ak(s),g=r.createProgram(),m,x,y=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(bc).join(`
`),m.length>0&&(m+=`
`),x=[p,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(bc).join(`
`),x.length>0&&(x+=`
`)):(m=[VE(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(bc).join(`
`),x=[p,VE(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==qo?"#define TONE_MAPPING":"",t.toneMapping!==qo?xt.tonemapping_pars_fragment:"",t.toneMapping!==qo?Ek("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",xt.colorspace_pars_fragment,Sk("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(bc).join(`
`)),o=Qv(o),o=BE(o,t),o=NE(o,t),a=Qv(a),a=BE(a,t),a=NE(a,t),o=GE(o),a=GE(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,m=[f,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,x=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===aE?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===aE?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);let _=y+m+o,w=y+x+a,b=UE(r,r.VERTEX_SHADER,_),T=UE(r,r.FRAGMENT_SHADER,w);r.attachShader(g,b),r.attachShader(g,T),t.index0AttributeName!==void 0?r.bindAttribLocation(g,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g);function A(D){if(n.debug.checkShaderErrors){let z=r.getProgramInfoLog(g).trim(),L=r.getShaderInfoLog(b).trim(),G=r.getShaderInfoLog(T).trim(),J=!0,X=!0;if(r.getProgramParameter(g,r.LINK_STATUS)===!1)if(J=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,g,b,T);else{let N=zE(r,b,"vertex"),U=zE(r,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+`

Program Info Log: `+z+`
`+N+`
`+U)}else z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",z):(L===""||G==="")&&(X=!1);X&&(D.diagnostics={runnable:J,programLog:z,vertexShader:{log:L,prefix:m},fragmentShader:{log:G,prefix:x}})}r.deleteShader(b),r.deleteShader(T),S=new Rc(r,g),E=Ck(r,g)}let S;this.getUniforms=function(){return S===void 0&&A(this),S};let E;this.getAttributes=function(){return E===void 0&&A(this),E};let R=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return R===!1&&(R=r.getProgramParameter(g,xk)),R},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=_k++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=b,this.fragmentShader=T,this}var Nk=0,ey=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new ty(e),t.set(e,i)),i}},ty=class{constructor(e){this.id=Nk++,this.code=e,this.usedTimes=0}};function Gk(n,e,t,i,r,s,o){let a=new Fh,l=new ey,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures,p=r.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(S){return S===0?"uv":`uv${S}`}function g(S,E,R,D,z){let L=D.fog,G=z.geometry,J=S.isMeshStandardMaterial?D.environment:null,X=(S.isMeshStandardMaterial?t:e).get(S.envMap||J),N=X&&X.mapping===gm?X.image.height:null,U=f[S.type];S.precision!==null&&(p=r.getMaxPrecision(S.precision),p!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",p,"instead."));let O=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,F=O!==void 0?O.length:0,$=0;G.morphAttributes.position!==void 0&&($=1),G.morphAttributes.normal!==void 0&&($=2),G.morphAttributes.color!==void 0&&($=3);let P,C,M,B;if(U){let Se=Es[U];P=Se.vertexShader,C=Se.fragmentShader}else P=S.vertexShader,C=S.fragmentShader,l.update(S),M=l.getVertexShaderID(S),B=l.getFragmentShaderID(S);let k=n.getRenderTarget(),Q=z.isInstancedMesh===!0,Y=z.isBatchedMesh===!0,re=!!S.map,Z=!!S.matcap,V=!!X,ne=!!S.aoMap,ie=!!S.lightMap,te=!!S.bumpMap,j=!!S.normalMap,W=!!S.displacementMap,H=!!S.emissiveMap,q=!!S.metalnessMap,I=!!S.roughnessMap,ee=S.anisotropy>0,me=S.clearcoat>0,pe=S.iridescence>0,ge=S.sheen>0,xe=S.transmission>0,we=ee&&!!S.anisotropyMap,_e=me&&!!S.clearcoatMap,Ie=me&&!!S.clearcoatNormalMap,Be=me&&!!S.clearcoatRoughnessMap,Ae=pe&&!!S.iridescenceMap,it=pe&&!!S.iridescenceThicknessMap,se=ge&&!!S.sheenColorMap,Le=ge&&!!S.sheenRoughnessMap,Ee=!!S.specularMap,ke=!!S.specularColorMap,We=!!S.specularIntensityMap,Qe=xe&&!!S.transmissionMap,rt=xe&&!!S.thicknessMap,Oe=!!S.gradientMap,Ce=!!S.alphaMap,le=S.alphaTest>0,Pe=!!S.alphaHash,Ve=!!S.extensions,et=!!G.attributes.uv1,Je=!!G.attributes.uv2,Te=!!G.attributes.uv3,Ze=qo;return S.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&(Ze=n.toneMapping),{isWebGL2:u,shaderID:U,shaderType:S.type,shaderName:S.name,vertexShader:P,fragmentShader:C,defines:S.defines,customVertexShaderID:M,customFragmentShaderID:B,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:p,batching:Y,instancing:Q,instancingColor:Q&&z.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:k===null?n.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:Ui,map:re,matcap:Z,envMap:V,envMapMode:V&&X.mapping,envMapCubeUVHeight:N,aoMap:ne,lightMap:ie,bumpMap:te,normalMap:j,displacementMap:d&&W,emissiveMap:H,normalMapObjectSpace:j&&S.normalMapType===XR,normalMapTangentSpace:j&&S.normalMapType===C1,metalnessMap:q,roughnessMap:I,anisotropy:ee,anisotropyMap:we,clearcoat:me,clearcoatMap:_e,clearcoatNormalMap:Ie,clearcoatRoughnessMap:Be,iridescence:pe,iridescenceMap:Ae,iridescenceThicknessMap:it,sheen:ge,sheenColorMap:se,sheenRoughnessMap:Le,specularMap:Ee,specularColorMap:ke,specularIntensityMap:We,transmission:xe,transmissionMap:Qe,thicknessMap:rt,gradientMap:Oe,opaque:S.transparent===!1&&S.blending===Cc,alphaMap:Ce,alphaTest:le,alphaHash:Pe,combine:S.combine,mapUv:re&&v(S.map.channel),aoMapUv:ne&&v(S.aoMap.channel),lightMapUv:ie&&v(S.lightMap.channel),bumpMapUv:te&&v(S.bumpMap.channel),normalMapUv:j&&v(S.normalMap.channel),displacementMapUv:W&&v(S.displacementMap.channel),emissiveMapUv:H&&v(S.emissiveMap.channel),metalnessMapUv:q&&v(S.metalnessMap.channel),roughnessMapUv:I&&v(S.roughnessMap.channel),anisotropyMapUv:we&&v(S.anisotropyMap.channel),clearcoatMapUv:_e&&v(S.clearcoatMap.channel),clearcoatNormalMapUv:Ie&&v(S.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Be&&v(S.clearcoatRoughnessMap.channel),iridescenceMapUv:Ae&&v(S.iridescenceMap.channel),iridescenceThicknessMapUv:it&&v(S.iridescenceThicknessMap.channel),sheenColorMapUv:se&&v(S.sheenColorMap.channel),sheenRoughnessMapUv:Le&&v(S.sheenRoughnessMap.channel),specularMapUv:Ee&&v(S.specularMap.channel),specularColorMapUv:ke&&v(S.specularColorMap.channel),specularIntensityMapUv:We&&v(S.specularIntensityMap.channel),transmissionMapUv:Qe&&v(S.transmissionMap.channel),thicknessMapUv:rt&&v(S.thicknessMap.channel),alphaMapUv:Ce&&v(S.alphaMap.channel),vertexTangents:!!G.attributes.tangent&&(j||ee),vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!G.attributes.color&&G.attributes.color.itemSize===4,vertexUv1s:et,vertexUv2s:Je,vertexUv3s:Te,pointsUvs:z.isPoints===!0&&!!G.attributes.uv&&(re||Ce),fog:!!L,useFog:S.fog===!0,fogExp2:L&&L.isFogExp2,flatShading:S.flatShading===!0,sizeAttenuation:S.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:z.isSkinnedMesh===!0,morphTargets:G.morphAttributes.position!==void 0,morphNormals:G.morphAttributes.normal!==void 0,morphColors:G.morphAttributes.color!==void 0,morphTargetsCount:F,morphTextureStride:$,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numLightProbes:E.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:S.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:Ze,useLegacyLights:n._useLegacyLights,decodeVideoTexture:re&&S.map.isVideoTexture===!0&&Ut.getTransfer(S.map.colorSpace)===Qt,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===Kr,flipSided:S.side===Br,useDepthPacking:S.depthPacking>=0,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionDerivatives:Ve&&S.extensions.derivatives===!0,extensionFragDepth:Ve&&S.extensions.fragDepth===!0,extensionDrawBuffers:Ve&&S.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ve&&S.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Ve&&S.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:S.customProgramCacheKey()}}function m(S){let E=[];if(S.shaderID?E.push(S.shaderID):(E.push(S.customVertexShaderID),E.push(S.customFragmentShaderID)),S.defines!==void 0)for(let R in S.defines)E.push(R),E.push(S.defines[R]);return S.isRawShaderMaterial===!1&&(x(E,S),y(E,S),E.push(n.outputColorSpace)),E.push(S.customProgramCacheKey),E.join()}function x(S,E){S.push(E.precision),S.push(E.outputColorSpace),S.push(E.envMapMode),S.push(E.envMapCubeUVHeight),S.push(E.mapUv),S.push(E.alphaMapUv),S.push(E.lightMapUv),S.push(E.aoMapUv),S.push(E.bumpMapUv),S.push(E.normalMapUv),S.push(E.displacementMapUv),S.push(E.emissiveMapUv),S.push(E.metalnessMapUv),S.push(E.roughnessMapUv),S.push(E.anisotropyMapUv),S.push(E.clearcoatMapUv),S.push(E.clearcoatNormalMapUv),S.push(E.clearcoatRoughnessMapUv),S.push(E.iridescenceMapUv),S.push(E.iridescenceThicknessMapUv),S.push(E.sheenColorMapUv),S.push(E.sheenRoughnessMapUv),S.push(E.specularMapUv),S.push(E.specularColorMapUv),S.push(E.specularIntensityMapUv),S.push(E.transmissionMapUv),S.push(E.thicknessMapUv),S.push(E.combine),S.push(E.fogExp2),S.push(E.sizeAttenuation),S.push(E.morphTargetsCount),S.push(E.morphAttributeCount),S.push(E.numDirLights),S.push(E.numPointLights),S.push(E.numSpotLights),S.push(E.numSpotLightMaps),S.push(E.numHemiLights),S.push(E.numRectAreaLights),S.push(E.numDirLightShadows),S.push(E.numPointLightShadows),S.push(E.numSpotLightShadows),S.push(E.numSpotLightShadowsWithMaps),S.push(E.numLightProbes),S.push(E.shadowMapType),S.push(E.toneMapping),S.push(E.numClippingPlanes),S.push(E.numClipIntersection),S.push(E.depthPacking)}function y(S,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.matcap&&a.enable(4),E.envMap&&a.enable(5),E.normalMapObjectSpace&&a.enable(6),E.normalMapTangentSpace&&a.enable(7),E.clearcoat&&a.enable(8),E.iridescence&&a.enable(9),E.alphaTest&&a.enable(10),E.vertexColors&&a.enable(11),E.vertexAlphas&&a.enable(12),E.vertexUv1s&&a.enable(13),E.vertexUv2s&&a.enable(14),E.vertexUv3s&&a.enable(15),E.vertexTangents&&a.enable(16),E.anisotropy&&a.enable(17),E.alphaHash&&a.enable(18),E.batching&&a.enable(19),S.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.skinning&&a.enable(4),E.morphTargets&&a.enable(5),E.morphNormals&&a.enable(6),E.morphColors&&a.enable(7),E.premultipliedAlpha&&a.enable(8),E.shadowMapEnabled&&a.enable(9),E.useLegacyLights&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.transmission&&a.enable(15),E.sheen&&a.enable(16),E.opaque&&a.enable(17),E.pointsUvs&&a.enable(18),E.decodeVideoTexture&&a.enable(19),S.push(a.mask)}function _(S){let E=f[S.type],R;if(E){let D=Es[E];R=NM.clone(D.uniforms)}else R=S.uniforms;return R}function w(S,E){let R;for(let D=0,z=c.length;D<z;D++){let L=c[D];if(L.cacheKey===E){R=L,++R.usedTimes;break}}return R===void 0&&(R=new Bk(n,E,S,s),c.push(R)),R}function b(S){if(--S.usedTimes===0){let E=c.indexOf(S);c[E]=c[c.length-1],c.pop(),S.destroy()}}function T(S){l.remove(S)}function A(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:_,acquireProgram:w,releaseProgram:b,releaseShaderCache:T,programs:c,dispose:A}}function Vk(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function Hk(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function HE(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function WE(){let n=[],e=0,t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(h,d,p,f,v,g){let m=n[e];return m===void 0?(m={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:v,group:g},n[e]=m):(m.id=h.id,m.object=h,m.geometry=d,m.material=p,m.groupOrder=f,m.renderOrder=h.renderOrder,m.z=v,m.group=g),e++,m}function a(h,d,p,f,v,g){let m=o(h,d,p,f,v,g);p.transmission>0?i.push(m):p.transparent===!0?r.push(m):t.push(m)}function l(h,d,p,f,v,g){let m=o(h,d,p,f,v,g);p.transmission>0?i.unshift(m):p.transparent===!0?r.unshift(m):t.unshift(m)}function c(h,d){t.length>1&&t.sort(h||Hk),i.length>1&&i.sort(d||HE),r.length>1&&r.sort(d||HE)}function u(){for(let h=e,d=n.length;h<d;h++){let p=n[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function Wk(){let n=new WeakMap;function e(i,r){let s=n.get(i),o;return s===void 0?(o=new WE,n.set(i,[o])):r>=s.length?(o=new WE,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function qk(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new oe,color:new at};break;case"SpotLight":t={position:new oe,direction:new oe,color:new at,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new oe,color:new at,distance:0,decay:0};break;case"HemisphereLight":t={direction:new oe,skyColor:new at,groundColor:new at};break;case"RectAreaLight":t={color:new at,position:new oe,halfWidth:new oe,halfHeight:new oe};break}return n[e.id]=t,t}}}function jk(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}var Xk=0;function Yk(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function $k(n,e){let t=new qk,i=jk(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new oe);let s=new oe,o=new Et,a=new Et;function l(u,h){let d=0,p=0,f=0;for(let D=0;D<9;D++)r.probe[D].set(0,0,0);let v=0,g=0,m=0,x=0,y=0,_=0,w=0,b=0,T=0,A=0,S=0;u.sort(Yk);let E=h===!0?Math.PI:1;for(let D=0,z=u.length;D<z;D++){let L=u[D],G=L.color,J=L.intensity,X=L.distance,N=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)d+=G.r*J*E,p+=G.g*J*E,f+=G.b*J*E;else if(L.isLightProbe){for(let U=0;U<9;U++)r.probe[U].addScaledVector(L.sh.coefficients[U],J);S++}else if(L.isDirectionalLight){let U=t.get(L);if(U.color.copy(L.color).multiplyScalar(L.intensity*E),L.castShadow){let O=L.shadow,F=i.get(L);F.shadowBias=O.bias,F.shadowNormalBias=O.normalBias,F.shadowRadius=O.radius,F.shadowMapSize=O.mapSize,r.directionalShadow[v]=F,r.directionalShadowMap[v]=N,r.directionalShadowMatrix[v]=L.shadow.matrix,_++}r.directional[v]=U,v++}else if(L.isSpotLight){let U=t.get(L);U.position.setFromMatrixPosition(L.matrixWorld),U.color.copy(G).multiplyScalar(J*E),U.distance=X,U.coneCos=Math.cos(L.angle),U.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),U.decay=L.decay,r.spot[m]=U;let O=L.shadow;if(L.map&&(r.spotLightMap[T]=L.map,T++,O.updateMatrices(L),L.castShadow&&A++),r.spotLightMatrix[m]=O.matrix,L.castShadow){let F=i.get(L);F.shadowBias=O.bias,F.shadowNormalBias=O.normalBias,F.shadowRadius=O.radius,F.shadowMapSize=O.mapSize,r.spotShadow[m]=F,r.spotShadowMap[m]=N,b++}m++}else if(L.isRectAreaLight){let U=t.get(L);U.color.copy(G).multiplyScalar(J),U.halfWidth.set(L.width*.5,0,0),U.halfHeight.set(0,L.height*.5,0),r.rectArea[x]=U,x++}else if(L.isPointLight){let U=t.get(L);if(U.color.copy(L.color).multiplyScalar(L.intensity*E),U.distance=L.distance,U.decay=L.decay,L.castShadow){let O=L.shadow,F=i.get(L);F.shadowBias=O.bias,F.shadowNormalBias=O.normalBias,F.shadowRadius=O.radius,F.shadowMapSize=O.mapSize,F.shadowCameraNear=O.camera.near,F.shadowCameraFar=O.camera.far,r.pointShadow[g]=F,r.pointShadowMap[g]=N,r.pointShadowMatrix[g]=L.shadow.matrix,w++}r.point[g]=U,g++}else if(L.isHemisphereLight){let U=t.get(L);U.skyColor.copy(L.color).multiplyScalar(J*E),U.groundColor.copy(L.groundColor).multiplyScalar(J*E),r.hemi[y]=U,y++}}x>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=nt.LTC_FLOAT_1,r.rectAreaLTC2=nt.LTC_FLOAT_2):(r.rectAreaLTC1=nt.LTC_HALF_1,r.rectAreaLTC2=nt.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=nt.LTC_FLOAT_1,r.rectAreaLTC2=nt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=nt.LTC_HALF_1,r.rectAreaLTC2=nt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=p,r.ambient[2]=f;let R=r.hash;(R.directionalLength!==v||R.pointLength!==g||R.spotLength!==m||R.rectAreaLength!==x||R.hemiLength!==y||R.numDirectionalShadows!==_||R.numPointShadows!==w||R.numSpotShadows!==b||R.numSpotMaps!==T||R.numLightProbes!==S)&&(r.directional.length=v,r.spot.length=m,r.rectArea.length=x,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=_,r.directionalShadowMap.length=_,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=_,r.pointShadowMatrix.length=w,r.spotLightMatrix.length=b+T-A,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=A,r.numLightProbes=S,R.directionalLength=v,R.pointLength=g,R.spotLength=m,R.rectAreaLength=x,R.hemiLength=y,R.numDirectionalShadows=_,R.numPointShadows=w,R.numSpotShadows=b,R.numSpotMaps=T,R.numLightProbes=S,r.version=Xk++)}function c(u,h){let d=0,p=0,f=0,v=0,g=0,m=h.matrixWorldInverse;for(let x=0,y=u.length;x<y;x++){let _=u[x];if(_.isDirectionalLight){let w=r.directional[d];w.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(m),d++}else if(_.isSpotLight){let w=r.spot[f];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(m),w.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(m),f++}else if(_.isRectAreaLight){let w=r.rectArea[v];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(m),a.identity(),o.copy(_.matrixWorld),o.premultiply(m),a.extractRotation(o),w.halfWidth.set(_.width*.5,0,0),w.halfHeight.set(0,_.height*.5,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),v++}else if(_.isPointLight){let w=r.point[p];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(m),p++}else if(_.isHemisphereLight){let w=r.hemi[g];w.direction.setFromMatrixPosition(_.matrixWorld),w.direction.transformDirection(m),g++}}}return{setup:l,setupView:c,state:r}}function qE(n,e){let t=new $k(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(u){i.push(u)}function a(u){r.push(u)}function l(u){t.setup(i,u)}function c(u){t.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function Kk(n,e){let t=new WeakMap;function i(s,o=0){let a=t.get(s),l;return a===void 0?(l=new qE(n,e),t.set(s,[l])):o>=a.length?(l=new qE(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}var Bf=class extends _n{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=jR,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Nf=class extends _n{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Zk=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Jk=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Qk(n,e,t){let i=new Uh,r=new Me,s=new Me,o=new zt,a=new Bf({depthPacking:OM}),l=new Nf,c={},u=t.maxTextureSize,h={[Di]:Br,[Br]:Di,[Kr]:Kr},d=new ri({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Me},radius:{value:4}},vertexShader:Zk,fragmentShader:Jk}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new ki;f.setAttribute("position",new wi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new wt(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=wM;let m=this.type;this.render=function(b,T,A){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||b.length===0)return;let S=n.getRenderTarget(),E=n.getActiveCubeFace(),R=n.getActiveMipmapLevel(),D=n.state;D.setBlending(Wo),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);let z=m!==Zs&&this.type===Zs,L=m===Zs&&this.type!==Zs;for(let G=0,J=b.length;G<J;G++){let X=b[G],N=X.shadow;if(N===void 0){console.warn("THREE.WebGLShadowMap:",X,"has no shadow.");continue}if(N.autoUpdate===!1&&N.needsUpdate===!1)continue;r.copy(N.mapSize);let U=N.getFrameExtents();if(r.multiply(U),s.copy(N.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/U.x),r.x=s.x*U.x,N.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/U.y),r.y=s.y*U.y,N.mapSize.y=s.y)),N.map===null||z===!0||L===!0){let F=this.type!==Zs?{minFilter:ji,magFilter:ji}:{};N.map!==null&&N.map.dispose(),N.map=new co(r.x,r.y,F),N.map.texture.name=X.name+".shadowMap",N.camera.updateProjectionMatrix()}n.setRenderTarget(N.map),n.clear();let O=N.getViewportCount();for(let F=0;F<O;F++){let $=N.getViewport(F);o.set(s.x*$.x,s.y*$.y,s.x*$.z,s.y*$.w),D.viewport(o),N.updateMatrices(X,F),i=N.getFrustum(),_(T,A,N.camera,X,this.type)}N.isPointLightShadow!==!0&&this.type===Zs&&x(N,A),N.needsUpdate=!1}m=this.type,g.needsUpdate=!1,n.setRenderTarget(S,E,R)};function x(b,T){let A=e.update(v);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,p.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new co(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(T,null,A,d,v,null),p.uniforms.shadow_pass.value=b.mapPass.texture,p.uniforms.resolution.value=b.mapSize,p.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(T,null,A,p,v,null)}function y(b,T,A,S){let E=null,R=A.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(R!==void 0)E=R;else if(E=A.isPointLight===!0?l:a,n.localClippingEnabled&&T.clipShadows===!0&&Array.isArray(T.clippingPlanes)&&T.clippingPlanes.length!==0||T.displacementMap&&T.displacementScale!==0||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0){let D=E.uuid,z=T.uuid,L=c[D];L===void 0&&(L={},c[D]=L);let G=L[z];G===void 0&&(G=E.clone(),L[z]=G,T.addEventListener("dispose",w)),E=G}if(E.visible=T.visible,E.wireframe=T.wireframe,S===Zs?E.side=T.shadowSide!==null?T.shadowSide:T.side:E.side=T.shadowSide!==null?T.shadowSide:h[T.side],E.alphaMap=T.alphaMap,E.alphaTest=T.alphaTest,E.map=T.map,E.clipShadows=T.clipShadows,E.clippingPlanes=T.clippingPlanes,E.clipIntersection=T.clipIntersection,E.displacementMap=T.displacementMap,E.displacementScale=T.displacementScale,E.displacementBias=T.displacementBias,E.wireframeLinewidth=T.wireframeLinewidth,E.linewidth=T.linewidth,A.isPointLight===!0&&E.isMeshDistanceMaterial===!0){let D=n.properties.get(E);D.light=A}return E}function _(b,T,A,S,E){if(b.visible===!1)return;if(b.layers.test(T.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&E===Zs)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);let D=e.update(b),z=b.material;if(Array.isArray(z)){let L=D.groups;for(let G=0,J=L.length;G<J;G++){let X=L[G],N=z[X.materialIndex];if(N&&N.visible){let U=y(b,N,S,E);b.onBeforeShadow(n,b,T,A,D,U,X),n.renderBufferDirect(A,null,D,U,b,X),b.onAfterShadow(n,b,T,A,D,U,X)}}}else if(z.visible){let L=y(b,z,S,E);b.onBeforeShadow(n,b,T,A,D,L,null),n.renderBufferDirect(A,null,D,L,b,null),b.onAfterShadow(n,b,T,A,D,L,null)}}let R=b.children;for(let D=0,z=R.length;D<z;D++)_(R[D],T,A,S,E)}function w(b){b.target.removeEventListener("dispose",w);for(let T in c){let A=c[T],S=b.target.uuid;S in A&&(A[S].dispose(),delete A[S])}}}function eU(n,e,t){let i=t.isWebGL2;function r(){let le=!1,Pe=new zt,Ve=null,et=new zt(0,0,0,0);return{setMask:function(Je){Ve!==Je&&!le&&(n.colorMask(Je,Je,Je,Je),Ve=Je)},setLocked:function(Je){le=Je},setClear:function(Je,Te,Ze,Se,ce){ce===!0&&(Je*=Se,Te*=Se,Ze*=Se),Pe.set(Je,Te,Ze,Se),et.equals(Pe)===!1&&(n.clearColor(Je,Te,Ze,Se),et.copy(Pe))},reset:function(){le=!1,Ve=null,et.set(-1,0,0,0)}}}function s(){let le=!1,Pe=null,Ve=null,et=null;return{setTest:function(Je){Je?Y(n.DEPTH_TEST):re(n.DEPTH_TEST)},setMask:function(Je){Pe!==Je&&!le&&(n.depthMask(Je),Pe=Je)},setFunc:function(Je){if(Ve!==Je){switch(Je){case _R:n.depthFunc(n.NEVER);break;case wR:n.depthFunc(n.ALWAYS);break;case bR:n.depthFunc(n.LESS);break;case Ef:n.depthFunc(n.LEQUAL);break;case SR:n.depthFunc(n.EQUAL);break;case ER:n.depthFunc(n.GEQUAL);break;case TR:n.depthFunc(n.GREATER);break;case MR:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Ve=Je}},setLocked:function(Je){le=Je},setClear:function(Je){et!==Je&&(n.clearDepth(Je),et=Je)},reset:function(){le=!1,Pe=null,Ve=null,et=null}}}function o(){let le=!1,Pe=null,Ve=null,et=null,Je=null,Te=null,Ze=null,Se=null,ce=null;return{setTest:function(ue){le||(ue?Y(n.STENCIL_TEST):re(n.STENCIL_TEST))},setMask:function(ue){Pe!==ue&&!le&&(n.stencilMask(ue),Pe=ue)},setFunc:function(ue,de,be){(Ve!==ue||et!==de||Je!==be)&&(n.stencilFunc(ue,de,be),Ve=ue,et=de,Je=be)},setOp:function(ue,de,be){(Te!==ue||Ze!==de||Se!==be)&&(n.stencilOp(ue,de,be),Te=ue,Ze=de,Se=be)},setLocked:function(ue){le=ue},setClear:function(ue){ce!==ue&&(n.clearStencil(ue),ce=ue)},reset:function(){le=!1,Pe=null,Ve=null,et=null,Je=null,Te=null,Ze=null,Se=null,ce=null}}}let a=new r,l=new s,c=new o,u=new WeakMap,h=new WeakMap,d={},p={},f=new WeakMap,v=[],g=null,m=!1,x=null,y=null,_=null,w=null,b=null,T=null,A=null,S=new at(0,0,0),E=0,R=!1,D=null,z=null,L=null,G=null,J=null,X=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS),N=!1,U=0,O=n.getParameter(n.VERSION);O.indexOf("WebGL")!==-1?(U=parseFloat(/^WebGL (\d)/.exec(O)[1]),N=U>=1):O.indexOf("OpenGL ES")!==-1&&(U=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),N=U>=2);let F=null,$={},P=n.getParameter(n.SCISSOR_BOX),C=n.getParameter(n.VIEWPORT),M=new zt().fromArray(P),B=new zt().fromArray(C);function k(le,Pe,Ve,et){let Je=new Uint8Array(4),Te=n.createTexture();n.bindTexture(le,Te),n.texParameteri(le,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(le,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ze=0;Ze<Ve;Ze++)i&&(le===n.TEXTURE_3D||le===n.TEXTURE_2D_ARRAY)?n.texImage3D(Pe,0,n.RGBA,1,1,et,0,n.RGBA,n.UNSIGNED_BYTE,Je):n.texImage2D(Pe+Ze,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Je);return Te}let Q={};Q[n.TEXTURE_2D]=k(n.TEXTURE_2D,n.TEXTURE_2D,1),Q[n.TEXTURE_CUBE_MAP]=k(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Q[n.TEXTURE_2D_ARRAY]=k(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Q[n.TEXTURE_3D]=k(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Y(n.DEPTH_TEST),l.setFunc(Ef),H(!1),q(MS),Y(n.CULL_FACE),j(Wo);function Y(le){d[le]!==!0&&(n.enable(le),d[le]=!0)}function re(le){d[le]!==!1&&(n.disable(le),d[le]=!1)}function Z(le,Pe){return p[le]!==Pe?(n.bindFramebuffer(le,Pe),p[le]=Pe,i&&(le===n.DRAW_FRAMEBUFFER&&(p[n.FRAMEBUFFER]=Pe),le===n.FRAMEBUFFER&&(p[n.DRAW_FRAMEBUFFER]=Pe)),!0):!1}function V(le,Pe){let Ve=v,et=!1;if(le)if(Ve=f.get(Pe),Ve===void 0&&(Ve=[],f.set(Pe,Ve)),le.isWebGLMultipleRenderTargets){let Je=le.texture;if(Ve.length!==Je.length||Ve[0]!==n.COLOR_ATTACHMENT0){for(let Te=0,Ze=Je.length;Te<Ze;Te++)Ve[Te]=n.COLOR_ATTACHMENT0+Te;Ve.length=Je.length,et=!0}}else Ve[0]!==n.COLOR_ATTACHMENT0&&(Ve[0]=n.COLOR_ATTACHMENT0,et=!0);else Ve[0]!==n.BACK&&(Ve[0]=n.BACK,et=!0);et&&(t.isWebGL2?n.drawBuffers(Ve):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ve))}function ne(le){return g!==le?(n.useProgram(le),g=le,!0):!1}let ie={[Ka]:n.FUNC_ADD,[sR]:n.FUNC_SUBTRACT,[oR]:n.FUNC_REVERSE_SUBTRACT};if(i)ie[PS]=n.MIN,ie[RS]=n.MAX;else{let le=e.get("EXT_blend_minmax");le!==null&&(ie[PS]=le.MIN_EXT,ie[RS]=le.MAX_EXT)}let te={[aR]:n.ZERO,[lR]:n.ONE,[cR]:n.SRC_COLOR,[kv]:n.SRC_ALPHA,[mR]:n.SRC_ALPHA_SATURATE,[pR]:n.DST_COLOR,[hR]:n.DST_ALPHA,[uR]:n.ONE_MINUS_SRC_COLOR,[Uv]:n.ONE_MINUS_SRC_ALPHA,[fR]:n.ONE_MINUS_DST_COLOR,[dR]:n.ONE_MINUS_DST_ALPHA,[gR]:n.CONSTANT_COLOR,[vR]:n.ONE_MINUS_CONSTANT_COLOR,[yR]:n.CONSTANT_ALPHA,[xR]:n.ONE_MINUS_CONSTANT_ALPHA};function j(le,Pe,Ve,et,Je,Te,Ze,Se,ce,ue){if(le===Wo){m===!0&&(re(n.BLEND),m=!1);return}if(m===!1&&(Y(n.BLEND),m=!0),le!==nR){if(le!==x||ue!==R){if((y!==Ka||b!==Ka)&&(n.blendEquation(n.FUNC_ADD),y=Ka,b=Ka),ue)switch(le){case Cc:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case AS:n.blendFunc(n.ONE,n.ONE);break;case CS:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case DS:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",le);break}else switch(le){case Cc:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case AS:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case CS:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case DS:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",le);break}_=null,w=null,T=null,A=null,S.set(0,0,0),E=0,x=le,R=ue}return}Je=Je||Pe,Te=Te||Ve,Ze=Ze||et,(Pe!==y||Je!==b)&&(n.blendEquationSeparate(ie[Pe],ie[Je]),y=Pe,b=Je),(Ve!==_||et!==w||Te!==T||Ze!==A)&&(n.blendFuncSeparate(te[Ve],te[et],te[Te],te[Ze]),_=Ve,w=et,T=Te,A=Ze),(Se.equals(S)===!1||ce!==E)&&(n.blendColor(Se.r,Se.g,Se.b,ce),S.copy(Se),E=ce),x=le,R=!1}function W(le,Pe){le.side===Kr?re(n.CULL_FACE):Y(n.CULL_FACE);let Ve=le.side===Br;Pe&&(Ve=!Ve),H(Ve),le.blending===Cc&&le.transparent===!1?j(Wo):j(le.blending,le.blendEquation,le.blendSrc,le.blendDst,le.blendEquationAlpha,le.blendSrcAlpha,le.blendDstAlpha,le.blendColor,le.blendAlpha,le.premultipliedAlpha),l.setFunc(le.depthFunc),l.setTest(le.depthTest),l.setMask(le.depthWrite),a.setMask(le.colorWrite);let et=le.stencilWrite;c.setTest(et),et&&(c.setMask(le.stencilWriteMask),c.setFunc(le.stencilFunc,le.stencilRef,le.stencilFuncMask),c.setOp(le.stencilFail,le.stencilZFail,le.stencilZPass)),ee(le.polygonOffset,le.polygonOffsetFactor,le.polygonOffsetUnits),le.alphaToCoverage===!0?Y(n.SAMPLE_ALPHA_TO_COVERAGE):re(n.SAMPLE_ALPHA_TO_COVERAGE)}function H(le){D!==le&&(le?n.frontFace(n.CW):n.frontFace(n.CCW),D=le)}function q(le){le!==tR?(Y(n.CULL_FACE),le!==z&&(le===MS?n.cullFace(n.BACK):le===iR?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):re(n.CULL_FACE),z=le}function I(le){le!==L&&(N&&n.lineWidth(le),L=le)}function ee(le,Pe,Ve){le?(Y(n.POLYGON_OFFSET_FILL),(G!==Pe||J!==Ve)&&(n.polygonOffset(Pe,Ve),G=Pe,J=Ve)):re(n.POLYGON_OFFSET_FILL)}function me(le){le?Y(n.SCISSOR_TEST):re(n.SCISSOR_TEST)}function pe(le){le===void 0&&(le=n.TEXTURE0+X-1),F!==le&&(n.activeTexture(le),F=le)}function ge(le,Pe,Ve){Ve===void 0&&(F===null?Ve=n.TEXTURE0+X-1:Ve=F);let et=$[Ve];et===void 0&&(et={type:void 0,texture:void 0},$[Ve]=et),(et.type!==le||et.texture!==Pe)&&(F!==Ve&&(n.activeTexture(Ve),F=Ve),n.bindTexture(le,Pe||Q[le]),et.type=le,et.texture=Pe)}function xe(){let le=$[F];le!==void 0&&le.type!==void 0&&(n.bindTexture(le.type,null),le.type=void 0,le.texture=void 0)}function we(){try{n.compressedTexImage2D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function _e(){try{n.compressedTexImage3D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Ie(){try{n.texSubImage2D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Be(){try{n.texSubImage3D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Ae(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function it(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function se(){try{n.texStorage2D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Le(){try{n.texStorage3D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Ee(){try{n.texImage2D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function ke(){try{n.texImage3D.apply(n,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function We(le){M.equals(le)===!1&&(n.scissor(le.x,le.y,le.z,le.w),M.copy(le))}function Qe(le){B.equals(le)===!1&&(n.viewport(le.x,le.y,le.z,le.w),B.copy(le))}function rt(le,Pe){let Ve=h.get(Pe);Ve===void 0&&(Ve=new WeakMap,h.set(Pe,Ve));let et=Ve.get(le);et===void 0&&(et=n.getUniformBlockIndex(Pe,le.name),Ve.set(le,et))}function Oe(le,Pe){let Ve=h.get(Pe).get(le);u.get(Pe)!==Ve&&(n.uniformBlockBinding(Pe,Ve,le.__bindingPointIndex),u.set(Pe,Ve))}function Ce(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},F=null,$={},p={},f=new WeakMap,v=[],g=null,m=!1,x=null,y=null,_=null,w=null,b=null,T=null,A=null,S=new at(0,0,0),E=0,R=!1,D=null,z=null,L=null,G=null,J=null,M.set(0,0,n.canvas.width,n.canvas.height),B.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:Y,disable:re,bindFramebuffer:Z,drawBuffers:V,useProgram:ne,setBlending:j,setMaterial:W,setFlipSided:H,setCullFace:q,setLineWidth:I,setPolygonOffset:ee,setScissorTest:me,activeTexture:pe,bindTexture:ge,unbindTexture:xe,compressedTexImage2D:we,compressedTexImage3D:_e,texImage2D:Ee,texImage3D:ke,updateUBOMapping:rt,uniformBlockBinding:Oe,texStorage2D:se,texStorage3D:Le,texSubImage2D:Ie,texSubImage3D:Be,compressedTexSubImage2D:Ae,compressedTexSubImage3D:it,scissor:We,viewport:Qe,reset:Ce}}function tU(n,e,t,i,r,s,o){let a=r.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new WeakMap,h,d=new WeakMap,p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function f(q,I){return p?new OffscreenCanvas(q,I):Ih("canvas")}function v(q,I,ee,me){let pe=1;if((q.width>me||q.height>me)&&(pe=me/Math.max(q.width,q.height)),pe<1||I===!0)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap){let ge=I?Pf:Math.floor,xe=ge(pe*q.width),we=ge(pe*q.height);h===void 0&&(h=f(xe,we));let _e=ee?f(xe,we):h;return _e.width=xe,_e.height=we,_e.getContext("2d").drawImage(q,0,0,xe,we),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+q.width+"x"+q.height+") to ("+xe+"x"+we+")."),_e}else return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+q.width+"x"+q.height+")."),q;return q}function g(q){return qv(q.width)&&qv(q.height)}function m(q){return a?!1:q.wrapS!==zn||q.wrapT!==zn||q.minFilter!==ji&&q.minFilter!==fr}function x(q,I){return q.generateMipmaps&&I&&q.minFilter!==ji&&q.minFilter!==fr}function y(q){n.generateMipmap(q)}function _(q,I,ee,me,pe=!1){if(a===!1)return I;if(q!==null){if(n[q]!==void 0)return n[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let ge=I;if(I===n.RED&&(ee===n.FLOAT&&(ge=n.R32F),ee===n.HALF_FLOAT&&(ge=n.R16F),ee===n.UNSIGNED_BYTE&&(ge=n.R8)),I===n.RED_INTEGER&&(ee===n.UNSIGNED_BYTE&&(ge=n.R8UI),ee===n.UNSIGNED_SHORT&&(ge=n.R16UI),ee===n.UNSIGNED_INT&&(ge=n.R32UI),ee===n.BYTE&&(ge=n.R8I),ee===n.SHORT&&(ge=n.R16I),ee===n.INT&&(ge=n.R32I)),I===n.RG&&(ee===n.FLOAT&&(ge=n.RG32F),ee===n.HALF_FLOAT&&(ge=n.RG16F),ee===n.UNSIGNED_BYTE&&(ge=n.RG8)),I===n.RGBA){let xe=pe?Mf:Ut.getTransfer(me);ee===n.FLOAT&&(ge=n.RGBA32F),ee===n.HALF_FLOAT&&(ge=n.RGBA16F),ee===n.UNSIGNED_BYTE&&(ge=xe===Qt?n.SRGB8_ALPHA8:n.RGBA8),ee===n.UNSIGNED_SHORT_4_4_4_4&&(ge=n.RGBA4),ee===n.UNSIGNED_SHORT_5_5_5_1&&(ge=n.RGB5_A1)}return(ge===n.R16F||ge===n.R32F||ge===n.RG16F||ge===n.RG32F||ge===n.RGBA16F||ge===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ge}function w(q,I,ee){return x(q,ee)===!0||q.isFramebufferTexture&&q.minFilter!==ji&&q.minFilter!==fr?Math.log2(Math.max(I.width,I.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?I.mipmaps.length:1}function b(q){return q===ji||q===Nv||q===uf?n.NEAREST:n.LINEAR}function T(q){let I=q.target;I.removeEventListener("dispose",T),S(I),I.isVideoTexture&&u.delete(I)}function A(q){let I=q.target;I.removeEventListener("dispose",A),R(I)}function S(q){let I=i.get(q);if(I.__webglInit===void 0)return;let ee=q.source,me=d.get(ee);if(me){let pe=me[I.__cacheKey];pe.usedTimes--,pe.usedTimes===0&&E(q),Object.keys(me).length===0&&d.delete(ee)}i.remove(q)}function E(q){let I=i.get(q);n.deleteTexture(I.__webglTexture);let ee=q.source,me=d.get(ee);delete me[I.__cacheKey],o.memory.textures--}function R(q){let I=q.texture,ee=i.get(q),me=i.get(I);if(me.__webglTexture!==void 0&&(n.deleteTexture(me.__webglTexture),o.memory.textures--),q.depthTexture&&q.depthTexture.dispose(),q.isWebGLCubeRenderTarget)for(let pe=0;pe<6;pe++){if(Array.isArray(ee.__webglFramebuffer[pe]))for(let ge=0;ge<ee.__webglFramebuffer[pe].length;ge++)n.deleteFramebuffer(ee.__webglFramebuffer[pe][ge]);else n.deleteFramebuffer(ee.__webglFramebuffer[pe]);ee.__webglDepthbuffer&&n.deleteRenderbuffer(ee.__webglDepthbuffer[pe])}else{if(Array.isArray(ee.__webglFramebuffer))for(let pe=0;pe<ee.__webglFramebuffer.length;pe++)n.deleteFramebuffer(ee.__webglFramebuffer[pe]);else n.deleteFramebuffer(ee.__webglFramebuffer);if(ee.__webglDepthbuffer&&n.deleteRenderbuffer(ee.__webglDepthbuffer),ee.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ee.__webglMultisampledFramebuffer),ee.__webglColorRenderbuffer)for(let pe=0;pe<ee.__webglColorRenderbuffer.length;pe++)ee.__webglColorRenderbuffer[pe]&&n.deleteRenderbuffer(ee.__webglColorRenderbuffer[pe]);ee.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ee.__webglDepthRenderbuffer)}if(q.isWebGLMultipleRenderTargets)for(let pe=0,ge=I.length;pe<ge;pe++){let xe=i.get(I[pe]);xe.__webglTexture&&(n.deleteTexture(xe.__webglTexture),o.memory.textures--),i.remove(I[pe])}i.remove(I),i.remove(q)}let D=0;function z(){D=0}function L(){let q=D;return q>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+r.maxTextures),D+=1,q}function G(q){let I=[];return I.push(q.wrapS),I.push(q.wrapT),I.push(q.wrapR||0),I.push(q.magFilter),I.push(q.minFilter),I.push(q.anisotropy),I.push(q.internalFormat),I.push(q.format),I.push(q.type),I.push(q.generateMipmaps),I.push(q.premultiplyAlpha),I.push(q.flipY),I.push(q.unpackAlignment),I.push(q.colorSpace),I.join()}function J(q,I){let ee=i.get(q);if(q.isVideoTexture&&W(q),q.isRenderTargetTexture===!1&&q.version>0&&ee.__version!==q.version){let me=q.image;if(me===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(me.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{M(ee,q,I);return}}t.bindTexture(n.TEXTURE_2D,ee.__webglTexture,n.TEXTURE0+I)}function X(q,I){let ee=i.get(q);if(q.version>0&&ee.__version!==q.version){M(ee,q,I);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ee.__webglTexture,n.TEXTURE0+I)}function N(q,I){let ee=i.get(q);if(q.version>0&&ee.__version!==q.version){M(ee,q,I);return}t.bindTexture(n.TEXTURE_3D,ee.__webglTexture,n.TEXTURE0+I)}function U(q,I){let ee=i.get(q);if(q.version>0&&ee.__version!==q.version){B(ee,q,I);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ee.__webglTexture,n.TEXTURE0+I)}let O={[Nc]:n.REPEAT,[zn]:n.CLAMP_TO_EDGE,[Tf]:n.MIRRORED_REPEAT},F={[ji]:n.NEAREST,[Nv]:n.NEAREST_MIPMAP_NEAREST,[uf]:n.NEAREST_MIPMAP_LINEAR,[fr]:n.LINEAR,[SM]:n.LINEAR_MIPMAP_NEAREST,[ml]:n.LINEAR_MIPMAP_LINEAR},$={[YR]:n.NEVER,[eL]:n.ALWAYS,[$R]:n.LESS,[FM]:n.LEQUAL,[KR]:n.EQUAL,[QR]:n.GEQUAL,[ZR]:n.GREATER,[JR]:n.NOTEQUAL};function P(q,I,ee){if(ee?(n.texParameteri(q,n.TEXTURE_WRAP_S,O[I.wrapS]),n.texParameteri(q,n.TEXTURE_WRAP_T,O[I.wrapT]),(q===n.TEXTURE_3D||q===n.TEXTURE_2D_ARRAY)&&n.texParameteri(q,n.TEXTURE_WRAP_R,O[I.wrapR]),n.texParameteri(q,n.TEXTURE_MAG_FILTER,F[I.magFilter]),n.texParameteri(q,n.TEXTURE_MIN_FILTER,F[I.minFilter])):(n.texParameteri(q,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(q,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(q===n.TEXTURE_3D||q===n.TEXTURE_2D_ARRAY)&&n.texParameteri(q,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(I.wrapS!==zn||I.wrapT!==zn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(q,n.TEXTURE_MAG_FILTER,b(I.magFilter)),n.texParameteri(q,n.TEXTURE_MIN_FILTER,b(I.minFilter)),I.minFilter!==ji&&I.minFilter!==fr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),I.compareFunction&&(n.texParameteri(q,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(q,n.TEXTURE_COMPARE_FUNC,$[I.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){let me=e.get("EXT_texture_filter_anisotropic");if(I.magFilter===ji||I.minFilter!==uf&&I.minFilter!==ml||I.type===ro&&e.has("OES_texture_float_linear")===!1||a===!1&&I.type===Lh&&e.has("OES_texture_half_float_linear")===!1)return;(I.anisotropy>1||i.get(I).__currentAnisotropy)&&(n.texParameterf(q,me.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(I.anisotropy,r.getMaxAnisotropy())),i.get(I).__currentAnisotropy=I.anisotropy)}}function C(q,I){let ee=!1;q.__webglInit===void 0&&(q.__webglInit=!0,I.addEventListener("dispose",T));let me=I.source,pe=d.get(me);pe===void 0&&(pe={},d.set(me,pe));let ge=G(I);if(ge!==q.__cacheKey){pe[ge]===void 0&&(pe[ge]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ee=!0),pe[ge].usedTimes++;let xe=pe[q.__cacheKey];xe!==void 0&&(pe[q.__cacheKey].usedTimes--,xe.usedTimes===0&&E(I)),q.__cacheKey=ge,q.__webglTexture=pe[ge].texture}return ee}function M(q,I,ee){let me=n.TEXTURE_2D;(I.isDataArrayTexture||I.isCompressedArrayTexture)&&(me=n.TEXTURE_2D_ARRAY),I.isData3DTexture&&(me=n.TEXTURE_3D);let pe=C(q,I),ge=I.source;t.bindTexture(me,q.__webglTexture,n.TEXTURE0+ee);let xe=i.get(ge);if(ge.version!==xe.__version||pe===!0){t.activeTexture(n.TEXTURE0+ee);let we=Ut.getPrimaries(Ut.workingColorSpace),_e=I.colorSpace===Nn?null:Ut.getPrimaries(I.colorSpace),Ie=I.colorSpace===Nn||we===_e?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ie);let Be=m(I)&&g(I.image)===!1,Ae=v(I.image,Be,!1,r.maxTextureSize);Ae=H(I,Ae);let it=g(Ae)||a,se=s.convert(I.format,I.colorSpace),Le=s.convert(I.type),Ee=_(I.internalFormat,se,Le,I.colorSpace,I.isVideoTexture);P(me,I,it);let ke,We=I.mipmaps,Qe=a&&I.isVideoTexture!==!0&&Ee!==PM,rt=xe.__version===void 0||pe===!0,Oe=w(I,Ae,it);if(I.isDepthTexture)Ee=n.DEPTH_COMPONENT,a?I.type===ro?Ee=n.DEPTH_COMPONENT32F:I.type===Uo?Ee=n.DEPTH_COMPONENT24:I.type===il?Ee=n.DEPTH24_STENCIL8:Ee=n.DEPTH_COMPONENT16:I.type===ro&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),I.format===rl&&Ee===n.DEPTH_COMPONENT&&I.type!==A1&&I.type!==Uo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),I.type=Uo,Le=s.convert(I.type)),I.format===Gc&&Ee===n.DEPTH_COMPONENT&&(Ee=n.DEPTH_STENCIL,I.type!==il&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),I.type=il,Le=s.convert(I.type))),rt&&(Qe?t.texStorage2D(n.TEXTURE_2D,1,Ee,Ae.width,Ae.height):t.texImage2D(n.TEXTURE_2D,0,Ee,Ae.width,Ae.height,0,se,Le,null));else if(I.isDataTexture)if(We.length>0&&it){Qe&&rt&&t.texStorage2D(n.TEXTURE_2D,Oe,Ee,We[0].width,We[0].height);for(let Ce=0,le=We.length;Ce<le;Ce++)ke=We[Ce],Qe?t.texSubImage2D(n.TEXTURE_2D,Ce,0,0,ke.width,ke.height,se,Le,ke.data):t.texImage2D(n.TEXTURE_2D,Ce,Ee,ke.width,ke.height,0,se,Le,ke.data);I.generateMipmaps=!1}else Qe?(rt&&t.texStorage2D(n.TEXTURE_2D,Oe,Ee,Ae.width,Ae.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ae.width,Ae.height,se,Le,Ae.data)):t.texImage2D(n.TEXTURE_2D,0,Ee,Ae.width,Ae.height,0,se,Le,Ae.data);else if(I.isCompressedTexture)if(I.isCompressedArrayTexture){Qe&&rt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Oe,Ee,We[0].width,We[0].height,Ae.depth);for(let Ce=0,le=We.length;Ce<le;Ce++)ke=We[Ce],I.format!==Bn?se!==null?Qe?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ce,0,0,0,ke.width,ke.height,Ae.depth,se,ke.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ce,Ee,ke.width,ke.height,Ae.depth,0,ke.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qe?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ce,0,0,0,ke.width,ke.height,Ae.depth,se,Le,ke.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ce,Ee,ke.width,ke.height,Ae.depth,0,se,Le,ke.data)}else{Qe&&rt&&t.texStorage2D(n.TEXTURE_2D,Oe,Ee,We[0].width,We[0].height);for(let Ce=0,le=We.length;Ce<le;Ce++)ke=We[Ce],I.format!==Bn?se!==null?Qe?t.compressedTexSubImage2D(n.TEXTURE_2D,Ce,0,0,ke.width,ke.height,se,ke.data):t.compressedTexImage2D(n.TEXTURE_2D,Ce,Ee,ke.width,ke.height,0,ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qe?t.texSubImage2D(n.TEXTURE_2D,Ce,0,0,ke.width,ke.height,se,Le,ke.data):t.texImage2D(n.TEXTURE_2D,Ce,Ee,ke.width,ke.height,0,se,Le,ke.data)}else if(I.isDataArrayTexture)Qe?(rt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Oe,Ee,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ae.width,Ae.height,Ae.depth,se,Le,Ae.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ee,Ae.width,Ae.height,Ae.depth,0,se,Le,Ae.data);else if(I.isData3DTexture)Qe?(rt&&t.texStorage3D(n.TEXTURE_3D,Oe,Ee,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ae.width,Ae.height,Ae.depth,se,Le,Ae.data)):t.texImage3D(n.TEXTURE_3D,0,Ee,Ae.width,Ae.height,Ae.depth,0,se,Le,Ae.data);else if(I.isFramebufferTexture){if(rt)if(Qe)t.texStorage2D(n.TEXTURE_2D,Oe,Ee,Ae.width,Ae.height);else{let Ce=Ae.width,le=Ae.height;for(let Pe=0;Pe<Oe;Pe++)t.texImage2D(n.TEXTURE_2D,Pe,Ee,Ce,le,0,se,Le,null),Ce>>=1,le>>=1}}else if(We.length>0&&it){Qe&&rt&&t.texStorage2D(n.TEXTURE_2D,Oe,Ee,We[0].width,We[0].height);for(let Ce=0,le=We.length;Ce<le;Ce++)ke=We[Ce],Qe?t.texSubImage2D(n.TEXTURE_2D,Ce,0,0,se,Le,ke):t.texImage2D(n.TEXTURE_2D,Ce,Ee,se,Le,ke);I.generateMipmaps=!1}else Qe?(rt&&t.texStorage2D(n.TEXTURE_2D,Oe,Ee,Ae.width,Ae.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,se,Le,Ae)):t.texImage2D(n.TEXTURE_2D,0,Ee,se,Le,Ae);x(I,it)&&y(me),xe.__version=ge.version,I.onUpdate&&I.onUpdate(I)}q.__version=I.version}function B(q,I,ee){if(I.image.length!==6)return;let me=C(q,I),pe=I.source;t.bindTexture(n.TEXTURE_CUBE_MAP,q.__webglTexture,n.TEXTURE0+ee);let ge=i.get(pe);if(pe.version!==ge.__version||me===!0){t.activeTexture(n.TEXTURE0+ee);let xe=Ut.getPrimaries(Ut.workingColorSpace),we=I.colorSpace===Nn?null:Ut.getPrimaries(I.colorSpace),_e=I.colorSpace===Nn||xe===we?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,_e);let Ie=I.isCompressedTexture||I.image[0].isCompressedTexture,Be=I.image[0]&&I.image[0].isDataTexture,Ae=[];for(let Ce=0;Ce<6;Ce++)!Ie&&!Be?Ae[Ce]=v(I.image[Ce],!1,!0,r.maxCubemapSize):Ae[Ce]=Be?I.image[Ce].image:I.image[Ce],Ae[Ce]=H(I,Ae[Ce]);let it=Ae[0],se=g(it)||a,Le=s.convert(I.format,I.colorSpace),Ee=s.convert(I.type),ke=_(I.internalFormat,Le,Ee,I.colorSpace),We=a&&I.isVideoTexture!==!0,Qe=ge.__version===void 0||me===!0,rt=w(I,it,se);P(n.TEXTURE_CUBE_MAP,I,se);let Oe;if(Ie){We&&Qe&&t.texStorage2D(n.TEXTURE_CUBE_MAP,rt,ke,it.width,it.height);for(let Ce=0;Ce<6;Ce++){Oe=Ae[Ce].mipmaps;for(let le=0;le<Oe.length;le++){let Pe=Oe[le];I.format!==Bn?Le!==null?We?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le,0,0,Pe.width,Pe.height,Le,Pe.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le,ke,Pe.width,Pe.height,0,Pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):We?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le,0,0,Pe.width,Pe.height,Le,Ee,Pe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le,ke,Pe.width,Pe.height,0,Le,Ee,Pe.data)}}}else{Oe=I.mipmaps,We&&Qe&&(Oe.length>0&&rt++,t.texStorage2D(n.TEXTURE_CUBE_MAP,rt,ke,Ae[0].width,Ae[0].height));for(let Ce=0;Ce<6;Ce++)if(Be){We?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,Ae[Ce].width,Ae[Ce].height,Le,Ee,Ae[Ce].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,ke,Ae[Ce].width,Ae[Ce].height,0,Le,Ee,Ae[Ce].data);for(let le=0;le<Oe.length;le++){let Pe=Oe[le].image[Ce].image;We?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le+1,0,0,Pe.width,Pe.height,Le,Ee,Pe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le+1,ke,Pe.width,Pe.height,0,Le,Ee,Pe.data)}}else{We?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,Le,Ee,Ae[Ce]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,ke,Le,Ee,Ae[Ce]);for(let le=0;le<Oe.length;le++){let Pe=Oe[le];We?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le+1,0,0,Le,Ee,Pe.image[Ce]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,le+1,ke,Le,Ee,Pe.image[Ce])}}}x(I,se)&&y(n.TEXTURE_CUBE_MAP),ge.__version=pe.version,I.onUpdate&&I.onUpdate(I)}q.__version=I.version}function k(q,I,ee,me,pe,ge){let xe=s.convert(ee.format,ee.colorSpace),we=s.convert(ee.type),_e=_(ee.internalFormat,xe,we,ee.colorSpace);if(!i.get(I).__hasExternalTextures){let Ie=Math.max(1,I.width>>ge),Be=Math.max(1,I.height>>ge);pe===n.TEXTURE_3D||pe===n.TEXTURE_2D_ARRAY?t.texImage3D(pe,ge,_e,Ie,Be,I.depth,0,xe,we,null):t.texImage2D(pe,ge,_e,Ie,Be,0,xe,we,null)}t.bindFramebuffer(n.FRAMEBUFFER,q),j(I)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,me,pe,i.get(ee).__webglTexture,0,te(I)):(pe===n.TEXTURE_2D||pe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&pe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,me,pe,i.get(ee).__webglTexture,ge),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Q(q,I,ee){if(n.bindRenderbuffer(n.RENDERBUFFER,q),I.depthBuffer&&!I.stencilBuffer){let me=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ee||j(I)){let pe=I.depthTexture;pe&&pe.isDepthTexture&&(pe.type===ro?me=n.DEPTH_COMPONENT32F:pe.type===Uo&&(me=n.DEPTH_COMPONENT24));let ge=te(I);j(I)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ge,me,I.width,I.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ge,me,I.width,I.height)}else n.renderbufferStorage(n.RENDERBUFFER,me,I.width,I.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,q)}else if(I.depthBuffer&&I.stencilBuffer){let me=te(I);ee&&j(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,me,n.DEPTH24_STENCIL8,I.width,I.height):j(I)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,me,n.DEPTH24_STENCIL8,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,q)}else{let me=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let pe=0;pe<me.length;pe++){let ge=me[pe],xe=s.convert(ge.format,ge.colorSpace),we=s.convert(ge.type),_e=_(ge.internalFormat,xe,we,ge.colorSpace),Ie=te(I);ee&&j(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ie,_e,I.width,I.height):j(I)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ie,_e,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,_e,I.width,I.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Y(q,I){if(I&&I.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,q),!(I.depthTexture&&I.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(I.depthTexture).__webglTexture||I.depthTexture.image.width!==I.width||I.depthTexture.image.height!==I.height)&&(I.depthTexture.image.width=I.width,I.depthTexture.image.height=I.height,I.depthTexture.needsUpdate=!0),J(I.depthTexture,0);let ee=i.get(I.depthTexture).__webglTexture,me=te(I);if(I.depthTexture.format===rl)j(I)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ee,0,me):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ee,0);else if(I.depthTexture.format===Gc)j(I)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ee,0,me):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ee,0);else throw new Error("Unknown depthTexture format")}function re(q){let I=i.get(q),ee=q.isWebGLCubeRenderTarget===!0;if(q.depthTexture&&!I.__autoAllocateDepthBuffer){if(ee)throw new Error("target.depthTexture not supported in Cube render targets");Y(I.__webglFramebuffer,q)}else if(ee){I.__webglDepthbuffer=[];for(let me=0;me<6;me++)t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer[me]),I.__webglDepthbuffer[me]=n.createRenderbuffer(),Q(I.__webglDepthbuffer[me],q,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer),I.__webglDepthbuffer=n.createRenderbuffer(),Q(I.__webglDepthbuffer,q,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Z(q,I,ee){let me=i.get(q);I!==void 0&&k(me.__webglFramebuffer,q,q.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ee!==void 0&&re(q)}function V(q){let I=q.texture,ee=i.get(q),me=i.get(I);q.addEventListener("dispose",A),q.isWebGLMultipleRenderTargets!==!0&&(me.__webglTexture===void 0&&(me.__webglTexture=n.createTexture()),me.__version=I.version,o.memory.textures++);let pe=q.isWebGLCubeRenderTarget===!0,ge=q.isWebGLMultipleRenderTargets===!0,xe=g(q)||a;if(pe){ee.__webglFramebuffer=[];for(let we=0;we<6;we++)if(a&&I.mipmaps&&I.mipmaps.length>0){ee.__webglFramebuffer[we]=[];for(let _e=0;_e<I.mipmaps.length;_e++)ee.__webglFramebuffer[we][_e]=n.createFramebuffer()}else ee.__webglFramebuffer[we]=n.createFramebuffer()}else{if(a&&I.mipmaps&&I.mipmaps.length>0){ee.__webglFramebuffer=[];for(let we=0;we<I.mipmaps.length;we++)ee.__webglFramebuffer[we]=n.createFramebuffer()}else ee.__webglFramebuffer=n.createFramebuffer();if(ge)if(r.drawBuffers){let we=q.texture;for(let _e=0,Ie=we.length;_e<Ie;_e++){let Be=i.get(we[_e]);Be.__webglTexture===void 0&&(Be.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&q.samples>0&&j(q)===!1){let we=ge?I:[I];ee.__webglMultisampledFramebuffer=n.createFramebuffer(),ee.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ee.__webglMultisampledFramebuffer);for(let _e=0;_e<we.length;_e++){let Ie=we[_e];ee.__webglColorRenderbuffer[_e]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ee.__webglColorRenderbuffer[_e]);let Be=s.convert(Ie.format,Ie.colorSpace),Ae=s.convert(Ie.type),it=_(Ie.internalFormat,Be,Ae,Ie.colorSpace,q.isXRRenderTarget===!0),se=te(q);n.renderbufferStorageMultisample(n.RENDERBUFFER,se,it,q.width,q.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+_e,n.RENDERBUFFER,ee.__webglColorRenderbuffer[_e])}n.bindRenderbuffer(n.RENDERBUFFER,null),q.depthBuffer&&(ee.__webglDepthRenderbuffer=n.createRenderbuffer(),Q(ee.__webglDepthRenderbuffer,q,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(pe){t.bindTexture(n.TEXTURE_CUBE_MAP,me.__webglTexture),P(n.TEXTURE_CUBE_MAP,I,xe);for(let we=0;we<6;we++)if(a&&I.mipmaps&&I.mipmaps.length>0)for(let _e=0;_e<I.mipmaps.length;_e++)k(ee.__webglFramebuffer[we][_e],q,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+we,_e);else k(ee.__webglFramebuffer[we],q,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+we,0);x(I,xe)&&y(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ge){let we=q.texture;for(let _e=0,Ie=we.length;_e<Ie;_e++){let Be=we[_e],Ae=i.get(Be);t.bindTexture(n.TEXTURE_2D,Ae.__webglTexture),P(n.TEXTURE_2D,Be,xe),k(ee.__webglFramebuffer,q,Be,n.COLOR_ATTACHMENT0+_e,n.TEXTURE_2D,0),x(Be,xe)&&y(n.TEXTURE_2D)}t.unbindTexture()}else{let we=n.TEXTURE_2D;if((q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(a?we=q.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(we,me.__webglTexture),P(we,I,xe),a&&I.mipmaps&&I.mipmaps.length>0)for(let _e=0;_e<I.mipmaps.length;_e++)k(ee.__webglFramebuffer[_e],q,I,n.COLOR_ATTACHMENT0,we,_e);else k(ee.__webglFramebuffer,q,I,n.COLOR_ATTACHMENT0,we,0);x(I,xe)&&y(we),t.unbindTexture()}q.depthBuffer&&re(q)}function ne(q){let I=g(q)||a,ee=q.isWebGLMultipleRenderTargets===!0?q.texture:[q.texture];for(let me=0,pe=ee.length;me<pe;me++){let ge=ee[me];if(x(ge,I)){let xe=q.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,we=i.get(ge).__webglTexture;t.bindTexture(xe,we),y(xe),t.unbindTexture()}}}function ie(q){if(a&&q.samples>0&&j(q)===!1){let I=q.isWebGLMultipleRenderTargets?q.texture:[q.texture],ee=q.width,me=q.height,pe=n.COLOR_BUFFER_BIT,ge=[],xe=q.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,we=i.get(q),_e=q.isWebGLMultipleRenderTargets===!0;if(_e)for(let Ie=0;Ie<I.length;Ie++)t.bindFramebuffer(n.FRAMEBUFFER,we.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ie,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,we.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ie,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,we.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,we.__webglFramebuffer);for(let Ie=0;Ie<I.length;Ie++){ge.push(n.COLOR_ATTACHMENT0+Ie),q.depthBuffer&&ge.push(xe);let Be=we.__ignoreDepthValues!==void 0?we.__ignoreDepthValues:!1;if(Be===!1&&(q.depthBuffer&&(pe|=n.DEPTH_BUFFER_BIT),q.stencilBuffer&&(pe|=n.STENCIL_BUFFER_BIT)),_e&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,we.__webglColorRenderbuffer[Ie]),Be===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[xe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[xe])),_e){let Ae=i.get(I[Ie]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ae,0)}n.blitFramebuffer(0,0,ee,me,0,0,ee,me,pe,n.NEAREST),c&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ge)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),_e)for(let Ie=0;Ie<I.length;Ie++){t.bindFramebuffer(n.FRAMEBUFFER,we.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ie,n.RENDERBUFFER,we.__webglColorRenderbuffer[Ie]);let Be=i.get(I[Ie]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,we.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ie,n.TEXTURE_2D,Be,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,we.__webglMultisampledFramebuffer)}}function te(q){return Math.min(r.maxSamples,q.samples)}function j(q){let I=i.get(q);return a&&q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&I.__useRenderToTexture!==!1}function W(q){let I=o.render.frame;u.get(q)!==I&&(u.set(q,I),q.update())}function H(q,I){let ee=q.colorSpace,me=q.format,pe=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||q.format===Wv||ee!==Ui&&ee!==Nn&&(Ut.getTransfer(ee)===Qt?a===!1?e.has("EXT_sRGB")===!0&&me===Bn?(q.format=Wv,q.minFilter=fr,q.generateMipmaps=!1):I=Rf.sRGBToLinear(I):(me!==Bn||pe!==jo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ee)),I}this.allocateTextureUnit=L,this.resetTextureUnits=z,this.setTexture2D=J,this.setTexture2DArray=X,this.setTexture3D=N,this.setTextureCube=U,this.rebindTextures=Z,this.setupRenderTarget=V,this.updateRenderTargetMipmap=ne,this.updateMultisampleRenderTarget=ie,this.setupDepthRenderbuffer=re,this.setupFrameBufferTexture=k,this.useMultisampledRTT=j}function iU(n,e,t){let i=t.isWebGL2;function r(s,o=Nn){let a,l=Ut.getTransfer(o);if(s===jo)return n.UNSIGNED_BYTE;if(s===TM)return n.UNSIGNED_SHORT_4_4_4_4;if(s===MM)return n.UNSIGNED_SHORT_5_5_5_1;if(s===kR)return n.BYTE;if(s===UR)return n.SHORT;if(s===A1)return n.UNSIGNED_SHORT;if(s===EM)return n.INT;if(s===Uo)return n.UNSIGNED_INT;if(s===ro)return n.FLOAT;if(s===Lh)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===zR)return n.ALPHA;if(s===Bn)return n.RGBA;if(s===BR)return n.LUMINANCE;if(s===NR)return n.LUMINANCE_ALPHA;if(s===rl)return n.DEPTH_COMPONENT;if(s===Gc)return n.DEPTH_STENCIL;if(s===Wv)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===GR)return n.RED;if(s===AM)return n.RED_INTEGER;if(s===VR)return n.RG;if(s===CM)return n.RG_INTEGER;if(s===DM)return n.RGBA_INTEGER;if(s===A0||s===C0||s===D0||s===P0)if(l===Qt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===A0)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===C0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===D0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===P0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===A0)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===C0)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===D0)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===P0)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===OS||s===IS||s===FS||s===kS)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===OS)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===IS)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===FS)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===kS)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===PM)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===US||s===zS)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===US)return l===Qt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===zS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===BS||s===NS||s===GS||s===VS||s===HS||s===WS||s===qS||s===jS||s===XS||s===YS||s===$S||s===KS||s===ZS||s===JS)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===BS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===NS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===GS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===VS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===HS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===WS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===qS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===jS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===XS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===YS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===$S)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===KS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===ZS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===JS)return l===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===R0||s===QS||s===eE)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===R0)return l===Qt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===QS)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===eE)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===HR||s===tE||s===iE||s===rE)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===R0)return a.COMPRESSED_RED_RGTC1_EXT;if(s===tE)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===iE)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===rE)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===il?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}var iy=class extends tr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},vt=class extends bi{constructor(){super(),this.isGroup=!0,this.type="Group"}},rU={type:"move"},fh=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new vt,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new vt,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new oe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new oe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new vt,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new oe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new oe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null,a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(let v of e.hand.values()){let g=t.getJointPose(v,i),m=this._getHandJoint(c,v);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=g!==null}let u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],d=u.position.distanceTo(h.position),p=.02,f=.005;c.inputState.pinching&&d>p+f?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=p-f&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(rU)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new vt;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},ry=class extends lo{constructor(e,t){super();let i=this,r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,h=null,d=null,p=null,f=null,v=t.getContextAttributes(),g=null,m=null,x=[],y=[],_=new Me,w=null,b=new tr;b.layers.enable(1),b.viewport=new zt;let T=new tr;T.layers.enable(2),T.viewport=new zt;let A=[b,T],S=new iy;S.layers.enable(1),S.layers.enable(2);let E=null,R=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(P){let C=x[P];return C===void 0&&(C=new fh,x[P]=C),C.getTargetRaySpace()},this.getControllerGrip=function(P){let C=x[P];return C===void 0&&(C=new fh,x[P]=C),C.getGripSpace()},this.getHand=function(P){let C=x[P];return C===void 0&&(C=new fh,x[P]=C),C.getHandSpace()};function D(P){let C=y.indexOf(P.inputSource);if(C===-1)return;let M=x[C];M!==void 0&&(M.update(P.inputSource,P.frame,c||o),M.dispatchEvent({type:P.type,data:P.inputSource}))}function z(){r.removeEventListener("select",D),r.removeEventListener("selectstart",D),r.removeEventListener("selectend",D),r.removeEventListener("squeeze",D),r.removeEventListener("squeezestart",D),r.removeEventListener("squeezeend",D),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",L);for(let P=0;P<x.length;P++){let C=y[P];C!==null&&(y[P]=null,x[P].disconnect(C))}E=null,R=null,e.setRenderTarget(g),p=null,d=null,h=null,r=null,m=null,$.stop(),i.isPresenting=!1,e.setPixelRatio(w),e.setSize(_.width,_.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(P){s=P,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(P){a=P,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(P){c=P},this.getBaseLayer=function(){return d!==null?d:p},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(P){if(r=P,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",D),r.addEventListener("selectstart",D),r.addEventListener("selectend",D),r.addEventListener("squeeze",D),r.addEventListener("squeezestart",D),r.addEventListener("squeezeend",D),r.addEventListener("end",z),r.addEventListener("inputsourceschange",L),v.xrCompatible!==!0&&await t.makeXRCompatible(),w=e.getPixelRatio(),e.getSize(_),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let C={antialias:r.renderState.layers===void 0?v.antialias:!0,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(r,t,C),r.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),m=new co(p.framebufferWidth,p.framebufferHeight,{format:Bn,type:jo,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let C=null,M=null,B=null;v.depth&&(B=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,C=v.stencil?Gc:rl,M=v.stencil?il:Uo);let k={colorFormat:t.RGBA8,depthFormat:B,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(k),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),m=new co(d.textureWidth,d.textureHeight,{format:Bn,type:jo,depthTexture:new zf(d.textureWidth,d.textureHeight,M,void 0,void 0,void 0,void 0,void 0,void 0,C),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0});let Q=e.properties.get(m);Q.__ignoreDepthValues=d.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),$.setContext(r),$.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function L(P){for(let C=0;C<P.removed.length;C++){let M=P.removed[C],B=y.indexOf(M);B>=0&&(y[B]=null,x[B].disconnect(M))}for(let C=0;C<P.added.length;C++){let M=P.added[C],B=y.indexOf(M);if(B===-1){for(let Q=0;Q<x.length;Q++)if(Q>=y.length){y.push(M),B=Q;break}else if(y[Q]===null){y[Q]=M,B=Q;break}if(B===-1)break}let k=x[B];k&&k.connect(M)}}let G=new oe,J=new oe;function X(P,C,M){G.setFromMatrixPosition(C.matrixWorld),J.setFromMatrixPosition(M.matrixWorld);let B=G.distanceTo(J),k=C.projectionMatrix.elements,Q=M.projectionMatrix.elements,Y=k[14]/(k[10]-1),re=k[14]/(k[10]+1),Z=(k[9]+1)/k[5],V=(k[9]-1)/k[5],ne=(k[8]-1)/k[0],ie=(Q[8]+1)/Q[0],te=Y*ne,j=Y*ie,W=B/(-ne+ie),H=W*-ne;C.matrixWorld.decompose(P.position,P.quaternion,P.scale),P.translateX(H),P.translateZ(W),P.matrixWorld.compose(P.position,P.quaternion,P.scale),P.matrixWorldInverse.copy(P.matrixWorld).invert();let q=Y+W,I=re+W,ee=te-H,me=j+(B-H),pe=Z*re/I*q,ge=V*re/I*q;P.projectionMatrix.makePerspective(ee,me,pe,ge,q,I),P.projectionMatrixInverse.copy(P.projectionMatrix).invert()}function N(P,C){C===null?P.matrixWorld.copy(P.matrix):P.matrixWorld.multiplyMatrices(C.matrixWorld,P.matrix),P.matrixWorldInverse.copy(P.matrixWorld).invert()}this.updateCamera=function(P){if(r===null)return;S.near=T.near=b.near=P.near,S.far=T.far=b.far=P.far,(E!==S.near||R!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),E=S.near,R=S.far);let C=P.parent,M=S.cameras;N(S,C);for(let B=0;B<M.length;B++)N(M[B],C);M.length===2?X(S,b,T):S.projectionMatrix.copy(b.projectionMatrix),U(P,S,C)};function U(P,C,M){M===null?P.matrix.copy(C.matrixWorld):(P.matrix.copy(M.matrixWorld),P.matrix.invert(),P.matrix.multiply(C.matrixWorld)),P.matrix.decompose(P.position,P.quaternion,P.scale),P.updateMatrixWorld(!0),P.projectionMatrix.copy(C.projectionMatrix),P.projectionMatrixInverse.copy(C.projectionMatrixInverse),P.isPerspectiveCamera&&(P.fov=Hc*2*Math.atan(1/P.projectionMatrix.elements[5]),P.zoom=1)}this.getCamera=function(){return S},this.getFoveation=function(){if(!(d===null&&p===null))return l},this.setFoveation=function(P){l=P,d!==null&&(d.fixedFoveation=P),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=P)};let O=null;function F(P,C){if(u=C.getViewerPose(c||o),f=C,u!==null){let M=u.views;p!==null&&(e.setRenderTargetFramebuffer(m,p.framebuffer),e.setRenderTarget(m));let B=!1;M.length!==S.cameras.length&&(S.cameras.length=0,B=!0);for(let k=0;k<M.length;k++){let Q=M[k],Y=null;if(p!==null)Y=p.getViewport(Q);else{let Z=h.getViewSubImage(d,Q);Y=Z.viewport,k===0&&(e.setRenderTargetTextures(m,Z.colorTexture,d.ignoreDepthValues?void 0:Z.depthStencilTexture),e.setRenderTarget(m))}let re=A[k];re===void 0&&(re=new tr,re.layers.enable(k),re.viewport=new zt,A[k]=re),re.matrix.fromArray(Q.transform.matrix),re.matrix.decompose(re.position,re.quaternion,re.scale),re.projectionMatrix.fromArray(Q.projectionMatrix),re.projectionMatrixInverse.copy(re.projectionMatrix).invert(),re.viewport.set(Y.x,Y.y,Y.width,Y.height),k===0&&(S.matrix.copy(re.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),B===!0&&S.cameras.push(re)}}for(let M=0;M<x.length;M++){let B=y[M],k=x[M];B!==null&&k!==void 0&&k.update(B,C,c||o)}O&&O(P,C),C.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:C}),f=null}let $=new GM;$.setAnimationLoop(F),this.setAnimationLoop=function(P){O=P},this.dispose=function(){}}};function nU(n,e){function t(g,m){g.matrixAutoUpdate===!0&&g.updateMatrix(),m.value.copy(g.matrix)}function i(g,m){m.color.getRGB(g.fogColor.value,BM(n)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function r(g,m,x,y,_){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),h(g,m)):m.isMeshPhongMaterial?(s(g,m),u(g,m)):m.isMeshStandardMaterial?(s(g,m),d(g,m),m.isMeshPhysicalMaterial&&p(g,m,_)):m.isMeshMatcapMaterial?(s(g,m),f(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),v(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(o(g,m),m.isLineDashedMaterial&&a(g,m)):m.isPointsMaterial?l(g,m,x,y):m.isSpriteMaterial?c(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===Br&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===Br&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let x=e.get(m).envMap;if(x&&(g.envMap.value=x,g.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;let y=n._useLegacyLights===!0?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*y,t(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function l(g,m,x,y){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*x,g.scale.value=y*.5,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function c(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function u(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function h(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function d(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function p(g,m,x){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===Br&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=x.texture,g.transmissionSamplerSize.value.set(x.width,x.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}function f(g,m){m.matcap&&(g.matcap.value=m.matcap)}function v(g,m){let x=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(x.matrixWorld),g.nearDistance.value=x.shadow.camera.near,g.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function sU(n,e,t,i){let r={},s={},o=[],a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(x,y){let _=y.program;i.uniformBlockBinding(x,_)}function c(x,y){let _=r[x.id];_===void 0&&(f(x),_=u(x),r[x.id]=_,x.addEventListener("dispose",g));let w=y.program;i.updateUBOMapping(x,w);let b=e.render.frame;s[x.id]!==b&&(d(x),s[x.id]=b)}function u(x){let y=h();x.__bindingPointIndex=y;let _=n.createBuffer(),w=x.__size,b=x.usage;return n.bindBuffer(n.UNIFORM_BUFFER,_),n.bufferData(n.UNIFORM_BUFFER,w,b),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,_),_}function h(){for(let x=0;x<a;x++)if(o.indexOf(x)===-1)return o.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(x){let y=r[x.id],_=x.uniforms,w=x.__cache;n.bindBuffer(n.UNIFORM_BUFFER,y);for(let b=0,T=_.length;b<T;b++){let A=Array.isArray(_[b])?_[b]:[_[b]];for(let S=0,E=A.length;S<E;S++){let R=A[S];if(p(R,b,S,w)===!0){let D=R.__offset,z=Array.isArray(R.value)?R.value:[R.value],L=0;for(let G=0;G<z.length;G++){let J=z[G],X=v(J);typeof J=="number"||typeof J=="boolean"?(R.__data[0]=J,n.bufferSubData(n.UNIFORM_BUFFER,D+L,R.__data)):J.isMatrix3?(R.__data[0]=J.elements[0],R.__data[1]=J.elements[1],R.__data[2]=J.elements[2],R.__data[3]=0,R.__data[4]=J.elements[3],R.__data[5]=J.elements[4],R.__data[6]=J.elements[5],R.__data[7]=0,R.__data[8]=J.elements[6],R.__data[9]=J.elements[7],R.__data[10]=J.elements[8],R.__data[11]=0):(J.toArray(R.__data,L),L+=X.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,D,R.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function p(x,y,_,w){let b=x.value,T=y+"_"+_;if(w[T]===void 0)return typeof b=="number"||typeof b=="boolean"?w[T]=b:w[T]=b.clone(),!0;{let A=w[T];if(typeof b=="number"||typeof b=="boolean"){if(A!==b)return w[T]=b,!0}else if(A.equals(b)===!1)return A.copy(b),!0}return!1}function f(x){let y=x.uniforms,_=0,w=16;for(let T=0,A=y.length;T<A;T++){let S=Array.isArray(y[T])?y[T]:[y[T]];for(let E=0,R=S.length;E<R;E++){let D=S[E],z=Array.isArray(D.value)?D.value:[D.value];for(let L=0,G=z.length;L<G;L++){let J=z[L],X=v(J),N=_%w;N!==0&&w-N<X.boundary&&(_+=w-N),D.__data=new Float32Array(X.storage/Float32Array.BYTES_PER_ELEMENT),D.__offset=_,_+=X.storage}}}let b=_%w;return b>0&&(_+=w-b),x.__size=_,x.__cache={},this}function v(x){let y={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(y.boundary=4,y.storage=4):x.isVector2?(y.boundary=8,y.storage=8):x.isVector3||x.isColor?(y.boundary=16,y.storage=12):x.isVector4?(y.boundary=16,y.storage=16):x.isMatrix3?(y.boundary=48,y.storage=48):x.isMatrix4?(y.boundary=64,y.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),y}function g(x){let y=x.target;y.removeEventListener("dispose",g);let _=o.indexOf(y.__bindingPointIndex);o.splice(_,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}function m(){for(let x in r)n.deleteBuffer(r[x]);o=[],r={},s={}}return{bind:l,update:c,dispose:m}}var Bh=class{constructor(e={}){let{canvas:t=mL(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;i!==null?d=i.getContextAttributes().alpha:d=o;let p=new Uint32Array(4),f=new Int32Array(4),v=null,g=null,m=[],x=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Ht,this._useLegacyLights=!1,this.toneMapping=qo,this.toneMappingExposure=1;let y=this,_=!1,w=0,b=0,T=null,A=-1,S=null,E=new zt,R=new zt,D=null,z=new at(0),L=0,G=t.width,J=t.height,X=1,N=null,U=null,O=new zt(0,0,G,J),F=new zt(0,0,G,J),$=!1,P=new Uh,C=!1,M=!1,B=null,k=new Et,Q=new Me,Y=new oe,re={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Z(){return T===null?X:1}let V=i;function ne(K,he){for(let ye=0;ye<K.length;ye++){let ae=K[ye],fe=t.getContext(ae,he);if(fe!==null)return fe}return null}try{let K={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${T1}`),t.addEventListener("webglcontextlost",Ce,!1),t.addEventListener("webglcontextrestored",le,!1),t.addEventListener("webglcontextcreationerror",Pe,!1),V===null){let he=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&he.shift(),V=ne(he,K),V===null)throw ne(he)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&V instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),V.getShaderPrecisionFormat===void 0&&(V.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(K){throw console.error("THREE.WebGLRenderer: "+K.message),K}let ie,te,j,W,H,q,I,ee,me,pe,ge,xe,we,_e,Ie,Be,Ae,it,se,Le,Ee,ke,We,Qe;function rt(){ie=new EF(V),te=new yF(V,ie,e),ie.init(te),ke=new iU(V,ie,te),j=new eU(V,ie,te),W=new AF(V),H=new Vk,q=new tU(V,ie,j,H,te,ke,W),I=new _F(y),ee=new SF(y),me=new FL(V,te),We=new gF(V,ie,me,te),pe=new TF(V,me,W,We),ge=new RF(V,pe,me,W),se=new PF(V,te,q),Be=new xF(H),xe=new Gk(y,I,ee,ie,te,We,Be),we=new nU(y,H),_e=new Wk,Ie=new Kk(ie,te),it=new mF(y,I,ee,j,ge,d,l),Ae=new Qk(y,ge,te),Qe=new sU(V,W,te,j),Le=new vF(V,ie,W,te),Ee=new MF(V,ie,W,te),W.programs=xe.programs,y.capabilities=te,y.extensions=ie,y.properties=H,y.renderLists=_e,y.shadowMap=Ae,y.state=j,y.info=W}rt();let Oe=new ry(y,V);this.xr=Oe,this.getContext=function(){return V},this.getContextAttributes=function(){return V.getContextAttributes()},this.forceContextLoss=function(){let K=ie.get("WEBGL_lose_context");K&&K.loseContext()},this.forceContextRestore=function(){let K=ie.get("WEBGL_lose_context");K&&K.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(K){K!==void 0&&(X=K,this.setSize(G,J,!1))},this.getSize=function(K){return K.set(G,J)},this.setSize=function(K,he,ye=!0){if(Oe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}G=K,J=he,t.width=Math.floor(K*X),t.height=Math.floor(he*X),ye===!0&&(t.style.width=K+"px",t.style.height=he+"px"),this.setViewport(0,0,K,he)},this.getDrawingBufferSize=function(K){return K.set(G*X,J*X).floor()},this.setDrawingBufferSize=function(K,he,ye){G=K,J=he,X=ye,t.width=Math.floor(K*ye),t.height=Math.floor(he*ye),this.setViewport(0,0,K,he)},this.getCurrentViewport=function(K){return K.copy(E)},this.getViewport=function(K){return K.copy(O)},this.setViewport=function(K,he,ye,ae){K.isVector4?O.set(K.x,K.y,K.z,K.w):O.set(K,he,ye,ae),j.viewport(E.copy(O).multiplyScalar(X).floor())},this.getScissor=function(K){return K.copy(F)},this.setScissor=function(K,he,ye,ae){K.isVector4?F.set(K.x,K.y,K.z,K.w):F.set(K,he,ye,ae),j.scissor(R.copy(F).multiplyScalar(X).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(K){j.setScissorTest($=K)},this.setOpaqueSort=function(K){N=K},this.setTransparentSort=function(K){U=K},this.getClearColor=function(K){return K.copy(it.getClearColor())},this.setClearColor=function(){it.setClearColor.apply(it,arguments)},this.getClearAlpha=function(){return it.getClearAlpha()},this.setClearAlpha=function(){it.setClearAlpha.apply(it,arguments)},this.clear=function(K=!0,he=!0,ye=!0){let ae=0;if(K){let fe=!1;if(T!==null){let Fe=T.texture.format;fe=Fe===DM||Fe===CM||Fe===AM}if(fe){let Fe=T.texture.type,tt=Fe===jo||Fe===Uo||Fe===A1||Fe===il||Fe===TM||Fe===MM,Ke=it.getClearColor(),De=it.getClearAlpha(),Xe=Ke.r,st=Ke.g,ut=Ke.b;tt?(p[0]=Xe,p[1]=st,p[2]=ut,p[3]=De,V.clearBufferuiv(V.COLOR,0,p)):(f[0]=Xe,f[1]=st,f[2]=ut,f[3]=De,V.clearBufferiv(V.COLOR,0,f))}else ae|=V.COLOR_BUFFER_BIT}he&&(ae|=V.DEPTH_BUFFER_BIT),ye&&(ae|=V.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),V.clear(ae)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ce,!1),t.removeEventListener("webglcontextrestored",le,!1),t.removeEventListener("webglcontextcreationerror",Pe,!1),_e.dispose(),Ie.dispose(),H.dispose(),I.dispose(),ee.dispose(),ge.dispose(),We.dispose(),Qe.dispose(),xe.dispose(),Oe.dispose(),Oe.removeEventListener("sessionstart",ce),Oe.removeEventListener("sessionend",ue),B&&(B.dispose(),B=null),de.stop()};function Ce(K){K.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function le(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;let K=W.autoReset,he=Ae.enabled,ye=Ae.autoUpdate,ae=Ae.needsUpdate,fe=Ae.type;rt(),W.autoReset=K,Ae.enabled=he,Ae.autoUpdate=ye,Ae.needsUpdate=ae,Ae.type=fe}function Pe(K){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",K.statusMessage)}function Ve(K){let he=K.target;he.removeEventListener("dispose",Ve),et(he)}function et(K){Je(K),H.remove(K)}function Je(K){let he=H.get(K).programs;he!==void 0&&(he.forEach(function(ye){xe.releaseProgram(ye)}),K.isShaderMaterial&&xe.releaseShaderCache(K))}this.renderBufferDirect=function(K,he,ye,ae,fe,Fe){he===null&&(he=re);let tt=fe.isMesh&&fe.matrixWorld.determinant()<0,Ke=$e(K,he,ye,ae,fe);j.setMaterial(ae,tt);let De=ye.index,Xe=1;if(ae.wireframe===!0){if(De=pe.getWireframeAttribute(ye),De===void 0)return;Xe=2}let st=ye.drawRange,ut=ye.attributes.position,Ct=st.start*Xe,bt=(st.start+st.count)*Xe;Fe!==null&&(Ct=Math.max(Ct,Fe.start*Xe),bt=Math.min(bt,(Fe.start+Fe.count)*Xe)),De!==null?(Ct=Math.max(Ct,0),bt=Math.min(bt,De.count)):ut!=null&&(Ct=Math.max(Ct,0),bt=Math.min(bt,ut.count));let yt=bt-Ct;if(yt<0||yt===1/0)return;We.setup(fe,ae,Ke,ye,De);let ft,St=Le;if(De!==null&&(ft=me.get(De),St=Ee,St.setIndex(ft)),fe.isMesh)ae.wireframe===!0?(j.setLineWidth(ae.wireframeLinewidth*Z()),St.setMode(V.LINES)):St.setMode(V.TRIANGLES);else if(fe.isLine){let ot=ae.linewidth;ot===void 0&&(ot=1),j.setLineWidth(ot*Z()),fe.isLineSegments?St.setMode(V.LINES):fe.isLineLoop?St.setMode(V.LINE_LOOP):St.setMode(V.LINE_STRIP)}else fe.isPoints?St.setMode(V.POINTS):fe.isSprite&&St.setMode(V.TRIANGLES);if(fe.isBatchedMesh)St.renderMultiDraw(fe._multiDrawStarts,fe._multiDrawCounts,fe._multiDrawCount);else if(fe.isInstancedMesh)St.renderInstances(Ct,yt,fe.count);else if(ye.isInstancedBufferGeometry){let ot=ye._maxInstanceCount!==void 0?ye._maxInstanceCount:1/0,pt=Math.min(ye.instanceCount,ot);St.renderInstances(Ct,yt,pt)}else St.render(Ct,yt)};function Te(K,he,ye){K.transparent===!0&&K.side===Kr&&K.forceSinglePass===!1?(K.side=Br,K.needsUpdate=!0,ve(K,he,ye),K.side=Di,K.needsUpdate=!0,ve(K,he,ye),K.side=Kr):ve(K,he,ye)}this.compile=function(K,he,ye=null){ye===null&&(ye=K),g=Ie.get(ye),g.init(),x.push(g),ye.traverseVisible(function(fe){fe.isLight&&fe.layers.test(he.layers)&&(g.pushLight(fe),fe.castShadow&&g.pushShadow(fe))}),K!==ye&&K.traverseVisible(function(fe){fe.isLight&&fe.layers.test(he.layers)&&(g.pushLight(fe),fe.castShadow&&g.pushShadow(fe))}),g.setupLights(y._useLegacyLights);let ae=new Set;return K.traverse(function(fe){let Fe=fe.material;if(Fe)if(Array.isArray(Fe))for(let tt=0;tt<Fe.length;tt++){let Ke=Fe[tt];Te(Ke,ye,fe),ae.add(Ke)}else Te(Fe,ye,fe),ae.add(Fe)}),x.pop(),g=null,ae},this.compileAsync=function(K,he,ye=null){let ae=this.compile(K,he,ye);return new Promise(fe=>{function Fe(){if(ae.forEach(function(tt){H.get(tt).currentProgram.isReady()&&ae.delete(tt)}),ae.size===0){fe(K);return}setTimeout(Fe,10)}ie.get("KHR_parallel_shader_compile")!==null?Fe():setTimeout(Fe,10)})};let Ze=null;function Se(K){Ze&&Ze(K)}function ce(){de.stop()}function ue(){de.start()}let de=new GM;de.setAnimationLoop(Se),typeof self<"u"&&de.setContext(self),this.setAnimationLoop=function(K){Ze=K,Oe.setAnimationLoop(K),K===null?de.stop():de.start()},Oe.addEventListener("sessionstart",ce),Oe.addEventListener("sessionend",ue),this.render=function(K,he){if(he!==void 0&&he.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),he.parent===null&&he.matrixWorldAutoUpdate===!0&&he.updateMatrixWorld(),Oe.enabled===!0&&Oe.isPresenting===!0&&(Oe.cameraAutoUpdate===!0&&Oe.updateCamera(he),he=Oe.getCamera()),K.isScene===!0&&K.onBeforeRender(y,K,he,T),g=Ie.get(K,x.length),g.init(),x.push(g),k.multiplyMatrices(he.projectionMatrix,he.matrixWorldInverse),P.setFromProjectionMatrix(k),M=this.localClippingEnabled,C=Be.init(this.clippingPlanes,M),v=_e.get(K,m.length),v.init(),m.push(v),be(K,he,0,y.sortObjects),v.finish(),y.sortObjects===!0&&v.sort(N,U),this.info.render.frame++,C===!0&&Be.beginShadows();let ye=g.state.shadowsArray;if(Ae.render(ye,K,he),C===!0&&Be.endShadows(),this.info.autoReset===!0&&this.info.reset(),it.render(v,K),g.setupLights(y._useLegacyLights),he.isArrayCamera){let ae=he.cameras;for(let fe=0,Fe=ae.length;fe<Fe;fe++){let tt=ae[fe];Ue(v,K,tt,tt.viewport)}}else Ue(v,K,he);T!==null&&(q.updateMultisampleRenderTarget(T),q.updateRenderTargetMipmap(T)),K.isScene===!0&&K.onAfterRender(y,K,he),We.resetDefaultState(),A=-1,S=null,x.pop(),x.length>0?g=x[x.length-1]:g=null,m.pop(),m.length>0?v=m[m.length-1]:v=null};function be(K,he,ye,ae){if(K.visible===!1)return;if(K.layers.test(he.layers)){if(K.isGroup)ye=K.renderOrder;else if(K.isLOD)K.autoUpdate===!0&&K.update(he);else if(K.isLight)g.pushLight(K),K.castShadow&&g.pushShadow(K);else if(K.isSprite){if(!K.frustumCulled||P.intersectsSprite(K)){ae&&Y.setFromMatrixPosition(K.matrixWorld).applyMatrix4(k);let Fe=ge.update(K),tt=K.material;tt.visible&&v.push(K,Fe,tt,ye,Y.z,null)}}else if((K.isMesh||K.isLine||K.isPoints)&&(!K.frustumCulled||P.intersectsObject(K))){let Fe=ge.update(K),tt=K.material;if(ae&&(K.boundingSphere!==void 0?(K.boundingSphere===null&&K.computeBoundingSphere(),Y.copy(K.boundingSphere.center)):(Fe.boundingSphere===null&&Fe.computeBoundingSphere(),Y.copy(Fe.boundingSphere.center)),Y.applyMatrix4(K.matrixWorld).applyMatrix4(k)),Array.isArray(tt)){let Ke=Fe.groups;for(let De=0,Xe=Ke.length;De<Xe;De++){let st=Ke[De],ut=tt[st.materialIndex];ut&&ut.visible&&v.push(K,Fe,ut,ye,Y.z,st)}}else tt.visible&&v.push(K,Fe,tt,ye,Y.z,null)}}let fe=K.children;for(let Fe=0,tt=fe.length;Fe<tt;Fe++)be(fe[Fe],he,ye,ae)}function Ue(K,he,ye,ae){let fe=K.opaque,Fe=K.transmissive,tt=K.transparent;g.setupLightsView(ye),C===!0&&Be.setGlobalState(y.clippingPlanes,ye),Fe.length>0&&Re(fe,Fe,he,ye),ae&&j.viewport(E.copy(ae)),fe.length>0&&Ge(fe,he,ye),Fe.length>0&&Ge(Fe,he,ye),tt.length>0&&Ge(tt,he,ye),j.buffers.depth.setTest(!0),j.buffers.depth.setMask(!0),j.buffers.color.setMask(!0),j.setPolygonOffset(!1)}function Re(K,he,ye,ae){if((ye.isScene===!0?ye.overrideMaterial:null)!==null)return;let fe=te.isWebGL2;B===null&&(B=new co(1,1,{generateMipmaps:!0,type:ie.has("EXT_color_buffer_half_float")?Lh:jo,minFilter:ml,samples:fe?4:0})),y.getDrawingBufferSize(Q),fe?B.setSize(Q.x,Q.y):B.setSize(Pf(Q.x),Pf(Q.y));let Fe=y.getRenderTarget();y.setRenderTarget(B),y.getClearColor(z),L=y.getClearAlpha(),L<1&&y.setClearColor(16777215,.5),y.clear();let tt=y.toneMapping;y.toneMapping=qo,Ge(K,ye,ae),q.updateMultisampleRenderTarget(B),q.updateRenderTargetMipmap(B);let Ke=!1;for(let De=0,Xe=he.length;De<Xe;De++){let st=he[De],ut=st.object,Ct=st.geometry,bt=st.material,yt=st.group;if(bt.side===Kr&&ut.layers.test(ae.layers)){let ft=bt.side;bt.side=Br,bt.needsUpdate=!0,ze(ut,ye,ae,Ct,bt,yt),bt.side=ft,bt.needsUpdate=!0,Ke=!0}}Ke===!0&&(q.updateMultisampleRenderTarget(B),q.updateRenderTargetMipmap(B)),y.setRenderTarget(Fe),y.setClearColor(z,L),y.toneMapping=tt}function Ge(K,he,ye){let ae=he.isScene===!0?he.overrideMaterial:null;for(let fe=0,Fe=K.length;fe<Fe;fe++){let tt=K[fe],Ke=tt.object,De=tt.geometry,Xe=ae===null?tt.material:ae,st=tt.group;Ke.layers.test(ye.layers)&&ze(Ke,he,ye,De,Xe,st)}}function ze(K,he,ye,ae,fe,Fe){K.onBeforeRender(y,he,ye,ae,fe,Fe),K.modelViewMatrix.multiplyMatrices(ye.matrixWorldInverse,K.matrixWorld),K.normalMatrix.getNormalMatrix(K.modelViewMatrix),fe.onBeforeRender(y,he,ye,ae,K,Fe),fe.transparent===!0&&fe.side===Kr&&fe.forceSinglePass===!1?(fe.side=Br,fe.needsUpdate=!0,y.renderBufferDirect(ye,he,ae,fe,K,Fe),fe.side=Di,fe.needsUpdate=!0,y.renderBufferDirect(ye,he,ae,fe,K,Fe),fe.side=Kr):y.renderBufferDirect(ye,he,ae,fe,K,Fe),K.onAfterRender(y,he,ye,ae,fe,Fe)}function ve(K,he,ye){he.isScene!==!0&&(he=re);let ae=H.get(K),fe=g.state.lights,Fe=g.state.shadowsArray,tt=fe.state.version,Ke=xe.getParameters(K,fe.state,Fe,he,ye),De=xe.getProgramCacheKey(Ke),Xe=ae.programs;ae.environment=K.isMeshStandardMaterial?he.environment:null,ae.fog=he.fog,ae.envMap=(K.isMeshStandardMaterial?ee:I).get(K.envMap||ae.environment),Xe===void 0&&(K.addEventListener("dispose",Ve),Xe=new Map,ae.programs=Xe);let st=Xe.get(De);if(st!==void 0){if(ae.currentProgram===st&&ae.lightsStateVersion===tt)return Ye(K,Ke),st}else Ke.uniforms=xe.getUniforms(K),K.onBuild(ye,Ke,y),K.onBeforeCompile(Ke,y),st=xe.acquireProgram(Ke,De),Xe.set(De,st),ae.uniforms=Ke.uniforms;let ut=ae.uniforms;return(!K.isShaderMaterial&&!K.isRawShaderMaterial||K.clipping===!0)&&(ut.clippingPlanes=Be.uniform),Ye(K,Ke),ae.needsLights=je(K),ae.lightsStateVersion=tt,ae.needsLights&&(ut.ambientLightColor.value=fe.state.ambient,ut.lightProbe.value=fe.state.probe,ut.directionalLights.value=fe.state.directional,ut.directionalLightShadows.value=fe.state.directionalShadow,ut.spotLights.value=fe.state.spot,ut.spotLightShadows.value=fe.state.spotShadow,ut.rectAreaLights.value=fe.state.rectArea,ut.ltc_1.value=fe.state.rectAreaLTC1,ut.ltc_2.value=fe.state.rectAreaLTC2,ut.pointLights.value=fe.state.point,ut.pointLightShadows.value=fe.state.pointShadow,ut.hemisphereLights.value=fe.state.hemi,ut.directionalShadowMap.value=fe.state.directionalShadowMap,ut.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,ut.spotShadowMap.value=fe.state.spotShadowMap,ut.spotLightMatrix.value=fe.state.spotLightMatrix,ut.spotLightMap.value=fe.state.spotLightMap,ut.pointShadowMap.value=fe.state.pointShadowMap,ut.pointShadowMatrix.value=fe.state.pointShadowMatrix),ae.currentProgram=st,ae.uniformsList=null,st}function Ne(K){if(K.uniformsList===null){let he=K.currentProgram.getUniforms();K.uniformsList=Rc.seqWithValue(he.seq,K.uniforms)}return K.uniformsList}function Ye(K,he){let ye=H.get(K);ye.outputColorSpace=he.outputColorSpace,ye.batching=he.batching,ye.instancing=he.instancing,ye.instancingColor=he.instancingColor,ye.skinning=he.skinning,ye.morphTargets=he.morphTargets,ye.morphNormals=he.morphNormals,ye.morphColors=he.morphColors,ye.morphTargetsCount=he.morphTargetsCount,ye.numClippingPlanes=he.numClippingPlanes,ye.numIntersection=he.numClipIntersection,ye.vertexAlphas=he.vertexAlphas,ye.vertexTangents=he.vertexTangents,ye.toneMapping=he.toneMapping}function $e(K,he,ye,ae,fe){he.isScene!==!0&&(he=re),q.resetTextureUnits();let Fe=he.fog,tt=ae.isMeshStandardMaterial?he.environment:null,Ke=T===null?y.outputColorSpace:T.isXRRenderTarget===!0?T.texture.colorSpace:Ui,De=(ae.isMeshStandardMaterial?ee:I).get(ae.envMap||tt),Xe=ae.vertexColors===!0&&!!ye.attributes.color&&ye.attributes.color.itemSize===4,st=!!ye.attributes.tangent&&(!!ae.normalMap||ae.anisotropy>0),ut=!!ye.morphAttributes.position,Ct=!!ye.morphAttributes.normal,bt=!!ye.morphAttributes.color,yt=qo;ae.toneMapped&&(T===null||T.isXRRenderTarget===!0)&&(yt=y.toneMapping);let ft=ye.morphAttributes.position||ye.morphAttributes.normal||ye.morphAttributes.color,St=ft!==void 0?ft.length:0,ot=H.get(ae),pt=g.state.lights;if(C===!0&&(M===!0||K!==S)){let Kt=K===S&&ae.id===A;Be.setState(ae,K,Kt)}let Nt=!1;ae.version===ot.__version?(ot.needsLights&&ot.lightsStateVersion!==pt.state.version||ot.outputColorSpace!==Ke||fe.isBatchedMesh&&ot.batching===!1||!fe.isBatchedMesh&&ot.batching===!0||fe.isInstancedMesh&&ot.instancing===!1||!fe.isInstancedMesh&&ot.instancing===!0||fe.isSkinnedMesh&&ot.skinning===!1||!fe.isSkinnedMesh&&ot.skinning===!0||fe.isInstancedMesh&&ot.instancingColor===!0&&fe.instanceColor===null||fe.isInstancedMesh&&ot.instancingColor===!1&&fe.instanceColor!==null||ot.envMap!==De||ae.fog===!0&&ot.fog!==Fe||ot.numClippingPlanes!==void 0&&(ot.numClippingPlanes!==Be.numPlanes||ot.numIntersection!==Be.numIntersection)||ot.vertexAlphas!==Xe||ot.vertexTangents!==st||ot.morphTargets!==ut||ot.morphNormals!==Ct||ot.morphColors!==bt||ot.toneMapping!==yt||te.isWebGL2===!0&&ot.morphTargetsCount!==St)&&(Nt=!0):(Nt=!0,ot.__version=ae.version);let di=ot.currentProgram;Nt===!0&&(di=ve(ae,he,fe));let Gt=!1,Wt=!1,ni=!1,Ft=di.getUniforms(),$t=ot.uniforms;if(j.useProgram(di.program)&&(Gt=!0,Wt=!0,ni=!0),ae.id!==A&&(A=ae.id,Wt=!0),Gt||S!==K){Ft.setValue(V,"projectionMatrix",K.projectionMatrix),Ft.setValue(V,"viewMatrix",K.matrixWorldInverse);let Kt=Ft.map.cameraPosition;Kt!==void 0&&Kt.setValue(V,Y.setFromMatrixPosition(K.matrixWorld)),te.logarithmicDepthBuffer&&Ft.setValue(V,"logDepthBufFC",2/(Math.log(K.far+1)/Math.LN2)),(ae.isMeshPhongMaterial||ae.isMeshToonMaterial||ae.isMeshLambertMaterial||ae.isMeshBasicMaterial||ae.isMeshStandardMaterial||ae.isShaderMaterial)&&Ft.setValue(V,"isOrthographic",K.isOrthographicCamera===!0),S!==K&&(S=K,Wt=!0,ni=!0)}if(fe.isSkinnedMesh){Ft.setOptional(V,fe,"bindMatrix"),Ft.setOptional(V,fe,"bindMatrixInverse");let Kt=fe.skeleton;Kt&&(te.floatVertexTextures?(Kt.boneTexture===null&&Kt.computeBoneTexture(),Ft.setValue(V,"boneTexture",Kt.boneTexture,q)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}fe.isBatchedMesh&&(Ft.setOptional(V,fe,"batchingTexture"),Ft.setValue(V,"batchingTexture",fe._matricesTexture,q));let $i=ye.morphAttributes;if(($i.position!==void 0||$i.normal!==void 0||$i.color!==void 0&&te.isWebGL2===!0)&&se.update(fe,ye,di),(Wt||ot.receiveShadow!==fe.receiveShadow)&&(ot.receiveShadow=fe.receiveShadow,Ft.setValue(V,"receiveShadow",fe.receiveShadow)),ae.isMeshGouraudMaterial&&ae.envMap!==null&&($t.envMap.value=De,$t.flipEnvMap.value=De.isCubeTexture&&De.isRenderTargetTexture===!1?-1:1),Wt&&(Ft.setValue(V,"toneMappingExposure",y.toneMappingExposure),ot.needsLights&&He($t,ni),Fe&&ae.fog===!0&&we.refreshFogUniforms($t,Fe),we.refreshMaterialUniforms($t,ae,X,J,B),Rc.upload(V,Ne(ot),$t,q)),ae.isShaderMaterial&&ae.uniformsNeedUpdate===!0&&(Rc.upload(V,Ne(ot),$t,q),ae.uniformsNeedUpdate=!1),ae.isSpriteMaterial&&Ft.setValue(V,"center",fe.center),Ft.setValue(V,"modelViewMatrix",fe.modelViewMatrix),Ft.setValue(V,"normalMatrix",fe.normalMatrix),Ft.setValue(V,"modelMatrix",fe.matrixWorld),ae.isShaderMaterial||ae.isRawShaderMaterial){let Kt=ae.uniformsGroups;for(let nn=0,fo=Kt.length;nn<fo;nn++)if(te.isWebGL2){let Ls=Kt[nn];Qe.update(Ls,di),Qe.bind(Ls,di)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return di}function He(K,he){K.ambientLightColor.needsUpdate=he,K.lightProbe.needsUpdate=he,K.directionalLights.needsUpdate=he,K.directionalLightShadows.needsUpdate=he,K.pointLights.needsUpdate=he,K.pointLightShadows.needsUpdate=he,K.spotLights.needsUpdate=he,K.spotLightShadows.needsUpdate=he,K.rectAreaLights.needsUpdate=he,K.hemisphereLights.needsUpdate=he}function je(K){return K.isMeshLambertMaterial||K.isMeshToonMaterial||K.isMeshPhongMaterial||K.isMeshStandardMaterial||K.isShadowMaterial||K.isShaderMaterial&&K.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(K,he,ye){H.get(K.texture).__webglTexture=he,H.get(K.depthTexture).__webglTexture=ye;let ae=H.get(K);ae.__hasExternalTextures=!0,ae.__hasExternalTextures&&(ae.__autoAllocateDepthBuffer=ye===void 0,ae.__autoAllocateDepthBuffer||ie.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ae.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(K,he){let ye=H.get(K);ye.__webglFramebuffer=he,ye.__useDefaultFramebuffer=he===void 0},this.setRenderTarget=function(K,he=0,ye=0){T=K,w=he,b=ye;let ae=!0,fe=null,Fe=!1,tt=!1;if(K){let Ke=H.get(K);Ke.__useDefaultFramebuffer!==void 0?(j.bindFramebuffer(V.FRAMEBUFFER,null),ae=!1):Ke.__webglFramebuffer===void 0?q.setupRenderTarget(K):Ke.__hasExternalTextures&&q.rebindTextures(K,H.get(K.texture).__webglTexture,H.get(K.depthTexture).__webglTexture);let De=K.texture;(De.isData3DTexture||De.isDataArrayTexture||De.isCompressedArrayTexture)&&(tt=!0);let Xe=H.get(K).__webglFramebuffer;K.isWebGLCubeRenderTarget?(Array.isArray(Xe[he])?fe=Xe[he][ye]:fe=Xe[he],Fe=!0):te.isWebGL2&&K.samples>0&&q.useMultisampledRTT(K)===!1?fe=H.get(K).__webglMultisampledFramebuffer:Array.isArray(Xe)?fe=Xe[ye]:fe=Xe,E.copy(K.viewport),R.copy(K.scissor),D=K.scissorTest}else E.copy(O).multiplyScalar(X).floor(),R.copy(F).multiplyScalar(X).floor(),D=$;if(j.bindFramebuffer(V.FRAMEBUFFER,fe)&&te.drawBuffers&&ae&&j.drawBuffers(K,fe),j.viewport(E),j.scissor(R),j.setScissorTest(D),Fe){let Ke=H.get(K.texture);V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ke.__webglTexture,ye)}else if(tt){let Ke=H.get(K.texture),De=he||0;V.framebufferTextureLayer(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,Ke.__webglTexture,ye||0,De)}A=-1},this.readRenderTargetPixels=function(K,he,ye,ae,fe,Fe,tt){if(!(K&&K.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ke=H.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&tt!==void 0&&(Ke=Ke[tt]),Ke){j.bindFramebuffer(V.FRAMEBUFFER,Ke);try{let De=K.texture,Xe=De.format,st=De.type;if(Xe!==Bn&&ke.convert(Xe)!==V.getParameter(V.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let ut=st===Lh&&(ie.has("EXT_color_buffer_half_float")||te.isWebGL2&&ie.has("EXT_color_buffer_float"));if(st!==jo&&ke.convert(st)!==V.getParameter(V.IMPLEMENTATION_COLOR_READ_TYPE)&&!(st===ro&&(te.isWebGL2||ie.has("OES_texture_float")||ie.has("WEBGL_color_buffer_float")))&&!ut){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}he>=0&&he<=K.width-ae&&ye>=0&&ye<=K.height-fe&&V.readPixels(he,ye,ae,fe,ke.convert(Xe),ke.convert(st),Fe)}finally{let De=T!==null?H.get(T).__webglFramebuffer:null;j.bindFramebuffer(V.FRAMEBUFFER,De)}}},this.copyFramebufferToTexture=function(K,he,ye=0){let ae=Math.pow(2,-ye),fe=Math.floor(he.image.width*ae),Fe=Math.floor(he.image.height*ae);q.setTexture2D(he,0),V.copyTexSubImage2D(V.TEXTURE_2D,ye,0,0,K.x,K.y,fe,Fe),j.unbindTexture()},this.copyTextureToTexture=function(K,he,ye,ae=0){let fe=he.image.width,Fe=he.image.height,tt=ke.convert(ye.format),Ke=ke.convert(ye.type);q.setTexture2D(ye,0),V.pixelStorei(V.UNPACK_FLIP_Y_WEBGL,ye.flipY),V.pixelStorei(V.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ye.premultiplyAlpha),V.pixelStorei(V.UNPACK_ALIGNMENT,ye.unpackAlignment),he.isDataTexture?V.texSubImage2D(V.TEXTURE_2D,ae,K.x,K.y,fe,Fe,tt,Ke,he.image.data):he.isCompressedTexture?V.compressedTexSubImage2D(V.TEXTURE_2D,ae,K.x,K.y,he.mipmaps[0].width,he.mipmaps[0].height,tt,he.mipmaps[0].data):V.texSubImage2D(V.TEXTURE_2D,ae,K.x,K.y,tt,Ke,he.image),ae===0&&ye.generateMipmaps&&V.generateMipmap(V.TEXTURE_2D),j.unbindTexture()},this.copyTextureToTexture3D=function(K,he,ye,ae,fe=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Fe=K.max.x-K.min.x+1,tt=K.max.y-K.min.y+1,Ke=K.max.z-K.min.z+1,De=ke.convert(ae.format),Xe=ke.convert(ae.type),st;if(ae.isData3DTexture)q.setTexture3D(ae,0),st=V.TEXTURE_3D;else if(ae.isDataArrayTexture||ae.isCompressedArrayTexture)q.setTexture2DArray(ae,0),st=V.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}V.pixelStorei(V.UNPACK_FLIP_Y_WEBGL,ae.flipY),V.pixelStorei(V.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ae.premultiplyAlpha),V.pixelStorei(V.UNPACK_ALIGNMENT,ae.unpackAlignment);let ut=V.getParameter(V.UNPACK_ROW_LENGTH),Ct=V.getParameter(V.UNPACK_IMAGE_HEIGHT),bt=V.getParameter(V.UNPACK_SKIP_PIXELS),yt=V.getParameter(V.UNPACK_SKIP_ROWS),ft=V.getParameter(V.UNPACK_SKIP_IMAGES),St=ye.isCompressedTexture?ye.mipmaps[fe]:ye.image;V.pixelStorei(V.UNPACK_ROW_LENGTH,St.width),V.pixelStorei(V.UNPACK_IMAGE_HEIGHT,St.height),V.pixelStorei(V.UNPACK_SKIP_PIXELS,K.min.x),V.pixelStorei(V.UNPACK_SKIP_ROWS,K.min.y),V.pixelStorei(V.UNPACK_SKIP_IMAGES,K.min.z),ye.isDataTexture||ye.isData3DTexture?V.texSubImage3D(st,fe,he.x,he.y,he.z,Fe,tt,Ke,De,Xe,St.data):ye.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),V.compressedTexSubImage3D(st,fe,he.x,he.y,he.z,Fe,tt,Ke,De,St.data)):V.texSubImage3D(st,fe,he.x,he.y,he.z,Fe,tt,Ke,De,Xe,St),V.pixelStorei(V.UNPACK_ROW_LENGTH,ut),V.pixelStorei(V.UNPACK_IMAGE_HEIGHT,Ct),V.pixelStorei(V.UNPACK_SKIP_PIXELS,bt),V.pixelStorei(V.UNPACK_SKIP_ROWS,yt),V.pixelStorei(V.UNPACK_SKIP_IMAGES,ft),fe===0&&ae.generateMipmaps&&V.generateMipmap(st),j.unbindTexture()},this.initTexture=function(K){K.isCubeTexture?q.setTextureCube(K,0):K.isData3DTexture?q.setTexture3D(K,0):K.isDataArrayTexture||K.isCompressedArrayTexture?q.setTexture2DArray(K,0):q.setTexture2D(K,0),j.unbindTexture()},this.resetState=function(){w=0,b=0,T=null,j.reset(),We.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return no}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===D1?"display-p3":"srgb",t.unpackColorSpace=Ut.workingColorSpace===vm?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Ht?nl:LM}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===nl?Ht:Ui}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}},ny=class extends Bh{};ny.prototype.isWebGL1Renderer=!0;var sy=class n{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new at(e),this.near=t,this.far=i}clone(){return new n(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}},Gf=class extends bi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}},oy=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Hv,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Wn()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Rr=new oe,ay=class n{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.applyMatrix4(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.applyNormalMatrix(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.transformDirection(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ts(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ts(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ts(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ts(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),i=Vt(i,this.array),r=Vt(r,this.array),s=Vt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new wi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new n(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},jE=new oe,XE=new zt,YE=new zt,oU=new oe,$E=new Et,Op=new oe,tv=new bn,KE=new Et,iv=new Jo,ly=class extends wt{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=LS,this.bindMatrix=new Et,this.bindMatrixInverse=new Et,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new tn),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Op),this.boundingBox.expandByPoint(Op)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new bn),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Op),this.boundingSphere.expandByPoint(Op)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),tv.copy(this.boundingSphere),tv.applyMatrix4(r),e.ray.intersectsSphere(tv)!==!1&&(KE.copy(r).invert(),iv.copy(e.ray).applyMatrix4(KE),!(this.boundingBox!==null&&iv.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,iv)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new zt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===LS?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===FR?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let i=this.skeleton,r=this.geometry;XE.fromBufferAttribute(r.attributes.skinIndex,e),YE.fromBufferAttribute(r.attributes.skinWeight,e),jE.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){let o=YE.getComponent(s);if(o!==0){let a=XE.getComponent(s);$E.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(oU.copy(jE).applyMatrix4($E),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}},Vf=class extends bi{constructor(){super(),this.isBone=!0,this.type="Bone"}},cy=class extends xr{constructor(e=null,t=1,i=1,r,s,o,a,l,c=ji,u=ji,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},ZE=new Et,aU=new Et,uy=class n{constructor(e=[],t=[]){this.uuid=Wn(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Et)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let i=new Et;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){let a=e[s]?e[s].matrixWorld:aU;ZE.multiplyMatrices(a,t[s]),ZE.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new n(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new cy(t,e,e,Bn,ro);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){let s=e.bones[i],o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Vf),this.bones.push(o),this.boneInverses.push(new Et().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){let o=t[r];e.bones.push(o.uuid);let a=i[r];e.boneInverses.push(a.toArray())}return e}},qc=class extends wi{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},pc=new Et,JE=new Et,Ip=[],QE=new tn,lU=new Et,Ju=new wt,Qu=new bn,hy=class extends wt{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new qc(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,lU)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new tn),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,pc),QE.copy(e.boundingBox).applyMatrix4(pc),this.boundingBox.union(QE)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new bn),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,pc),Qu.copy(e.boundingSphere).applyMatrix4(pc),this.boundingSphere.union(Qu)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let i=this.matrixWorld,r=this.count;if(Ju.geometry=this.geometry,Ju.material=this.material,Ju.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Qu.copy(this.boundingSphere),Qu.applyMatrix4(i),e.ray.intersectsSphere(Qu)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,pc),JE.multiplyMatrices(i,pc),Ju.matrixWorld=JE,Ju.raycast(e,Ip);for(let o=0,a=Ip.length;o<a;o++){let l=Ip[o];l.instanceId=s,l.object=this,t.push(l)}Ip.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new qc(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},jc=class extends _n{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new at(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},eT=new oe,tT=new oe,iT=new Et,rv=new Jo,Fp=new bn,xm=class extends bi{constructor(n=new ki,e=new jc){super(),this.isLine=!0,this.type="Line",this.geometry=n,this.material=e,this.updateMorphTargets()}copy(n,e){return super.copy(n,e),this.material=Array.isArray(n.material)?n.material.slice():n.material,this.geometry=n.geometry,this}computeLineDistances(){let n=this.geometry;if(n.index===null){let e=n.attributes.position,t=[0];for(let i=1,r=e.count;i<r;i++)eT.fromBufferAttribute(e,i-1),tT.fromBufferAttribute(e,i),t[i]=t[i-1],t[i]+=eT.distanceTo(tT);n.setAttribute("lineDistance",new Xi(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(n,e){let t=this.geometry,i=this.matrixWorld,r=n.params.Line.threshold,s=t.drawRange;if(t.boundingSphere===null&&t.computeBoundingSphere(),Fp.copy(t.boundingSphere),Fp.applyMatrix4(i),Fp.radius+=r,n.ray.intersectsSphere(Fp)===!1)return;iT.copy(i).invert(),rv.copy(n.ray).applyMatrix4(iT);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new oe,c=new oe,u=new oe,h=new oe,d=this.isLineSegments?2:1,p=t.index,f=t.attributes.position;if(p!==null){let v=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let m=v,x=g-1;m<x;m+=d){let y=p.getX(m),_=p.getX(m+1);if(l.fromBufferAttribute(f,y),c.fromBufferAttribute(f,_),rv.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);let w=n.ray.origin.distanceTo(h);w<n.near||w>n.far||e.push({distance:w,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let m=v,x=g-1;m<x;m+=d){if(l.fromBufferAttribute(f,m),c.fromBufferAttribute(f,m+1),rv.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);let y=n.ray.origin.distanceTo(h);y<n.near||y>n.far||e.push({distance:y,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let n=this.geometry.morphAttributes,e=Object.keys(n);if(e.length>0){let t=n[e[0]];if(t!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++){let s=t[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},rT=new oe,nT=new oe,ws=class extends xm{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)rT.fromBufferAttribute(t,r),nT.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+rT.distanceTo(nT);e.setAttribute("lineDistance",new Xi(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},dy=class extends xm{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}},Hf=class extends _n{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new at(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},sT=new Et,py=new Jo,kp=new bn,Up=new oe,fy=class extends bi{constructor(e=new ki,t=new Hf){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),kp.copy(i.boundingSphere),kp.applyMatrix4(r),kp.radius+=s,e.ray.intersectsSphere(kp)===!1)return;sT.copy(r).invert(),py.copy(e.ray).applyMatrix4(sT);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,u=i.attributes.position;if(c!==null){let h=Math.max(0,o.start),d=Math.min(c.count,o.start+o.count);for(let p=h,f=d;p<f;p++){let v=c.getX(p);Up.fromBufferAttribute(u,v),oT(Up,v,l,r,e,t,this)}}else{let h=Math.max(0,o.start),d=Math.min(u.count,o.start+o.count);for(let p=h,f=d;p<f;p++)Up.fromBufferAttribute(u,p),oT(Up,p,l,r,e,t,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){let o=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}};function oT(n,e,t,i,r,s,o){let a=py.distanceSqToPoint(n);if(a<t){let l=new oe;py.closestPointToPoint(n,l),l.applyMatrix4(i);let c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}var Xn=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i=this.getLengths(),r=0,s=i.length,o;t?o=t:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);let u=i[r],h=i[r+1]-u,d=(o-u)/h;return(r+d)/(s-1)}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);let s=this.getPoint(i),o=this.getPoint(r),a=t||(s.isVector2?new Me:new oe);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new oe,r=[],s=[],o=[],a=new oe,l=new Et;for(let p=0;p<=e;p++){let f=p/e;r[p]=this.getTangentAt(f,new oe)}s[0]=new oe,o[0]=new oe;let c=Number.MAX_VALUE,u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),h<=c&&(c=h,i.set(0,1,0)),d<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let p=1;p<=e;p++){if(s[p]=s[p-1].clone(),o[p]=o[p-1].clone(),a.crossVectors(r[p-1],r[p]),a.length()>Number.EPSILON){a.normalize();let f=Math.acos(Fi(r[p-1].dot(r[p]),-1,1));s[p].applyMatrix4(l.makeRotationAxis(a,f))}o[p].crossVectors(r[p],s[p])}if(t===!0){let p=Math.acos(Fi(s[0].dot(s[e]),-1,1));p/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(p=-p);for(let f=1;f<=e;f++)s[f].applyMatrix4(l.makeRotationAxis(r[f],p*f)),o[f].crossVectors(r[f],s[f])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Nh=class extends Xn{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){let i=t||new Me,r=Math.PI*2,s=this.aEndAngle-this.aStartAngle,o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);let a=this.aStartAngle+e*s,l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,p=c-this.aY;l=d*u-p*h+this.aX,c=d*h+p*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},my=class extends Nh{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}};function I1(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,h){let d=(o-s)/c-(a-s)/(c+u)+(a-o)/u,p=(a-o)/u-(l-o)/(u+h)+(l-a)/h;d*=u,p*=u,r(o,a,d,p)},calc:function(s){let o=s*s,a=o*s;return n+e*s+t*o+i*a}}}var zp=new oe,nv=new I1,sv=new I1,ov=new I1,gy=class extends Xn{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new oe){let i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%s]:(zp.subVectors(r[0],r[1]).add(r[0]),c=zp);let h=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(zp.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=zp),this.curveType==="centripetal"||this.curveType==="chordal"){let p=this.curveType==="chordal"?.5:.25,f=Math.pow(c.distanceToSquared(h),p),v=Math.pow(h.distanceToSquared(d),p),g=Math.pow(d.distanceToSquared(u),p);v<1e-4&&(v=1),f<1e-4&&(f=v),g<1e-4&&(g=v),nv.initNonuniformCatmullRom(c.x,h.x,d.x,u.x,f,v,g),sv.initNonuniformCatmullRom(c.y,h.y,d.y,u.y,f,v,g),ov.initNonuniformCatmullRom(c.z,h.z,d.z,u.z,f,v,g)}else this.curveType==="catmullrom"&&(nv.initCatmullRom(c.x,h.x,d.x,u.x,this.tension),sv.initCatmullRom(c.y,h.y,d.y,u.y,this.tension),ov.initCatmullRom(c.z,h.z,d.z,u.z,this.tension));return i.set(nv.calc(l),sv.calc(l),ov.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(new oe().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function aT(n,e,t,i,r){let s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function cU(n,e){let t=1-n;return t*t*e}function uU(n,e){return 2*(1-n)*n*e}function hU(n,e){return n*n*e}function mh(n,e,t,i){return cU(n,e)+uU(n,t)+hU(n,i)}function dU(n,e){let t=1-n;return t*t*t*e}function pU(n,e){let t=1-n;return 3*t*t*n*e}function fU(n,e){return 3*(1-n)*n*n*e}function mU(n,e){return n*n*n*e}function gh(n,e,t,i,r){return dU(n,e)+pU(n,t)+fU(n,i)+mU(n,r)}var Wf=class extends Xn{constructor(e=new Me,t=new Me,i=new Me,r=new Me){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Me){let i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(gh(e,r.x,s.x,o.x,a.x),gh(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},qf=class extends Xn{constructor(e=new oe,t=new oe,i=new oe,r=new oe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new oe){let i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(gh(e,r.x,s.x,o.x,a.x),gh(e,r.y,s.y,o.y,a.y),gh(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},jf=class extends Xn{constructor(e=new Me,t=new Me){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Me){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Me){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},vy=class extends Xn{constructor(e=new oe,t=new oe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new oe){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new oe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Xf=class extends Xn{constructor(e=new Me,t=new Me,i=new Me){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Me){let i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(mh(e,r.x,s.x,o.x),mh(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},yy=class extends Xn{constructor(e=new oe,t=new oe,i=new oe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new oe){let i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(mh(e,r.x,s.x,o.x),mh(e,r.y,s.y,o.y),mh(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Yf=class extends Xn{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Me){let i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(aT(a,l.x,c.x,u.x,h.x),aT(a,l.y,c.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(new Me().fromArray(r))}return this}},xy=Object.freeze({__proto__:null,ArcCurve:my,CatmullRomCurve3:gy,CubicBezierCurve:Wf,CubicBezierCurve3:qf,EllipseCurve:Nh,LineCurve:jf,LineCurve3:vy,QuadraticBezierCurve:Xf,QuadraticBezierCurve3:yy,SplineCurve:Yf}),_y=class extends Xn{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new xy[i](t,e))}return this}getPoint(e,t){let i=e*this.getLength(),r=this.getCurveLengths(),s=0;for(;s<r.length;){if(r[s]>=i){let o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],i;for(let r=0,s=this.curves;r<s.length;r++){let o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){let u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let r=e.curves[t];this.curves.push(new xy[r.type]().fromJSON(r))}return this}},Xo=class extends _y{constructor(e){super(),this.type="Path",this.currentPoint=new Me,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let i=new jf(this.currentPoint.clone(),new Me(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){let s=new Xf(this.currentPoint.clone(),new Me(e,t),new Me(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){let a=new Wf(this.currentPoint.clone(),new Me(e,t),new Me(i,r),new Me(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),i=new Yf(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){let a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){let c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){let c=new Nh(e,t,i,r,s,o,a,l);if(this.curves.length>0){let h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);let u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Bp=new oe,Np=new oe,av=new oe,Gp=new Qa,$f=class extends ki{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let i=Math.pow(10,4),r=Math.cos(Dc*t),s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let p=0;p<a;p+=3){s?(l[0]=s.getX(p),l[1]=s.getX(p+1),l[2]=s.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);let{a:f,b:v,c:g}=Gp;if(f.fromBufferAttribute(o,l[0]),v.fromBufferAttribute(o,l[1]),g.fromBufferAttribute(o,l[2]),Gp.getNormal(av),u[0]=`${Math.round(f.x*i)},${Math.round(f.y*i)},${Math.round(f.z*i)}`,u[1]=`${Math.round(v.x*i)},${Math.round(v.y*i)},${Math.round(v.z*i)}`,u[2]=`${Math.round(g.x*i)},${Math.round(g.y*i)},${Math.round(g.z*i)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let m=0;m<3;m++){let x=(m+1)%3,y=u[m],_=u[x],w=Gp[c[m]],b=Gp[c[x]],T=`${y}_${_}`,A=`${_}_${y}`;A in h&&h[A]?(av.dot(h[A].normal)<=r&&(d.push(w.x,w.y,w.z),d.push(b.x,b.y,b.z)),h[A]=null):T in h||(h[T]={index0:l[m],index1:l[x],normal:av.clone()})}}for(let p in h)if(h[p]){let{index0:f,index1:v}=h[p];Bp.fromBufferAttribute(o,f),Np.fromBufferAttribute(o,v),d.push(Bp.x,Bp.y,Bp.z),d.push(Np.x,Np.y,Np.z)}this.setAttribute("position",new Xi(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}},sl=class extends Xo{constructor(e){super(e),this.uuid=Wn(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let r=e.holes[t];this.holes.push(new Xo().fromJSON(r))}return this}},gU={triangulate:function(n,e,t=2){let i=e&&e.length,r=i?e[0]*t:n.length,s=XM(n,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,p;if(i&&(s=wU(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let f=t;f<r;f+=t)h=n[f],d=n[f+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=p!==0?32767/p:0}return Gh(s,o,t,a,l,p,0),o}};function XM(n,e,t,i,r){let s,o;if(r===LU(n,e,t,i)>0)for(s=e;s<t;s+=i)o=lT(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=lT(s,n[s],n[s+1],o);return o&&_m(o,o.next)&&(Hh(o),o=o.next),o}function vl(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(_m(t,t.next)||ci(t.prev,t,t.next)===0)){if(Hh(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Gh(n,e,t,i,r,s,o){if(!n)return;!o&&s&&MU(n,i,r,s);let a=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,s?yU(n,i,r,s):vU(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),Hh(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=xU(vl(n),e,t),Gh(n,e,t,i,r,s,2)):o===2&&_U(n,e,t,i,r,s):Gh(vl(n),e,t,i,r,s,1);break}}}function vU(n){let e=n.prev,t=n,i=n.next;if(ci(e,t,i)>=0)return!1;let r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c,f=i.next;for(;f!==e;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Sc(r,a,s,l,o,c,f.x,f.y)&&ci(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function yU(n,e,t,i){let r=n.prev,s=n,o=n.next;if(ci(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,p=a<l?a<c?a:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,v=a>l?a>c?a:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,m=wy(p,f,e,t,i),x=wy(v,g,e,t,i),y=n.prevZ,_=n.nextZ;for(;y&&y.z>=m&&_&&_.z<=x;){if(y.x>=p&&y.x<=v&&y.y>=f&&y.y<=g&&y!==r&&y!==o&&Sc(a,u,l,h,c,d,y.x,y.y)&&ci(y.prev,y,y.next)>=0||(y=y.prevZ,_.x>=p&&_.x<=v&&_.y>=f&&_.y<=g&&_!==r&&_!==o&&Sc(a,u,l,h,c,d,_.x,_.y)&&ci(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;y&&y.z>=m;){if(y.x>=p&&y.x<=v&&y.y>=f&&y.y<=g&&y!==r&&y!==o&&Sc(a,u,l,h,c,d,y.x,y.y)&&ci(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;_&&_.z<=x;){if(_.x>=p&&_.x<=v&&_.y>=f&&_.y<=g&&_!==r&&_!==o&&Sc(a,u,l,h,c,d,_.x,_.y)&&ci(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function xU(n,e,t){let i=n;do{let r=i.prev,s=i.next.next;!_m(r,s)&&YM(r,i,i.next,s)&&Vh(r,s)&&Vh(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Hh(i),Hh(i.next),i=n=s),i=i.next}while(i!==n);return vl(i)}function _U(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&DU(o,a)){let l=$M(o,a);o=vl(o,o.next),l=vl(l,l.next),Gh(o,e,t,i,r,s,0),Gh(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function wU(n,e,t,i){let r=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=XM(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(CU(c));for(r.sort(bU),s=0;s<r.length;s++)t=SU(r[s],t);return t}function bU(n,e){return n.x-e.x}function SU(n,e){let t=EU(n,e);if(!t)return e;let i=$M(t,n);return vl(i,i.next),vl(t,t.next)}function EU(n,e){let t=e,i=-1/0,r,s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=s&&d>i&&(i=d,r=t.x<t.next.x?t:t.next,d===s))return r}t=t.next}while(t!==e);if(!r)return null;let a=r,l=r.x,c=r.y,u=1/0,h;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&Sc(o<c?s:i,o,l,c,o<c?i:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),Vh(t,n)&&(h<u||h===u&&(t.x>r.x||t.x===r.x&&TU(r,t)))&&(r=t,u=h)),t=t.next;while(t!==a);return r}function TU(n,e){return ci(n.prev,n,e.prev)<0&&ci(e.next,n,n.next)<0}function MU(n,e,t,i){let r=n;do r.z===0&&(r.z=wy(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,AU(r)}function AU(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1);return n}function wy(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function CU(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Sc(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function DU(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!PU(n,e)&&(Vh(n,e)&&Vh(e,n)&&RU(n,e)&&(ci(n.prev,n,e.prev)||ci(n,e.prev,e))||_m(n,e)&&ci(n.prev,n,n.next)>0&&ci(e.prev,e,e.next)>0)}function ci(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function _m(n,e){return n.x===e.x&&n.y===e.y}function YM(n,e,t,i){let r=Hp(ci(n,e,t)),s=Hp(ci(n,e,i)),o=Hp(ci(t,i,n)),a=Hp(ci(t,i,e));return!!(r!==s&&o!==a||r===0&&Vp(n,t,e)||s===0&&Vp(n,i,e)||o===0&&Vp(t,n,i)||a===0&&Vp(t,e,i))}function Vp(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Hp(n){return n>0?1:n<0?-1:0}function PU(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&YM(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Vh(n,e){return ci(n.prev,n,n.next)<0?ci(n,e,n.next)>=0&&ci(n,n.prev,e)>=0:ci(n,e,n.prev)<0||ci(n,n.next,e)<0}function RU(n,e){let t=n,i=!1,r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function $M(n,e){let t=new by(n.i,n.x,n.y),i=new by(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function lT(n,e,t,i){let r=new by(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Hh(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function by(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function LU(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}var ol=class n{static area(e){let t=e.length,i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return n.area(e)<0}static triangulateShape(e,t){let i=[],r=[],s=[];cT(e),uT(i,e);let o=e.length;t.forEach(cT);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,uT(i,t[l]);let a=gU.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}};function cT(n){let e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function uT(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}var Wh=class n extends ki{constructor(e=new sl([new Me(.5,.5),new Me(-.5,.5),new Me(-.5,-.5),new Me(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){let c=e[a];o(c)}this.setAttribute("position",new Xi(r,3)),this.setAttribute("uv",new Xi(s,2)),this.computeVertexNormals();function o(a){let l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,h=t.depth!==void 0?t.depth:1,d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,p=t.bevelThickness!==void 0?t.bevelThickness:.2,f=t.bevelSize!==void 0?t.bevelSize:p-.1,v=t.bevelOffset!==void 0?t.bevelOffset:0,g=t.bevelSegments!==void 0?t.bevelSegments:3,m=t.extrudePath,x=t.UVGenerator!==void 0?t.UVGenerator:OU,y,_=!1,w,b,T,A;m&&(y=m.getSpacedPoints(u),_=!0,d=!1,w=m.computeFrenetFrames(u,!1),b=new oe,T=new oe,A=new oe),d||(g=0,p=0,f=0,v=0);let S=a.extractPoints(c),E=S.shape,R=S.holes;if(!ol.isClockWise(E)){E=E.reverse();for(let Z=0,V=R.length;Z<V;Z++){let ne=R[Z];ol.isClockWise(ne)&&(R[Z]=ne.reverse())}}let D=ol.triangulateShape(E,R),z=E;for(let Z=0,V=R.length;Z<V;Z++){let ne=R[Z];E=E.concat(ne)}function L(Z,V,ne){return V||console.error("THREE.ExtrudeGeometry: vec does not exist"),Z.clone().addScaledVector(V,ne)}let G=E.length,J=D.length;function X(Z,V,ne){let ie,te,j,W=Z.x-V.x,H=Z.y-V.y,q=ne.x-Z.x,I=ne.y-Z.y,ee=W*W+H*H,me=W*I-H*q;if(Math.abs(me)>Number.EPSILON){let pe=Math.sqrt(ee),ge=Math.sqrt(q*q+I*I),xe=V.x-H/pe,we=V.y+W/pe,_e=ne.x-I/ge,Ie=ne.y+q/ge,Be=((_e-xe)*I-(Ie-we)*q)/(W*I-H*q);ie=xe+W*Be-Z.x,te=we+H*Be-Z.y;let Ae=ie*ie+te*te;if(Ae<=2)return new Me(ie,te);j=Math.sqrt(Ae/2)}else{let pe=!1;W>Number.EPSILON?q>Number.EPSILON&&(pe=!0):W<-Number.EPSILON?q<-Number.EPSILON&&(pe=!0):Math.sign(H)===Math.sign(I)&&(pe=!0),pe?(ie=-H,te=W,j=Math.sqrt(ee)):(ie=W,te=H,j=Math.sqrt(ee/2))}return new Me(ie/j,te/j)}let N=[];for(let Z=0,V=z.length,ne=V-1,ie=Z+1;Z<V;Z++,ne++,ie++)ne===V&&(ne=0),ie===V&&(ie=0),N[Z]=X(z[Z],z[ne],z[ie]);let U=[],O,F=N.concat();for(let Z=0,V=R.length;Z<V;Z++){let ne=R[Z];O=[];for(let ie=0,te=ne.length,j=te-1,W=ie+1;ie<te;ie++,j++,W++)j===te&&(j=0),W===te&&(W=0),O[ie]=X(ne[ie],ne[j],ne[W]);U.push(O),F=F.concat(O)}for(let Z=0;Z<g;Z++){let V=Z/g,ne=p*Math.cos(V*Math.PI/2),ie=f*Math.sin(V*Math.PI/2)+v;for(let te=0,j=z.length;te<j;te++){let W=L(z[te],N[te],ie);B(W.x,W.y,-ne)}for(let te=0,j=R.length;te<j;te++){let W=R[te];O=U[te];for(let H=0,q=W.length;H<q;H++){let I=L(W[H],O[H],ie);B(I.x,I.y,-ne)}}}let $=f+v;for(let Z=0;Z<G;Z++){let V=d?L(E[Z],F[Z],$):E[Z];_?(T.copy(w.normals[0]).multiplyScalar(V.x),b.copy(w.binormals[0]).multiplyScalar(V.y),A.copy(y[0]).add(T).add(b),B(A.x,A.y,A.z)):B(V.x,V.y,0)}for(let Z=1;Z<=u;Z++)for(let V=0;V<G;V++){let ne=d?L(E[V],F[V],$):E[V];_?(T.copy(w.normals[Z]).multiplyScalar(ne.x),b.copy(w.binormals[Z]).multiplyScalar(ne.y),A.copy(y[Z]).add(T).add(b),B(A.x,A.y,A.z)):B(ne.x,ne.y,h/u*Z)}for(let Z=g-1;Z>=0;Z--){let V=Z/g,ne=p*Math.cos(V*Math.PI/2),ie=f*Math.sin(V*Math.PI/2)+v;for(let te=0,j=z.length;te<j;te++){let W=L(z[te],N[te],ie);B(W.x,W.y,h+ne)}for(let te=0,j=R.length;te<j;te++){let W=R[te];O=U[te];for(let H=0,q=W.length;H<q;H++){let I=L(W[H],O[H],ie);_?B(I.x,I.y+y[u-1].y,y[u-1].x+ne):B(I.x,I.y,h+ne)}}}P(),C();function P(){let Z=r.length/3;if(d){let V=0,ne=G*V;for(let ie=0;ie<J;ie++){let te=D[ie];k(te[2]+ne,te[1]+ne,te[0]+ne)}V=u+g*2,ne=G*V;for(let ie=0;ie<J;ie++){let te=D[ie];k(te[0]+ne,te[1]+ne,te[2]+ne)}}else{for(let V=0;V<J;V++){let ne=D[V];k(ne[2],ne[1],ne[0])}for(let V=0;V<J;V++){let ne=D[V];k(ne[0]+G*u,ne[1]+G*u,ne[2]+G*u)}}i.addGroup(Z,r.length/3-Z,0)}function C(){let Z=r.length/3,V=0;M(z,V),V+=z.length;for(let ne=0,ie=R.length;ne<ie;ne++){let te=R[ne];M(te,V),V+=te.length}i.addGroup(Z,r.length/3-Z,1)}function M(Z,V){let ne=Z.length;for(;--ne>=0;){let ie=ne,te=ne-1;te<0&&(te=Z.length-1);for(let j=0,W=u+g*2;j<W;j++){let H=G*j,q=G*(j+1),I=V+ie+H,ee=V+te+H,me=V+te+q,pe=V+ie+q;Q(I,ee,me,pe)}}}function B(Z,V,ne){l.push(Z),l.push(V),l.push(ne)}function k(Z,V,ne){Y(Z),Y(V),Y(ne);let ie=r.length/3,te=x.generateTopUV(i,r,ie-3,ie-2,ie-1);re(te[0]),re(te[1]),re(te[2])}function Q(Z,V,ne,ie){Y(Z),Y(V),Y(ie),Y(V),Y(ne),Y(ie);let te=r.length/3,j=x.generateSideWallUV(i,r,te-6,te-3,te-2,te-1);re(j[0]),re(j[1]),re(j[3]),re(j[1]),re(j[2]),re(j[3])}function Y(Z){r.push(l[Z*3+0]),r.push(l[Z*3+1]),r.push(l[Z*3+2])}function re(Z){s.push(Z.x),s.push(Z.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return IU(t,i,e)}static fromJSON(e,t){let i=[];for(let s=0,o=e.shapes.length;s<o;s++){let a=t[e.shapes[s]];i.push(a)}let r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new xy[r.type]().fromJSON(r)),new n(i,e.options)}},OU={generateTopUV:function(n,e,t,i,r){let s=e[t*3],o=e[t*3+1],a=e[i*3],l=e[i*3+1],c=e[r*3],u=e[r*3+1];return[new Me(s,o),new Me(a,l),new Me(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){let o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[i*3],u=e[i*3+1],h=e[i*3+2],d=e[r*3],p=e[r*3+1],f=e[r*3+2],v=e[s*3],g=e[s*3+1],m=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new Me(o,1-l),new Me(c,1-h),new Me(d,1-f),new Me(v,1-m)]:[new Me(a,1-l),new Me(u,1-h),new Me(p,1-f),new Me(g,1-m)]}};function IU(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){let s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var Xc=class extends _n{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new at(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new at(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=C1,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},ds=class extends Xc{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Me(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Fi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new at(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new at(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new at(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},qh=class extends _n{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new at(16777215),this.specular=new at(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new at(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=C1,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=M1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};function Wp(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function FU(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function kU(n){function e(r,s){return n[r]-n[s]}let t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function hT(n,e,t){let i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){let a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function KM(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}var yl=class{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;i:{r:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break r;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break i}if(!(e>=s)){let a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break i}break e}for(;i<o;){let a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Sy=class extends yl{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:nE,endingEnd:nE}}intervalChanged_(e,t,i){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case sE:s=e,a=2*t-i;break;case oE:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case sE:o=e,l=2*i-t;break;case oE:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}let c=(i-t)*.5,u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,p=this._weightNext,f=(i-t)/(r-t),v=f*f,g=v*f,m=-d*g+2*d*v-d*f,x=(1+d)*g+(-1.5-2*d)*v+(-.5+d)*f+1,y=(-1-p)*g+(1.5+p)*v+.5*f,_=p*g-p*v;for(let w=0;w!==a;++w)s[w]=m*o[u+w]+x*o[c+w]+y*o[l+w]+_*o[h+w];return s}},Ey=class extends yl{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*h+o[l+d]*u;return s}},Ty=class extends yl{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}},Yn=class{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Wp(t,this.TimeBufferType),this.values=Wp(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Wp(e.times,Array),values:Wp(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Ty(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ey(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Sy(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Oh:t=this.InterpolantFactoryMethodDiscrete;break;case Vc:t=this.InterpolantFactoryMethodLinear;break;case L0:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Oh;case this.InterpolantFactoryMethodLinear:return Vc;case this.InterpolantFactoryMethodSmooth:return L0}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){let i=this.times,r=i.length,s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&FU(r))for(let a=0,l=r.length;a!==l;++a){let c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===L0,s=e.length-1,o=1;for(let a=1;a<s;++a){let l=!1,c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(r)l=!0;else{let h=a*i,d=h-i,p=h+i;for(let f=0;f!==i;++f){let v=t[h+f];if(v!==t[d+f]||v!==t[p+f]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];let h=a*i,d=o*i;for(let p=0;p!==i;++p)t[d+p]=t[h+p]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};Yn.prototype.TimeBufferType=Float32Array;Yn.prototype.ValueBufferType=Float32Array;Yn.prototype.DefaultInterpolation=Vc;var Qo=class extends Yn{};Qo.prototype.ValueTypeName="bool";Qo.prototype.ValueBufferType=Array;Qo.prototype.DefaultInterpolation=Oh;Qo.prototype.InterpolantFactoryMethodLinear=void 0;Qo.prototype.InterpolantFactoryMethodSmooth=void 0;var Kf=class extends Yn{};Kf.prototype.ValueTypeName="color";var ea=class extends Yn{};ea.prototype.ValueTypeName="number";var My=class extends yl{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t),c=e*a;for(let u=c+a;c!==u;c+=4)jn.slerpFlat(s,0,o,c-a,o,c,l);return s}},uo=class extends Yn{InterpolantFactoryMethodLinear(e){return new My(this.times,this.values,this.getValueSize(),e)}};uo.prototype.ValueTypeName="quaternion";uo.prototype.DefaultInterpolation=Vc;uo.prototype.InterpolantFactoryMethodSmooth=void 0;var ta=class extends Yn{};ta.prototype.ValueTypeName="string";ta.prototype.ValueBufferType=Array;ta.prototype.DefaultInterpolation=Oh;ta.prototype.InterpolantFactoryMethodLinear=void 0;ta.prototype.InterpolantFactoryMethodSmooth=void 0;var ia=class extends Yn{};ia.prototype.ValueTypeName="vector";var Ay=class{constructor(e,t=-1,i,r=WR){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Wn(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(zU(i[o]).scale(r));let s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){let t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Yn.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){let s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);let u=kU(l);l=hT(l,1,u),c=hT(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new ea(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){let r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){let c=e[a],u=c.name.match(s);if(u&&u.length>1){let h=u[1],d=r[h];d||(r[h]=d=[]),d.push(c)}}let o=[];for(let a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(u,h,d,p,f){if(d.length!==0){let v=[],g=[];KM(d,v,g,p),v.length!==0&&f.push(new u(h,v,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode,l=e.length||-1,c=e.hierarchy||[];for(let u=0;u<c.length;u++){let h=c[u].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let d={},p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let f=0;f<h[p].morphTargets.length;f++)d[h[p].morphTargets[f]]=-1;for(let f in d){let v=[],g=[];for(let m=0;m!==h[p].morphTargets.length;++m){let x=h[p];v.push(x.time),g.push(x.morphTarget===f?1:0)}r.push(new ea(".morphTargetInfluence["+f+"]",v,g))}l=d.length*o}else{let d=".bones["+t[u].name+"]";i(ia,d+".position",h,"pos",r),i(uo,d+".quaternion",h,"rot",r),i(ia,d+".scale",h,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){let e=this.tracks,t=0;for(let i=0,r=e.length;i!==r;++i){let s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function UU(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ea;case"vector":case"vector2":case"vector3":case"vector4":return ia;case"color":return Kf;case"quaternion":return uo;case"bool":case"boolean":return Qo;case"string":return ta}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function zU(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=UU(n.type);if(n.times===void 0){let t=[],i=[];KM(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}var so={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}},Zf=class{constructor(e,t,i){let r=this,s=!1,o=0,a=0,l,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){let h=c.indexOf(u);return h!==-1&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=c.length;h<d;h+=2){let p=c[h],f=c[h+1];if(p.global&&(p.lastIndex=0),p.test(u))return f}return null}}},BU=new Zf,Rs=class{constructor(n){this.manager=n!==void 0?n:BU,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(n,e){let t=this;return new Promise(function(i,r){t.load(n,i,e,r)})}parse(){}setCrossOrigin(n){return this.crossOrigin=n,this}setWithCredentials(n){return this.withCredentials=n,this}setPath(n){return this.path=n,this}setResourcePath(n){return this.resourcePath=n,this}setRequestHeader(n){return this.requestHeader=n,this}};Rs.DEFAULT_MATERIAL_NAME="__DEFAULT";var Ks={},Cy=class extends Error{constructor(e,t){super(e),this.response=t}},ra=class extends Rs{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=so.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Ks[e]!==void 0){Ks[e].push({onLoad:t,onProgress:i,onError:r});return}Ks[e]=[],Ks[e].push({onLoad:t,onProgress:i,onError:r});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;let u=Ks[e],h=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),p=d?parseInt(d):0,f=p!==0,v=0,g=new ReadableStream({start(m){x();function x(){h.read().then(({done:y,value:_})=>{if(y)m.close();else{v+=_.byteLength;let w=new ProgressEvent("progress",{lengthComputable:f,loaded:v,total:p});for(let b=0,T=u.length;b<T;b++){let A=u[b];A.onProgress&&A.onProgress(w)}m.enqueue(_),x()}})}}});return new Response(g)}else throw new Cy(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{let u=/charset="?([^;"\s]*)"?/i.exec(a),h=u&&u[1]?u[1].toLowerCase():void 0,d=new TextDecoder(h);return c.arrayBuffer().then(p=>d.decode(p))}}}).then(c=>{so.add(e,c);let u=Ks[e];delete Ks[e];for(let h=0,d=u.length;h<d;h++){let p=u[h];p.onLoad&&p.onLoad(c)}}).catch(c=>{let u=Ks[e];if(u===void 0)throw this.manager.itemError(e),c;delete Ks[e];for(let h=0,d=u.length;h<d;h++){let p=u[h];p.onError&&p.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},Jf=class extends Rs{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=so.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;let a=Ih("img");function l(){u(),so.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}},Dy=class extends Rs{constructor(e){super(e)}load(e,t,i,r){let s=new kh;s.colorSpace=Ht;let o=new Jf(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}},Qf=class extends Rs{constructor(e){super(e)}load(e,t,i,r){let s=new xr,o=new Jf(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}},jh=class extends bi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new at(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},lv=new Et,dT=new oe,pT=new oe,Xh=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Me(512,512),this.map=null,this.mapPass=null,this.matrix=new Et,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Uh,this._frameExtents=new Me(1,1),this._viewportCount=1,this._viewports=[new zt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;dT.setFromMatrixPosition(e.matrixWorld),t.position.copy(dT),pT.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(pT),t.updateMatrixWorld(),lv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lv),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(lv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Py=class extends Xh{constructor(){super(new tr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=Hc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},Ry=class extends jh{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(bi.DEFAULT_UP),this.updateMatrix(),this.target=new bi,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Py}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},fT=new Et,eh=new oe,cv=new oe,Ly=class extends Xh{constructor(){super(new tr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Me(4,2),this._viewportCount=6,this._viewports=[new zt(2,1,1,1),new zt(0,1,1,1),new zt(3,1,1,1),new zt(1,1,1,1),new zt(3,0,1,1),new zt(1,0,1,1)],this._cubeDirections=[new oe(1,0,0),new oe(-1,0,0),new oe(0,0,1),new oe(0,0,-1),new oe(0,1,0),new oe(0,-1,0)],this._cubeUps=[new oe(0,1,0),new oe(0,1,0),new oe(0,1,0),new oe(0,1,0),new oe(0,0,1),new oe(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),eh.setFromMatrixPosition(e.matrixWorld),i.position.copy(eh),cv.copy(i.position),cv.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(cv),i.updateMatrixWorld(),r.makeTranslation(-eh.x,-eh.y,-eh.z),fT.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fT)}},Oy=class extends jh{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Ly}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Iy=class extends Xh{constructor(){super(new zh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Yh=class extends jh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(bi.DEFAULT_UP),this.updateMatrix(),this.target=new bi,this.shadow=new Iy}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},al=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}},Fy=class extends ki{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},ky=class extends Rs{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=so.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{r&&r(c)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;let l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return so.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){r&&r(c),so.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});so.add(e,l),s.manager.itemStart(e)}},qp,Uy=class{static getContext(){return qp===void 0&&(qp=new(window.AudioContext||window.webkitAudioContext)),qp}static setContext(e){qp=e}},zy=class extends Rs{constructor(e){super(e)}load(e,t,i,r){let s=this,o=new ra(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{let c=l.slice(0);Uy.getContext().decodeAudioData(c,function(u){t(u)}).catch(a)}catch(c){a(c)}},i,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}},F1="\\[\\]\\.:\\/",NU=new RegExp("["+F1+"]","g"),k1="[^"+F1+"]",GU="[^"+F1.replace("\\.","")+"]",VU=/((?:WC+[\/:])*)/.source.replace("WC",k1),HU=/(WCOD+)?/.source.replace("WCOD",GU),WU=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",k1),qU=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",k1),jU=new RegExp("^"+VU+HU+WU+qU+"$"),XU=["material","materials","bones","map"],By=class{constructor(e,t,i){let r=i||ei.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},ei=class n{constructor(e,t,i){this.path=t,this.parsedPath=i||n.parseTrackName(t),this.node=n.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new n.Composite(e,t,i):new n(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(NU,"")}static parseTrackName(e){let t=jU.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let s=i.nodeName.substring(r+1);XU.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){let i=function(s){for(let o=0;o<s.length;o++){let a=s[o];if(a.name===t||a.uuid===t)return a;let l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,i=t.objectName,r=t.propertyName,s=t.propertyIndex;if(e||(e=n.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}let o=e[r];if(o===void 0){let c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};ei.Composite=By;ei.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ei.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ei.prototype.GetterByBindingType=[ei.prototype._getValue_direct,ei.prototype._getValue_array,ei.prototype._getValue_arrayElement,ei.prototype._getValue_toArray];ei.prototype.SetterByBindingTypeAndVersioning=[[ei.prototype._setValue_direct,ei.prototype._setValue_direct_setNeedsUpdate,ei.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ei.prototype._setValue_array,ei.prototype._setValue_array_setNeedsUpdate,ei.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ei.prototype._setValue_arrayElement,ei.prototype._setValue_arrayElement_setNeedsUpdate,ei.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ei.prototype._setValue_fromArray,ei.prototype._setValue_fromArray_setNeedsUpdate,ei.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var em=class{constructor(e,t,i=0,r=1/0){this.ray=new Jo(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new Fh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Ny(e,this,i,t),i.sort(mT),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)Ny(e[r],this,i,t);return i.sort(mT),i}};function mT(n,e){return n.distance-e.distance}function Ny(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){let r=n.children;for(let s=0,o=r.length;s<o;s++)Ny(r[s],e,t,!0)}}var tm=class{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Fi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},gT=new Me,Gy=class{constructor(e=new Me(1/0,1/0),t=new Me(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=gT.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,gT).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Js=class{constructor(){this.type="ShapePath",this.color=new at,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Xo,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(m){let x=[];for(let y=0,_=m.length;y<_;y++){let w=m[y],b=new sl;b.curves=w.curves,x.push(b)}return x}function i(m,x){let y=x.length,_=!1;for(let w=y-1,b=0;b<y;w=b++){let T=x[w],A=x[b],S=A.x-T.x,E=A.y-T.y;if(Math.abs(E)>Number.EPSILON){if(E<0&&(T=x[b],S=-S,A=x[w],E=-E),m.y<T.y||m.y>A.y)continue;if(m.y===T.y){if(m.x===T.x)return!0}else{let R=E*(m.x-T.x)-S*(m.y-T.y);if(R===0)return!0;if(R<0)continue;_=!_}}else{if(m.y!==T.y)continue;if(A.x<=m.x&&m.x<=T.x||T.x<=m.x&&m.x<=A.x)return!0}}return _}let r=ol.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l,c=[];if(s.length===1)return a=s[0],l=new sl,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;let h=[],d=[],p=[],f=0,v;d[f]=void 0,p[f]=[];for(let m=0,x=s.length;m<x;m++)a=s[m],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!u&&d[f]&&f++,d[f]={s:new sl,p:v},d[f].s.curves=a.curves,u&&f++,p[f]=[]):p[f].push({h:a,p:v[0]});if(!d[0])return t(s);if(d.length>1){let m=!1,x=0;for(let y=0,_=d.length;y<_;y++)h[y]=[];for(let y=0,_=d.length;y<_;y++){let w=p[y];for(let b=0;b<w.length;b++){let T=w[b],A=!0;for(let S=0;S<d.length;S++)i(T.p,d[S].p)&&(y!==S&&x++,A?(A=!1,h[S].push(T)):m=!0);A&&h[y].push(T)}}x>0&&m===!1&&(p=h)}let g;for(let m=0,x=d.length;m<x;m++){l=d[m].s,c.push(l),g=p[m];for(let y=0,_=g.length;y<_;y++)l.holes.push(g[y].h)}return c}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:T1}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=T1);var na=class n{constructor(e,t,i,r,s="div"){this.parent=e,this.object=t,this.property=i,this._disabled=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),n.nextNameID=n.nextNameID||0,this.$name.id=`lil-gui-name-${++n.nextNameID}`,this.$widget=document.createElement(s),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled?this:(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e),this)}options(e){let t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);let e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}},Vy=class extends na{constructor(e,t,i){super(e,t,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}};function Hy(n){let e,t;return(e=n.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=n.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=n.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),t?"#"+t:!1}var YU={isPrimitive:!0,match:n=>typeof n=="string",fromHexString:Hy,toHexString:Hy},$h={isPrimitive:!0,match:n=>typeof n=="number",fromHexString:n=>parseInt(n.substring(1),16),toHexString:n=>"#"+n.toString(16).padStart(6,0)},$U={isPrimitive:!1,match:Array.isArray,fromHexString(n,e,t=1){let i=$h.fromHexString(n);e[0]=(i>>16&255)/255*t,e[1]=(i>>8&255)/255*t,e[2]=(i&255)/255*t},toHexString([n,e,t],i=1){i=255/i;let r=n*i<<16^e*i<<8^t*i<<0;return $h.toHexString(r)}},KU={isPrimitive:!1,match:n=>Object(n)===n,fromHexString(n,e,t=1){let i=$h.fromHexString(n);e.r=(i>>16&255)/255*t,e.g=(i>>8&255)/255*t,e.b=(i&255)/255*t},toHexString({r:n,g:e,b:t},i=1){i=255/i;let r=n*i<<16^e*i<<8^t*i<<0;return $h.toHexString(r)}},ZU=[YU,$h,$U,KU];function JU(n){return ZU.find(e=>e.match(n))}var Wy=class extends na{constructor(e,t,i,r){super(e,t,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=JU(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{let s=Hy(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){let t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}},vh=class extends na{constructor(e,t,i){super(e,t,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object)}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}},qy=class extends na{constructor(e,t,i,r,s,o){super(e,t,i,"number"),this._initInput(),this.min(r),this.max(s);let a=o!==void 0;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){let e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=t*100+"%"}return this._inputFocused||(this.$input.value=e),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;let e=()=>{let m=parseFloat(this.$input.value);isNaN(m)||this.setValue(this._clamp(m))},t=m=>{let x=parseFloat(this.$input.value);isNaN(x)||(this._snapClampSetValue(x+m),this.$input.value=this.getValue())},i=m=>{m.code==="Enter"&&this.$input.blur(),m.code==="ArrowUp"&&(m.preventDefault(),t(this._step*this._arrowKeyMultiplier(m))),m.code==="ArrowDown"&&(m.preventDefault(),t(this._step*this._arrowKeyMultiplier(m)*-1))},r=m=>{this._inputFocused&&(m.preventDefault(),t(this._step*this._normalizeMouseWheel(m)))},s=!1,o,a,l,c,u,h=5,d=m=>{o=m.clientX,a=l=m.clientY,s=!0,c=this.getValue(),u=0,window.addEventListener("mousemove",p),window.addEventListener("mouseup",f)},p=m=>{if(s){let x=m.clientX-o,y=m.clientY-a;Math.abs(y)>h?(m.preventDefault(),this.$input.blur(),s=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(x)>h&&f()}if(!s){let x=m.clientY-l;u-=x*this._step*this._arrowKeyMultiplier(m),c+u>this._max?u=this._max-c:c+u<this._min&&(u=this._min-c),this._snapClampSetValue(c+u)}l=m.clientY},f=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f)},v=()=>{this._inputFocused=!0},g=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",e),this.$input.addEventListener("keydown",i),this.$input.addEventListener("wheel",r,{passive:!1}),this.$input.addEventListener("mousedown",d),this.$input.addEventListener("focus",v),this.$input.addEventListener("blur",g)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");let e=(m,x,y,_,w)=>(m-x)/(y-x)*(w-_)+_,t=m=>{let x=this.$slider.getBoundingClientRect(),y=e(m,x.left,x.right,this._min,this._max);this._snapClampSetValue(y)},i=m=>{this._setDraggingStyle(!0),t(m.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)},r=m=>{t(m.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)},o=!1,a,l,c=m=>{m.preventDefault(),this._setDraggingStyle(!0),t(m.touches[0].clientX),o=!1},u=m=>{m.touches.length>1||(this._hasScrollBar?(a=m.touches[0].clientX,l=m.touches[0].clientY,o=!0):c(m),window.addEventListener("touchmove",h),window.addEventListener("touchend",d))},h=m=>{if(o){let x=m.touches[0].clientX-a,y=m.touches[0].clientY-l;Math.abs(x)>Math.abs(y)?c(m):(window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d))}else m.preventDefault(),t(m.touches[0].clientX)},d=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d)},p=this._callOnFinishChange.bind(this),f=400,v,g=m=>{if(Math.abs(m.deltaX)<Math.abs(m.deltaY)&&this._hasScrollBar)return;m.preventDefault();let x=this._normalizeMouseWheel(m)*this._step;this._snapClampSetValue(this.getValue()+x),this.$input.value=this.getValue(),clearTimeout(v),v=setTimeout(p,f)};this.$slider.addEventListener("mousedown",i),this.$slider.addEventListener("touchstart",u,{passive:!1}),this.$slider.addEventListener("wheel",g,{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:i}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,i=-e.wheelDelta/120,i*=this._stepExplicit?1:10),t+-i}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){let t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){let e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}},jy=class extends na{constructor(e,t,i,r){super(e,t,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(r)?r:Object.values(r),this._names=Array.isArray(r)?r:Object.keys(r),this._names.forEach(s=>{let o=document.createElement("option");o.innerHTML=s,this.$select.appendChild(o)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){let e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=t===-1?e:this._names[t],this}},Xy=class extends na{constructor(e,t,i){super(e,t,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{r.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}},QU=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  background-color: var(--background-color);
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean .widget {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "\u2195";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background-color: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background-color: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background-color: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "\u25BE";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "\u25B8";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui input {
  -webkit-tap-highlight-color: transparent;
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input::-webkit-outer-spin-button,
.lil-gui input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.lil-gui input[type=number] {
  -moz-appearance: textfield;
}
.lil-gui input[type=checkbox] {
  appearance: none;
  -webkit-appearance: none;
  height: var(--checkbox-size);
  width: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "\u2713";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  -webkit-tap-highlight-color: transparent;
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: 1px solid var(--widget-color);
  text-align: center;
  line-height: calc(var(--widget-height) - 4px);
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
    border-color: var(--hover-color);
  }
  .lil-gui button:focus {
    border-color: var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function ez(n){let e=document.createElement("style");e.innerHTML=n;let t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}var vT=!1,Yy=class n{constructor({parent:e,autoPlace:t=e===void 0,container:i,width:r,title:s="Controls",injectStyles:o=!0,touchStyles:a=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{(l.code==="Enter"||l.code==="Space")&&(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),a&&this.domElement.classList.add("allow-touch-styles"),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),!vT&&o&&(ez(QU),vT=!0),i?i.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this.domElement.addEventListener("keydown",l=>l.stopPropagation()),this.domElement.addEventListener("keyup",l=>l.stopPropagation())}add(e,t,i,r,s){if(Object(i)===i)return new jy(this,e,t,i);let o=e[t];switch(typeof o){case"number":return new qy(this,e,t,i,r,s);case"boolean":return new Vy(this,e,t);case"string":return new Xy(this,e,t);case"function":return new vh(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,o)}addColor(e,t,i=1){return new Wy(this,e,t,i)}addFolder(e){return new n({parent:this,title:e})}load(e,t=!0){return e.controllers&&this.controllers.forEach(i=>{i instanceof vh||i._name in e.controllers&&i.load(e.controllers[i._name])}),t&&e.folders&&this.folders.forEach(i=>{i._title in e.folders&&i.load(e.folders[i._title])}),this}save(e=!0){let t={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof vh)){if(i._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);t.controllers[i._name]=i.save()}}),e&&this.folders.forEach(i=>{if(i._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);t.folders[i._title]=i.save()}),t}open(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{let t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");let i=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);let r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(t=>t.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}},$y=class{constructor(){this.active=!1,this.active&&(this.ui=new Yy({closed:!0,width:400}))}},Sn=class{constructor(){this.callbacks={},this.callbacks.base={}}on(e,t){return typeof e>"u"||e===""?(console.warn("wrong names"),!1):typeof t>"u"?(console.warn("wrong callback"),!1):(this.resolveNames(e).forEach(i=>{let r=this.resolveName(i);this.callbacks[r.namespace]instanceof Object||(this.callbacks[r.namespace]={}),this.callbacks[r.namespace][r.value]instanceof Array||(this.callbacks[r.namespace][r.value]=[]),this.callbacks[r.namespace][r.value].push(t)}),this)}off(e){return typeof e>"u"||e===""?(console.warn("wrong name"),!1):(this.resolveNames(e).forEach(t=>{let i=this.resolveName(t);if(i.namespace!=="base"&&i.value==="")delete this.callbacks[i.namespace];else if(i.namespace==="base")for(let r in this.callbacks)this.callbacks[r]instanceof Object&&this.callbacks[r][i.value]instanceof Array&&(delete this.callbacks[r][i.value],Object.keys(this.callbacks[r]).length===0&&delete this.callbacks[r]);else this.callbacks[i.namespace]instanceof Object&&this.callbacks[i.namespace][i.value]instanceof Array&&(delete this.callbacks[i.namespace][i.value],Object.keys(this.callbacks[i.namespace]).length===0&&delete this.callbacks[i.namespace])}),this)}trigger(e,t){if(typeof e>"u"||e==="")return console.warn("wrong name"),!1;let i=null,r=t instanceof Array?t:[],s=this.resolveNames(e);if(s=this.resolveName(s[0]),s.namespace==="base")for(let o in this.callbacks)this.callbacks[o]instanceof Object&&this.callbacks[o][s.value]instanceof Array&&this.callbacks[o][s.value].forEach(function(a){a.apply(this,r)});else if(this.callbacks[s.namespace]instanceof Object){if(s.value==="")return console.warn("wrong name"),this;this.callbacks[s.namespace][s.value].forEach(function(o){o.apply(this,r)})}return i}resolveNames(e){let t=e;return t=t.replace(/[^a-zA-Z0-9 ,/.]/g,""),t=t.replace(/[,/]+/g," "),t=t.split(" "),t}resolveName(e){let t={},i=e.split(".");return t.original=e,t.value=i[0],t.namespace="base",i.length>1&&i[1]!==""&&(t.namespace=i[1]),t}},tz=55,hf=20,_t=1,Fr=8,yT=["#590D22","#800F2F","#A4133C","#C9184A","#FF4D6D","#FF758F","#FF8FA3","#FFB3C1","#FFCCD5","#FFF0F3"];function xT(n){_t=n}var Ky=class extends Sn{constructor(e){super(),this.searchBarHeight=e,this.app=new Bt,this.time=this.app.time,this.world=this.app.world,this.width=window.innerWidth,this.height=window.innerHeight,this.aspect=this.width/this.height,this.aspectAlt=this.height/this.width,this.pixelRatio=Math.min(window.devicePixelRatio,2),this.visibleWidth=1,this.visibleHeight=1,this.resetEverythingWhenBackToTheTop=!1,this.storedInnerWidth=window.innerWidth,this.storedInnerHeight=window.innerHeight,this.checkSize=!0,this.storedTime,this.currentTime,this.gate1=!0,this.gate2=!0,this.ratioScaler=1,window.addEventListener("resize",()=>{this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=Math.min(window.devicePixelRatio,2),this.trigger("resize"),this.ratioScaler=this.calculateNormalizedScaler(window.innerWidth,window.innerHeight)})}setVisible(){this.visibleHeight=2*Math.tan(this.app.camera.instance.fov*Math.PI/180/2)*hf,this.visibleWidth=this.visibleHeight*this.app.camera.instance.aspect}getVisible(e){let t=2*Math.tan(this.app.camera.instance.fov*Math.PI/180/2)*e,i=t*this.app.camera.instance.aspect;return new Me(i,t)}calculateScaler(e,t){return Math.abs(e-t)}calculateNormalizedScaler(e,t){let i=Math.abs(e-t),r=Math.max(e,t);return r>0?i/r:0}pixelsToWorldUnits(e,t){let i=this.app.camera.instance.fov*Math.PI/180,r=2*Math.tan(i/2)*t,s=this.app.camera.instance.aspect,o=r*s/window.innerWidth;return e*o}startDimentionCheck(){this.time||(this.time=this.app.time),this.setStoredTime(),this.gate2=!0,this.checkSize&&(this.checkSize=!1,this.gate1=!0,this.checkDimentions())}checkDimentions(){if(this.storedTime<this.time.elapsed&&this.gate1){this.gate1=!1,this.gate2=!1,this.checkSize=!0,this.resetEverything();return}setTimeout(()=>{this.gate2&&this.checkDimentions()},500)}setStoredTime(){this.storedTime=this.time.elapsed+500}resetEverything(){this.world||(this.world=this.app.world),scrollY===0?this.reset():this.resetEverythingWhenBackToTheTop=!0}reset(){}},Zy=class extends Sn{constructor(){super(),this.start=Date.now(),this.current=this.start,this.elapsed=0,this.delta=16,this.elapsedSeconds=0,window.requestAnimationFrame(()=>{this.tick()})}tick(){let e=Date.now();this.delta=e-this.current,this.current=e,this.elapsed=this.current-this.start,this.elapsedSeconds=Math.round(this.elapsed*.001),this.trigger("tick"),window.requestAnimationFrame(()=>{this.tick()})}},_T={type:"change"},uv={type:"start"},wT={type:"end"},jp=new Jo,bT=new Ss,iz=Math.cos(70*kM.DEG2RAD),Jy=class extends lo{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new oe,this.cursor=new oe,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Kl.ROTATE,MIDDLE:Kl.DOLLY,RIGHT:Kl.PAN},this.touches={ONE:Zl.ROTATE,TWO:Zl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(se){se.addEventListener("keydown",ge),this._domElementKeyEvents=se},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ge),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(_T),i.update(),s=r.NONE},this.update=function(){let se=new oe,Le=new jn().setFromUnitVectors(e.up,new oe(0,1,0)),Ee=Le.clone().invert(),ke=new oe,We=new jn,Qe=new oe,rt=2*Math.PI;return function(Oe=null){let Ce=i.object.position;se.copy(Ce).sub(i.target),se.applyQuaternion(Le),a.setFromVector3(se),i.autoRotate&&s===r.NONE&&R(S(Oe)),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let le=i.minAzimuthAngle,Pe=i.maxAzimuthAngle;isFinite(le)&&isFinite(Pe)&&(le<-Math.PI?le+=rt:le>Math.PI&&(le-=rt),Pe<-Math.PI?Pe+=rt:Pe>Math.PI&&(Pe-=rt),le<=Pe?a.theta=Math.max(le,Math.min(Pe,a.theta)):a.theta=a.theta>(le+Pe)/2?Math.max(le,a.theta):Math.min(Pe,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor),i.zoomToCursor&&b||i.object.isOrthographicCamera?a.radius=U(a.radius):a.radius=U(a.radius*c),se.setFromSpherical(a),se.applyQuaternion(Ee),Ce.copy(i.target).add(se),i.object.lookAt(i.target),i.enableDamping===!0?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0));let Ve=!1;if(i.zoomToCursor&&b){let et=null;if(i.object.isPerspectiveCamera){let Je=se.length();et=U(Je*c);let Te=Je-et;i.object.position.addScaledVector(_,Te),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){let Je=new oe(w.x,w.y,0);Je.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Ve=!0;let Te=new oe(w.x,w.y,0);Te.unproject(i.object),i.object.position.sub(Te).add(Je),i.object.updateMatrixWorld(),et=se.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;et!==null&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(et).add(i.object.position):(jp.origin.copy(i.object.position),jp.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(jp.direction))<iz?e.lookAt(i.target):(bT.setFromNormalAndCoplanarPoint(i.object.up,i.target),jp.intersectPlane(bT,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Ve=!0);return c=1,b=!1,Ve||ke.distanceToSquared(i.object.position)>o||8*(1-We.dot(i.object.quaternion))>o||Qe.distanceToSquared(i.target)>0?(i.dispatchEvent(_T),ke.copy(i.object.position),We.copy(i.object.quaternion),Qe.copy(i.target),!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",_e),i.domElement.removeEventListener("pointerdown",H),i.domElement.removeEventListener("pointercancel",I),i.domElement.removeEventListener("wheel",pe),i.domElement.removeEventListener("pointermove",q),i.domElement.removeEventListener("pointerup",I),i._domElementKeyEvents!==null&&(i._domElementKeyEvents.removeEventListener("keydown",ge),i._domElementKeyEvents=null)};let i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},s=r.NONE,o=1e-6,a=new tm,l=new tm,c=1,u=new oe,h=new Me,d=new Me,p=new Me,f=new Me,v=new Me,g=new Me,m=new Me,x=new Me,y=new Me,_=new oe,w=new Me,b=!1,T=[],A={};function S(se){return se!==null?2*Math.PI/60*i.autoRotateSpeed*se:2*Math.PI/60/60*i.autoRotateSpeed}function E(se){let Le=Math.abs(se)/(100*(window.devicePixelRatio|0));return Math.pow(.95,i.zoomSpeed*Le)}function R(se){l.theta-=se}function D(se){l.phi-=se}let z=function(){let se=new oe;return function(Le,Ee){se.setFromMatrixColumn(Ee,0),se.multiplyScalar(-Le),u.add(se)}}(),L=function(){let se=new oe;return function(Le,Ee){i.screenSpacePanning===!0?se.setFromMatrixColumn(Ee,1):(se.setFromMatrixColumn(Ee,0),se.crossVectors(i.object.up,se)),se.multiplyScalar(Le),u.add(se)}}(),G=function(){let se=new oe;return function(Le,Ee){let ke=i.domElement;if(i.object.isPerspectiveCamera){let We=i.object.position;se.copy(We).sub(i.target);let Qe=se.length();Qe*=Math.tan(i.object.fov/2*Math.PI/180),z(2*Le*Qe/ke.clientHeight,i.object.matrix),L(2*Ee*Qe/ke.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(z(Le*(i.object.right-i.object.left)/i.object.zoom/ke.clientWidth,i.object.matrix),L(Ee*(i.object.top-i.object.bottom)/i.object.zoom/ke.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function J(se){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=se:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function X(se){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=se:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function N(se,Le){if(!i.zoomToCursor)return;b=!0;let Ee=i.domElement.getBoundingClientRect(),ke=se-Ee.left,We=Le-Ee.top,Qe=Ee.width,rt=Ee.height;w.x=ke/Qe*2-1,w.y=-(We/rt)*2+1,_.set(w.x,w.y,1).unproject(i.object).sub(i.object.position).normalize()}function U(se){return Math.max(i.minDistance,Math.min(i.maxDistance,se))}function O(se){h.set(se.clientX,se.clientY)}function F(se){N(se.clientX,se.clientX),m.set(se.clientX,se.clientY)}function $(se){f.set(se.clientX,se.clientY)}function P(se){d.set(se.clientX,se.clientY),p.subVectors(d,h).multiplyScalar(i.rotateSpeed);let Le=i.domElement;R(2*Math.PI*p.x/Le.clientHeight),D(2*Math.PI*p.y/Le.clientHeight),h.copy(d),i.update()}function C(se){x.set(se.clientX,se.clientY),y.subVectors(x,m),y.y>0?J(E(y.y)):y.y<0&&X(E(y.y)),m.copy(x),i.update()}function M(se){v.set(se.clientX,se.clientY),g.subVectors(v,f).multiplyScalar(i.panSpeed),G(g.x,g.y),f.copy(v),i.update()}function B(se){N(se.clientX,se.clientY),se.deltaY<0?X(E(se.deltaY)):se.deltaY>0&&J(E(se.deltaY)),i.update()}function k(se){let Le=!1;switch(se.code){case i.keys.UP:se.ctrlKey||se.metaKey||se.shiftKey?D(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(0,i.keyPanSpeed),Le=!0;break;case i.keys.BOTTOM:se.ctrlKey||se.metaKey||se.shiftKey?D(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(0,-i.keyPanSpeed),Le=!0;break;case i.keys.LEFT:se.ctrlKey||se.metaKey||se.shiftKey?R(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(i.keyPanSpeed,0),Le=!0;break;case i.keys.RIGHT:se.ctrlKey||se.metaKey||se.shiftKey?R(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(-i.keyPanSpeed,0),Le=!0;break}Le&&(se.preventDefault(),i.update())}function Q(se){if(T.length===1)h.set(se.pageX,se.pageY);else{let Le=it(se),Ee=.5*(se.pageX+Le.x),ke=.5*(se.pageY+Le.y);h.set(Ee,ke)}}function Y(se){if(T.length===1)f.set(se.pageX,se.pageY);else{let Le=it(se),Ee=.5*(se.pageX+Le.x),ke=.5*(se.pageY+Le.y);f.set(Ee,ke)}}function re(se){let Le=it(se),Ee=se.pageX-Le.x,ke=se.pageY-Le.y,We=Math.sqrt(Ee*Ee+ke*ke);m.set(0,We)}function Z(se){i.enableZoom&&re(se),i.enablePan&&Y(se)}function V(se){i.enableZoom&&re(se),i.enableRotate&&Q(se)}function ne(se){if(T.length==1)d.set(se.pageX,se.pageY);else{let Ee=it(se),ke=.5*(se.pageX+Ee.x),We=.5*(se.pageY+Ee.y);d.set(ke,We)}p.subVectors(d,h).multiplyScalar(i.rotateSpeed);let Le=i.domElement;R(2*Math.PI*p.x/Le.clientHeight),D(2*Math.PI*p.y/Le.clientHeight),h.copy(d)}function ie(se){if(T.length===1)v.set(se.pageX,se.pageY);else{let Le=it(se),Ee=.5*(se.pageX+Le.x),ke=.5*(se.pageY+Le.y);v.set(Ee,ke)}g.subVectors(v,f).multiplyScalar(i.panSpeed),G(g.x,g.y),f.copy(v)}function te(se){let Le=it(se),Ee=se.pageX-Le.x,ke=se.pageY-Le.y,We=Math.sqrt(Ee*Ee+ke*ke);x.set(0,We),y.set(0,Math.pow(x.y/m.y,i.zoomSpeed)),J(y.y),m.copy(x);let Qe=(se.pageX+Le.x)*.5,rt=(se.pageY+Le.y)*.5;N(Qe,rt)}function j(se){i.enableZoom&&te(se),i.enablePan&&ie(se)}function W(se){i.enableZoom&&te(se),i.enableRotate&&ne(se)}function H(se){i.enabled!==!1&&(T.length===0&&(i.domElement.setPointerCapture(se.pointerId),i.domElement.addEventListener("pointermove",q),i.domElement.addEventListener("pointerup",I)),Ie(se),se.pointerType==="touch"?xe(se):ee(se))}function q(se){i.enabled!==!1&&(se.pointerType==="touch"?we(se):me(se))}function I(se){Be(se),T.length===0&&(i.domElement.releasePointerCapture(se.pointerId),i.domElement.removeEventListener("pointermove",q),i.domElement.removeEventListener("pointerup",I)),i.dispatchEvent(wT),s=r.NONE}function ee(se){let Le;switch(se.button){case 0:Le=i.mouseButtons.LEFT;break;case 1:Le=i.mouseButtons.MIDDLE;break;case 2:Le=i.mouseButtons.RIGHT;break;default:Le=-1}switch(Le){case Kl.DOLLY:if(i.enableZoom===!1)return;F(se),s=r.DOLLY;break;case Kl.ROTATE:if(se.ctrlKey||se.metaKey||se.shiftKey){if(i.enablePan===!1)return;$(se),s=r.PAN}else{if(i.enableRotate===!1)return;O(se),s=r.ROTATE}break;case Kl.PAN:if(se.ctrlKey||se.metaKey||se.shiftKey){if(i.enableRotate===!1)return;O(se),s=r.ROTATE}else{if(i.enablePan===!1)return;$(se),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(uv)}function me(se){switch(s){case r.ROTATE:if(i.enableRotate===!1)return;P(se);break;case r.DOLLY:if(i.enableZoom===!1)return;C(se);break;case r.PAN:if(i.enablePan===!1)return;M(se);break}}function pe(se){i.enabled===!1||i.enableZoom===!1||s!==r.NONE||(se.preventDefault(),i.dispatchEvent(uv),B(se),i.dispatchEvent(wT))}function ge(se){i.enabled===!1||i.enablePan===!1||k(se)}function xe(se){switch(Ae(se),T.length){case 1:switch(i.touches.ONE){case Zl.ROTATE:if(i.enableRotate===!1)return;Q(se),s=r.TOUCH_ROTATE;break;case Zl.PAN:if(i.enablePan===!1)return;Y(se),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case Zl.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Z(se),s=r.TOUCH_DOLLY_PAN;break;case Zl.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;V(se),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(uv)}function we(se){switch(Ae(se),s){case r.TOUCH_ROTATE:if(i.enableRotate===!1)return;ne(se),i.update();break;case r.TOUCH_PAN:if(i.enablePan===!1)return;ie(se),i.update();break;case r.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;j(se),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;W(se),i.update();break;default:s=r.NONE}}function _e(se){i.enabled!==!1&&se.preventDefault()}function Ie(se){T.push(se.pointerId)}function Be(se){delete A[se.pointerId];for(let Le=0;Le<T.length;Le++)if(T[Le]==se.pointerId){T.splice(Le,1);return}}function Ae(se){let Le=A[se.pointerId];Le===void 0&&(Le=new Me,A[se.pointerId]=Le),Le.set(se.pageX,se.pageY)}function it(se){let Le=se.pointerId===T[0]?T[1]:T[0];return A[Le]}i.domElement.addEventListener("contextmenu",_e),i.domElement.addEventListener("pointerdown",H),i.domElement.addEventListener("pointercancel",I),i.domElement.addEventListener("wheel",pe,{passive:!1}),this.update()}},hv=null,Yt=class{constructor(){if(hv)return hv;hv=this}getRandomVector3(){return new oe((Math.random()-.5)*10,(Math.random()-.5)*10,(Math.random()-.5)*10)}getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}getRandomIntWithGap(e,t,i,r){e=Math.ceil(e),t=Math.floor(t);let s=Math.floor(Math.random()*(t-e)+e);return s>i&&s<r&&(s=this.getRandomIntWithGap(e,t,i,r)),s}magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}isBetween(e,t,i){return i>e&&i<t}createScreenSpacePlane(e,t,i=new Me){let r=e.aspect,s=e.fov*Math.PI/180,o=2*Math.tan(s/2)*(t*1.2),a=o*r;return i.set(a,o)}getThreeXPositionFromScreenX(e,t,i){if(!t)return;let r=e/window.innerWidth*2-1,s=new oe(r,0,.5);s.unproject(t);let o=s.sub(i).normalize(),a=-i.z/o.z;return i.clone().add(o.multiplyScalar(a)).x}getThreePositionFromScreenPosition(e,t,i,r){if(!t)return;let s=new oe,o=new oe(e.x/window.innerWidth*2-1,-(e.y/window.innerHeight)*2+1,0);o.unproject(t),o.sub(r).normalize();let a=-i/o.z;return s.copy(r).add(o.multiplyScalar(a))}getRandomColor(e){function t(i){var r=255-i,s=0|Math.random()*r+i,o=s.toString(16);return o.length==1?"0"+o:o}return new at("#"+t(e)+t(e)+t(e))}getRandomShade(){var e=Math.random();return new at(e,e,e)}getRandomColorFromPalette(){let e=Math.round(Math.random()*yT.length);return new at(yT[e])}lerp(e,t,i){return e*(1-i)+t*i}lerp2(e,t,i){return(1-i)*e+i*t}smoothStep2(e,t){let i=e*e,r=1-(1-e)*(1-e);return this.lerp(i,r,e*t)}smoothstep(e,t,i){let r=Math.min(Math.max((i-e)/(t-e),0),1);return r*r*(3-2*r)}clamp(e,t,i){return Math.min(Math.max(i,e),t)}tri(e){let t=e%2/2,i=0;return t<.5?i=t*4-1:i=(1-t)*4-1,i}squ(e){return e%2/2<.5?1:-1}saw(e){return e%2/2*2-1}update3DObjectPosition(e,t,i){let r=e.getBoundingClientRect(),s=(r.left+r.width/2)/window.innerWidth*2-1,o=-(r.top+r.height/2)/window.innerHeight*2+1,a=new oe(s,o,0);return a.unproject(i),a}update3DObjectPositionWithOffsetX(e,t,i,r,s){let o=e.getBoundingClientRect(),a=(o.left+o.width/2+r)/window.innerWidth*2-1,l=-(o.top+o.height/2+s)/window.innerHeight*2+1,c=new oe(a,l,0);return c.unproject(i),c}findPositionedAncestor(e){for(e=e.parentElement;e&&e!==document;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return null}getYPpositionFromElement(e){return e.getBoundingClientRect().top+window.scrollY}},Qy=class extends Sn{constructor(e){super(),this.app=new Bt,this.helper=new Yt,this.group=e,this.sizes=this.app.sizes,this.time=this.app.time,this.scene=this.app.scene,this.canvas=this.app.canvas,this.debug=this.app.debug,this.scrollManager=this.app.scrollManager,this.mouse=this.app.mouse,this.cullingDistance=200,this.floatiness=5,this.pump=1e-5,this.cameraTrackingGroup=new vt,this.cameraTrackingGroup.name="cameraTrackingGroup",this.ease="circ.inOut",this.effectController={position:{x:0,y:0,z:hf},rotation:{x:0,y:0,z:0},fov:55,focus:10,near:.1,far:1e3},this.setInstance(),this.sizes.on("resize",()=>{this.resize()}),this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("camera"),this.debugFolder.close(),this.setupDebugUi())}setInstance(){this.instance=new tr(tz,this.sizes.width/this.sizes.height,.1,90),this.instance.position.set(0,0,hf),this.group.add(this.instance,this.cameraTrackingGroup);let e=hf,t=this.instance.fov*(Math.PI/180),i=2*Math.tan(t/2)*e,r=this.sizes.width/this.sizes.height,s=i/2,o=r*s;this.left=-o,this.right=o,this.top=s,this.bottom=-s,this.instance.updateProjectionMatrix(),this.matChanger()}getInstance(){return this.instance?this.instance:null}setControls(){this.controls=new Jy(this.instance,this.canvas),this.controls.enableDamping=!0}resize(){this.instance.aspect=this.sizes.width/this.sizes.height,this.instance.updateProjectionMatrix()}calculateFov(e){return 75*(e/(window.innerWidth/window.innerHeight))}setupDebugUi(){this.debugFolder.add(this.effectController.position,"x").min(-5).max(5).step(.001).name("camera x").onChange(this.matChanger()),this.debugFolder.add(this.effectController.position,"y").min(.1).max(5).step(.001).name("camera y").onChange(this.matChanger()),this.debugFolder.add(this.effectController.position,"z").min(0).max(120).step(.001).name("camera z").onChange(this.matChanger()),this.debugFolder.add(this.effectController.rotation,"x").min(-Math.PI).max(Math.PI).step(.001).name("rotate x").onChange(this.matChanger()),this.debugFolder.add(this.effectController.rotation,"y").min(-Math.PI).max(Math.PI).step(.001).name("rotate y").onChange(this.matChanger()),this.debugFolder.add(this.effectController.rotation,"z").min(-Math.PI).max(Math.PI).step(.001).name("rotate z").onChange(this.matChanger()),this.debugFolder.add(this.effectController,"fov").min(10).max(145).step(1).name("fov").onChange(this.matChanger()),this.debugFolder.add(this.effectController,"near").min(.1).max(20).step(.1).name("near").onChange(this.matChanger()),this.debugFolder.add(this.effectController,"far").min(5).max(20).step(.1).name("far").onChange(this.matChanger())}matChanger(){return()=>{this.instance.position.x=this.effectController.position.x,this.instance.position.y=this.effectController.position.y,this.instance.position.z=this.effectController.position.z,this.instance.rotation.x=this.effectController.rotation.x,this.instance.rotation.y=this.effectController.rotation.y,this.instance.rotation.z=this.effectController.rotation.z,this.instance.fov=this.effectController.fov,this.instance.updateProjectionMatrix(),this.instance.focus=this.effectController.focus,this.instance.near=this.effectController.near,this.instance.far=this.effectController.far}}update(){}},ex=class{constructor(){this.app=new Bt,this.helper=new Yt,this.time=this.app.time,this.canvas=this.app.canvas,this.debug=this.app.debug,this.sizes=this.app.sizes,this.scene=this.app.scene,this.resources=this.app.resources,this.camera=this.app.camera,this.debug=this.app.debug,this.startRendering=!1,this.setInstance(),this.sizes.on("resize",()=>{this.resize()})}setInstance(){this.instance=new Bh({stencil:!0,alpha:!0,canvas:this.canvas,antialias:!0}),this.instance.sortObjects=!0,this.instance.outputColorSpace=Ht,this.instance.toneMappingExposure=Math.pow(1.051,10),this.instance.physicallyCorrectLights=!0,this.instance.shadowMap.enabled=!1,this.instance.setClearColor(0,0),this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}resize(){this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}update(){this.instance.render(this.scene,this.camera.instance)}};function Qs(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function ZM(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var wn={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Yc={duration:.5,overwrite:!1,delay:0},U1,vr,Ai,Gn=1e8,Xt=1/Gn,tx=Math.PI*2,rz=tx/4,nz=0,JM=Math.sqrt,sz=Math.cos,oz=Math.sin,Yi=function(n){return typeof n=="string"},vi=function(n){return typeof n=="function"},ho=function(n){return typeof n=="number"},z1=function(n){return typeof n>"u"},Ps=function(n){return typeof n=="object"},Jr=function(n){return n!==!1},B1=function(){return typeof window<"u"},Xp=function(n){return vi(n)||Yi(n)},QM=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},yr=Array.isArray,ix=/(?:-?\.?\d|\.)+/gi,e2=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ec=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,dv=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,t2=/[+-]=-?[.\d]+/,i2=/[^,'"\[\]\s]+/gi,az=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,li,Fn,rx,N1,En={},im={},r2,n2=function(n){return(im=xl(n,En))&&rn},G1=function(n,e){return console.warn("Invalid property",n,"set to",e,"Missing plugin? gsap.registerPlugin()")},rm=function(n,e){return!e&&console.warn(n)},s2=function(n,e){return n&&(En[n]=e)&&im&&(im[n]=e)||En},Kh=function(){return 0},lz={suppressEvents:!0,isStart:!0,kill:!1},df={suppressEvents:!0,kill:!1},cz={suppressEvents:!0},V1={},Yo=[],nx={},o2,gn={},pv={},ST=30,pf=[],H1="",W1=function(n){var e=n[0],t,i;if(Ps(e)||vi(e)||(n=[n]),!(t=(e._gsap||{}).harness)){for(i=pf.length;i--&&!pf[i].targetTest(e););t=pf[i]}for(i=n.length;i--;)n[i]&&(n[i]._gsap||(n[i]._gsap=new P2(n[i],t)))||n.splice(i,1);return n},ll=function(n){return n._gsap||W1(Vn(n))[0]._gsap},a2=function(n,e,t){return(t=n[e])&&vi(t)?n[e]():z1(t)&&n.getAttribute&&n.getAttribute(e)||t},Qr=function(n,e){return(n=n.split(",")).forEach(e)||n},_i=function(n){return Math.round(n*1e5)/1e5||0},ir=function(n){return Math.round(n*1e7)/1e7||0},Lc=function(n,e){var t=e.charAt(0),i=parseFloat(e.substr(2));return n=parseFloat(n),t==="+"?n+i:t==="-"?n-i:t==="*"?n*i:n/i},uz=function(n,e){for(var t=e.length,i=0;n.indexOf(e[i])<0&&++i<t;);return i<t},nm=function(){var n=Yo.length,e=Yo.slice(0),t,i;for(nx={},Yo.length=0,t=0;t<n;t++)i=e[t],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},l2=function(n,e,t,i){Yo.length&&!vr&&nm(),n.render(e,t,i||vr&&e<0&&(n._initted||n._startAt)),Yo.length&&!vr&&nm()},c2=function(n){var e=parseFloat(n);return(e||e===0)&&(n+"").match(i2).length<2?e:Yi(n)?n.trim():n},u2=function(n){return n},$n=function(n,e){for(var t in e)t in n||(n[t]=e[t]);return n},hz=function(n){return function(e,t){for(var i in t)i in e||i==="duration"&&n||i==="ease"||(e[i]=t[i])}},xl=function(n,e){for(var t in e)n[t]=e[t];return n},ET=function n(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Ps(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},sm=function(n,e){var t={},i;for(i in n)i in e||(t[i]=n[i]);return t},yh=function(n){var e=n.parent||li,t=n.keyframes?hz(yr(n.keyframes)):$n;if(Jr(n.inherit))for(;e;)t(n,e.vars.defaults),e=e.parent||e._dp;return n},dz=function(n,e){for(var t=n.length,i=t===e.length;i&&t--&&n[t]===e[t];);return t<0},h2=function(n,e,t,i,r){t===void 0&&(t="_first"),i===void 0&&(i="_last");var s=n[i],o;if(r)for(o=e[r];s&&s[r]>o;)s=s._prev;return s?(e._next=s._next,s._next=e):(e._next=n[t],n[t]=e),e._next?e._next._prev=e:n[i]=e,e._prev=s,e.parent=e._dp=n,e},wm=function(n,e,t,i){t===void 0&&(t="_first"),i===void 0&&(i="_last");var r=e._prev,s=e._next;r?r._next=s:n[t]===e&&(n[t]=s),s?s._prev=r:n[i]===e&&(n[i]=r),e._next=e._prev=e.parent=null},sa=function(n,e){n.parent&&(!e||n.parent.autoRemoveChildren)&&n.parent.remove(n),n._act=0},cl=function(n,e){if(n&&(!e||e._end>n._dur||e._start<0))for(var t=n;t;)t._dirty=1,t=t.parent;return n},pz=function(n){for(var e=n.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return n},sx=function(n,e,t,i){return n._startAt&&(vr?n._startAt.revert(df):n.vars.immediateRender&&!n.vars.autoRevert||n._startAt.render(e,!0,i))},fz=function n(e){return!e||e._ts&&n(e.parent)},TT=function(n){return n._repeat?$c(n._tTime,n=n.duration()+n._rDelay)*n:0},$c=function(n,e){var t=Math.floor(n/=e);return n&&t===n?t-1:t},om=function(n,e){return(n-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},bm=function(n){return n._end=ir(n._start+(n._tDur/Math.abs(n._ts||n._rts||Xt)||0))},Sm=function(n,e){var t=n._dp;return t&&t.smoothChildTiming&&n._ts&&(n._start=ir(t._time-(n._ts>0?e/n._ts:((n._dirty?n.totalDuration():n._tDur)-e)/-n._ts)),bm(n),t._dirty||cl(t,n)),n},d2=function(n,e){var t;if((e._time||e._initted&&!e._dur)&&(t=om(n.rawTime(),e),(!e._dur||rd(0,e.totalDuration(),t)-e._tTime>Xt)&&e.render(t,!0)),cl(n,e)._dp&&n._initted&&n._time>=n._dur&&n._ts){if(n._dur<n.duration())for(t=n;t._dp;)t.rawTime()>=0&&t.totalTime(t._tTime),t=t._dp;n._zTime=-Xt}},Ms=function(n,e,t,i){return e.parent&&sa(e),e._start=ir((ho(t)?t:t||n!==li?In(n,t,e):n._time)+e._delay),e._end=ir(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),h2(n,e,"_first","_last",n._sort?"_start":0),ox(e)||(n._recent=e),i||d2(n,e),n._ts<0&&Sm(n,n._tTime),n},p2=function(n,e){return(En.ScrollTrigger||G1("scrollTrigger",e))&&En.ScrollTrigger.create(e,n)},f2=function(n,e,t,i,r){if(j1(n,e,r),!n._initted)return 1;if(!t&&n._pt&&!vr&&(n._dur&&n.vars.lazy!==!1||!n._dur&&n.vars.lazy)&&o2!==yn.frame)return Yo.push(n),n._lazy=[r,i],1},mz=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},ox=function(n){var e=n.data;return e==="isFromStart"||e==="isStart"},gz=function(n,e,t,i){var r=n.ratio,s=e<0||!e&&(!n._start&&mz(n)&&!(!n._initted&&ox(n))||(n._ts<0||n._dp._ts<0)&&!ox(n))?0:1,o=n._rDelay,a=0,l,c,u;if(o&&n._repeat&&(a=rd(0,n._tDur,e),c=$c(a,o),n._yoyo&&c&1&&(s=1-s),c!==$c(n._tTime,o)&&(r=1-s,n.vars.repeatRefresh&&n._initted&&n.invalidate())),s!==r||vr||i||n._zTime===Xt||!e&&n._zTime){if(!n._initted&&f2(n,e,i,t,a))return;for(u=n._zTime,n._zTime=e||(t?Xt:0),t||(t=e&&!u),n.ratio=s,n._from&&(s=1-s),n._time=0,n._tTime=a,l=n._pt;l;)l.r(s,l.d),l=l._next;e<0&&sx(n,e,t,!0),n._onUpdate&&!t&&Hn(n,"onUpdate"),a&&n._repeat&&!t&&n.parent&&Hn(n,"onRepeat"),(e>=n._tDur||e<0)&&n.ratio===s&&(s&&sa(n,1),!t&&!vr&&(Hn(n,s?"onComplete":"onReverseComplete",!0),n._prom&&n._prom()))}else n._zTime||(n._zTime=e)},vz=function(n,e,t){var i;if(t>e)for(i=n._first;i&&i._start<=t;){if(i.data==="isPause"&&i._start>e)return i;i=i._next}else for(i=n._last;i&&i._start>=t;){if(i.data==="isPause"&&i._start<e)return i;i=i._prev}},Kc=function(n,e,t,i){var r=n._repeat,s=ir(e)||0,o=n._tTime/n._tDur;return o&&!i&&(n._time*=s/n._dur),n._dur=s,n._tDur=r?r<0?1e10:ir(s*(r+1)+n._rDelay*r):s,o>0&&!i&&Sm(n,n._tTime=n._tDur*o),n.parent&&bm(n),t||cl(n.parent,n),n},MT=function(n){return n instanceof Zr?cl(n):Kc(n,n._dur)},yz={_start:0,endTime:Kh,totalDuration:Kh},In=function n(e,t,i){var r=e.labels,s=e._recent||yz,o=e.duration()>=Gn?s.endTime(!1):e._dur,a,l,c;return Yi(t)&&(isNaN(t)||t in r)?(l=t.charAt(0),c=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(a<0?s:i).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),c&&i&&(l=l/100*(yr(i)?i[0]:i).totalDuration()),a>1?n(e,t.substr(0,a-1),i)+l:o+l)):t==null?o:+t},xh=function(n,e,t){var i=ho(e[1]),r=(i?2:1)+(n<2?0:1),s=e[r],o,a;if(i&&(s.duration=e[1]),s.parent=t,n){for(o=s,a=t;a&&!("immediateRender"in o);)o=a.vars.defaults||{},a=Jr(a.vars.inherit)&&a.parent;s.immediateRender=Jr(o.immediateRender),n<2?s.runBackwards=1:s.startAt=e[r-1]}return new Oi(e[0],s,e[r+1])},la=function(n,e){return n||n===0?e(n):e},rd=function(n,e,t){return t<n?n:t>e?e:t},mr=function(n,e){return!Yi(n)||!(e=az.exec(n))?"":e[1]},xz=function(n,e,t){return la(t,function(i){return rd(n,e,i)})},ax=[].slice,m2=function(n,e){return n&&Ps(n)&&"length"in n&&(!e&&!n.length||n.length-1 in n&&Ps(n[0]))&&!n.nodeType&&n!==Fn},_z=function(n,e,t){return t===void 0&&(t=[]),n.forEach(function(i){var r;return Yi(i)&&!e||m2(i,1)?(r=t).push.apply(r,Vn(i)):t.push(i)})||t},Vn=function(n,e,t){return Ai&&!e&&Ai.selector?Ai.selector(n):Yi(n)&&!t&&(rx||!Zc())?ax.call((e||N1).querySelectorAll(n),0):yr(n)?_z(n,t):m2(n)?ax.call(n,0):n?[n]:[]},lx=function(n){return n=Vn(n)[0]||rm("Invalid scope")||{},function(e){var t=n.current||n.nativeElement||n;return Vn(e,t.querySelectorAll?t:t===n?rm("Invalid scope")||N1.createElement("div"):n)}},g2=function(n){return n.sort(function(){return .5-Math.random()})},v2=function(n){if(vi(n))return n;var e=Ps(n)?n:{each:n},t=ul(e.ease),i=e.from||0,r=parseFloat(e.base)||0,s={},o=i>0&&i<1,a=isNaN(i)||o,l=e.axis,c=i,u=i;return Yi(i)?c=u={center:.5,edges:.5,end:1}[i]||0:!o&&a&&(c=i[0],u=i[1]),function(h,d,p){var f=(p||e).length,v=s[f],g,m,x,y,_,w,b,T,A;if(!v){if(A=e.grid==="auto"?0:(e.grid||[1,Gn])[1],!A){for(b=-Gn;b<(b=p[A++].getBoundingClientRect().left)&&A<f;);A--}for(v=s[f]=[],g=a?Math.min(A,f)*c-.5:i%A,m=A===Gn?0:a?f*u/A-.5:i/A|0,b=0,T=Gn,w=0;w<f;w++)x=w%A-g,y=m-(w/A|0),v[w]=_=l?Math.abs(l==="y"?y:x):JM(x*x+y*y),_>b&&(b=_),_<T&&(T=_);i==="random"&&g2(v),v.max=b-T,v.min=T,v.v=f=(parseFloat(e.amount)||parseFloat(e.each)*(A>f?f-1:l?l==="y"?f/A:A:Math.max(A,f/A))||0)*(i==="edges"?-1:1),v.b=f<0?r-f:r,v.u=mr(e.amount||e.each)||0,t=t&&f<0?A2(t):t}return f=(v[h]-v.min)/v.max||0,ir(v.b+(t?t(f):f)*v.v)+v.u}},cx=function(n){var e=Math.pow(10,((n+"").split(".")[1]||"").length);return function(t){var i=ir(Math.round(parseFloat(t)/n)*n*e);return(i-i%1)/e+(ho(t)?0:mr(t))}},y2=function(n,e){var t=yr(n),i,r;return!t&&Ps(n)&&(i=t=n.radius||Gn,n.values?(n=Vn(n.values),(r=!ho(n[0]))&&(i*=i)):n=cx(n.increment)),la(e,t?vi(n)?function(s){return r=n(s),Math.abs(r-s)<=i?r:s}:function(s){for(var o=parseFloat(r?s.x:s),a=parseFloat(r?s.y:0),l=Gn,c=0,u=n.length,h,d;u--;)r?(h=n[u].x-o,d=n[u].y-a,h=h*h+d*d):h=Math.abs(n[u]-o),h<l&&(l=h,c=u);return c=!i||l<=i?n[c]:s,r||c===s||ho(s)?c:c+mr(s)}:cx(n))},x2=function(n,e,t,i){return la(yr(n)?!e:t===!0?!!(t=0):!i,function(){return yr(n)?n[~~(Math.random()*n.length)]:(t=t||1e-5)&&(i=t<1?Math.pow(10,(t+"").length-2):1)&&Math.floor(Math.round((n-t/2+Math.random()*(e-n+t*.99))/t)*t*i)/i})},wz=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(i){return e.reduce(function(r,s){return s(r)},i)}},bz=function(n,e){return function(t){return n(parseFloat(t))+(e||mr(t))}},Sz=function(n,e,t){return w2(n,e,0,1,t)},_2=function(n,e,t){return la(t,function(i){return n[~~e(i)]})},Ez=function n(e,t,i){var r=t-e;return yr(e)?_2(e,n(0,e.length),t):la(i,function(s){return(r+(s-e)%r)%r+e})},Tz=function n(e,t,i){var r=t-e,s=r*2;return yr(e)?_2(e,n(0,e.length-1),t):la(i,function(o){return o=(s+(o-e)%s)%s||0,e+(o>r?s-o:o)})},Zh=function(n){for(var e=0,t="",i,r,s,o;~(i=n.indexOf("random(",e));)s=n.indexOf(")",i),o=n.charAt(i+7)==="[",r=n.substr(i+7,s-i-7).match(o?i2:ix),t+=n.substr(e,i-e)+x2(o?r:+r[0],o?0:+r[1],+r[2]||1e-5),e=s+1;return t+n.substr(e,n.length-e)},w2=function(n,e,t,i,r){var s=e-n,o=i-t;return la(r,function(a){return t+((a-n)/s*o||0)})},Mz=function n(e,t,i,r){var s=isNaN(e+t)?0:function(p){return(1-p)*e+p*t};if(!s){var o=Yi(e),a={},l,c,u,h,d;if(i===!0&&(r=1)&&(i=null),o)e={p:e},t={p:t};else if(yr(e)&&!yr(t)){for(u=[],h=e.length,d=h-2,c=1;c<h;c++)u.push(n(e[c-1],e[c]));h--,s=function(p){p*=h;var f=Math.min(d,~~p);return u[f](p-f)},i=t}else r||(e=xl(yr(e)?[]:{},e));if(!u){for(l in t)q1.call(a,e,l,"get",t[l]);s=function(p){return $1(p,a)||(o?e.p:e)}}}return la(i,s)},AT=function(n,e,t){var i=n.labels,r=Gn,s,o,a;for(s in i)o=i[s]-e,o<0==!!t&&o&&r>(o=Math.abs(o))&&(a=s,r=o);return a},Hn=function(n,e,t){var i=n.vars,r=i[e],s=Ai,o=n._ctx,a,l,c;if(r)return a=i[e+"Params"],l=i.callbackScope||n,t&&Yo.length&&nm(),o&&(Ai=o),c=a?r.apply(l,a):r.call(l),Ai=s,c},oh=function(n){return sa(n),n.scrollTrigger&&n.scrollTrigger.kill(!!vr),n.progress()<1&&Hn(n,"onInterrupt"),n},Tc,b2=[],S2=function(n){if(!B1()){b2.push(n);return}n=!n.name&&n.default||n;var e=n.name,t=vi(n),i=e&&!t&&n.init?function(){this._props=[]}:n,r={init:Kh,render:$1,add:q1,kill:Vz,modifier:Gz,rawVars:0},s={targetTest:0,get:0,getSetter:Y1,aliases:{},register:0};if(Zc(),n!==i){if(gn[e])return;$n(i,$n(sm(n,r),s)),xl(i.prototype,xl(r,sm(n,s))),gn[i.prop=e]=i,n.targetTest&&(pf.push(i),V1[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}s2(e,i),n.register&&n.register(rn,i,en)},jt=255,ah={aqua:[0,jt,jt],lime:[0,jt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,jt],navy:[0,0,128],white:[jt,jt,jt],olive:[128,128,0],yellow:[jt,jt,0],orange:[jt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[jt,0,0],pink:[jt,192,203],cyan:[0,jt,jt],transparent:[jt,jt,jt,0]},fv=function(n,e,t){return n+=n<0?1:n>1?-1:0,(n*6<1?e+(t-e)*n*6:n<.5?t:n*3<2?e+(t-e)*(2/3-n)*6:e)*jt+.5|0},E2=function(n,e,t){var i=n?ho(n)?[n>>16,n>>8&jt,n&jt]:0:ah.black,r,s,o,a,l,c,u,h,d,p;if(!i){if(n.substr(-1)===","&&(n=n.substr(0,n.length-1)),ah[n])i=ah[n];else if(n.charAt(0)==="#"){if(n.length<6&&(r=n.charAt(1),s=n.charAt(2),o=n.charAt(3),n="#"+r+r+s+s+o+o+(n.length===5?n.charAt(4)+n.charAt(4):"")),n.length===9)return i=parseInt(n.substr(1,6),16),[i>>16,i>>8&jt,i&jt,parseInt(n.substr(7),16)/255];n=parseInt(n.substr(1),16),i=[n>>16,n>>8&jt,n&jt]}else if(n.substr(0,3)==="hsl"){if(i=p=n.match(ix),!e)a=+i[0]%360/360,l=+i[1]/100,c=+i[2]/100,s=c<=.5?c*(l+1):c+l-c*l,r=c*2-s,i.length>3&&(i[3]*=1),i[0]=fv(a+1/3,r,s),i[1]=fv(a,r,s),i[2]=fv(a-1/3,r,s);else if(~n.indexOf("="))return i=n.match(e2),t&&i.length<4&&(i[3]=1),i}else i=n.match(ix)||ah.transparent;i=i.map(Number)}return e&&!p&&(r=i[0]/jt,s=i[1]/jt,o=i[2]/jt,u=Math.max(r,s,o),h=Math.min(r,s,o),c=(u+h)/2,u===h?a=l=0:(d=u-h,l=c>.5?d/(2-u-h):d/(u+h),a=u===r?(s-o)/d+(s<o?6:0):u===s?(o-r)/d+2:(r-s)/d+4,a*=60),i[0]=~~(a+.5),i[1]=~~(l*100+.5),i[2]=~~(c*100+.5)),t&&i.length<4&&(i[3]=1),i},T2=function(n){var e=[],t=[],i=-1;return n.split($o).forEach(function(r){var s=r.match(Ec)||[];e.push.apply(e,s),t.push(i+=s.length+1)}),e.c=t,e},CT=function(n,e,t){var i="",r=(n+i).match($o),s=e?"hsla(":"rgba(",o=0,a,l,c,u;if(!r)return n;if(r=r.map(function(h){return(h=E2(h,e,1))&&s+(e?h[0]+","+h[1]+"%,"+h[2]+"%,"+h[3]:h.join(","))+")"}),t&&(c=T2(n),a=t.c,a.join(i)!==c.c.join(i)))for(l=n.replace($o,"1").split(Ec),u=l.length-1;o<u;o++)i+=l[o]+(~a.indexOf(o)?r.shift()||s+"0,0,0,0)":(c.length?c:r.length?r:t).shift());if(!l)for(l=n.split($o),u=l.length-1;o<u;o++)i+=l[o]+r[o];return i+l[u]},$o=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in ah)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),Az=/hsl[a]?\(/,M2=function(n){var e=n.join(" "),t;if($o.lastIndex=0,$o.test(e))return t=Az.test(e),n[1]=CT(n[1],t),n[0]=CT(n[0],t,T2(n[1])),!0},Jh,yn=function(){var n=Date.now,e=500,t=33,i=n(),r=i,s=1e3/240,o=s,a=[],l,c,u,h,d,p,f=function v(g){var m=n()-r,x=g===!0,y,_,w,b;if(m>e&&(i+=m-t),r+=m,w=r-i,y=w-o,(y>0||x)&&(b=++h.frame,d=w-h.time*1e3,h.time=w=w/1e3,o+=y+(y>=s?4:s-y),_=1),x||(l=c(v)),_)for(p=0;p<a.length;p++)a[p](w,d,b,g)};return h={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(v){return d/(1e3/(v||60))},wake:function(){r2&&(!rx&&B1()&&(Fn=rx=window,N1=Fn.document||{},En.gsap=rn,(Fn.gsapVersions||(Fn.gsapVersions=[])).push(rn.version),n2(im||Fn.GreenSockGlobals||!Fn.gsap&&Fn||{}),u=Fn.requestAnimationFrame,b2.forEach(S2)),l&&h.sleep(),c=u||function(v){return setTimeout(v,o-h.time*1e3+1|0)},Jh=1,f(2))},sleep:function(){(u?Fn.cancelAnimationFrame:clearTimeout)(l),Jh=0,c=Kh},lagSmoothing:function(v,g){e=v||1/0,t=Math.min(g||33,e)},fps:function(v){s=1e3/(v||240),o=h.time*1e3+s},add:function(v,g,m){var x=g?function(y,_,w,b){v(y,_,w,b),h.remove(x)}:v;return h.remove(v),a[m?"unshift":"push"](x),Zc(),x},remove:function(v,g){~(g=a.indexOf(v))&&a.splice(g,1)&&p>=g&&p--},_listeners:a},h}(),Zc=function(){return!Jh&&yn.wake()},It={},Cz=/^[\d.\-M][\d.\-,\s]/,Dz=/["']/g,Pz=function(n){for(var e={},t=n.substr(1,n.length-3).split(":"),i=t[0],r=1,s=t.length,o,a,l;r<s;r++)a=t[r],o=r!==s-1?a.lastIndexOf(","):a.length,l=a.substr(0,o),e[i]=isNaN(l)?l.replace(Dz,"").trim():+l,i=a.substr(o+1).trim();return e},Rz=function(n){var e=n.indexOf("(")+1,t=n.indexOf(")"),i=n.indexOf("(",e);return n.substring(e,~i&&i<t?n.indexOf(")",t+1):t)},Lz=function(n){var e=(n+"").split("("),t=It[e[0]];return t&&e.length>1&&t.config?t.config.apply(null,~n.indexOf("{")?[Pz(e[1])]:Rz(n).split(",").map(c2)):It._CE&&Cz.test(n)?It._CE("",n):t},A2=function(n){return function(e){return 1-n(1-e)}},C2=function n(e,t){for(var i=e._first,r;i;)i instanceof Zr?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},ul=function(n,e){return n&&(vi(n)?n:It[n]||Lz(n))||e},Sl=function(n,e,t,i){t===void 0&&(t=function(o){return 1-e(1-o)}),i===void 0&&(i=function(o){return o<.5?e(o*2)/2:1-e((1-o)*2)/2});var r={easeIn:e,easeOut:t,easeInOut:i},s;return Qr(n,function(o){It[o]=En[o]=r,It[s=o.toLowerCase()]=t;for(var a in r)It[s+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=It[o+"."+a]=r[a]}),r},D2=function(n){return function(e){return e<.5?(1-n(1-e*2))/2:.5+n((e-.5)*2)/2}},mv=function n(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/tx*(Math.asin(1/r)||0),a=function(c){return c===1?1:r*Math.pow(2,-10*c)*oz((c-o)*s)+1},l=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:D2(a);return s=tx/s,l.config=function(c,u){return n(e,c,u)},l},gv=function n(e,t){t===void 0&&(t=1.70158);var i=function(s){return s?--s*s*((t+1)*s+t)+1:0},r=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:D2(i);return r.config=function(s){return n(e,s)},r};Qr("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;Sl(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});It.Linear.easeNone=It.none=It.Linear.easeIn;Sl("Elastic",mv("in"),mv("out"),mv());(function(n,e){var t=1/e,i=2*t,r=2.5*t,s=function(o){return o<t?n*o*o:o<i?n*Math.pow(o-1.5/e,2)+.75:o<r?n*(o-=2.25/e)*o+.9375:n*Math.pow(o-2.625/e,2)+.984375};Sl("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);Sl("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});Sl("Circ",function(n){return-(JM(1-n*n)-1)});Sl("Sine",function(n){return n===1?1:-sz(n*rz)+1});Sl("Back",gv("in"),gv("out"),gv());It.SteppedEase=It.steps=En.SteppedEase={config:function(n,e){n===void 0&&(n=1);var t=1/n,i=n+(e?0:1),r=e?1:0,s=1-Xt;return function(o){return((i*rd(0,s,o)|0)+r)*t}}};Yc.ease=It["quad.out"];Qr("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return H1+=n+","+n+"Params,"});var P2=function(n,e){this.id=nz++,n._gsap=this,this.target=n,this.harness=e,this.get=e?e.get:a2,this.set=e?e.getSetter:Y1},Jc=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Kc(this,+t.duration,1,1),this.data=t.data,Ai&&(this._ctx=Ai,Ai.data.push(this)),Jh||yn.wake()}var e=n.prototype;return e.delay=function(t){return t||t===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,Kc(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,i){if(Zc(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(Sm(this,t),!r._dp||r.parent||d2(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&Ms(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===Xt||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),l2(this,t,i)),this},e.time=function(t,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+TT(this))%(this._dur+this._rDelay)||(t?this._dur:0),i):this._time},e.totalProgress=function(t,i){return arguments.length?this.totalTime(this.totalDuration()*t,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-t:t)+TT(this),i):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,i){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*r,i):this._repeat?$c(this._tTime,r)+1:1},e.timeScale=function(t){if(!arguments.length)return this._rts===-Xt?0:this._rts;if(this._rts===t)return this;var i=this.parent&&this._ts?om(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||t===-Xt?0:this._rts,this.totalTime(rd(-Math.abs(this._delay),this._tDur,i),!0),bm(this),pz(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Zc(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Xt&&(this._tTime-=Xt)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&Ms(i,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(Jr(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var i=this.parent||this._dp;return i?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?om(i.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){t===void 0&&(t=cz);var i=vr;return vr=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),this.data!=="nested"&&t.kill!==!1&&this.kill(),vr=i,this},e.globalTime=function(t){for(var i=this,r=arguments.length?t:i.rawTime();i;)r=i._start+r/(i._ts||1),i=i._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(t):r},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,MT(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var i=this._time;return this._rDelay=t,MT(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,i){return this.totalTime(In(this,t),Jr(i))},e.restart=function(t,i){return this.play().totalTime(t?-this._delay:0,Jr(i))},e.play=function(t,i){return t!=null&&this.seek(t,i),this.reversed(!1).paused(!1)},e.reverse=function(t,i){return t!=null&&this.seek(t||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(t,i){return t!=null&&this.seek(t,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-Xt:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Xt,this},e.isActive=function(){var t=this.parent||this._dp,i=this._start,r;return!!(!t||this._ts&&this._initted&&t.isActive()&&(r=t.rawTime(!0))>=i&&r<this.endTime(!0)-Xt)},e.eventCallback=function(t,i,r){var s=this.vars;return arguments.length>1?(i?(s[t]=i,r&&(s[t+"Params"]=r),t==="onUpdate"&&(this._onUpdate=i)):delete s[t],this):s[t]},e.then=function(t){var i=this;return new Promise(function(r){var s=vi(t)?t:u2,o=function(){var a=i.then;i.then=null,vi(s)&&(s=s(i))&&(s.then||s===i)&&(i.then=a),r(s),i.then=a};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?o():i._prom=o})},e.kill=function(){oh(this)},n}();$n(Jc.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Xt,_prom:0,_ps:!1,_rts:1});var Zr=function(n){ZM(e,n);function e(i,r){var s;return i===void 0&&(i={}),s=n.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=Jr(i.sortChildren),li&&Ms(i.parent||li,Qs(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&p2(Qs(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(i,r,s){return xh(0,arguments,this),this},t.from=function(i,r,s){return xh(1,arguments,this),this},t.fromTo=function(i,r,s,o){return xh(2,arguments,this),this},t.set=function(i,r,s){return r.duration=0,r.parent=this,yh(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new Oi(i,r,In(this,s),1),this},t.call=function(i,r,s){return Ms(this,Oi.delayedCall(0,i,r),s)},t.staggerTo=function(i,r,s,o,a,l,c){return s.duration=r,s.stagger=s.stagger||o,s.onComplete=l,s.onCompleteParams=c,s.parent=this,new Oi(i,s,In(this,a)),this},t.staggerFrom=function(i,r,s,o,a,l,c){return s.runBackwards=1,yh(s).immediateRender=Jr(s.immediateRender),this.staggerTo(i,r,s,o,a,l,c)},t.staggerFromTo=function(i,r,s,o,a,l,c,u){return o.startAt=s,yh(o).immediateRender=Jr(o.immediateRender),this.staggerTo(i,r,o,a,l,c,u)},t.render=function(i,r,s){var o=this._time,a=this._dirty?this.totalDuration():this._tDur,l=this._dur,c=i<=0?0:ir(i),u=this._zTime<0!=i<0&&(this._initted||!l),h,d,p,f,v,g,m,x,y,_,w,b;if(this!==li&&c>a&&i>=0&&(c=a),c!==this._tTime||s||u){if(o!==this._time&&l&&(c+=this._time-o,i+=this._time-o),h=c,y=this._start,x=this._ts,g=!x,u&&(l||(o=this._zTime),(i||!r)&&(this._zTime=i)),this._repeat){if(w=this._yoyo,v=l+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(v*100+i,r,s);if(h=ir(c%v),c===a?(f=this._repeat,h=l):(f=~~(c/v),f&&f===c/v&&(h=l,f--),h>l&&(h=l)),_=$c(this._tTime,v),!o&&this._tTime&&_!==f&&this._tTime-_*v-this._dur<=0&&(_=f),w&&f&1&&(h=l-h,b=1),f!==_&&!this._lock){var T=w&&_&1,A=T===(w&&f&1);if(f<_&&(T=!T),o=T?0:l,this._lock=1,this.render(o||(b?0:ir(f*v)),r,!l)._lock=0,this._tTime=c,!r&&this.parent&&Hn(this,"onRepeat"),this.vars.repeatRefresh&&!b&&(this.invalidate()._lock=1),o&&o!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,a=this._tDur,A&&(this._lock=2,o=T?l:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!b&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;C2(this,b)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(m=vz(this,ir(o),ir(h)),m&&(c-=h-(h=m._start))),this._tTime=c,this._time=h,this._act=!x,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,o=0),!o&&h&&!r&&!f&&(Hn(this,"onStart"),this._tTime!==c))return this;if(h>=o&&i>=0)for(d=this._first;d;){if(p=d._next,(d._act||h>=d._start)&&d._ts&&m!==d){if(d.parent!==this)return this.render(i,r,s);if(d.render(d._ts>0?(h-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(h-d._start)*d._ts,r,s),h!==this._time||!this._ts&&!g){m=0,p&&(c+=this._zTime=-Xt);break}}d=p}else{d=this._last;for(var S=i<0?i:h;d;){if(p=d._prev,(d._act||S<=d._end)&&d._ts&&m!==d){if(d.parent!==this)return this.render(i,r,s);if(d.render(d._ts>0?(S-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(S-d._start)*d._ts,r,s||vr&&(d._initted||d._startAt)),h!==this._time||!this._ts&&!g){m=0,p&&(c+=this._zTime=S?-Xt:Xt);break}}d=p}}if(m&&!r&&(this.pause(),m.render(h>=o?0:-Xt)._zTime=h>=o?1:-1,this._ts))return this._start=y,bm(this),this.render(i,r,s);this._onUpdate&&!r&&Hn(this,"onUpdate",!0),(c===a&&this._tTime>=this.totalDuration()||!c&&o)&&(y===this._start||Math.abs(x)!==Math.abs(this._ts))&&(this._lock||((i||!l)&&(c===a&&this._ts>0||!c&&this._ts<0)&&sa(this,1),!r&&!(i<0&&!o)&&(c||o||!a)&&(Hn(this,c===a&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<a&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,r){var s=this;if(ho(r)||(r=In(this,r,i)),!(i instanceof Jc)){if(yr(i))return i.forEach(function(o){return s.add(o,r)}),this;if(Yi(i))return this.addLabel(i,r);if(vi(i))i=Oi.delayedCall(0,i);else return this}return this!==i?Ms(this,i,r):this},t.getChildren=function(i,r,s,o){i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=-Gn);for(var a=[],l=this._first;l;)l._start>=o&&(l instanceof Oi?r&&a.push(l):(s&&a.push(l),i&&a.push.apply(a,l.getChildren(!0,r,s)))),l=l._next;return a},t.getById=function(i){for(var r=this.getChildren(1,1,1),s=r.length;s--;)if(r[s].vars.id===i)return r[s]},t.remove=function(i){return Yi(i)?this.removeLabel(i):vi(i)?this.killTweensOf(i):(wm(this,i),i===this._recent&&(this._recent=this._last),cl(this))},t.totalTime=function(i,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ir(yn.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),n.prototype.totalTime.call(this,i,r),this._forcing=0,this):this._tTime},t.addLabel=function(i,r){return this.labels[i]=In(this,r),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,r,s){var o=Oi.delayedCall(0,r||Kh,s);return o.data="isPause",this._hasPause=1,Ms(this,o,In(this,i))},t.removePause=function(i){var r=this._first;for(i=In(this,i);r;)r._start===i&&r.data==="isPause"&&sa(r),r=r._next},t.killTweensOf=function(i,r,s){for(var o=this.getTweensOf(i,s),a=o.length;a--;)zo!==o[a]&&o[a].kill(i,r);return this},t.getTweensOf=function(i,r){for(var s=[],o=Vn(i),a=this._first,l=ho(r),c;a;)a instanceof Oi?uz(a._targets,o)&&(l?(!zo||a._initted&&a._ts)&&a.globalTime(0)<=r&&a.globalTime(a.totalDuration())>r:!r||a.isActive())&&s.push(a):(c=a.getTweensOf(o,r)).length&&s.push.apply(s,c),a=a._next;return s},t.tweenTo=function(i,r){r=r||{};var s=this,o=In(s,i),a=r,l=a.startAt,c=a.onStart,u=a.onStartParams,h=a.immediateRender,d,p=Oi.to(s,$n({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:r.duration||Math.abs((o-(l&&"time"in l?l.time:s._time))/s.timeScale())||Xt,onStart:function(){if(s.pause(),!d){var f=r.duration||Math.abs((o-(l&&"time"in l?l.time:s._time))/s.timeScale());p._dur!==f&&Kc(p,f,0,1).render(p._time,!0,!0),d=1}c&&c.apply(p,u||[])}},r));return h?p.render(0):p},t.tweenFromTo=function(i,r,s){return this.tweenTo(r,$n({startAt:{time:In(this,i)}},s))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),AT(this,In(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),AT(this,In(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+Xt)},t.shiftChildren=function(i,r,s){s===void 0&&(s=0);for(var o=this._first,a=this.labels,l;o;)o._start>=s&&(o._start+=i,o._end+=i),o=o._next;if(r)for(l in a)a[l]>=s&&(a[l]+=i);return cl(this)},t.invalidate=function(i){var r=this._first;for(this._lock=0;r;)r.invalidate(i),r=r._next;return n.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var r=this._first,s;r;)s=r._next,this.remove(r),r=s;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),cl(this)},t.totalDuration=function(i){var r=0,s=this,o=s._last,a=Gn,l,c,u;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-i:i));if(s._dirty){for(u=s.parent;o;)l=o._prev,o._dirty&&o.totalDuration(),c=o._start,c>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,Ms(s,o,c-o._delay,1)._lock=0):a=c,c<0&&o._ts&&(r-=c,(!u&&!s._dp||u&&u.smoothChildTiming)&&(s._start+=c/s._ts,s._time-=c,s._tTime-=c),s.shiftChildren(-c,!1,-1/0),a=0),o._end>r&&o._ts&&(r=o._end),o=l;Kc(s,s===li&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(i){if(li._ts&&(l2(li,om(i,li)),o2=yn.frame),yn.frame>=ST){ST+=wn.autoSleep||120;var r=li._first;if((!r||!r._ts)&&wn.autoSleep&&yn._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||yn.sleep()}}},e}(Jc);$n(Zr.prototype,{_lock:0,_hasPause:0,_forcing:0});var Oz=function(n,e,t,i,r,s,o){var a=new en(this._pt,n,e,0,1,k2,null,r),l=0,c=0,u,h,d,p,f,v,g,m;for(a.b=t,a.e=i,t+="",i+="",(g=~i.indexOf("random("))&&(i=Zh(i)),s&&(m=[t,i],s(m,n,e),t=m[0],i=m[1]),h=t.match(dv)||[];u=dv.exec(i);)p=u[0],f=i.substring(l,u.index),d?d=(d+1)%5:f.substr(-5)==="rgba("&&(d=1),p!==h[c++]&&(v=parseFloat(h[c-1])||0,a._pt={_next:a._pt,p:f||c===1?f:",",s:v,c:p.charAt(1)==="="?Lc(v,p)-v:parseFloat(p)-v,m:d&&d<4?Math.round:0},l=dv.lastIndex);return a.c=l<i.length?i.substring(l,i.length):"",a.fp=o,(t2.test(i)||g)&&(a.e=0),this._pt=a,a},q1=function(n,e,t,i,r,s,o,a,l,c){vi(i)&&(i=i(r||0,n,s));var u=n[e],h=t!=="get"?t:vi(u)?l?n[e.indexOf("set")||!vi(n["get"+e.substr(3)])?e:"get"+e.substr(3)](l):n[e]():u,d=vi(u)?l?zz:I2:X1,p;if(Yi(i)&&(~i.indexOf("random(")&&(i=Zh(i)),i.charAt(1)==="="&&(p=Lc(h,i)+(mr(h)||0),(p||p===0)&&(i=p))),!c||h!==i||ux)return!isNaN(h*i)&&i!==""?(p=new en(this._pt,n,e,+h||0,i-(h||0),typeof u=="boolean"?Nz:F2,0,d),l&&(p.fp=l),o&&p.modifier(o,this,n),this._pt=p):(!u&&!(e in n)&&G1(e,i),Oz.call(this,n,e,h,i,d,a||wn.stringFilter,l))},Iz=function(n,e,t,i,r){if(vi(n)&&(n=_h(n,r,e,t,i)),!Ps(n)||n.style&&n.nodeType||yr(n)||QM(n))return Yi(n)?_h(n,r,e,t,i):n;var s={},o;for(o in n)s[o]=_h(n[o],r,e,t,i);return s},R2=function(n,e,t,i,r,s){var o,a,l,c;if(gn[n]&&(o=new gn[n]).init(r,o.rawVars?e[n]:Iz(e[n],i,r,s,t),t,i,s)!==!1&&(t._pt=a=new en(t._pt,r,n,0,1,o.render,o,0,o.priority),t!==Tc))for(l=t._ptLookup[t._targets.indexOf(r)],c=o._props.length;c--;)l[o._props[c]]=a;return o},zo,ux,j1=function n(e,t,i){var r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,c=r.onUpdate,u=r.onUpdateParams,h=r.callbackScope,d=r.runBackwards,p=r.yoyoEase,f=r.keyframes,v=r.autoRevert,g=e._dur,m=e._startAt,x=e._targets,y=e.parent,_=y&&y.data==="nested"?y.vars.targets:x,w=e._overwrite==="auto"&&!U1,b=e.timeline,T,A,S,E,R,D,z,L,G,J,X,N,U;if(b&&(!f||!s)&&(s="none"),e._ease=ul(s,Yc.ease),e._yEase=p?A2(ul(p===!0?s:p,Yc.ease)):0,p&&e._yoyo&&!e._repeat&&(p=e._yEase,e._yEase=e._ease,e._ease=p),e._from=!b&&!!r.runBackwards,!b||f&&!r.stagger){if(L=x[0]?ll(x[0]).harness:0,N=L&&r[L.prop],T=sm(r,V1),m&&(m._zTime<0&&m.progress(1),t<0&&d&&a&&!v?m.render(-1,!0):m.revert(d&&g?df:lz),m._lazy=0),o){if(sa(e._startAt=Oi.set(x,$n({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!m&&Jr(l),startAt:null,delay:0,onUpdate:c,onUpdateParams:u,callbackScope:h,stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(vr||!a&&!v)&&e._startAt.revert(df),a&&g&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(d&&g&&!m){if(t&&(a=!1),S=$n({overwrite:!1,data:"isFromStart",lazy:a&&!m&&Jr(l),immediateRender:a,stagger:0,parent:y},T),N&&(S[L.prop]=N),sa(e._startAt=Oi.set(x,S)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(vr?e._startAt.revert(df):e._startAt.render(-1,!0)),e._zTime=t,!a)n(e._startAt,Xt,Xt);else if(!t)return}for(e._pt=e._ptCache=0,l=g&&Jr(l)||l&&!g,A=0;A<x.length;A++){if(R=x[A],z=R._gsap||W1(x)[A]._gsap,e._ptLookup[A]=J={},nx[z.id]&&Yo.length&&nm(),X=_===x?A:_.indexOf(R),L&&(G=new L).init(R,N||T,e,X,_)!==!1&&(e._pt=E=new en(e._pt,R,G.name,0,1,G.render,G,0,G.priority),G._props.forEach(function(O){J[O]=E}),G.priority&&(D=1)),!L||N)for(S in T)gn[S]&&(G=R2(S,T,e,X,R,_))?G.priority&&(D=1):J[S]=E=q1.call(e,R,S,"get",T[S],X,_,0,r.stringFilter);e._op&&e._op[A]&&e.kill(R,e._op[A]),w&&e._pt&&(zo=e,li.killTweensOf(R,J,e.globalTime(t)),U=!e.parent,zo=0),e._pt&&l&&(nx[z.id]=1)}D&&U2(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!U,f&&t<=0&&b.render(Gn,!0,!0)},Fz=function(n,e,t,i,r,s,o){var a=(n._pt&&n._ptCache||(n._ptCache={}))[e],l,c,u,h;if(!a)for(a=n._ptCache[e]=[],u=n._ptLookup,h=n._targets.length;h--;){if(l=u[h][e],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return ux=1,n.vars[e]="+=0",j1(n,o),ux=0,1;a.push(l)}for(h=a.length;h--;)c=a[h],l=c._pt||c,l.s=(i||i===0)&&!r?i:l.s+(i||0)+s*l.c,l.c=t-l.s,c.e&&(c.e=_i(t)+mr(c.e)),c.b&&(c.b=l.s+mr(c.b))},kz=function(n,e){var t=n[0]?ll(n[0]).harness:0,i=t&&t.aliases,r,s,o,a;if(!i)return e;r=xl({},e);for(s in i)if(s in r)for(a=i[s].split(","),o=a.length;o--;)r[a[o]]=r[s];return r},Uz=function(n,e,t,i){var r=e.ease||i||"power1.inOut",s,o;if(yr(e))o=t[n]||(t[n]=[]),e.forEach(function(a,l){return o.push({t:l/(e.length-1)*100,v:a,e:r})});else for(s in e)o=t[s]||(t[s]=[]),s==="ease"||o.push({t:parseFloat(n),v:e[s],e:r})},_h=function(n,e,t,i,r){return vi(n)?n.call(e,t,i,r):Yi(n)&&~n.indexOf("random(")?Zh(n):n},L2=H1+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",O2={};Qr(L2+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return O2[n]=1});var Oi=function(n){ZM(e,n);function e(i,r,s,o){var a;typeof r=="number"&&(s.duration=r,r=s,s=null),a=n.call(this,o?r:yh(r))||this;var l=a.vars,c=l.duration,u=l.delay,h=l.immediateRender,d=l.stagger,p=l.overwrite,f=l.keyframes,v=l.defaults,g=l.scrollTrigger,m=l.yoyoEase,x=r.parent||li,y=(yr(i)||QM(i)?ho(i[0]):"length"in r)?[i]:Vn(i),_,w,b,T,A,S,E,R;if(a._targets=y.length?W1(y):rm("GSAP target "+i+" not found. https://greensock.com",!wn.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=p,f||d||Xp(c)||Xp(u)){if(r=a.vars,_=a.timeline=new Zr({data:"nested",defaults:v||{},targets:x&&x.data==="nested"?x.vars.targets:y}),_.kill(),_.parent=_._dp=Qs(a),_._start=0,d||Xp(c)||Xp(u)){if(T=y.length,E=d&&v2(d),Ps(d))for(A in d)~L2.indexOf(A)&&(R||(R={}),R[A]=d[A]);for(w=0;w<T;w++)b=sm(r,O2),b.stagger=0,m&&(b.yoyoEase=m),R&&xl(b,R),S=y[w],b.duration=+_h(c,Qs(a),w,S,y),b.delay=(+_h(u,Qs(a),w,S,y)||0)-a._delay,!d&&T===1&&b.delay&&(a._delay=u=b.delay,a._start+=u,b.delay=0),_.to(S,b,E?E(w,S,y):0),_._ease=It.none;_.duration()?c=u=0:a.timeline=0}else if(f){yh($n(_.vars.defaults,{ease:"none"})),_._ease=ul(f.ease||r.ease||"none");var D=0,z,L,G;if(yr(f))f.forEach(function(J){return _.to(y,J,">")}),_.duration();else{b={};for(A in f)A==="ease"||A==="easeEach"||Uz(A,f[A],b,f.easeEach);for(A in b)for(z=b[A].sort(function(J,X){return J.t-X.t}),D=0,w=0;w<z.length;w++)L=z[w],G={ease:L.e,duration:(L.t-(w?z[w-1].t:0))/100*c},G[A]=L.v,_.to(y,G,D),D+=G.duration;_.duration()<c&&_.to({},{duration:c-_.duration()})}}c||a.duration(c=_.duration())}else a.timeline=0;return p===!0&&!U1&&(zo=Qs(a),li.killTweensOf(y),zo=0),Ms(x,Qs(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(h||!c&&!f&&a._start===ir(x._time)&&Jr(h)&&fz(Qs(a))&&x.data!=="nested")&&(a._tTime=-Xt,a.render(Math.max(0,-u)||0)),g&&p2(Qs(a),g),a}var t=e.prototype;return t.render=function(i,r,s){var o=this._time,a=this._tDur,l=this._dur,c=i<0,u=i>a-Xt&&!c?a:i<Xt?0:i,h,d,p,f,v,g,m,x,y;if(!l)gz(this,i,r,s);else if(u!==this._tTime||!i||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c){if(h=u,x=this.timeline,this._repeat){if(f=l+this._rDelay,this._repeat<-1&&c)return this.totalTime(f*100+i,r,s);if(h=ir(u%f),u===a?(p=this._repeat,h=l):(p=~~(u/f),p&&p===u/f&&(h=l,p--),h>l&&(h=l)),g=this._yoyo&&p&1,g&&(y=this._yEase,h=l-h),v=$c(this._tTime,f),h===o&&!s&&this._initted)return this._tTime=u,this;p!==v&&(x&&this._yEase&&C2(x,g),this.vars.repeatRefresh&&!g&&!this._lock&&(this._lock=s=1,this.render(ir(f*p),!0).invalidate()._lock=0))}if(!this._initted){if(f2(this,c?i:h,s,r,u))return this._tTime=0,this;if(o!==this._time)return this;if(l!==this._dur)return this.render(i,r,s)}if(this._tTime=u,this._time=h,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=m=(y||this._ease)(h/l),this._from&&(this.ratio=m=1-m),h&&!o&&!r&&!p&&(Hn(this,"onStart"),this._tTime!==u))return this;for(d=this._pt;d;)d.r(m,d.d),d=d._next;x&&x.render(i<0?i:!h&&g?-Xt:x._dur*x._ease(h/this._dur),r,s)||this._startAt&&(this._zTime=i),this._onUpdate&&!r&&(c&&sx(this,i,r,s),Hn(this,"onUpdate")),this._repeat&&p!==v&&this.vars.onRepeat&&!r&&this.parent&&Hn(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(c&&!this._onUpdate&&sx(this,i,!0,!0),(i||!l)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&sa(this,1),!r&&!(c&&!o)&&(u||o||g)&&(Hn(this,u===a?"onComplete":"onReverseComplete",!0),this._prom&&!(u<a&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),n.prototype.invalidate.call(this,i)},t.resetTo=function(i,r,s,o){Jh||yn.wake(),this._ts||this.play();var a=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||j1(this,a),l=this._ease(a/this._dur),Fz(this,i,r,s,o,l,a)?this.resetTo(i,r,s,o):(Sm(this,0),this.parent||h2(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,r){if(r===void 0&&(r="all"),!i&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?oh(this):this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(i,r,zo&&zo.vars.overwrite!==!0)._first||oh(this),this.parent&&s!==this.timeline.totalDuration()&&Kc(this,this._dur*this.timeline._tDur/s,0,1),this}var o=this._targets,a=i?Vn(i):o,l=this._ptLookup,c=this._pt,u,h,d,p,f,v,g;if((!r||r==="all")&&dz(o,a))return r==="all"&&(this._pt=0),oh(this);for(u=this._op=this._op||[],r!=="all"&&(Yi(r)&&(f={},Qr(r,function(m){return f[m]=1}),r=f),r=kz(o,r)),g=o.length;g--;)if(~a.indexOf(o[g])){h=l[g],r==="all"?(u[g]=r,p=h,d={}):(d=u[g]=u[g]||{},p=r);for(f in p)v=h&&h[f],v&&((!("kill"in v.d)||v.d.kill(f)===!0)&&wm(this,v,"_pt"),delete h[f]),d!=="all"&&(d[f]=1)}return this._initted&&!this._pt&&c&&oh(this),this},e.to=function(i,r){return new e(i,r,arguments[2])},e.from=function(i,r){return xh(1,arguments)},e.delayedCall=function(i,r,s,o){return new e(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:r,onReverseComplete:r,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:o})},e.fromTo=function(i,r,s){return xh(2,arguments)},e.set=function(i,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new e(i,r)},e.killTweensOf=function(i,r,s){return li.killTweensOf(i,r,s)},e}(Jc);$n(Oi.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Qr("staggerTo,staggerFrom,staggerFromTo",function(n){Oi[n]=function(){var e=new Zr,t=ax.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var X1=function(n,e,t){return n[e]=t},I2=function(n,e,t){return n[e](t)},zz=function(n,e,t,i){return n[e](i.fp,t)},Bz=function(n,e,t){return n.setAttribute(e,t)},Y1=function(n,e){return vi(n[e])?I2:z1(n[e])&&n.setAttribute?Bz:X1},F2=function(n,e){return e.set(e.t,e.p,Math.round((e.s+e.c*n)*1e6)/1e6,e)},Nz=function(n,e){return e.set(e.t,e.p,!!(e.s+e.c*n),e)},k2=function(n,e){var t=e._pt,i="";if(!n&&e.b)i=e.b;else if(n===1&&e.e)i=e.e;else{for(;t;)i=t.p+(t.m?t.m(t.s+t.c*n):Math.round((t.s+t.c*n)*1e4)/1e4)+i,t=t._next;i+=e.c}e.set(e.t,e.p,i,e)},$1=function(n,e){for(var t=e._pt;t;)t.r(n,t.d),t=t._next},Gz=function(n,e,t,i){for(var r=this._pt,s;r;)s=r._next,r.p===i&&r.modifier(n,e,t),r=s},Vz=function(n){for(var e=this._pt,t,i;e;)i=e._next,e.p===n&&!e.op||e.op===n?wm(this,e,"_pt"):e.dep||(t=1),e=i;return!t},Hz=function(n,e,t,i){i.mSet(n,e,i.m.call(i.tween,t,i.mt),i)},U2=function(n){for(var e=n._pt,t,i,r,s;e;){for(t=e._next,i=r;i&&i.pr>e.pr;)i=i._next;(e._prev=i?i._prev:s)?e._prev._next=e:r=e,(e._next=i)?i._prev=e:s=e,e=t}n._pt=r},en=function(){function n(t,i,r,s,o,a,l,c,u){this.t=i,this.s=s,this.c=o,this.p=r,this.r=a||F2,this.d=l||this,this.set=c||X1,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(t,i,r){this.mSet=this.mSet||this.set,this.set=Hz,this.m=t,this.mt=r,this.tween=i},n}();Qr(H1+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return V1[n]=1});En.TweenMax=En.TweenLite=Oi;En.TimelineLite=En.TimelineMax=Zr;li=new Zr({sortChildren:!1,defaults:Yc,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});wn.stringFilter=M2;var Qc=[],ff={},Wz=[],DT=0,vv=function(n){return(ff[n]||Wz).map(function(e){return e()})},hx=function(){var n=Date.now(),e=[];n-DT>2&&(vv("matchMediaInit"),Qc.forEach(function(t){var i=t.queries,r=t.conditions,s,o,a,l;for(o in i)s=Fn.matchMedia(i[o]).matches,s&&(a=1),s!==r[o]&&(r[o]=s,l=1);l&&(t.revert(),a&&e.push(t))}),vv("matchMediaRevert"),e.forEach(function(t){return t.onMatch(t)}),DT=n,vv("matchMedia"))},z2=function(){function n(t,i){this.selector=i&&lx(i),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=n.prototype;return e.add=function(t,i,r){vi(t)&&(r=i,i=t,t=vi);var s=this,o=function(){var a=Ai,l=s.selector,c;return a&&a!==s&&a.data.push(s),r&&(s.selector=lx(r)),Ai=s,c=i.apply(s,arguments),vi(c)&&s._r.push(c),Ai=a,s.selector=l,s.isReverted=!1,c};return s.last=o,t===vi?o(s):t?s[t]=o:o},e.ignore=function(t){var i=Ai;Ai=null,t(this),Ai=i},e.getTweens=function(){var t=[];return this.data.forEach(function(i){return i instanceof n?t.push.apply(t,i.getTweens()):i instanceof Oi&&!(i.parent&&i.parent.data==="nested")&&t.push(i)}),t},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,i){var r=this;if(t){var s=this.getTweens();this.data.forEach(function(a){a.data==="isFlip"&&(a.revert(),a.getChildren(!0,!0,!1).forEach(function(l){return s.splice(s.indexOf(l),1)}))}),s.map(function(a){return{g:a.globalTime(0),t:a}}).sort(function(a,l){return l.g-a.g||-1}).forEach(function(a){return a.t.revert(t)}),this.data.forEach(function(a){return!(a instanceof Jc)&&a.revert&&a.revert(t)}),this._r.forEach(function(a){return a(t,r)}),this.isReverted=!0}else this.data.forEach(function(a){return a.kill&&a.kill()});if(this.clear(),i){var o=Qc.indexOf(this);~o&&Qc.splice(o,1)}},e.revert=function(t){this.kill(t||{})},n}(),qz=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(t,i,r){Ps(t)||(t={matches:t});var s=new z2(0,r||this.scope),o=s.conditions={},a,l,c;this.contexts.push(s),i=s.add("onMatch",i),s.queries=t;for(l in t)l==="all"?c=1:(a=Fn.matchMedia(t[l]),a&&(Qc.indexOf(s)<0&&Qc.push(s),(o[l]=a.matches)&&(c=1),a.addListener?a.addListener(hx):a.addEventListener("change",hx)));return c&&i(s),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach(function(i){return i.kill(t,!0)})},n}(),am={registerPlugin:function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e.forEach(function(i){return S2(i)})},timeline:function(n){return new Zr(n)},getTweensOf:function(n,e){return li.getTweensOf(n,e)},getProperty:function(n,e,t,i){Yi(n)&&(n=Vn(n)[0]);var r=ll(n||{}).get,s=t?u2:c2;return t==="native"&&(t=""),n&&(e?s((gn[e]&&gn[e].get||r)(n,e,t,i)):function(o,a,l){return s((gn[o]&&gn[o].get||r)(n,o,a,l))})},quickSetter:function(n,e,t){if(n=Vn(n),n.length>1){var i=n.map(function(c){return rn.quickSetter(c,e,t)}),r=i.length;return function(c){for(var u=r;u--;)i[u](c)}}n=n[0]||{};var s=gn[e],o=ll(n),a=o.harness&&(o.harness.aliases||{})[e]||e,l=s?function(c){var u=new s;Tc._pt=0,u.init(n,t?c+t:c,Tc,0,[n]),u.render(1,u),Tc._pt&&$1(1,Tc)}:o.set(n,a);return s?l:function(c){return l(n,a,t?c+t:c,o,1)}},quickTo:function(n,e,t){var i,r=rn.to(n,xl((i={},i[e]="+=0.1",i.paused=!0,i),t||{})),s=function(o,a,l){return r.resetTo(e,o,a,l)};return s.tween=r,s},isTweening:function(n){return li.getTweensOf(n,!0).length>0},defaults:function(n){return n&&n.ease&&(n.ease=ul(n.ease,Yc.ease)),ET(Yc,n||{})},config:function(n){return ET(wn,n||{})},registerEffect:function(n){var e=n.name,t=n.effect,i=n.plugins,r=n.defaults,s=n.extendTimeline;(i||"").split(",").forEach(function(o){return o&&!gn[o]&&!En[o]&&rm(e+" effect requires "+o+" plugin.")}),pv[e]=function(o,a,l){return t(Vn(o),$n(a||{},r),l)},s&&(Zr.prototype[e]=function(o,a,l){return this.add(pv[e](o,Ps(a)?a:(l=a)&&{},this),l)})},registerEase:function(n,e){It[n]=ul(e)},parseEase:function(n,e){return arguments.length?ul(n,e):It},getById:function(n){return li.getById(n)},exportRoot:function(n,e){n===void 0&&(n={});var t=new Zr(n),i,r;for(t.smoothChildTiming=Jr(n.smoothChildTiming),li.remove(t),t._dp=0,t._time=t._tTime=li._time,i=li._first;i;)r=i._next,(e||!(!i._dur&&i instanceof Oi&&i.vars.onComplete===i._targets[0]))&&Ms(t,i,i._start-i._delay),i=r;return Ms(li,t,0),t},context:function(n,e){return n?new z2(n,e):Ai},matchMedia:function(n){return new qz(n)},matchMediaRefresh:function(){return Qc.forEach(function(n){var e=n.conditions,t,i;for(i in e)e[i]&&(e[i]=!1,t=1);t&&n.revert()})||hx()},addEventListener:function(n,e){var t=ff[n]||(ff[n]=[]);~t.indexOf(e)||t.push(e)},removeEventListener:function(n,e){var t=ff[n],i=t&&t.indexOf(e);i>=0&&t.splice(i,1)},utils:{wrap:Ez,wrapYoyo:Tz,distribute:v2,random:x2,snap:y2,normalize:Sz,getUnit:mr,clamp:xz,splitColor:E2,toArray:Vn,selector:lx,mapRange:w2,pipe:wz,unitize:bz,interpolate:Mz,shuffle:g2},install:n2,effects:pv,ticker:yn,updateRoot:Zr.updateRoot,plugins:gn,globalTimeline:li,core:{PropTween:en,globals:s2,Tween:Oi,Timeline:Zr,Animation:Jc,getCache:ll,_removeLinkedListItem:wm,reverting:function(){return vr},context:function(n){return n&&Ai&&(Ai.data.push(n),n._ctx=Ai),Ai},suppressOverwrites:function(n){return U1=n}}};Qr("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return am[n]=Oi[n]});yn.add(Zr.updateRoot);Tc=am.to({},{duration:0});var jz=function(n,e){for(var t=n._pt;t&&t.p!==e&&t.op!==e&&t.fp!==e;)t=t._next;return t},Xz=function(n,e){var t=n._targets,i,r,s;for(i in e)for(r=t.length;r--;)s=n._ptLookup[r][i],s&&(s=s.d)&&(s._pt&&(s=jz(s,i)),s&&s.modifier&&s.modifier(e[i],n,t[r],i))},yv=function(n,e){return{name:n,rawVars:1,init:function(t,i,r){r._onInit=function(s){var o,a;if(Yi(i)&&(o={},Qr(i,function(l){return o[l]=1}),i=o),e){o={};for(a in i)o[a]=e(i[a]);i=o}Xz(s,i)}}}},rn=am.registerPlugin({name:"attr",init:function(n,e,t,i,r){var s,o,a;this.tween=t;for(s in e)a=n.getAttribute(s)||"",o=this.add(n,"setAttribute",(a||0)+"",e[s],i,r,0,0,s),o.op=s,o.b=a,this._props.push(s)},render:function(n,e){for(var t=e._pt;t;)vr?t.set(t.t,t.p,t.b,t):t.r(n,t.d),t=t._next}},{name:"endArray",init:function(n,e){for(var t=e.length;t--;)this.add(n,t,n[t]||0,e[t],0,0,0,0,0,1)}},yv("roundProps",cx),yv("modifiers"),yv("snap",y2))||am;Oi.version=Zr.version=rn.version="3.11.5";r2=1;B1()&&Zc();It.Power0;It.Power1;It.Power2;It.Power3;It.Power4;It.Linear;It.Quad;It.Cubic;It.Quart;It.Quint;It.Strong;It.Elastic;It.Back;It.SteppedEase;It.Bounce;It.Sine;It.Expo;It.Circ;var PT,Bo,Oc,K1,el,RT,Z1,Yz=function(){return typeof window<"u"},po={},Ya=180/Math.PI,Ic=Math.PI/180,fc=Math.atan2,LT=1e8,J1=/([A-Z])/g,$z=/(left|right|width|margin|padding|x)/i,Kz=/[\s,\(]\S/,As={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},dx=function(n,e){return e.set(e.t,e.p,Math.round((e.s+e.c*n)*1e4)/1e4+e.u,e)},Zz=function(n,e){return e.set(e.t,e.p,n===1?e.e:Math.round((e.s+e.c*n)*1e4)/1e4+e.u,e)},Jz=function(n,e){return e.set(e.t,e.p,n?Math.round((e.s+e.c*n)*1e4)/1e4+e.u:e.b,e)},Qz=function(n,e){var t=e.s+e.c*n;e.set(e.t,e.p,~~(t+(t<0?-.5:.5))+e.u,e)},B2=function(n,e){return e.set(e.t,e.p,n?e.e:e.b,e)},N2=function(n,e){return e.set(e.t,e.p,n!==1?e.b:e.e,e)},eB=function(n,e,t){return n.style[e]=t},tB=function(n,e,t){return n.style.setProperty(e,t)},iB=function(n,e,t){return n._gsap[e]=t},rB=function(n,e,t){return n._gsap.scaleX=n._gsap.scaleY=t},nB=function(n,e,t,i,r){var s=n._gsap;s.scaleX=s.scaleY=t,s.renderTransform(r,s)},sB=function(n,e,t,i,r){var s=n._gsap;s[e]=t,s.renderTransform(r,s)},ui="transform",hs=ui+"Origin",oB=function n(e,t){var i=this,r=this.target,s=r.style;if(e in po){if(this.tfm=this.tfm||{},e!=="transform")e=As[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=eo(r,o)}):this.tfm[e]=r._gsap.x?r._gsap[e]:eo(r,e);else return As.transform.split(",").forEach(function(o){return n.call(i,o,t)});if(this.props.indexOf(ui)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(hs,t,"")),e=ui}(s||t)&&this.props.push(e,t,s[e])},G2=function(n){n.translate&&(n.removeProperty("translate"),n.removeProperty("scale"),n.removeProperty("rotate"))},aB=function(){var n=this.props,e=this.target,t=e.style,i=e._gsap,r,s;for(r=0;r<n.length;r+=3)n[r+1]?e[n[r]]=n[r+2]:n[r+2]?t[n[r]]=n[r+2]:t.removeProperty(n[r].substr(0,2)==="--"?n[r]:n[r].replace(J1,"-$1").toLowerCase());if(this.tfm){for(s in this.tfm)i[s]=this.tfm[s];i.svg&&(i.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),r=Z1(),(!r||!r.isStart)&&!t[ui]&&(G2(t),i.uncache=1)}},V2=function(n,e){var t={target:n,props:[],revert:aB,save:oB};return n._gsap||rn.core.getCache(n),e&&e.split(",").forEach(function(i){return t.save(i)}),t},H2,px=function(n,e){var t=Bo.createElementNS?Bo.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),n):Bo.createElement(n);return t.style?t:Bo.createElement(n)},Cs=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(J1,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,eu(t)||t,1)||""},OT="O,Moz,ms,Ms,Webkit".split(","),eu=function(n,e,t){var i=e||el,r=i.style,s=5;if(n in r&&!t)return n;for(n=n.charAt(0).toUpperCase()+n.substr(1);s--&&!(OT[s]+n in r););return s<0?null:(s===3?"ms":s>=0?OT[s]:"")+n},fx=function(){Yz()&&window.document&&(PT=window,Bo=PT.document,Oc=Bo.documentElement,el=px("div")||{style:{}},px("div"),ui=eu(ui),hs=ui+"Origin",el.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",H2=!!eu("perspective"),Z1=rn.core.reverting,K1=1)},xv=function n(e){var t=px("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,s=this.style.cssText,o;if(Oc.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),Oc.removeChild(t),this.style.cssText=s,o},IT=function(n,e){for(var t=e.length;t--;)if(n.hasAttribute(e[t]))return n.getAttribute(e[t])},W2=function(n){var e;try{e=n.getBBox()}catch{e=xv.call(n,!0)}return e&&(e.width||e.height)||n.getBBox===xv||(e=xv.call(n,!0)),e&&!e.width&&!e.x&&!e.y?{x:+IT(n,["x","cx","x1"])||0,y:+IT(n,["y","cy","y1"])||0,width:0,height:0}:e},q2=function(n){return!!(n.getCTM&&(!n.parentNode||n.ownerSVGElement)&&W2(n))},Qh=function(n,e){if(e){var t=n.style;e in po&&e!==hs&&(e=ui),t.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),t.removeProperty(e.replace(J1,"-$1").toLowerCase())):t.removeAttribute(e)}},No=function(n,e,t,i,r,s){var o=new en(n._pt,e,t,0,1,s?N2:B2);return n._pt=o,o.b=i,o.e=r,n._props.push(t),o},FT={deg:1,rad:1,turn:1},lB={grid:1,flex:1},oa=function n(e,t,i,r){var s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=el.style,l=$z.test(t),c=e.tagName.toLowerCase()==="svg",u=(c?"client":"offset")+(l?"Width":"Height"),h=100,d=r==="px",p=r==="%",f,v,g,m;return r===o||!s||FT[r]||FT[o]?s:(o!=="px"&&!d&&(s=n(e,t,i,"px")),m=e.getCTM&&q2(e),(p||o==="%")&&(po[t]||~t.indexOf("adius"))?(f=m?e.getBBox()[l?"width":"height"]:e[u],_i(p?s/f*h:s/100*f)):(a[l?"width":"height"]=h+(d?o:r),v=~t.indexOf("adius")||r==="em"&&e.appendChild&&!c?e:e.parentNode,m&&(v=(e.ownerSVGElement||{}).parentNode),(!v||v===Bo||!v.appendChild)&&(v=Bo.body),g=v._gsap,g&&p&&g.width&&l&&g.time===yn.time&&!g.uncache?_i(s/g.width*h):((p||o==="%")&&!lB[Cs(v,"display")]&&(a.position=Cs(e,"position")),v===e&&(a.position="static"),v.appendChild(el),f=el[u],v.removeChild(el),a.position="absolute",l&&p&&(g=ll(v),g.time=yn.time,g.width=v[u]),_i(d?f*s/h:f&&s?h/f*s:0))))},eo=function(n,e,t,i){var r;return K1||fx(),e in As&&e!=="transform"&&(e=As[e],~e.indexOf(",")&&(e=e.split(",")[0])),po[e]&&e!=="transform"?(r=td(n,i),r=e!=="transformOrigin"?r[e]:r.svg?r.origin:cm(Cs(n,hs))+" "+r.zOrigin+"px"):(r=n.style[e],(!r||r==="auto"||i||~(r+"").indexOf("calc("))&&(r=lm[e]&&lm[e](n,e,t)||Cs(n,e)||a2(n,e)||(e==="opacity"?1:0))),t&&!~(r+"").trim().indexOf(" ")?oa(n,e,r,t)+t:r},cB=function(n,e,t,i){if(!t||t==="none"){var r=eu(e,n,1),s=r&&Cs(n,r,1);s&&s!==t?(e=r,t=s):e==="borderColor"&&(t=Cs(n,"borderTopColor"))}var o=new en(this._pt,n.style,e,0,1,k2),a=0,l=0,c,u,h,d,p,f,v,g,m,x,y,_;if(o.b=t,o.e=i,t+="",i+="",i==="auto"&&(n.style[e]=i,i=Cs(n,e)||i,n.style[e]=t),c=[t,i],M2(c),t=c[0],i=c[1],h=t.match(Ec)||[],_=i.match(Ec)||[],_.length){for(;u=Ec.exec(i);)v=u[0],m=i.substring(a,u.index),p?p=(p+1)%5:(m.substr(-5)==="rgba("||m.substr(-5)==="hsla(")&&(p=1),v!==(f=h[l++]||"")&&(d=parseFloat(f)||0,y=f.substr((d+"").length),v.charAt(1)==="="&&(v=Lc(d,v)+y),g=parseFloat(v),x=v.substr((g+"").length),a=Ec.lastIndex-x.length,x||(x=x||wn.units[e]||y,a===i.length&&(i+=x,o.e+=x)),y!==x&&(d=oa(n,e,f,x)||0),o._pt={_next:o._pt,p:m||l===1?m:",",s:d,c:g-d,m:p&&p<4||e==="zIndex"?Math.round:0});o.c=a<i.length?i.substring(a,i.length):""}else o.r=e==="display"&&i==="none"?N2:B2;return t2.test(i)&&(o.e=0),this._pt=o,o},kT={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},uB=function(n){var e=n.split(" "),t=e[0],i=e[1]||"50%";return(t==="top"||t==="bottom"||i==="left"||i==="right")&&(n=t,t=i,i=n),e[0]=kT[t]||t,e[1]=kT[i]||i,e.join(" ")},hB=function(n,e){if(e.tween&&e.tween._time===e.tween._dur){var t=e.t,i=t.style,r=e.u,s=t._gsap,o,a,l;if(r==="all"||r===!0)i.cssText="",a=1;else for(r=r.split(","),l=r.length;--l>-1;)o=r[l],po[o]&&(a=1,o=o==="transformOrigin"?hs:ui),Qh(t,o);a&&(Qh(t,ui),s&&(s.svg&&t.removeAttribute("transform"),td(t,1),s.uncache=1,G2(i)))}},lm={clearProps:function(n,e,t,i,r){if(r.data!=="isFromStart"){var s=n._pt=new en(n._pt,e,t,0,0,hB);return s.u=i,s.pr=-10,s.tween=r,n._props.push(t),1}}},ed=[1,0,0,1,0,0],j2={},X2=function(n){return n==="matrix(1, 0, 0, 1, 0, 0)"||n==="none"||!n},UT=function(n){var e=Cs(n,ui);return X2(e)?ed:e.substr(7).match(e2).map(_i)},Q1=function(n,e){var t=n._gsap||ll(n),i=n.style,r=UT(n),s,o,a,l;return t.svg&&n.getAttribute("transform")?(a=n.transform.baseVal.consolidate().matrix,r=[a.a,a.b,a.c,a.d,a.e,a.f],r.join(",")==="1,0,0,1,0,0"?ed:r):(r===ed&&!n.offsetParent&&n!==Oc&&!t.svg&&(a=i.display,i.display="block",s=n.parentNode,(!s||!n.offsetParent)&&(l=1,o=n.nextElementSibling,Oc.appendChild(n)),r=UT(n),a?i.display=a:Qh(n,"display"),l&&(o?s.insertBefore(n,o):s?s.appendChild(n):Oc.removeChild(n))),e&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},mx=function(n,e,t,i,r,s){var o=n._gsap,a=r||Q1(n,!0),l=o.xOrigin||0,c=o.yOrigin||0,u=o.xOffset||0,h=o.yOffset||0,d=a[0],p=a[1],f=a[2],v=a[3],g=a[4],m=a[5],x=e.split(" "),y=parseFloat(x[0])||0,_=parseFloat(x[1])||0,w,b,T,A;t?a!==ed&&(b=d*v-p*f)&&(T=y*(v/b)+_*(-f/b)+(f*m-v*g)/b,A=y*(-p/b)+_*(d/b)-(d*m-p*g)/b,y=T,_=A):(w=W2(n),y=w.x+(~x[0].indexOf("%")?y/100*w.width:y),_=w.y+(~(x[1]||x[0]).indexOf("%")?_/100*w.height:_)),i||i!==!1&&o.smooth?(g=y-l,m=_-c,o.xOffset=u+(g*d+m*f)-g,o.yOffset=h+(g*p+m*v)-m):o.xOffset=o.yOffset=0,o.xOrigin=y,o.yOrigin=_,o.smooth=!!i,o.origin=e,o.originIsAbsolute=!!t,n.style[hs]="0px 0px",s&&(No(s,o,"xOrigin",l,y),No(s,o,"yOrigin",c,_),No(s,o,"xOffset",u,o.xOffset),No(s,o,"yOffset",h,o.yOffset)),n.setAttribute("data-svg-origin",y+" "+_)},td=function(n,e){var t=n._gsap||new P2(n);if("x"in t&&!e&&!t.uncache)return t;var i=n.style,r=t.scaleX<0,s="px",o="deg",a=getComputedStyle(n),l=Cs(n,hs)||"0",c,u,h,d,p,f,v,g,m,x,y,_,w,b,T,A,S,E,R,D,z,L,G,J,X,N,U,O,F,$,P,C;return c=u=h=f=v=g=m=x=y=0,d=p=1,t.svg=!!(n.getCTM&&q2(n)),a.translate&&((a.translate!=="none"||a.scale!=="none"||a.rotate!=="none")&&(i[ui]=(a.translate!=="none"?"translate3d("+(a.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(a.rotate!=="none"?"rotate("+a.rotate+") ":"")+(a.scale!=="none"?"scale("+a.scale.split(" ").join(",")+") ":"")+(a[ui]!=="none"?a[ui]:"")),i.scale=i.rotate=i.translate="none"),b=Q1(n,t.svg),t.svg&&(t.uncache?(X=n.getBBox(),l=t.xOrigin-X.x+"px "+(t.yOrigin-X.y)+"px",J=""):J=!e&&n.getAttribute("data-svg-origin"),mx(n,J||l,!!J||t.originIsAbsolute,t.smooth!==!1,b)),_=t.xOrigin||0,w=t.yOrigin||0,b!==ed&&(E=b[0],R=b[1],D=b[2],z=b[3],c=L=b[4],u=G=b[5],b.length===6?(d=Math.sqrt(E*E+R*R),p=Math.sqrt(z*z+D*D),f=E||R?fc(R,E)*Ya:0,m=D||z?fc(D,z)*Ya+f:0,m&&(p*=Math.abs(Math.cos(m*Ic))),t.svg&&(c-=_-(_*E+w*D),u-=w-(_*R+w*z))):(C=b[6],$=b[7],U=b[8],O=b[9],F=b[10],P=b[11],c=b[12],u=b[13],h=b[14],T=fc(C,F),v=T*Ya,T&&(A=Math.cos(-T),S=Math.sin(-T),J=L*A+U*S,X=G*A+O*S,N=C*A+F*S,U=L*-S+U*A,O=G*-S+O*A,F=C*-S+F*A,P=$*-S+P*A,L=J,G=X,C=N),T=fc(-D,F),g=T*Ya,T&&(A=Math.cos(-T),S=Math.sin(-T),J=E*A-U*S,X=R*A-O*S,N=D*A-F*S,P=z*S+P*A,E=J,R=X,D=N),T=fc(R,E),f=T*Ya,T&&(A=Math.cos(T),S=Math.sin(T),J=E*A+R*S,X=L*A+G*S,R=R*A-E*S,G=G*A-L*S,E=J,L=X),v&&Math.abs(v)+Math.abs(f)>359.9&&(v=f=0,g=180-g),d=_i(Math.sqrt(E*E+R*R+D*D)),p=_i(Math.sqrt(G*G+C*C)),T=fc(L,G),m=Math.abs(T)>2e-4?T*Ya:0,y=P?1/(P<0?-P:P):0),t.svg&&(J=n.getAttribute("transform"),t.forceCSS=n.setAttribute("transform","")||!X2(Cs(n,ui)),J&&n.setAttribute("transform",J))),Math.abs(m)>90&&Math.abs(m)<270&&(r?(d*=-1,m+=f<=0?180:-180,f+=f<=0?180:-180):(p*=-1,m+=m<=0?180:-180)),e=e||t.uncache,t.x=c-((t.xPercent=c&&(!e&&t.xPercent||(Math.round(n.offsetWidth/2)===Math.round(-c)?-50:0)))?n.offsetWidth*t.xPercent/100:0)+s,t.y=u-((t.yPercent=u&&(!e&&t.yPercent||(Math.round(n.offsetHeight/2)===Math.round(-u)?-50:0)))?n.offsetHeight*t.yPercent/100:0)+s,t.z=h+s,t.scaleX=_i(d),t.scaleY=_i(p),t.rotation=_i(f)+o,t.rotationX=_i(v)+o,t.rotationY=_i(g)+o,t.skewX=m+o,t.skewY=x+o,t.transformPerspective=y+s,(t.zOrigin=parseFloat(l.split(" ")[2])||0)&&(i[hs]=cm(l)),t.xOffset=t.yOffset=0,t.force3D=wn.force3D,t.renderTransform=t.svg?pB:H2?Y2:dB,t.uncache=0,t},cm=function(n){return(n=n.split(" "))[0]+" "+n[1]},_v=function(n,e,t){var i=mr(e);return _i(parseFloat(e)+parseFloat(oa(n,"x",t+"px",i)))+i},dB=function(n,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Y2(n,e)},Va="0deg",th="0px",Ha=") ",Y2=function(n,e){var t=e||this,i=t.xPercent,r=t.yPercent,s=t.x,o=t.y,a=t.z,l=t.rotation,c=t.rotationY,u=t.rotationX,h=t.skewX,d=t.skewY,p=t.scaleX,f=t.scaleY,v=t.transformPerspective,g=t.force3D,m=t.target,x=t.zOrigin,y="",_=g==="auto"&&n&&n!==1||g===!0;if(x&&(u!==Va||c!==Va)){var w=parseFloat(c)*Ic,b=Math.sin(w),T=Math.cos(w),A;w=parseFloat(u)*Ic,A=Math.cos(w),s=_v(m,s,b*A*-x),o=_v(m,o,-Math.sin(w)*-x),a=_v(m,a,T*A*-x+x)}v!==th&&(y+="perspective("+v+Ha),(i||r)&&(y+="translate("+i+"%, "+r+"%) "),(_||s!==th||o!==th||a!==th)&&(y+=a!==th||_?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+Ha),l!==Va&&(y+="rotate("+l+Ha),c!==Va&&(y+="rotateY("+c+Ha),u!==Va&&(y+="rotateX("+u+Ha),(h!==Va||d!==Va)&&(y+="skew("+h+", "+d+Ha),(p!==1||f!==1)&&(y+="scale("+p+", "+f+Ha),m.style[ui]=y||"translate(0, 0)"},pB=function(n,e){var t=e||this,i=t.xPercent,r=t.yPercent,s=t.x,o=t.y,a=t.rotation,l=t.skewX,c=t.skewY,u=t.scaleX,h=t.scaleY,d=t.target,p=t.xOrigin,f=t.yOrigin,v=t.xOffset,g=t.yOffset,m=t.forceCSS,x=parseFloat(s),y=parseFloat(o),_,w,b,T,A;a=parseFloat(a),l=parseFloat(l),c=parseFloat(c),c&&(c=parseFloat(c),l+=c,a+=c),a||l?(a*=Ic,l*=Ic,_=Math.cos(a)*u,w=Math.sin(a)*u,b=Math.sin(a-l)*-h,T=Math.cos(a-l)*h,l&&(c*=Ic,A=Math.tan(l-c),A=Math.sqrt(1+A*A),b*=A,T*=A,c&&(A=Math.tan(c),A=Math.sqrt(1+A*A),_*=A,w*=A)),_=_i(_),w=_i(w),b=_i(b),T=_i(T)):(_=u,T=h,w=b=0),(x&&!~(s+"").indexOf("px")||y&&!~(o+"").indexOf("px"))&&(x=oa(d,"x",s,"px"),y=oa(d,"y",o,"px")),(p||f||v||g)&&(x=_i(x+p-(p*_+f*b)+v),y=_i(y+f-(p*w+f*T)+g)),(i||r)&&(A=d.getBBox(),x=_i(x+i/100*A.width),y=_i(y+r/100*A.height)),A="matrix("+_+","+w+","+b+","+T+","+x+","+y+")",d.setAttribute("transform",A),m&&(d.style[ui]=A)},fB=function(n,e,t,i,r){var s=360,o=Yi(r),a=parseFloat(r)*(o&&~r.indexOf("rad")?Ya:1),l=a-i,c=i+l+"deg",u,h;return o&&(u=r.split("_")[1],u==="short"&&(l%=s,l!==l%(s/2)&&(l+=l<0?s:-s)),u==="cw"&&l<0?l=(l+s*LT)%s-~~(l/s)*s:u==="ccw"&&l>0&&(l=(l-s*LT)%s-~~(l/s)*s)),n._pt=h=new en(n._pt,e,t,i,l,Zz),h.e=c,h.u="deg",n._props.push(t),h},zT=function(n,e){for(var t in e)n[t]=e[t];return n},mB=function(n,e,t){var i=zT({},t._gsap),r="perspective,force3D,transformOrigin,svgOrigin",s=t.style,o,a,l,c,u,h,d,p;i.svg?(l=t.getAttribute("transform"),t.setAttribute("transform",""),s[ui]=e,o=td(t,1),Qh(t,ui),t.setAttribute("transform",l)):(l=getComputedStyle(t)[ui],s[ui]=e,o=td(t,1),s[ui]=l);for(a in po)l=i[a],c=o[a],l!==c&&r.indexOf(a)<0&&(d=mr(l),p=mr(c),u=d!==p?oa(t,a,l,p):parseFloat(l),h=parseFloat(c),n._pt=new en(n._pt,o,a,u,h-u,dx),n._pt.u=p||0,n._props.push(a));zT(o,i)};Qr("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",s="Left",o=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(a){return e<2?n+a:"border"+a+n});lm[e>1?"border"+n:n]=function(a,l,c,u,h){var d,p;if(arguments.length<4)return d=o.map(function(f){return eo(a,f,c)}),p=d.join(" "),p.split(d[0]).length===5?d[0]:p;d=(u+"").split(" "),p={},o.forEach(function(f,v){return p[f]=d[v]=d[v]||d[(v-1)/2|0]}),a.init(l,p,h)}});var $2={name:"css",register:fx,targetTest:function(n){return n.style&&n.nodeType},init:function(n,e,t,i,r){var s=this._props,o=n.style,a=t.vars.startAt,l,c,u,h,d,p,f,v,g,m,x,y,_,w,b,T;K1||fx(),this.styles=this.styles||V2(n),T=this.styles.props,this.tween=t;for(f in e)if(f!=="autoRound"&&(c=e[f],!(gn[f]&&R2(f,e,t,i,n,r)))){if(d=typeof c,p=lm[f],d==="function"&&(c=c.call(t,i,n,r),d=typeof c),d==="string"&&~c.indexOf("random(")&&(c=Zh(c)),p)p(this,n,f,c,t)&&(b=1);else if(f.substr(0,2)==="--")l=(getComputedStyle(n).getPropertyValue(f)+"").trim(),c+="",$o.lastIndex=0,$o.test(l)||(v=mr(l),g=mr(c)),g?v!==g&&(l=oa(n,f,l,g)+g):v&&(c+=v),this.add(o,"setProperty",l,c,i,r,0,0,f),s.push(f),T.push(f,0,o[f]);else if(d!=="undefined"){if(a&&f in a?(l=typeof a[f]=="function"?a[f].call(t,i,n,r):a[f],Yi(l)&&~l.indexOf("random(")&&(l=Zh(l)),mr(l+"")||(l+=wn.units[f]||mr(eo(n,f))||""),(l+"").charAt(1)==="="&&(l=eo(n,f))):l=eo(n,f),h=parseFloat(l),m=d==="string"&&c.charAt(1)==="="&&c.substr(0,2),m&&(c=c.substr(2)),u=parseFloat(c),f in As&&(f==="autoAlpha"&&(h===1&&eo(n,"visibility")==="hidden"&&u&&(h=0),T.push("visibility",0,o.visibility),No(this,o,"visibility",h?"inherit":"hidden",u?"inherit":"hidden",!u)),f!=="scale"&&f!=="transform"&&(f=As[f],~f.indexOf(",")&&(f=f.split(",")[0]))),x=f in po,x){if(this.styles.save(f),y||(_=n._gsap,_.renderTransform&&!e.parseTransform||td(n,e.parseTransform),w=e.smoothOrigin!==!1&&_.smooth,y=this._pt=new en(this._pt,o,ui,0,1,_.renderTransform,_,0,-1),y.dep=1),f==="scale")this._pt=new en(this._pt,_,"scaleY",_.scaleY,(m?Lc(_.scaleY,m+u):u)-_.scaleY||0,dx),this._pt.u=0,s.push("scaleY",f),f+="X";else if(f==="transformOrigin"){T.push(hs,0,o[hs]),c=uB(c),_.svg?mx(n,c,0,w,0,this):(g=parseFloat(c.split(" ")[2])||0,g!==_.zOrigin&&No(this,_,"zOrigin",_.zOrigin,g),No(this,o,f,cm(l),cm(c)));continue}else if(f==="svgOrigin"){mx(n,c,1,w,0,this);continue}else if(f in j2){fB(this,_,f,h,m?Lc(h,m+c):c);continue}else if(f==="smoothOrigin"){No(this,_,"smooth",_.smooth,c);continue}else if(f==="force3D"){_[f]=c;continue}else if(f==="transform"){mB(this,c,n);continue}}else f in o||(f=eu(f)||f);if(x||(u||u===0)&&(h||h===0)&&!Kz.test(c)&&f in o)v=(l+"").substr((h+"").length),u||(u=0),g=mr(c)||(f in wn.units?wn.units[f]:v),v!==g&&(h=oa(n,f,l,g)),this._pt=new en(this._pt,x?_:o,f,h,(m?Lc(h,m+u):u)-h,!x&&(g==="px"||f==="zIndex")&&e.autoRound!==!1?Qz:dx),this._pt.u=g||0,v!==g&&g!=="%"&&(this._pt.b=l,this._pt.r=Jz);else if(f in o)cB.call(this,n,f,l,m?m+c:c);else if(f in n)this.add(n,f,l||n[f],m?m+c:c,i,r);else if(f!=="parseTransform"){G1(f,c);continue}x||(f in o?T.push(f,0,o[f]):T.push(f,1,l||n[f])),s.push(f)}}b&&U2(this)},render:function(n,e){if(e.tween._time||!Z1())for(var t=e._pt;t;)t.r(n,t.d),t=t._next;else e.styles.revert()},get:eo,aliases:As,getSetter:function(n,e,t){var i=As[e];return i&&i.indexOf(",")<0&&(e=i),e in po&&e!==hs&&(n._gsap.x||eo(n,"x"))?t&&RT===t?e==="scale"?rB:iB:(RT=t||{})&&(e==="scale"?nB:sB):n.style&&!z1(n.style[e])?eB:~e.indexOf("-")?tB:Y1(n,e)},core:{_removeProperty:Qh,_getMatrix:Q1}};rn.utils.checkPrefix=eu;rn.core.getStyleSaver=V2;(function(n,e,t,i){var r=Qr(n+","+e+","+t,function(s){po[s]=1});Qr(e,function(s){wn.units[s]="deg",j2[s]=1}),As[r[13]]=n+","+e,Qr(i,function(s){var o=s.split(":");As[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Qr("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){wn.units[n]="px"});rn.registerPlugin($2);var lt=rn.registerPlugin($2)||rn;lt.core.Tween;var gx=class{constructor(){eR(this,"updateGuiTweaks",()=>{this.scene.traverse(e=>{e instanceof wt&&e.material instanceof Xc&&(e.material.envMap=this.environmentMap.texture,e.material.envMapIntensity=this.environmentMap.intensity,e.material.needsUpdate=!0)})}),this.app=new Bt,this.time=this.app.time,this.scene=this.app.scene,this.resources=this.app.resources,this.debug=this.app.debug,this.environmentMap={},this.flashyRunning=!1,this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("light"),this.debugFolder.close()),this.setSunLight(),this.setEnvironmentMap()}setSunLight(){this.sunLight=new Yh("#ffffff",1.594),this.sunLight.name="directional light",this.sunLight.position.set(-8,0,8),this.sunLight.lookAt(0,0,0),this.scene.add(this.sunLight),this.sunLight2=new Yh("#ffffff",1.594),this.sunLight2.name="directional light2",this.sunLight2.position.set(-8,0,8),this.sunLight2.lookAt(0,0,0),this.scene.add(this.sunLight2),this.debug.active&&(this.debugFolder.add(this.sunLight,"intensity").name("general light").min(0).max(10).step(.001),this.debugFolder.add(this.sunLight2,"intensity").name("sunLightIntensity").min(0).max(30).step(.001),this.debugFolder.add(this.sunLight2.position,"x").name("sunLightX").min(-20).max(20).step(.001),this.debugFolder.add(this.sunLight2.position,"y").name("sunLightY").min(-20).max(20).step(.001),this.debugFolder.add(this.sunLight2.position,"z").name("sunLightZ").min(-30).max(30).step(.001))}setEnvironmentMap(){}resetFlashy(){lt.to(this.sunLight2,{intensity:1,duration:.1,ease:"power1.inOut"}),lt.to(this.sunLight,{intensity:1,duration:.1,ease:"power1.inOut"}),lt.to(this.sunLight2.position,{x:-4,y:4,z:-8,duration:1}),lt.to(this.sunLight.position,{x:.497,y:12.753,z:-10.919,duration:1})}runFlashy(){let e=1.4110406831404683,t=1.779492125312498,i=6,r=.1,s=["power1.inOut","elastic.out","bounce.out"],o=s[Math.floor(Math.random()*s.length)];lt.fromTo(this.sunLight,{intensity:Math.random()*.2},{intensity:e,duration:r,repeat:i,ease:o,delay:Math.random()*.5,onComplete:()=>{this.sunLight.intensity=e}}),lt.fromTo(this.sunLight2,{intensity:Math.random()*.2},{intensity:t,duration:r,repeat:i,ease:o,delay:Math.random()*.5,onComplete:()=>{this.sunLight2.intensity=t}}),lt.to(this.sunLight2.position,{x:-4,y:4,z:8,duration:1}),lt.to(this.sunLight.position,{x:.497,y:12.753,z:1.919,duration:1})}update(){}},vx=class extends Sn{constructor(e,t,i){super(),this.app=new Bt,this.scene=this.app.scene,this.scrollManager=this.app.scrollManager,this.helper=new Yt,this.group=e,this.mouse=t,this.camera=i,this.renderer=this.app.renderer,this.rayArmed=!1,this.storedPosition=new oe,setTimeout(()=>{this.rayArmed=!0},1e3),this.mag=0,this.raycaster=new em(new oe,this.direction,0,150),this.ray=this.raycaster.ray,this.runMouseDetect(),this.runTouchStart(),this.instance=this.createCube(),this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.instance.material.onBeforeRender(r=>r.clearDepth()),this.instance.renderOrder=999,this.instance.rotation.x=Math.PI*.5,this.instance.scale.x=.2,this.instance.scale.y=.2,this.instance.scale.z=.2}runMouseDetect(){this.mouse.on("mouse-move",e=>{this.raycaster.setFromCamera(this.mouse.screenPosition,this.camera.instance)}),this.scrollManager.on("scroll",e=>{this.raycaster.setFromCamera(this.mouse.screenPosition,this.camera.instance),this.mouse.processing()})}runTouchStart(){this.mouse.on("touch-start",()=>{this.raycaster.setFromCamera(this.mouse.screenPosition,this.camera.instance)})}createCube(){return new wt(new gl,new gr)}getRandomPosition(e){let t=Math.random()*2*Math.PI,i=Math.sqrt(Math.random())*e,r=i*Math.cos(t),s=i*Math.sin(t),o=i*Math.sin(t);return{x:r,y:s,z:o}}updatePositions(e){for(let t=0;t<this.positionAttribute.count;t++)this.positionAttribute.setXYZ(t,this.initialPositions[t*3]+e*(this.randomizedPositions[t*3]-this.initialPositions[t*3]),this.initialPositions[t*3+1]+e*(this.randomizedPositions[t*3+1]-this.initialPositions[t*3+1]),this.initialPositions[t*3+2]+e*(this.randomizedPositions[t*3+2]-this.initialPositions[t*3+2]));this.positionAttribute.needsUpdate=!0}update(){}},gB=`uniform vec2 hitUv;
uniform float pulse;
uniform float mouseVelocity;
uniform vec2 mouseVelocityVec;

varying vec2 vUv;
varying vec3 vViewPosition;

void main() {
    vec3 pos = position;
    vUv = uv;

    float effectRadius = 0.01;
    float size = 0.05; 
    float effectStrength = 0.0001;
    float displacementFactor = mouseVelocity;

    vec2 direction = mouseVelocityVec == vec2(0.0) ? vec2(0.0) : normalize(mouseVelocityVec);
    direction.y *= -1.0; 

    float distanceFromHit = distance(vUv, hitUv);

    
    
    
    

    vec2 diff = abs(vUv - hitUv);

    
    if (diff.x < size && diff.y < size) {
        
        
        float influence = effectStrength; 
        pos.xy += direction * displacementFactor * influence * pulse * 5.0;
    }

    vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
}`,vB=`uniform sampler2D colorTexture;
uniform sampler2D depthTexture;
uniform float depthScale;
uniform vec3 viewPos;
uniform sampler2D uTexture1;
uniform float uTime;
uniform sampler2D alphaTexture;
uniform float uRatio;
uniform float uMaskRatio;
uniform vec2 hitUv;

varying vec2 vUv;
varying vec3 vViewPosition;

float vertJerkOpt = 0.02;
float vertMovementOpt = 0.01;

float bottomStaticOpt = 0.25;

float scalinesOpt = 0.1;

float rgbOffsetOpt = 0.0;
float horzFuzzOpt = 1.0;

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v)
  {
  const vec4 C = vec4(0.211324865405187,  
                      0.366025403784439,  
                     -0.577350269189626,  
                      0.024390243902439); 

  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

  vec2 i1;
  
  
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  
  
  
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

  i = mod289(i); 
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
		+ i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

float staticV(vec2 uv) {
    float staticHeight = snoise(vec2(9.0,uTime*1.2+3.0))*0.3+5.0;
    float staticAmount = snoise(vec2(1.0,uTime*1.2-6.0))*0.1+0.3;
    float staticStrength = snoise(vec2(-9.75,uTime*0.6-3.0))*2.0+2.0;
	return (1.0-step(snoise(vec2(5.0*pow(uTime,2.0)+pow(uv.x*7.0,1.2),pow((mod(uTime,100.0)+100.0)*uv.y*0.3+3.0,staticHeight))),staticAmount))*staticStrength;
}

vec2 parallaxOffset(vec3 viewDir, float height, float scale, vec2 uv) {
    
    float numLayers = 500.0; 
    float layerDepth = 1.0 / numLayers;
    vec2 dtex = viewDir.xy * scale / viewDir.z / numLayers;
    vec2 currentTexCoords = uv;

    
    
    

    float currentLayerDepth = 0.0;
    float currentDepthValue = texture2D(depthTexture, currentTexCoords).r;

    
    while (currentLayerDepth < currentDepthValue) {
        currentTexCoords -= dtex;
        currentDepthValue = texture2D(depthTexture, currentTexCoords).r;
        currentLayerDepth += layerDepth;
    }

    
    float lower = currentLayerDepth - layerDepth;
    float upper = currentLayerDepth;
    vec2 lowerTexCoords = currentTexCoords + dtex;
    vec2 upperTexCoords = currentTexCoords;

    for (int i = 0; i < 5; ++i) { 
        vec2 midTexCoords = (lowerTexCoords + upperTexCoords) * 0.5;
        float midDepth = texture2D(depthTexture, midTexCoords).r;
        if (midDepth > layerDepth * (numLayers - 1.0 - float(i))) {
            lowerTexCoords = midTexCoords;
        } else {
            upperTexCoords = midTexCoords;
        }
    }

    return (upperTexCoords - vUv);
}

vec3 gammaCorrectedColor(vec3 textureColor){
   return pow(textureColor.rgb, vec3(1.0 / 2.2));
}

void main() {

    

    vec2 fitColorUv = vUv;
    

    if (uMaskRatio < uRatio) {
        
        
        float scaleX = uMaskRatio / uRatio;
        fitColorUv.x = fitColorUv.x * scaleX + (1.0 - scaleX) * 0.5;
    } 

    

    
    
    
    
    
    

    vec3 vp = vec3(viewPos.x, viewPos.y, viewPos.z);
    vec3 viewDir = normalize(vViewPosition + vp);
    vec2 newCoords = fitColorUv + parallaxOffset(viewDir, texture2D(depthTexture, vUv).r, depthScale, fitColorUv);
    

        
        
        

        

    
    

    vec4 texColor = texture2D(colorTexture, newCoords);

    
    float edgeWidth = 0.05; 
    
    

    
    

    float alpha = 1.0;

  
    vec4 texColorAlpha2 = texture2D(alphaTexture, newCoords);
    if (texColorAlpha2.x > 0.5) {
        alpha = 0.0; 
    }

    
    vec4 texColorAlpha = texture2D(uTexture1, vUv);
    if (texColorAlpha.a < 0.5) {
        discard; 
    }

	
	float jerkOffset = (1.0-step(snoise(vec2(uTime*1.3,5.0)),0.8))*0.05;
	
	float fuzzOffset = snoise(vec2(uTime*15.0,newCoords.y*80.0))*0.003;
	float largeFuzzOffset = snoise(vec2(uTime*1.0,newCoords.y*25.0))*0.004;
    
    float vertMovementOn = (1.0-step(snoise(vec2(uTime*0.2,8.0)),0.4))*vertMovementOpt;
    float vertJerk = (1.0-step(snoise(vec2(uTime*1.5,5.0)),0.6))*vertJerkOpt;
    float vertJerk2 = (1.0-step(snoise(vec2(uTime*5.5,5.0)),0.2))*vertJerkOpt;
    float yOffset = abs(sin(uTime)*4.0)*vertMovementOn+vertJerk*vertJerk2*0.3;
    float y = mod(newCoords.y+yOffset,1.0);
    
	
	float xOffset = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt;
    
    float staticVal = 0.0;
   
    for (float y = -1.0; y <= 1.0; y += 1.0) {
        float maxDist = 5.0/200.0;
        float dist = y/200.0;
    	staticVal += staticV(vec2(newCoords.x,newCoords.y+dist))*(maxDist-abs(dist))*1.5;
    }
        
    staticVal *= bottomStaticOpt;
	
	float red 	=   texture2D(	colorTexture, 	vec2(newCoords.x + xOffset -0.01*rgbOffsetOpt,y)).r+staticVal;
	float green = 	texture2D(	colorTexture, 	vec2(newCoords.x + xOffset,	  y)).g+staticVal;
	float blue 	=	texture2D(	colorTexture, 	vec2(newCoords.x + xOffset +0.01*rgbOffsetOpt,y)).b+staticVal;
	
	vec3 color = vec3(red,green,blue);
	float scanline = sin(newCoords.y*800.0)*0.04*scalinesOpt;
	color -= scanline;
	
	vec4 noiseOut = vec4(color, 1.0);

  

  
  gl_FragColor = mix(vec4(gammaCorrectedColor(texColor.rgb * 1.0), alpha), vec4(gammaCorrectedColor(noiseOut.rgb * 1.0), alpha), 0.1);

    
  

    

    

    

    
    
    
}`,yx=class{constructor(e){this.group=e,this.app=new Bt,this.helper=new Yt,this.scaleDownGroup=new vt,this.scaleDownGroup.name="scaleDownGroup",this.group.add(this.scaleDownGroup),this.movement=new oe,this.targetPositionVector3=new oe,this.currentPositionVector3=new oe,this.pulse=0,this.mouseVelocityLerped=0,this.pulseLerped=0,this.mouseVelocityVecLerped=new Me,this.start(),this.storedWidth=this.instance.geometry.parameters.width,this.storedHeight=this.instance.geometry.parameters.height,this.currentWidth=this.instance.geometry.parameters.width,this.currentHeight=this.instance.geometry.parameters.height,this.app.sizes.on("resize",()=>{this.currentHeight=this.app.sizes.pixelsToWorldUnits(this.rect.height,.165)*2,this.currentWidth=this.currentHeight*this.maskRatio,this.ratioOfScale=this.currentHeight/this.storedHeight,this.instance.scale.x=this.ratioOfScale,this.instance.scale.y=this.ratioOfScale})}start(){this.markerElement=document.getElementById("gl-space-scene"),this.rect=this.markerElement.getBoundingClientRect(),this.app.isMobile===!1?this.mask=this.app.resources.items.spaceA:this.mask=this.app.resources.items.shapeMaskOne,this.maskRatioAlt=this.app.resources.items.spaceA.source.data.height/this.app.resources.items.spaceA.source.data.width,this.maskRatio=this.app.resources.items.spaceA.source.data.width/this.app.resources.items.spaceA.source.data.height;let e=.165;this.hhh=this.app.sizes.pixelsToWorldUnits(this.rect.height,e)*2,this.www=this.hhh*this.maskRatio,this.geometry=new hi(this.www,this.hhh,32,32),this.material=new ri({side:Di,stencilWrite:!0,stencilRef:4,stencilZPass:IM,transparent:!0,uniforms:{colorTexture:{value:this.app.resources.items.spaceTexture},depthTexture:{value:this.app.resources.items.spaceDepthMap},alphaTexture:{value:this.app.resources.items.spaceSceneAlpha},depthScale:{value:.0075},uTime:{value:0},viewPos:{value:this.movement},uTexture1:{value:this.mask},uRatio:{value:this.app.resources.items.spaceTexture.source.data.width/this.app.resources.items.spaceTexture.source.data.height},uMaskRatio:{value:this.maskRatio},hitUv:{value:new Me},pulse:{value:this.pulse},mouseVelocity:{value:0},mouseVelocityVec:{value:new Me}},vertexShader:gB,fragmentShader:vB}),this.instance=new wt(this.geometry,this.material),this.instance.renderOrder=990,this.scaleDownGroup.add(this.instance),this.scaleDownGroup.scale.x*=.605,this.scaleDownGroup.scale.y*=.605,this.scaleDownGroup.scale.z*=.605}update(){this.movement.x=this.helper.lerp(this.movement.x,-this.app.mouse.screenPosition.x*.5,.05),this.movement.y=this.helper.lerp(this.movement.y,-this.app.mouse.screenPosition.y*.5,.05),this.movement.x+=Math.sin(this.app.time.elapsed*5e-4)*.02,this.movement.y+=Math.cos(this.app.time.elapsed*5e-4)*.02,this.material.uniforms.viewPos.value=this.movement,this.material.uniforms.uTime.value=this.app.time.elapsed*.001,this.mouseVelocityLerped=this.helper.lerp(this.mouseVelocityLerped,this.app.mouse.mouseVelocity,.04),this.pulseLerped=this.helper.lerp(this.pulseLerped,this.pulse,.04),this.mouseVelocityVecLerped.lerpVectors(this.mouseVelocityVecLerped,this.app.mouse.velocity,.04),this.material.uniforms.pulse.value=this.pulseLerped,this.material.uniforms.mouseVelocity.value=this.mouseVelocityLerped,this.material.uniforms.mouseVelocityVec.value=this.mouseVelocityVecLerped}},yB=`uniform vec2 hitUv;
uniform float pulse;
uniform float mouseVelocity;
uniform vec2 mouseVelocityVec;

varying vec2 vUv;
varying vec3 vViewPosition;

void main() {
    vec3 pos = position;
    vUv = uv;

    float effectRadius = 0.01;
    float size = 0.05; 
    float effectStrength = 0.0001;
    float displacementFactor = mouseVelocity;

    vec2 direction = mouseVelocityVec == vec2(0.0) ? vec2(0.0) : normalize(mouseVelocityVec);
    direction.y *= -1.0; 

    float distanceFromHit = distance(vUv, hitUv);

    
    
    
    

    vec2 diff = abs(vUv - hitUv);

    
    if (diff.x < size && diff.y < size) {
        
        
        float influence = effectStrength; 
        pos.xy += direction * displacementFactor * influence * pulse * 5.0;
    }

    vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
}`,xB=`uniform sampler2D colorTexture;
uniform sampler2D depthTexture;
uniform float depthScale;
uniform vec3 viewPos;
uniform sampler2D uTexture1;
uniform float uTime;
uniform sampler2D alphaTexture;
uniform float uRatio;
uniform float uMaskRatio;
uniform float opacity;
uniform vec2 hitUv;

varying vec2 vUv;
varying vec3 vViewPosition;

float vertJerkOpt = 0.02;
float vertMovementOpt = 0.01;

float bottomStaticOpt = 0.25;

float scalinesOpt = 0.1;

float rgbOffsetOpt = 0.0;
float horzFuzzOpt = 1.0;

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v)
  {
  const vec4 C = vec4(0.211324865405187,  
                      0.366025403784439,  
                     -0.577350269189626,  
                      0.024390243902439); 

  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

  vec2 i1;
  
  
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  
  
  
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

  i = mod289(i); 
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
		+ i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

float staticV(vec2 uv) {
    float staticHeight = snoise(vec2(9.0,uTime*1.2+3.0))*0.3+5.0;
    float staticAmount = snoise(vec2(1.0,uTime*1.2-6.0))*0.1+0.3;
    float staticStrength = snoise(vec2(-9.75,uTime*0.6-3.0))*2.0+2.0;
	return (1.0-step(snoise(vec2(5.0*pow(uTime,2.0)+pow(uv.x*7.0,1.2),pow((mod(uTime,100.0)+100.0)*uv.y*0.3+3.0,staticHeight))),staticAmount))*staticStrength;
}

vec2 parallaxOffset(vec3 viewDir, float height, float scale, vec2 uv) {
    
    float numLayers = 500.0; 
    float layerDepth = 1.0 / numLayers;
    vec2 dtex = viewDir.xy * scale / viewDir.z / numLayers;
    vec2 currentTexCoords = uv;

    
    
    

    float currentLayerDepth = 0.0;
    float currentDepthValue = texture2D(depthTexture, currentTexCoords).r;

    
    while (currentLayerDepth < currentDepthValue) {
        currentTexCoords -= dtex;
        currentDepthValue = texture2D(depthTexture, currentTexCoords).r;
        currentLayerDepth += layerDepth;
    }

    
    float lower = currentLayerDepth - layerDepth;
    float upper = currentLayerDepth;
    vec2 lowerTexCoords = currentTexCoords + dtex;
    vec2 upperTexCoords = currentTexCoords;

    for (int i = 0; i < 5; ++i) { 
        vec2 midTexCoords = (lowerTexCoords + upperTexCoords) * 0.5;
        float midDepth = texture2D(depthTexture, midTexCoords).r;
        if (midDepth > layerDepth * (numLayers - 1.0 - float(i))) {
            lowerTexCoords = midTexCoords;
        } else {
            upperTexCoords = midTexCoords;
        }
    }

    return upperTexCoords - vUv;
}

vec3 gammaCorrectedColor(vec3 textureColor){
   return pow(textureColor.rgb, vec3(1.0 / 2.2));
}

void main() {

    

    vec2 fitColorUv = vUv;
    

    if (uMaskRatio < uRatio) {
        
        
        float scaleX = uMaskRatio / uRatio;
        fitColorUv.x = fitColorUv.x * scaleX + (1.0 - scaleX) * 0.5;
    } 

    vec3 vp = vec3(viewPos.x, viewPos.y, viewPos.z);
    vec3 viewDir = normalize(vViewPosition + vp);
    vec2 newCoords = fitColorUv + parallaxOffset(viewDir, texture2D(depthTexture, vUv).r, depthScale, fitColorUv);
    

        
        
        

    
    vec4 texColorAlpha = texture2D(uTexture1, fitColorUv);
    if (texColorAlpha.a < 0.5) {
        discard; 
    }

    float alpha = 1.0;

  
    vec4 texColorAlpha2 = texture2D(alphaTexture, newCoords);
    if (texColorAlpha2.x > 0.5) {
        
       alpha = 0.0;
    }

    
    

    vec4 texColor = texture2D(colorTexture, newCoords);

    
    float edgeWidth = 0.005; 
    
    

    
    

  alpha = opacity * alpha;

	
	float jerkOffset = (1.0-step(snoise(vec2(uTime*1.3,5.0)),0.8))*0.05;
	
	float fuzzOffset = snoise(vec2(uTime*15.0,newCoords.y*80.0))*0.003;
	float largeFuzzOffset = snoise(vec2(uTime*1.0,newCoords.y*25.0))*0.004;
    
    float vertMovementOn = (1.0-step(snoise(vec2(uTime*0.2,8.0)),0.4))*vertMovementOpt;
    float vertJerk = (1.0-step(snoise(vec2(uTime*1.5,5.0)),0.6))*vertJerkOpt;
    float vertJerk2 = (1.0-step(snoise(vec2(uTime*5.5,5.0)),0.2))*vertJerkOpt;
    float yOffset = abs(sin(uTime)*4.0)*vertMovementOn+vertJerk*vertJerk2*0.3;
    float y = mod(newCoords.y+yOffset,1.0);
    
	
	float xOffset = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt;
    
    float staticVal = 0.0;
   
    for (float y = -1.0; y <= 1.0; y += 1.0) {
        float maxDist = 5.0/200.0;
        float dist = y/200.0;
    	staticVal += staticV(vec2(newCoords.x,newCoords.y+dist))*(maxDist-abs(dist))*1.5;
    }
        
    staticVal *= bottomStaticOpt;
	
	float red 	=   texture2D(	colorTexture, 	vec2(newCoords.x + xOffset -0.01*rgbOffsetOpt,y)).r+staticVal;
	float green = 	texture2D(	colorTexture, 	vec2(newCoords.x + xOffset,	  y)).g+staticVal;
	float blue 	=	texture2D(	colorTexture, 	vec2(newCoords.x + xOffset +0.01*rgbOffsetOpt,y)).b+staticVal;
	
	vec3 color = vec3(red,green,blue);
	float scanline = sin(newCoords.y*800.0)*0.04*scalinesOpt;
	color -= scanline;
	
	vec4 noiseOut = vec4(color,1.0);

  

  

  gl_FragColor = mix(vec4(gammaCorrectedColor(texColor.rgb * 1.0), alpha), vec4(gammaCorrectedColor(noiseOut.rgb * 1.0), alpha), 0.1);

    
    
      

  

    

    
}`,xx=class{constructor(e){this.group=e,this.app=new Bt,this.helper=new Yt,this.movement=new oe,this.targetPositionVector3=new oe,this.currentPositionVector3=new oe,this.fuckKnowsModifier=1.21,this.pulse=0,this.mouseVelocityLerped=0,this.pulseLerped=0,this.mouseVelocityVecLerped=new Me,this.start(),this.storedWidth=this.instance.geometry.parameters.width,this.storedHeight=this.instance.geometry.parameters.height,this.currentWidth=this.instance.geometry.parameters.width,this.currentHeight=this.instance.geometry.parameters.height,this.app.sizes.on("resize",()=>{this.app&&(this.currentHeight=this.app.sizes.pixelsToWorldUnits(this.rect.height,.165)*this.fuckKnowsModifier,this.currentWidth=this.currentHeight*this.maskRatio,this.ratioOfScale=this.currentHeight/this.storedHeight,this.instance.scale.x=this.ratioOfScale,this.instance.scale.y=this.ratioOfScale)})}start(){this.markerElement=document.getElementById("gl-bar-scene"),this.rect=this.markerElement.getBoundingClientRect(),this.app.isMobile===!1?this.mask=this.app.resources.items.barA:this.mask=this.app.resources.items.shapeMaskTwo,this.maskRatioAlt=this.app.resources.items.barA.source.data.height/this.app.resources.items.barA.source.data.width,this.maskRatio=this.app.resources.items.barA.source.data.width/this.app.resources.items.barA.source.data.height;let e=.165;this.hhh=this.app.sizes.pixelsToWorldUnits(this.rect.height,e)*this.fuckKnowsModifier,this.www=this.hhh*this.maskRatio,this.geometry=new hi(this.www,this.hhh,32,32),this.material=new ri({side:Di,transparent:!0,uniforms:{colorTexture:{value:this.app.resources.items.barTexture},depthTexture:{value:this.app.resources.items.barDepthMap},alphaTexture:{value:this.app.resources.items.barSceneAlpha},depthScale:{value:.1},uTime:{value:0},viewPos:{value:this.movement},uTexture1:{value:this.mask},uRatio:{value:this.app.resources.items.barTexture.source.data.width/this.app.resources.items.barTexture.source.data.height},uMaskRatio:{value:this.maskRatio},opacity:{value:1},hitUv:{value:new Me},pulse:{value:this.pulse},mouseVelocity:{value:0},mouseVelocityVec:{value:new Me}},vertexShader:yB,fragmentShader:xB}),this.instance=new wt(this.geometry,this.material),this.instance.renderOrder=991,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.group.add(this.instance)}flicker(){let e=[.05,.04,.065],t=Math.floor(Math.random()*3)+2,i=e[Math.floor(Math.random()*e.length)];lt.to(this.material.uniforms.opacity,{value:0,duration:i*2,repeat:t,ease:"none",delay:0,onComplete:()=>{this.material.uniforms.opacity.value=1}})}followTarget(){this.targetPosition=this.helper.update3DObjectPositionWithOffsetX(this.markerElement,this.instance,this.app.camera.instance,9.5,6.5),this.instance.position.x=this.helper.lerp(this.instance.position.x,this.targetPosition.x,_t),this.instance.position.y=this.helper.lerp(this.instance.position.y,this.targetPosition.y,_t),this.instance.position.z=this.helper.lerp(this.instance.position.z,this.targetPosition.z,_t)}dispose(){if(this.geometry&&this.geometry.dispose(),this.material){for(let e in this.material.uniforms){let t=this.material.uniforms[e];t&&t.value&&t.value.dispose&&t.value.dispose()}this.material.dispose()}this.instance&&this.group&&this.group.remove(this.instance),lt.killTweensOf(this.material.uniforms.opacity),this.group=null,this.app=null,this.helper=null,this.movement=null,this.targetPositionVector3=null,this.currentPositionVector3=null,this.instance=null,this.material=null,this.geometry=null,this.markerElement=null,this.mask=null}update(){this.movement.x=this.helper.lerp(this.movement.x,-this.app.mouse.screenPosition.x*.5,.05),this.movement.y=this.helper.lerp(this.movement.y,-this.app.mouse.screenPosition.y*.5,.05),this.movement.x+=Math.sin(this.app.time.elapsed*5e-4)*.01,this.movement.y+=Math.cos(this.app.time.elapsed*5e-4)*.01,this.material.uniforms.uTime.value=this.app.time.elapsed*.001,this.material.uniforms.viewPos.value=this.movement,this.mouseVelocityLerped=this.helper.lerp(this.mouseVelocityLerped,this.app.mouse.mouseVelocity,.04),this.pulseLerped=this.helper.lerp(this.pulseLerped,this.pulse,.04),this.mouseVelocityVecLerped.lerpVectors(this.mouseVelocityVecLerped,this.app.mouse.velocity,.04),this.material.uniforms.pulse.value=this.pulseLerped,this.material.uniforms.mouseVelocity.value=this.mouseVelocityLerped,this.material.uniforms.mouseVelocityVec.value=this.mouseVelocityVecLerped}};function BT(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function _B(n,e,t){return e&&BT(n.prototype,e),t&&BT(n,t),n}var rr,_x,xn,Go,Vo,Fc,K2,$a,wh,Z2,oo,as,J2,Q2=function(){return rr||typeof window<"u"&&(rr=window.gsap)&&rr.registerPlugin&&rr},eA=1,Mc=[],Dt=[],Ds=[],bh=Date.now,wx=function(n,e){return e},wB=function(){var n=wh.core,e=n.bridge||{},t=n._scrollers,i=n._proxies;t.push.apply(t,Dt),i.push.apply(i,Ds),Dt=t,Ds=i,wx=function(r,s){return e[r](s)}},Ko=function(n,e){return~Ds.indexOf(n)&&Ds[Ds.indexOf(n)+1][e]},Sh=function(n){return!!~Z2.indexOf(n)},Xr=function(n,e,t,i,r){return n.addEventListener(e,t,{passive:!i,capture:!!r})},Lr=function(n,e,t,i){return n.removeEventListener(e,t,!!i)},Yp="scrollLeft",$p="scrollTop",bx=function(){return oo&&oo.isPressed||Dt.cache++},um=function(n,e){var t=function i(r){if(r||r===0){eA&&(xn.history.scrollRestoration="manual");var s=oo&&oo.isPressed;r=i.v=Math.round(r)||(oo&&oo.iOS?1:0),n(r),i.cacheID=Dt.cache,s&&wx("ss",r)}else(e||Dt.cache!==i.cacheID||wx("ref"))&&(i.cacheID=Dt.cache,i.v=n());return i.v+i.offset};return t.offset=0,n&&t},Ur={s:Yp,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:um(function(n){return arguments.length?xn.scrollTo(n,Ii.sc()):xn.pageXOffset||Go[Yp]||Vo[Yp]||Fc[Yp]||0})},Ii={s:$p,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:Ur,sc:um(function(n){return arguments.length?xn.scrollTo(Ur.sc(),n):xn.pageYOffset||Go[$p]||Vo[$p]||Fc[$p]||0})},$r=function(n){return rr.utils.toArray(n)[0]||(typeof n=="string"&&rr.config().nullTargetWarn!==!1?console.warn("Element not found:",n):null)},aa=function(n,e){var t=e.s,i=e.sc;Sh(n)&&(n=Go.scrollingElement||Vo);var r=Dt.indexOf(n),s=i===Ii.sc?1:2;!~r&&(r=Dt.push(n)-1),Dt[r+s]||n.addEventListener("scroll",bx);var o=Dt[r+s],a=o||(Dt[r+s]=um(Ko(n,t),!0)||(Sh(n)?i:um(function(l){return arguments.length?n[t]=l:n[t]})));return a.target=n,o||(a.smooth=rr.getProperty(n,"scrollBehavior")==="smooth"),a},Sx=function(n,e,t){var i=n,r=n,s=bh(),o=s,a=e||50,l=Math.max(500,a*3),c=function(d,p){var f=bh();p||f-s>a?(r=i,i=d,o=s,s=f):t?i+=d:i=r+(d-r)/(f-o)*(s-o)},u=function(){r=i=t?0:i,o=s=0},h=function(d){var p=o,f=r,v=bh();return(d||d===0)&&d!==i&&c(d),s===o||v-o>l?0:(i+(t?f:-f))/((t?v:s)-p)*1e3};return{update:c,reset:u,getVelocity:h}},ih=function(n,e){return e&&!n._gsapAllow&&n.preventDefault(),n.changedTouches?n.changedTouches[0]:n},NT=function(n){var e=Math.max.apply(Math,n),t=Math.min.apply(Math,n);return Math.abs(e)>=Math.abs(t)?e:t},tA=function(){wh=rr.core.globals().ScrollTrigger,wh&&wh.core&&wB()},iA=function(n){return rr=n||Q2(),rr&&typeof document<"u"&&document.body&&(xn=window,Go=document,Vo=Go.documentElement,Fc=Go.body,Z2=[xn,Go,Vo,Fc],rr.utils.clamp,J2=rr.core.context||function(){},$a="onpointerenter"in Fc?"pointer":"mouse",K2=Ci.isTouch=xn.matchMedia&&xn.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in xn||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,as=Ci.eventTypes=("ontouchstart"in Vo?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in Vo?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return eA=0},500),tA(),_x=1),_x};Ur.op=Ii;Dt.cache=0;var Ci=function(){function n(t){this.init(t)}var e=n.prototype;return e.init=function(t){_x||iA(rr)||console.warn("Please gsap.registerPlugin(Observer)"),wh||tA();var i=t.tolerance,r=t.dragMinimum,s=t.type,o=t.target,a=t.lineHeight,l=t.debounce,c=t.preventDefault,u=t.onStop,h=t.onStopDelay,d=t.ignore,p=t.wheelSpeed,f=t.event,v=t.onDragStart,g=t.onDragEnd,m=t.onDrag,x=t.onPress,y=t.onRelease,_=t.onRight,w=t.onLeft,b=t.onUp,T=t.onDown,A=t.onChangeX,S=t.onChangeY,E=t.onChange,R=t.onToggleX,D=t.onToggleY,z=t.onHover,L=t.onHoverEnd,G=t.onMove,J=t.ignoreCheck,X=t.isNormalizer,N=t.onGestureStart,U=t.onGestureEnd,O=t.onWheel,F=t.onEnable,$=t.onDisable,P=t.onClick,C=t.scrollSpeed,M=t.capture,B=t.allowClicks,k=t.lockAxis,Q=t.onLockAxis;this.target=o=$r(o)||Vo,this.vars=t,d&&(d=rr.utils.toArray(d)),i=i||1e-9,r=r||0,p=p||1,C=C||1,s=s||"wheel,touch,pointer",l=l!==!1,a||(a=parseFloat(xn.getComputedStyle(Fc).lineHeight)||22);var Y,re,Z,V,ne,ie,te,j=this,W=0,H=0,q=aa(o,Ur),I=aa(o,Ii),ee=q(),me=I(),pe=~s.indexOf("touch")&&!~s.indexOf("pointer")&&as[0]==="pointerdown",ge=Sh(o),xe=o.ownerDocument||Go,we=[0,0,0],_e=[0,0,0],Ie=0,Be=function(){return Ie=bh()},Ae=function(Te,Ze){return(j.event=Te)&&d&&~d.indexOf(Te.target)||Ze&&pe&&Te.pointerType!=="touch"||J&&J(Te,Ze)},it=function(){j._vx.reset(),j._vy.reset(),re.pause(),u&&u(j)},se=function(){var Te=j.deltaX=NT(we),Ze=j.deltaY=NT(_e),Se=Math.abs(Te)>=i,ce=Math.abs(Ze)>=i;E&&(Se||ce)&&E(j,Te,Ze,we,_e),Se&&(_&&j.deltaX>0&&_(j),w&&j.deltaX<0&&w(j),A&&A(j),R&&j.deltaX<0!=W<0&&R(j),W=j.deltaX,we[0]=we[1]=we[2]=0),ce&&(T&&j.deltaY>0&&T(j),b&&j.deltaY<0&&b(j),S&&S(j),D&&j.deltaY<0!=H<0&&D(j),H=j.deltaY,_e[0]=_e[1]=_e[2]=0),(V||Z)&&(G&&G(j),Z&&(m(j),Z=!1),V=!1),ie&&!(ie=!1)&&Q&&Q(j),ne&&(O(j),ne=!1),Y=0},Le=function(Te,Ze,Se){we[Se]+=Te,_e[Se]+=Ze,j._vx.update(Te),j._vy.update(Ze),l?Y||(Y=requestAnimationFrame(se)):se()},Ee=function(Te,Ze){k&&!te&&(j.axis=te=Math.abs(Te)>Math.abs(Ze)?"x":"y",ie=!0),te!=="y"&&(we[2]+=Te,j._vx.update(Te,!0)),te!=="x"&&(_e[2]+=Ze,j._vy.update(Ze,!0)),l?Y||(Y=requestAnimationFrame(se)):se()},ke=function(Te){if(!Ae(Te,1)){Te=ih(Te,c);var Ze=Te.clientX,Se=Te.clientY,ce=Ze-j.x,ue=Se-j.y,de=j.isDragging;j.x=Ze,j.y=Se,(de||Math.abs(j.startX-Ze)>=r||Math.abs(j.startY-Se)>=r)&&(m&&(Z=!0),de||(j.isDragging=!0),Ee(ce,ue),de||v&&v(j))}},We=j.onPress=function(Te){Ae(Te,1)||Te&&Te.button||(j.axis=te=null,re.pause(),j.isPressed=!0,Te=ih(Te),W=H=0,j.startX=j.x=Te.clientX,j.startY=j.y=Te.clientY,j._vx.reset(),j._vy.reset(),Xr(X?o:xe,as[1],ke,c,!0),j.deltaX=j.deltaY=0,x&&x(j))},Qe=j.onRelease=function(Te){if(!Ae(Te,1)){Lr(X?o:xe,as[1],ke,!0);var Ze=!isNaN(j.y-j.startY),Se=j.isDragging&&(Math.abs(j.x-j.startX)>3||Math.abs(j.y-j.startY)>3),ce=ih(Te);!Se&&Ze&&(j._vx.reset(),j._vy.reset(),c&&B&&rr.delayedCall(.08,function(){if(bh()-Ie>300&&!Te.defaultPrevented){if(Te.target.click)Te.target.click();else if(xe.createEvent){var ue=xe.createEvent("MouseEvents");ue.initMouseEvent("click",!0,!0,xn,1,ce.screenX,ce.screenY,ce.clientX,ce.clientY,!1,!1,!1,!1,0,null),Te.target.dispatchEvent(ue)}}})),j.isDragging=j.isGesturing=j.isPressed=!1,u&&!X&&re.restart(!0),g&&Se&&g(j),y&&y(j,Se)}},rt=function(Te){return Te.touches&&Te.touches.length>1&&(j.isGesturing=!0)&&N(Te,j.isDragging)},Oe=function(){return(j.isGesturing=!1)||U(j)},Ce=function(Te){if(!Ae(Te)){var Ze=q(),Se=I();Le((Ze-ee)*C,(Se-me)*C,1),ee=Ze,me=Se,u&&re.restart(!0)}},le=function(Te){if(!Ae(Te)){Te=ih(Te,c),O&&(ne=!0);var Ze=(Te.deltaMode===1?a:Te.deltaMode===2?xn.innerHeight:1)*p;Le(Te.deltaX*Ze,Te.deltaY*Ze,0),u&&!X&&re.restart(!0)}},Pe=function(Te){if(!Ae(Te)){var Ze=Te.clientX,Se=Te.clientY,ce=Ze-j.x,ue=Se-j.y;j.x=Ze,j.y=Se,V=!0,(ce||ue)&&Ee(ce,ue)}},Ve=function(Te){j.event=Te,z(j)},et=function(Te){j.event=Te,L(j)},Je=function(Te){return Ae(Te)||ih(Te,c)&&P(j)};re=j._dc=rr.delayedCall(h||.25,it).pause(),j.deltaX=j.deltaY=0,j._vx=Sx(0,50,!0),j._vy=Sx(0,50,!0),j.scrollX=q,j.scrollY=I,j.isDragging=j.isGesturing=j.isPressed=!1,J2(this),j.enable=function(Te){return j.isEnabled||(Xr(ge?xe:o,"scroll",bx),s.indexOf("scroll")>=0&&Xr(ge?xe:o,"scroll",Ce,c,M),s.indexOf("wheel")>=0&&Xr(o,"wheel",le,c,M),(s.indexOf("touch")>=0&&K2||s.indexOf("pointer")>=0)&&(Xr(o,as[0],We,c,M),Xr(xe,as[2],Qe),Xr(xe,as[3],Qe),B&&Xr(o,"click",Be,!1,!0),P&&Xr(o,"click",Je),N&&Xr(xe,"gesturestart",rt),U&&Xr(xe,"gestureend",Oe),z&&Xr(o,$a+"enter",Ve),L&&Xr(o,$a+"leave",et),G&&Xr(o,$a+"move",Pe)),j.isEnabled=!0,Te&&Te.type&&We(Te),F&&F(j)),j},j.disable=function(){j.isEnabled&&(Mc.filter(function(Te){return Te!==j&&Sh(Te.target)}).length||Lr(ge?xe:o,"scroll",bx),j.isPressed&&(j._vx.reset(),j._vy.reset(),Lr(X?o:xe,as[1],ke,!0)),Lr(ge?xe:o,"scroll",Ce,M),Lr(o,"wheel",le,M),Lr(o,as[0],We,M),Lr(xe,as[2],Qe),Lr(xe,as[3],Qe),Lr(o,"click",Be,!0),Lr(o,"click",Je),Lr(xe,"gesturestart",rt),Lr(xe,"gestureend",Oe),Lr(o,$a+"enter",Ve),Lr(o,$a+"leave",et),Lr(o,$a+"move",Pe),j.isEnabled=j.isPressed=j.isDragging=!1,$&&$(j))},j.kill=j.revert=function(){j.disable();var Te=Mc.indexOf(j);Te>=0&&Mc.splice(Te,1),oo===j&&(oo=0)},Mc.push(j),X&&Sh(o)&&(oo=j),j.enable(f)},_B(n,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),n}();Ci.version="3.11.5";Ci.create=function(n){return new Ci(n)};Ci.register=iA;Ci.getAll=function(){return Mc.slice()};Ci.getById=function(n){return Mc.filter(function(e){return e.vars.id===n})[0]};Q2()&&rr.registerPlugin(Ci);var dt,yc,Pt,ii,cs,gi,rA,hm,dm,Ac,mf,Kp,pr,Em,Ex,Ir,GT,VT,xc,nA,wv,sA,fn,oA,aA,lA,Fo,Tx,e_,bv,Zp=1,kr=Date.now,Sv=kr(),qn=0,lh=0,bB=function n(){return lh&&requestAnimationFrame(n)},HT=function(){return Em=1},WT=function(){return Em=0},bs=function(n){return n},ch=function(n){return Math.round(n*1e5)/1e5||0},cA=function(){return typeof window<"u"},uA=function(){return dt||cA()&&(dt=window.gsap)&&dt.registerPlugin&&dt},_l=function(n){return!!~rA.indexOf(n)},hA=function(n){return Ko(n,"getBoundingClientRect")||(_l(n)?function(){return wf.width=Pt.innerWidth,wf.height=Pt.innerHeight,wf}:function(){return io(n)})},SB=function(n,e,t){var i=t.d,r=t.d2,s=t.a;return(s=Ko(n,"getBoundingClientRect"))?function(){return s()[i]}:function(){return(e?Pt["inner"+r]:n["client"+r])||0}},EB=function(n,e){return!e||~Ds.indexOf(n)?hA(n):function(){return wf}},Ho=function(n,e){var t=e.s,i=e.d2,r=e.d,s=e.a;return Math.max(0,(t="scroll"+i)&&(s=Ko(n,t))?s()-hA(n)()[r]:_l(n)?(cs[t]||gi[t])-(Pt["inner"+i]||cs["client"+i]||gi["client"+i]):n[t]-n["offset"+i])},Jp=function(n,e){for(var t=0;t<xc.length;t+=3)(!e||~e.indexOf(xc[t+1]))&&n(xc[t],xc[t+1],xc[t+2])},ls=function(n){return typeof n=="string"},zr=function(n){return typeof n=="function"},uh=function(n){return typeof n=="number"},gf=function(n){return typeof n=="object"},rh=function(n,e,t){return n&&n.progress(e?0:1)&&t&&n.pause()},Ev=function(n,e){if(n.enabled){var t=e(n);t&&t.totalTime&&(n.callbackAnimation=t)}},mc=Math.abs,dA="left",pA="top",t_="right",i_="bottom",hl="width",dl="height",Eh="Right",Th="Left",Mh="Top",Ah="Bottom",xi="padding",Un="margin",tu="Width",r_="Height",er="px",us=function(n){return Pt.getComputedStyle(n)},TB=function(n){var e=us(n).position;n.style.position=e==="absolute"||e==="fixed"?e:"relative"},qT=function(n,e){for(var t in e)t in n||(n[t]=e[t]);return n},io=function(n,e){var t=e&&us(n)[Ex]!=="matrix(1, 0, 0, 1, 0, 0)"&&dt.to(n,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),i=n.getBoundingClientRect();return t&&t.progress(0).kill(),i},Mx=function(n,e){var t=e.d2;return n["offset"+t]||n["client"+t]||0},fA=function(n){var e=[],t=n.labels,i=n.duration(),r;for(r in t)e.push(t[r]/i);return e},MB=function(n){return function(e){return dt.utils.snap(fA(n),e)}},n_=function(n){var e=dt.utils.snap(n),t=Array.isArray(n)&&n.slice(0).sort(function(i,r){return i-r});return t?function(i,r,s){s===void 0&&(s=.001);var o;if(!r)return e(i);if(r>0){for(i-=s,o=0;o<t.length;o++)if(t[o]>=i)return t[o];return t[o-1]}else for(o=t.length,i+=s;o--;)if(t[o]<=i)return t[o];return t[0]}:function(i,r,s){s===void 0&&(s=.001);var o=e(i);return!r||Math.abs(o-i)<s||o-i<0==r<0?o:e(r<0?i-n:i+n)}},AB=function(n){return function(e,t){return n_(fA(n))(e,t.direction)}},Qp=function(n,e,t,i){return t.split(",").forEach(function(r){return n(e,r,i)})},qi=function(n,e,t,i,r){return n.addEventListener(e,t,{passive:!i,capture:!!r})},Wi=function(n,e,t,i){return n.removeEventListener(e,t,!!i)},ef=function(n,e,t){t=t&&t.wheelHandler,t&&(n(e,"wheel",t),n(e,"touchmove",t))},jT={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},tf={toggleActions:"play",anticipatePin:0},pm={top:0,left:0,center:.5,bottom:1,right:1},vf=function(n,e){if(ls(n)){var t=n.indexOf("="),i=~t?+(n.charAt(t-1)+1)*parseFloat(n.substr(t+1)):0;~t&&(n.indexOf("%")>t&&(i*=e/100),n=n.substr(0,t-1)),n=i+(n in pm?pm[n]*e:~n.indexOf("%")?parseFloat(n)*e/100:parseFloat(n)||0)}return n},rf=function(n,e,t,i,r,s,o,a){var l=r.startColor,c=r.endColor,u=r.fontSize,h=r.indent,d=r.fontWeight,p=ii.createElement("div"),f=_l(t)||Ko(t,"pinType")==="fixed",v=n.indexOf("scroller")!==-1,g=f?gi:t,m=n.indexOf("start")!==-1,x=m?l:c,y="border-color:"+x+";font-size:"+u+";color:"+x+";font-weight:"+d+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return y+="position:"+((v||a)&&f?"fixed;":"absolute;"),(v||a||!f)&&(y+=(i===Ii?t_:i_)+":"+(s+parseFloat(h))+"px;"),o&&(y+="box-sizing:border-box;text-align:left;width:"+o.offsetWidth+"px;"),p._isStart=m,p.setAttribute("class","gsap-marker-"+n+(e?" marker-"+e:"")),p.style.cssText=y,p.innerText=e||e===0?n+"-"+e:n,g.children[0]?g.insertBefore(p,g.children[0]):g.appendChild(p),p._offset=p["offset"+i.op.d2],yf(p,0,i,m),p},yf=function(n,e,t,i){var r={display:"block"},s=t[i?"os2":"p2"],o=t[i?"p2":"os2"];n._isFlipped=i,r[t.a+"Percent"]=i?-100:0,r[t.a]=i?"1px":0,r["border"+s+tu]=1,r["border"+o+tu]=0,r[t.p]=e+"px",dt.set(n,r)},At=[],Ax={},id,XT=function(){return kr()-qn>34&&(id||(id=requestAnimationFrame(ao)))},gc=function(){(!fn||!fn.isPressed||fn.startX>gi.clientWidth)&&(Dt.cache++,fn?id||(id=requestAnimationFrame(ao)):ao(),qn||bl("scrollStart"),qn=kr())},Tv=function(){lA=Pt.innerWidth,aA=Pt.innerHeight},hh=function(){Dt.cache++,!pr&&!sA&&!ii.fullscreenElement&&!ii.webkitFullscreenElement&&(!oA||lA!==Pt.innerWidth||Math.abs(Pt.innerHeight-aA)>Pt.innerHeight*.25)&&hm.restart(!0)},wl={},CB=[],mA=function n(){return Wi(mt,"scrollEnd",n)||tl(!0)},bl=function(n){return wl[n]&&wl[n].map(function(e){return e()})||CB},mn=[],gA=function(n){for(var e=0;e<mn.length;e+=5)(!n||mn[e+4]&&mn[e+4].query===n)&&(mn[e].style.cssText=mn[e+1],mn[e].getBBox&&mn[e].setAttribute("transform",mn[e+2]||""),mn[e+3].uncache=1)},s_=function(n,e){var t;for(Ir=0;Ir<At.length;Ir++)t=At[Ir],t&&(!e||t._ctx===e)&&(n?t.kill(1):t.revert(!0,!0));e&&gA(e),e||bl("revert")},vA=function(n,e){Dt.cache++,(e||!vn)&&Dt.forEach(function(t){return zr(t)&&t.cacheID++&&(t.rec=0)}),ls(n)&&(Pt.history.scrollRestoration=e_=n)},vn,pl=0,YT,DB=function(){if(YT!==pl){var n=YT=pl;requestAnimationFrame(function(){return n===pl&&tl(!0)})}},tl=function(n,e){if(qn&&!n){qi(mt,"scrollEnd",mA);return}vn=mt.isRefreshing=!0,Dt.forEach(function(i){return zr(i)&&i.cacheID++&&(i.rec=i())});var t=bl("refreshInit");nA&&mt.sort(),e||s_(),Dt.forEach(function(i){zr(i)&&(i.smooth&&(i.target.style.scrollBehavior="auto"),i(0))}),At.slice(0).forEach(function(i){return i.refresh()}),At.forEach(function(i,r){if(i._subPinOffset&&i.pin){var s=i.vars.horizontal?"offsetWidth":"offsetHeight",o=i.pin[s];i.revert(!0,1),i.adjustPinSpacing(i.pin[s]-o),i.refresh()}}),At.forEach(function(i){return i.vars.end==="max"&&i.setPositions(i.start,Math.max(i.start+1,Ho(i.scroller,i._dir)))}),t.forEach(function(i){return i&&i.render&&i.render(-1)}),Dt.forEach(function(i){zr(i)&&(i.smooth&&requestAnimationFrame(function(){return i.target.style.scrollBehavior="smooth"}),i.rec&&i(i.rec))}),vA(e_,1),hm.pause(),pl++,vn=2,ao(2),At.forEach(function(i){return zr(i.vars.onRefresh)&&i.vars.onRefresh(i)}),vn=mt.isRefreshing=!1,bl("refresh")},Cx=0,xf=1,Ch,ao=function(n){if(!vn||n===2){mt.isUpdating=!0,Ch&&Ch.update(0);var e=At.length,t=kr(),i=t-Sv>=50,r=e&&At[0].scroll();if(xf=Cx>r?-1:1,vn||(Cx=r),i&&(qn&&!Em&&t-qn>200&&(qn=0,bl("scrollEnd")),mf=Sv,Sv=t),xf<0){for(Ir=e;Ir-- >0;)At[Ir]&&At[Ir].update(0,i);xf=1}else for(Ir=0;Ir<e;Ir++)At[Ir]&&At[Ir].update(0,i);mt.isUpdating=!1}id=0},Dx=[dA,pA,i_,t_,Un+Ah,Un+Eh,Un+Mh,Un+Th,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],_f=Dx.concat([hl,dl,"boxSizing","max"+tu,"max"+r_,"position",Un,xi,xi+Mh,xi+Eh,xi+Ah,xi+Th]),PB=function(n,e,t){kc(t);var i=n._gsap;if(i.spacerIsNative)kc(i.spacerState);else if(n._gsap.swappedIn){var r=e.parentNode;r&&(r.insertBefore(n,e),r.removeChild(e))}n._gsap.swappedIn=!1},Mv=function(n,e,t,i){if(!n._gsap.swappedIn){for(var r=Dx.length,s=e.style,o=n.style,a;r--;)a=Dx[r],s[a]=t[a];s.position=t.position==="absolute"?"absolute":"relative",t.display==="inline"&&(s.display="inline-block"),o[i_]=o[t_]="auto",s.flexBasis=t.flexBasis||"auto",s.overflow="visible",s.boxSizing="border-box",s[hl]=Mx(n,Ur)+er,s[dl]=Mx(n,Ii)+er,s[xi]=o[Un]=o[pA]=o[dA]="0",kc(i),o[hl]=o["max"+tu]=t[hl],o[dl]=o["max"+r_]=t[dl],o[xi]=t[xi],n.parentNode!==e&&(n.parentNode.insertBefore(e,n),e.appendChild(n)),n._gsap.swappedIn=!0}},RB=/([A-Z])/g,kc=function(n){if(n){var e=n.t.style,t=n.length,i=0,r,s;for((n.t._gsap||dt.core.getCache(n.t)).uncache=1;i<t;i+=2)s=n[i+1],r=n[i],s?e[r]=s:e[r]&&e.removeProperty(r.replace(RB,"-$1").toLowerCase())}},nf=function(n){for(var e=_f.length,t=n.style,i=[],r=0;r<e;r++)i.push(_f[r],t[_f[r]]);return i.t=n,i},LB=function(n,e,t){for(var i=[],r=n.length,s=t?8:0,o;s<r;s+=2)o=n[s],i.push(o,o in e?e[o]:n[s+1]);return i.t=n.t,i},wf={left:0,top:0},$T=function(n,e,t,i,r,s,o,a,l,c,u,h,d){zr(n)&&(n=n(a)),ls(n)&&n.substr(0,3)==="max"&&(n=h+(n.charAt(4)==="="?vf("0"+n.substr(3),t):0));var p=d?d.time():0,f,v,g;if(d&&d.seek(0),uh(n))d&&(n=dt.utils.mapRange(d.scrollTrigger.start,d.scrollTrigger.end,0,h,n)),o&&yf(o,t,i,!0);else{zr(e)&&(e=e(a));var m=(n||"0").split(" "),x,y,_,w;g=$r(e)||gi,x=io(g)||{},(!x||!x.left&&!x.top)&&us(g).display==="none"&&(w=g.style.display,g.style.display="block",x=io(g),w?g.style.display=w:g.style.removeProperty("display")),y=vf(m[0],x[i.d]),_=vf(m[1]||"0",t),n=x[i.p]-l[i.p]-c+y+r-_,o&&yf(o,_,i,t-_<20||o._isStart&&_>20),t-=t-_}if(s){var b=n+t,T=s._isStart;f="scroll"+i.d2,yf(s,b,i,T&&b>20||!T&&(u?Math.max(gi[f],cs[f]):s.parentNode[f])<=b+1),u&&(l=io(o),u&&(s.style[i.op.p]=l[i.op.p]-i.op.m-s._offset+er))}return d&&g&&(f=io(g),d.seek(h),v=io(g),d._caScrollDist=f[i.p]-v[i.p],n=n/d._caScrollDist*h),d&&d.seek(p),d?n:Math.round(n)},OB=/(webkit|moz|length|cssText|inset)/i,KT=function(n,e,t,i){if(n.parentNode!==e){var r=n.style,s,o;if(e===gi){n._stOrig=r.cssText,o=us(n);for(s in o)!+s&&!OB.test(s)&&o[s]&&typeof r[s]=="string"&&s!=="0"&&(r[s]=o[s]);r.top=t,r.left=i}else r.cssText=n._stOrig;dt.core.getCache(n).uncache=1,e.appendChild(n)}},yA=function(n,e,t){var i=e,r=i;return function(s){var o=Math.round(n());return o!==i&&o!==r&&Math.abs(o-i)>3&&Math.abs(o-r)>3&&(s=o,t&&t()),r=i,i=s,s}},ZT=function(n,e){var t=aa(n,e),i="_scroll"+e.p2,r=function s(o,a,l,c,u){var h=s.tween,d=a.onComplete,p={};l=l||t();var f=yA(t,l,function(){h.kill(),s.tween=0});return u=c&&u||0,c=c||o-l,h&&h.kill(),a[i]=o,a.modifiers=p,p[i]=function(){return f(l+c*h.ratio+u*h.ratio*h.ratio)},a.onUpdate=function(){Dt.cache++,ao()},a.onComplete=function(){s.tween=0,d&&d.call(h)},h=s.tween=dt.to(n,a),h};return n[i]=t,t.wheelHandler=function(){return r.tween&&r.tween.kill()&&(r.tween=0)},qi(n,"wheel",t.wheelHandler),mt.isTouch&&qi(n,"touchmove",t.wheelHandler),r},mt=function(){function n(t,i){yc||n.register(dt)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),this.init(t,i)}var e=n.prototype;return e.init=function(t,i){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!lh){this.update=this.refresh=this.kill=bs;return}t=qT(ls(t)||uh(t)||t.nodeType?{trigger:t}:t,tf);var r=t,s=r.onUpdate,o=r.toggleClass,a=r.id,l=r.onToggle,c=r.onRefresh,u=r.scrub,h=r.trigger,d=r.pin,p=r.pinSpacing,f=r.invalidateOnRefresh,v=r.anticipatePin,g=r.onScrubComplete,m=r.onSnapComplete,x=r.once,y=r.snap,_=r.pinReparent,w=r.pinSpacer,b=r.containerAnimation,T=r.fastScrollEnd,A=r.preventOverlaps,S=t.horizontal||t.containerAnimation&&t.horizontal!==!1?Ur:Ii,E=!u&&u!==0,R=$r(t.scroller||Pt),D=dt.core.getCache(R),z=_l(R),L=("pinType"in t?t.pinType:Ko(R,"pinType")||z&&"fixed")==="fixed",G=[t.onEnter,t.onLeave,t.onEnterBack,t.onLeaveBack],J=E&&t.toggleActions.split(" "),X="markers"in t?t.markers:tf.markers,N=z?0:parseFloat(us(R)["border"+S.p2+tu])||0,U=this,O=t.onRefreshInit&&function(){return t.onRefreshInit(U)},F=SB(R,z,S),$=EB(R,z),P=0,C=0,M=aa(R,S),B,k,Q,Y,re,Z,V,ne,ie,te,j,W,H,q,I,ee,me,pe,ge,xe,we,_e,Ie,Be,Ae,it,se,Le,Ee,ke,We,Qe,rt,Oe,Ce,le,Pe,Ve,et;if(Tx(U),U._dir=S,v*=45,U.scroller=R,U.scroll=b?b.time.bind(b):M,Y=M(),U.vars=t,i=i||t.animation,"refreshPriority"in t&&(nA=1,t.refreshPriority===-9999&&(Ch=U)),D.tweenScroll=D.tweenScroll||{top:ZT(R,Ii),left:ZT(R,Ur)},U.tweenTo=B=D.tweenScroll[S.p],U.scrubDuration=function(Se){Qe=uh(Se)&&Se,Qe?We?We.duration(Se):We=dt.to(i,{ease:"expo",totalProgress:"+=0.001",duration:Qe,paused:!0,onComplete:function(){return g&&g(U)}}):(We&&We.progress(1).kill(),We=0)},i&&(i.vars.lazy=!1,i._initted||i.vars.immediateRender!==!1&&t.immediateRender!==!1&&i.duration()&&i.render(0,!0,!0),U.animation=i.pause(),i.scrollTrigger=U,U.scrubDuration(u),We&&We.resetTo&&We.resetTo("totalProgress",0),Ee=0,a||(a=i.vars.id)),At.push(U),y&&((!gf(y)||y.push)&&(y={snapTo:y}),"scrollBehavior"in gi.style&&dt.set(z?[gi,cs]:R,{scrollBehavior:"auto"}),Dt.forEach(function(Se){return zr(Se)&&Se.target===(z?ii.scrollingElement||cs:R)&&(Se.smooth=!1)}),Q=zr(y.snapTo)?y.snapTo:y.snapTo==="labels"?MB(i):y.snapTo==="labelsDirectional"?AB(i):y.directional!==!1?function(Se,ce){return n_(y.snapTo)(Se,kr()-C<500?0:ce.direction)}:dt.utils.snap(y.snapTo),rt=y.duration||{min:.1,max:2},rt=gf(rt)?Ac(rt.min,rt.max):Ac(rt,rt),Oe=dt.delayedCall(y.delay||Qe/2||.1,function(){var Se=M(),ce=kr()-C<500,ue=B.tween;if((ce||Math.abs(U.getVelocity())<10)&&!ue&&!Em&&P!==Se){var de=(Se-Z)/H,be=i&&!E?i.totalProgress():de,Ue=ce?0:(be-ke)/(kr()-mf)*1e3||0,Re=dt.utils.clamp(-de,1-de,mc(Ue/2)*Ue/.185),Ge=de+(y.inertia===!1?0:Re),ze=Ac(0,1,Q(Ge,U)),ve=Math.round(Z+ze*H),Ne=y,Ye=Ne.onStart,$e=Ne.onInterrupt,He=Ne.onComplete;if(Se<=V&&Se>=Z&&ve!==Se){if(ue&&!ue._initted&&ue.data<=mc(ve-Se))return;y.inertia===!1&&(Re=ze-de),B(ve,{duration:rt(mc(Math.max(mc(Ge-be),mc(ze-be))*.185/Ue/.05||0)),ease:y.ease||"power3",data:mc(ve-Se),onInterrupt:function(){return Oe.restart(!0)&&$e&&$e(U)},onComplete:function(){U.update(),P=M(),Ee=ke=i&&!E?i.totalProgress():U.progress,m&&m(U),He&&He(U)}},Se,Re*H,ve-Se-Re*H),Ye&&Ye(U,B.tween)}}else U.isActive&&P!==Se&&Oe.restart(!0)}).pause()),a&&(Ax[a]=U),h=U.trigger=$r(h||d),et=h&&h._gsap&&h._gsap.stRevert,et&&(et=et(U)),d=d===!0?h:$r(d),ls(o)&&(o={targets:h,className:o}),d&&(p===!1||p===Un||(p=!p&&d.parentNode&&d.parentNode.style&&us(d.parentNode).display==="flex"?!1:xi),U.pin=d,k=dt.core.getCache(d),k.spacer?q=k.pinState:(w&&(w=$r(w),w&&!w.nodeType&&(w=w.current||w.nativeElement),k.spacerIsNative=!!w,w&&(k.spacerState=nf(w))),k.spacer=me=w||ii.createElement("div"),me.classList.add("pin-spacer"),a&&me.classList.add("pin-spacer-"+a),k.pinState=q=nf(d)),t.force3D!==!1&&dt.set(d,{force3D:!0}),U.spacer=me=k.spacer,Le=us(d),Ie=Le[p+S.os2],ge=dt.getProperty(d),xe=dt.quickSetter(d,S.a,er),Mv(d,me,Le),ee=nf(d)),X){W=gf(X)?qT(X,jT):jT,te=rf("scroller-start",a,R,S,W,0),j=rf("scroller-end",a,R,S,W,0,te),pe=te["offset"+S.op.d2];var Je=$r(Ko(R,"content")||R);ne=this.markerStart=rf("start",a,Je,S,W,pe,0,b),ie=this.markerEnd=rf("end",a,Je,S,W,pe,0,b),b&&(Ve=dt.quickSetter([ne,ie],S.a,er)),!L&&!(Ds.length&&Ko(R,"fixedMarkers")===!0)&&(TB(z?gi:R),dt.set([te,j],{force3D:!0}),Ae=dt.quickSetter(te,S.a,er),se=dt.quickSetter(j,S.a,er))}if(b){var Te=b.vars.onUpdate,Ze=b.vars.onUpdateParams;b.eventCallback("onUpdate",function(){U.update(0,0,1),Te&&Te.apply(b,Ze||[])})}U.previous=function(){return At[At.indexOf(U)-1]},U.next=function(){return At[At.indexOf(U)+1]},U.revert=function(Se,ce){if(!ce)return U.kill(!0);var ue=Se!==!1||!U.enabled,de=pr;ue!==U.isReverted&&(ue&&(le=Math.max(M(),U.scroll.rec||0),Ce=U.progress,Pe=i&&i.progress()),ne&&[ne,ie,te,j].forEach(function(be){return be.style.display=ue?"none":"block"}),ue&&(pr=U,U.update(ue)),d&&(!_||!U.isActive)&&(ue?PB(d,me,q):Mv(d,me,us(d),Be)),ue||U.update(ue),pr=de,U.isReverted=ue)},U.refresh=function(Se,ce){if(!((pr||!U.enabled)&&!ce)){if(d&&Se&&qn){qi(n,"scrollEnd",mA);return}!vn&&O&&O(U),pr=U,C=kr(),B.tween&&(B.tween.kill(),B.tween=0),We&&We.pause(),f&&i&&i.revert({kill:!1}).invalidate(),U.isReverted||U.revert(!0,!0),U._subPinOffset=!1;for(var ue=F(),de=$(),be=b?b.duration():Ho(R,S),Ue=H<=.01,Re=0,Ge=0,ze=t.end,ve=t.endTrigger||h,Ne=t.start||(t.start===0||!h?0:d?"0 0":"0 100%"),Ye=U.pinnedContainer=t.pinnedContainer&&$r(t.pinnedContainer),$e=h&&Math.max(0,At.indexOf(U))||0,He=$e,je,K,he,ye,ae,fe,Fe,tt,Ke,De,Xe;He--;)fe=At[He],fe.end||fe.refresh(0,1)||(pr=U),Fe=fe.pin,Fe&&(Fe===h||Fe===d||Fe===Ye)&&!fe.isReverted&&(De||(De=[]),De.unshift(fe),fe.revert(!0,!0)),fe!==At[He]&&($e--,He--);for(zr(Ne)&&(Ne=Ne(U)),Z=$T(Ne,h,ue,S,M(),ne,te,U,de,N,L,be,b)||(d?-.001:0),zr(ze)&&(ze=ze(U)),ls(ze)&&!ze.indexOf("+=")&&(~ze.indexOf(" ")?ze=(ls(Ne)?Ne.split(" ")[0]:"")+ze:(Re=vf(ze.substr(2),ue),ze=ls(Ne)?Ne:(b?dt.utils.mapRange(0,b.duration(),b.scrollTrigger.start,b.scrollTrigger.end,Z):Z)+Re,ve=h)),V=Math.max(Z,$T(ze||(ve?"100% 0":be),ve,ue,S,M()+Re,ie,j,U,de,N,L,be,b))||-.001,H=V-Z||(Z-=.01)&&.001,Re=0,He=$e;He--;)fe=At[He],Fe=fe.pin,Fe&&fe.start-fe._pinPush<=Z&&!b&&fe.end>0&&(je=fe.end-fe.start,(Fe===h&&fe.start-fe._pinPush<Z||Fe===Ye)&&!uh(Ne)&&(Re+=je*(1-fe.progress)),Fe===d&&(Ge+=je));if(Z+=Re,V+=Re,Ue&&(Ce=dt.utils.clamp(0,1,dt.utils.normalize(Z,V,le))),U._pinPush=Ge,ne&&Re&&(je={},je[S.a]="+="+Re,Ye&&(je[S.p]="-="+M()),dt.set([ne,ie],je)),d)je=us(d),ye=S===Ii,he=M(),we=parseFloat(ge(S.a))+Ge,!be&&V>1&&(Xe=(z?ii.scrollingElement||cs:R).style,Xe={style:Xe,value:Xe["overflow"+S.a.toUpperCase()]},Xe.style["overflow"+S.a.toUpperCase()]="scroll"),Mv(d,me,je),ee=nf(d),K=io(d,!0),tt=L&&aa(R,ye?Ur:Ii)(),p&&(Be=[p+S.os2,H+Ge+er],Be.t=me,He=p===xi?Mx(d,S)+H+Ge:0,He&&Be.push(S.d,He+er),kc(Be),Ye&&At.forEach(function(st){st.pin===Ye&&st.vars.pinSpacing!==!1&&(st._subPinOffset=!0)}),L&&M(le)),L&&(ae={top:K.top+(ye?he-Z:tt)+er,left:K.left+(ye?tt:he-Z)+er,boxSizing:"border-box",position:"fixed"},ae[hl]=ae["max"+tu]=Math.ceil(K.width)+er,ae[dl]=ae["max"+r_]=Math.ceil(K.height)+er,ae[Un]=ae[Un+Mh]=ae[Un+Eh]=ae[Un+Ah]=ae[Un+Th]="0",ae[xi]=je[xi],ae[xi+Mh]=je[xi+Mh],ae[xi+Eh]=je[xi+Eh],ae[xi+Ah]=je[xi+Ah],ae[xi+Th]=je[xi+Th],I=LB(q,ae,_),vn&&M(0)),i?(Ke=i._initted,wv(1),i.render(i.duration(),!0,!0),_e=ge(S.a)-we+H+Ge,it=Math.abs(H-_e)>1,L&&it&&I.splice(I.length-2,2),i.render(0,!0,!0),Ke||i.invalidate(!0),i.parent||i.totalTime(i.totalTime()),wv(0)):_e=H,Xe&&(Xe.value?Xe.style["overflow"+S.a.toUpperCase()]=Xe.value:Xe.style.removeProperty("overflow-"+S.a));else if(h&&M()&&!b)for(K=h.parentNode;K&&K!==gi;)K._pinOffset&&(Z-=K._pinOffset,V-=K._pinOffset),K=K.parentNode;De&&De.forEach(function(st){return st.revert(!1,!0)}),U.start=Z,U.end=V,Y=re=vn?le:M(),!b&&!vn&&(Y<le&&M(le),U.scroll.rec=0),U.revert(!1,!0),Oe&&(P=-1,U.isActive&&M(Z+H*Ce),Oe.restart(!0)),pr=0,i&&E&&(i._initted||Pe)&&i.progress()!==Pe&&i.progress(Pe,!0).render(i.time(),!0,!0),(Ue||Ce!==U.progress||b)&&(i&&!E&&i.totalProgress(b&&Z<-.001&&!Ce?dt.utils.normalize(Z,V,0):Ce,!0),U.progress=(Y-Z)/H===Ce?0:Ce),d&&p&&(me._pinOffset=Math.round(U.progress*_e)),We&&We.invalidate(),c&&!vn&&c(U)}},U.getVelocity=function(){return(M()-re)/(kr()-mf)*1e3||0},U.endAnimation=function(){rh(U.callbackAnimation),i&&(We?We.progress(1):i.paused()?E||rh(i,U.direction<0,1):rh(i,i.reversed()))},U.labelToScroll=function(Se){return i&&i.labels&&(Z||U.refresh()||Z)+i.labels[Se]/i.duration()*H||0},U.getTrailing=function(Se){var ce=At.indexOf(U),ue=U.direction>0?At.slice(0,ce).reverse():At.slice(ce+1);return(ls(Se)?ue.filter(function(de){return de.vars.preventOverlaps===Se}):ue).filter(function(de){return U.direction>0?de.end<=Z:de.start>=V})},U.update=function(Se,ce,ue){if(!(b&&!ue&&!Se)){var de=vn===!0?le:U.scroll(),be=Se?0:(de-Z)/H,Ue=be<0?0:be>1?1:be||0,Re=U.progress,Ge,ze,ve,Ne,Ye,$e,He,je;if(ce&&(re=Y,Y=b?M():de,y&&(ke=Ee,Ee=i&&!E?i.totalProgress():Ue)),v&&!Ue&&d&&!pr&&!Zp&&qn&&Z<de+(de-re)/(kr()-mf)*v&&(Ue=1e-4),Ue!==Re&&U.enabled){if(Ge=U.isActive=!!Ue&&Ue<1,ze=!!Re&&Re<1,$e=Ge!==ze,Ye=$e||!!Ue!=!!Re,U.direction=Ue>Re?1:-1,U.progress=Ue,Ye&&!pr&&(ve=Ue&&!Re?0:Ue===1?1:Re===1?2:3,E&&(Ne=!$e&&J[ve+1]!=="none"&&J[ve+1]||J[ve],je=i&&(Ne==="complete"||Ne==="reset"||Ne in i))),A&&($e||je)&&(je||u||!i)&&(zr(A)?A(U):U.getTrailing(A).forEach(function(ae){return ae.endAnimation()})),E||(We&&!pr&&!Zp?(We._dp._time-We._start!==We._time&&We.render(We._dp._time-We._start),We.resetTo?We.resetTo("totalProgress",Ue,i._tTime/i._tDur):(We.vars.totalProgress=Ue,We.invalidate().restart())):i&&i.totalProgress(Ue,!!pr)),d){if(Se&&p&&(me.style[p+S.os2]=Ie),!L)xe(ch(we+_e*Ue));else if(Ye){if(He=!Se&&Ue>Re&&V+1>de&&de+1>=Ho(R,S),_)if(!Se&&(Ge||He)){var K=io(d,!0),he=de-Z;KT(d,gi,K.top+(S===Ii?he:0)+er,K.left+(S===Ii?0:he)+er)}else KT(d,me);kc(Ge||He?I:ee),it&&Ue<1&&Ge||xe(we+(Ue===1&&!He?_e:0))}}y&&!B.tween&&!pr&&!Zp&&Oe.restart(!0),o&&($e||x&&Ue&&(Ue<1||!bv))&&dm(o.targets).forEach(function(ae){return ae.classList[Ge||x?"add":"remove"](o.className)}),s&&!E&&!Se&&s(U),Ye&&!pr?(E&&(je&&(Ne==="complete"?i.pause().totalProgress(1):Ne==="reset"?i.restart(!0).pause():Ne==="restart"?i.restart(!0):i[Ne]()),s&&s(U)),($e||!bv)&&(l&&$e&&Ev(U,l),G[ve]&&Ev(U,G[ve]),x&&(Ue===1?U.kill(!1,1):G[ve]=0),$e||(ve=Ue===1?1:3,G[ve]&&Ev(U,G[ve]))),T&&!Ge&&Math.abs(U.getVelocity())>(uh(T)?T:2500)&&(rh(U.callbackAnimation),We?We.progress(1):rh(i,Ne==="reverse"?1:!Ue,1))):E&&s&&!pr&&s(U)}if(se){var ye=b?de/b.duration()*(b._caScrollDist||0):de;Ae(ye+(te._isFlipped?1:0)),se(ye)}Ve&&Ve(-de/b.duration()*(b._caScrollDist||0))}},U.enable=function(Se,ce){U.enabled||(U.enabled=!0,qi(R,"resize",hh),qi(z?ii:R,"scroll",gc),O&&qi(n,"refreshInit",O),Se!==!1&&(U.progress=Ce=0,Y=re=P=M()),ce!==!1&&U.refresh())},U.getTween=function(Se){return Se&&B?B.tween:We},U.setPositions=function(Se,ce){d&&(we+=Se-Z,_e+=ce-Se-H,p===xi&&U.adjustPinSpacing(ce-Se-H)),U.start=Z=Se,U.end=V=ce,H=ce-Se,U.update()},U.adjustPinSpacing=function(Se){if(Be&&Se){var ce=Be.indexOf(S.d)+1;Be[ce]=parseFloat(Be[ce])+Se+er,Be[1]=parseFloat(Be[1])+Se+er,kc(Be)}},U.disable=function(Se,ce){if(U.enabled&&(Se!==!1&&U.revert(!0,!0),U.enabled=U.isActive=!1,ce||We&&We.pause(),le=0,k&&(k.uncache=1),O&&Wi(n,"refreshInit",O),Oe&&(Oe.pause(),B.tween&&B.tween.kill()&&(B.tween=0)),!z)){for(var ue=At.length;ue--;)if(At[ue].scroller===R&&At[ue]!==U)return;Wi(R,"resize",hh),Wi(R,"scroll",gc)}},U.kill=function(Se,ce){U.disable(Se,ce),We&&!ce&&We.kill(),a&&delete Ax[a];var ue=At.indexOf(U);ue>=0&&At.splice(ue,1),ue===Ir&&xf>0&&Ir--,ue=0,At.forEach(function(de){return de.scroller===U.scroller&&(ue=1)}),ue||vn||(U.scroll.rec=0),i&&(i.scrollTrigger=null,Se&&i.revert({kill:!1}),ce||i.kill()),ne&&[ne,ie,te,j].forEach(function(de){return de.parentNode&&de.parentNode.removeChild(de)}),Ch===U&&(Ch=0),d&&(k&&(k.uncache=1),ue=0,At.forEach(function(de){return de.pin===d&&ue++}),ue||(k.spacer=0)),t.onKill&&t.onKill(U)},U.enable(!1,!1),et&&et(U),!i||!i.add||H?U.refresh():dt.delayedCall(.01,function(){return Z||V||U.refresh()})&&(H=.01)&&(Z=V=0),d&&DB()},n.register=function(t){return yc||(dt=t||uA(),cA()&&window.document&&n.enable(),yc=lh),yc},n.defaults=function(t){if(t)for(var i in t)tf[i]=t[i];return tf},n.disable=function(t,i){lh=0,At.forEach(function(s){return s[i?"kill":"disable"](t)}),Wi(Pt,"wheel",gc),Wi(ii,"scroll",gc),clearInterval(Kp),Wi(ii,"touchcancel",bs),Wi(gi,"touchstart",bs),Qp(Wi,ii,"pointerdown,touchstart,mousedown",HT),Qp(Wi,ii,"pointerup,touchend,mouseup",WT),hm.kill(),Jp(Wi);for(var r=0;r<Dt.length;r+=3)ef(Wi,Dt[r],Dt[r+1]),ef(Wi,Dt[r],Dt[r+2])},n.enable=function(){if(Pt=window,ii=document,cs=ii.documentElement,gi=ii.body,dt&&(dm=dt.utils.toArray,Ac=dt.utils.clamp,Tx=dt.core.context||bs,wv=dt.core.suppressOverwrites||bs,e_=Pt.history.scrollRestoration||"auto",Cx=Pt.pageYOffset,dt.core.globals("ScrollTrigger",n),gi)){lh=1,bB(),Ci.register(dt),n.isTouch=Ci.isTouch,Fo=Ci.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),qi(Pt,"wheel",gc),rA=[Pt,ii,cs,gi],dt.matchMedia?(n.matchMedia=function(a){var l=dt.matchMedia(),c;for(c in a)l.add(c,a[c]);return l},dt.addEventListener("matchMediaInit",function(){return s_()}),dt.addEventListener("matchMediaRevert",function(){return gA()}),dt.addEventListener("matchMedia",function(){tl(0,1),bl("matchMedia")}),dt.matchMedia("(orientation: portrait)",function(){return Tv(),Tv})):console.warn("Requires GSAP 3.11.0 or later"),Tv(),qi(ii,"scroll",gc);var t=gi.style,i=t.borderTopStyle,r=dt.core.Animation.prototype,s,o;for(r.revert||Object.defineProperty(r,"revert",{value:function(){return this.time(-.01,!0)}}),t.borderTopStyle="solid",s=io(gi),Ii.m=Math.round(s.top+Ii.sc())||0,Ur.m=Math.round(s.left+Ur.sc())||0,i?t.borderTopStyle=i:t.removeProperty("border-top-style"),Kp=setInterval(XT,250),dt.delayedCall(.5,function(){return Zp=0}),qi(ii,"touchcancel",bs),qi(gi,"touchstart",bs),Qp(qi,ii,"pointerdown,touchstart,mousedown",HT),Qp(qi,ii,"pointerup,touchend,mouseup",WT),Ex=dt.utils.checkPrefix("transform"),_f.push(Ex),yc=kr(),hm=dt.delayedCall(.2,tl).pause(),xc=[ii,"visibilitychange",function(){var a=Pt.innerWidth,l=Pt.innerHeight;ii.hidden?(GT=a,VT=l):(GT!==a||VT!==l)&&hh()},ii,"DOMContentLoaded",tl,Pt,"load",tl,Pt,"resize",hh],Jp(qi),At.forEach(function(a){return a.enable(0,1)}),o=0;o<Dt.length;o+=3)ef(Wi,Dt[o],Dt[o+1]),ef(Wi,Dt[o],Dt[o+2])}},n.config=function(t){"limitCallbacks"in t&&(bv=!!t.limitCallbacks);var i=t.syncInterval;i&&clearInterval(Kp)||(Kp=i)&&setInterval(XT,i),"ignoreMobileResize"in t&&(oA=n.isTouch===1&&t.ignoreMobileResize),"autoRefreshEvents"in t&&(Jp(Wi)||Jp(qi,t.autoRefreshEvents||"none"),sA=(t.autoRefreshEvents+"").indexOf("resize")===-1)},n.scrollerProxy=function(t,i){var r=$r(t),s=Dt.indexOf(r),o=_l(r);~s&&Dt.splice(s,o?6:2),i&&(o?Ds.unshift(Pt,i,gi,i,cs,i):Ds.unshift(r,i))},n.clearMatchMedia=function(t){At.forEach(function(i){return i._ctx&&i._ctx.query===t&&i._ctx.kill(!0,!0)})},n.isInViewport=function(t,i,r){var s=(ls(t)?$r(t):t).getBoundingClientRect(),o=s[r?hl:dl]*i||0;return r?s.right-o>0&&s.left+o<Pt.innerWidth:s.bottom-o>0&&s.top+o<Pt.innerHeight},n.positionInViewport=function(t,i,r){ls(t)&&(t=$r(t));var s=t.getBoundingClientRect(),o=s[r?hl:dl],a=i==null?o/2:i in pm?pm[i]*o:~i.indexOf("%")?parseFloat(i)*o/100:parseFloat(i)||0;return r?(s.left+a)/Pt.innerWidth:(s.top+a)/Pt.innerHeight},n.killAll=function(t){if(At.slice(0).forEach(function(r){return r.vars.id!=="ScrollSmoother"&&r.kill()}),t!==!0){var i=wl.killAll||[];wl={},i.forEach(function(r){return r()})}},n}();mt.version="3.11.5";mt.saveStyles=function(n){return n?dm(n).forEach(function(e){if(e&&e.style){var t=mn.indexOf(e);t>=0&&mn.splice(t,5),mn.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),dt.core.getCache(e),Tx())}}):mn};mt.revert=function(n,e){return s_(!n,e)};mt.create=function(n,e){return new mt(n,e)};mt.refresh=function(n){return n?hh():(yc||mt.register())&&tl(!0)};mt.update=function(n){return++Dt.cache&&ao(n===!0?2:0)};mt.clearScrollMemory=vA;mt.maxScroll=function(n,e){return Ho(n,e?Ur:Ii)};mt.getScrollFunc=function(n,e){return aa($r(n),e?Ur:Ii)};mt.getById=function(n){return Ax[n]};mt.getAll=function(){return At.filter(function(n){return n.vars.id!=="ScrollSmoother"})};mt.isScrolling=function(){return!!qn};mt.snapDirectional=n_;mt.addEventListener=function(n,e){var t=wl[n]||(wl[n]=[]);~t.indexOf(e)||t.push(e)};mt.removeEventListener=function(n,e){var t=wl[n],i=t&&t.indexOf(e);i>=0&&t.splice(i,1)};mt.batch=function(n,e){var t=[],i={},r=e.interval||.016,s=e.batchMax||1e9,o=function(l,c){var u=[],h=[],d=dt.delayedCall(r,function(){c(u,h),u=[],h=[]}).pause();return function(p){u.length||d.restart(!0),u.push(p.trigger),h.push(p),s<=u.length&&d.progress(1)}},a;for(a in e)i[a]=a.substr(0,2)==="on"&&zr(e[a])&&a!=="onRefreshInit"?o(a,e[a]):e[a];return zr(s)&&(s=s(),qi(mt,"refresh",function(){return s=e.batchMax()})),dm(n).forEach(function(l){var c={};for(a in i)c[a]=i[a];c.trigger=l,t.push(mt.create(c))}),t};var JT=function(n,e,t,i){return e>i?n(i):e<0&&n(0),t>i?(i-e)/(t-e):t<0?e/(e-t):1},Av=function n(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(Ci.isTouch?" pinch-zoom":""):"none",e===cs&&n(gi,t)},sf={auto:1,scroll:1},IB=function(n){var e=n.event,t=n.target,i=n.axis,r=(e.changedTouches?e.changedTouches[0]:e).target,s=r._gsap||dt.core.getCache(r),o=kr(),a;if(!s._isScrollT||o-s._isScrollT>2e3){for(;r&&r!==gi&&(r.scrollHeight<=r.clientHeight&&r.scrollWidth<=r.clientWidth||!(sf[(a=us(r)).overflowY]||sf[a.overflowX]));)r=r.parentNode;s._isScroll=r&&r!==t&&!_l(r)&&(sf[(a=us(r)).overflowY]||sf[a.overflowX]),s._isScrollT=o}(s._isScroll||i==="x")&&(e.stopPropagation(),e._gsapAllow=!0)},xA=function(n,e,t,i){return Ci.create({target:n,capture:!0,debounce:!1,lockAxis:!0,type:e,onWheel:i=i&&IB,onPress:i,onDrag:i,onScroll:i,onEnable:function(){return t&&qi(ii,Ci.eventTypes[0],eM,!1,!0)},onDisable:function(){return Wi(ii,Ci.eventTypes[0],eM,!0)}})},FB=/(input|label|select|textarea)/i,QT,eM=function(n){var e=FB.test(n.target.tagName);(e||QT)&&(n._gsapAllow=!0,QT=e)},kB=function(n){gf(n)||(n={}),n.preventDefault=n.isNormalizer=n.allowClicks=!0,n.type||(n.type="wheel,touch"),n.debounce=!!n.debounce,n.id=n.id||"normalizer";var e=n,t=e.normalizeScrollX,i=e.momentum,r=e.allowNestedScroll,s=e.onRelease,o,a,l=$r(n.target)||cs,c=dt.core.globals().ScrollSmoother,u=c&&c.get(),h=Fo&&(n.content&&$r(n.content)||u&&n.content!==!1&&!u.smooth()&&u.content()),d=aa(l,Ii),p=aa(l,Ur),f=1,v=(Ci.isTouch&&Pt.visualViewport?Pt.visualViewport.scale*Pt.visualViewport.width:Pt.outerWidth)/Pt.innerWidth,g=0,m=zr(i)?function(){return i(o)}:function(){return i||2.8},x,y,_=xA(l,n.type,!0,r),w=function(){return y=!1},b=bs,T=bs,A=function(){a=Ho(l,Ii),T=Ac(Fo?1:0,a),t&&(b=Ac(0,Ho(l,Ur))),x=pl},S=function(){h._gsap.y=ch(parseFloat(h._gsap.y)+d.offset)+"px",h.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(h._gsap.y)+", 0, 1)",d.offset=d.cacheID=0},E=function(){if(y){requestAnimationFrame(w);var J=ch(o.deltaY/2),X=T(d.v-J);if(h&&X!==d.v+d.offset){d.offset=X-d.v;var N=ch((parseFloat(h&&h._gsap.y)||0)-d.offset);h.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+N+", 0, 1)",h._gsap.y=N+"px",d.cacheID=Dt.cache,ao()}return!0}d.offset&&S(),y=!0},R,D,z,L,G=function(){A(),R.isActive()&&R.vars.scrollY>a&&(d()>a?R.progress(1)&&d(a):R.resetTo("scrollY",a))};return h&&dt.set(h,{y:"+=0"}),n.ignoreCheck=function(J){return Fo&&J.type==="touchmove"&&E()||f>1.05&&J.type!=="touchstart"||o.isGesturing||J.touches&&J.touches.length>1},n.onPress=function(){y=!1;var J=f;f=ch((Pt.visualViewport&&Pt.visualViewport.scale||1)/v),R.pause(),J!==f&&Av(l,f>1.01?!0:t?!1:"x"),D=p(),z=d(),A(),x=pl},n.onRelease=n.onGestureStart=function(J,X){if(d.offset&&S(),!X)L.restart(!0);else{Dt.cache++;var N=m(),U,O;t&&(U=p(),O=U+N*.05*-J.velocityX/.227,N*=JT(p,U,O,Ho(l,Ur)),R.vars.scrollX=b(O)),U=d(),O=U+N*.05*-J.velocityY/.227,N*=JT(d,U,O,Ho(l,Ii)),R.vars.scrollY=T(O),R.invalidate().duration(N).play(.01),(Fo&&R.vars.scrollY>=a||U>=a-1)&&dt.to({},{onUpdate:G,duration:N})}s&&s(J)},n.onWheel=function(){R._ts&&R.pause(),kr()-g>1e3&&(x=0,g=kr())},n.onChange=function(J,X,N,U,O){if(pl!==x&&A(),X&&t&&p(b(U[2]===X?D+(J.startX-J.x):p()+X-U[1])),N){d.offset&&S();var F=O[2]===N,$=F?z+J.startY-J.y:d()+N-O[1],P=T($);F&&$!==P&&(z+=P-$),d(P)}(N||X)&&ao()},n.onEnable=function(){Av(l,t?!1:"x"),mt.addEventListener("refresh",G),qi(Pt,"resize",G),d.smooth&&(d.target.style.scrollBehavior="auto",d.smooth=p.smooth=!1),_.enable()},n.onDisable=function(){Av(l,!0),Wi(Pt,"resize",G),mt.removeEventListener("refresh",G),_.kill()},n.lockAxis=n.lockAxis!==!1,o=new Ci(n),o.iOS=Fo,Fo&&!d()&&d(1),Fo&&dt.ticker.add(bs),L=o._dc,R=dt.to(o,{ease:"power4",paused:!0,scrollX:t?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:yA(d,d(),function(){return R.pause()})},onUpdate:ao,onComplete:L.vars.onComplete}),o};mt.sort=function(n){return At.sort(n||function(e,t){return(e.vars.refreshPriority||0)*-1e6+e.start-(t.start+(t.vars.refreshPriority||0)*-1e6)})};mt.observe=function(n){return new Ci(n)};mt.normalizeScroll=function(n){if(typeof n>"u")return fn;if(n===!0&&fn)return fn.enable();if(n===!1)return fn&&fn.kill();var e=n instanceof Ci?n:kB(n);return fn&&fn.target===e.target&&fn.kill(),_l(e.target)&&(fn=e),e};mt.core={_getVelocityProp:Sx,_inputObserver:xA,_scrollers:Dt,_proxies:Ds,bridge:{ss:function(){qn||bl("scrollStart"),qn=kr()},ref:function(){return pr}}};uA()&&dt.registerPlugin(mt);lt.registerPlugin(mt);var Px=class{constructor(e){this.group=e,this.app=new Bt,this.helper=new Yt,this.timeline=app.sharedAnimationTimeline.timeline,this.scrollingTimeline=this.app.sharedAnimationTimeline.scrollingTimeline,this.scrollingTimeline5=this.app.sharedAnimationTimeline.scrollingTimeline5,this.scrollingTimeline2=this.app.sharedAnimationTimeline.scrollingTimeline2,this.followBool=!0,this.movement=new Me,this.targetPositionVector3=new oe,this.currentPositionVector3=new oe,this.arrayOfLinesShapeInstances=[],this.startPulsing=!1,this.removeLines=!1,this.pulse=0,this.animationLoopTimeInSeconds=8,this.mouseVelocityLerp=0,this.animateGroupPulse=new vt,this.animateGroupPulse.name="animateGroupPulse",this.group.add(this.animateGroupPulse),this.animateGroup=new vt,this.animateGroup.name="animateGroup",this.animateGroupPulse.add(this.animateGroup),this.instanceGroup=new vt,this.instanceGroup.name="instanceGroup",this.instanceGroup.position.x=0,this.instanceGroup.position.y=0,this.instanceGroup.position.z=0,this.animateGroup.add(this.instanceGroup),this.start(),this.customShader(),this.updateLineShapes(),this.app.world.logoLoader.on("scrolling-enabled",()=>{this.startPulsing=!0})}start(){this.createMazePattern(),this.addTestCube(),this.markerElementMarker3=document.getElementById("main-logo"),this.markerElementMarker2=document.getElementsByClassName("marker-center1")[0],this.markerElementMainLogo=document.getElementById("main-logo"),this.markerElement=this.markerElementMarker3,this.rect=this.markerElement.getBoundingClientRect()}customShader(){this.customUniforms={uTime:{value:0},uMouse:{value:new Me(.5,.5)},uResolution:{value:new Me(this.app.sizes.width,this.app.sizes.height)},uScrollY:{value:0},uScrolledPercentageTillSticky:{value:0},uPulse:{value:0},uWiden:{value:0},uColorChange:{value:0},uMouseVelocity:{value:0},maskPosition:{value:new oe},maskSize:{value:new oe(.07,.07,.07)}},this.arrayOfLinesShapeInstances.forEach(e=>{e.material.onBeforeCompile=t=>{t.uniforms.uTime=this.customUniforms.uTime,t.uniforms.uMouse=this.customUniforms.uMouse,t.uniforms.uResolution=this.customUniforms.uResolution,t.uniforms.uScrollY=this.customUniforms.uScrollY,t.uniforms.uScreenPosition={value:new Me(e.geometry.attributes.position.array[3],e.geometry.attributes.position.array[1])},t.uniforms.uScrolledPercentageTillSticky=this.customUniforms.uScrolledPercentageTillSticky,t.uniforms.uPulse=this.customUniforms.uPulse,t.uniforms.uWiden=this.customUniforms.uWiden,t.uniforms.uColorChange=this.customUniforms.uColorChange,t.uniforms.uMouseVelocity=this.customUniforms.uMouseVelocity,t.uniforms.maskSize=this.customUniforms.maskSize,t.uniforms.maskPosition=this.customUniforms.maskPosition,t.vertexShader=t.vertexShader.replace("#include <common>",`
              #include <common>
              uniform float uTime;
              uniform vec2 uResolution;
              uniform vec2 uMouse;
              uniform float uScrolledPercentageTillSticky;
              uniform float uPulse;
              uniform float uWiden;
              uniform float uMouseVelocity;

              varying vec2 vUv2;
              varying vec3 vPosition;
              varying float vDistanceToCamera;
              varying float vDistanceToCameraDot;
              varying vec4 vScreenPosition;
              attribute vec3 alteredPosition;
              attribute vec3 mousePosition;

          `),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`
              #include <begin_vertex>

              vUv2 = uv;
              vPosition = position;
              vScreenPosition = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
              vDistanceToCamera = distance(position, cameraPosition);
              vDistanceToCameraDot = dot(position, cameraPosition);

          `),t.vertexShader=t.vertexShader.replace("#include <project_vertex>",`
             vec4 mvPosition = mix(vec4( transformed, 1.0 ), mix(vec4(alteredPosition, 1.0), vec4(mousePosition, 1.0), uMouseVelocity), 1.0 - uWiden);

         //   vec4 mvPosition = vec4( transformed, 1.0 );


            #ifdef USE_BATCHING

              mvPosition = batchingMatrix * mvPosition;

            #endif

            #ifdef USE_INSTANCING

              mvPosition = instanceMatrix * mvPosition;

            #endif

            mvPosition = modelViewMatrix * mvPosition;

            gl_Position = projectionMatrix * mvPosition;

            `),t.fragmentShader=t.fragmentShader.replace("#include <common>",`
              #include <common>
              uniform float uTime;
              uniform vec2 uMouse;
              uniform vec2 uResolution;
              uniform float uScrollY;
              uniform vec2 uScreenPosition;
              uniform float uScrolledPercentageTillSticky;
              uniform float uPulse;
              uniform float uColorChange;
              uniform vec3 maskPosition;
              uniform vec3 maskSize;

  
              varying vec2 vUv2;
              varying float vDistanceToCamera;
              varying float vDistanceToCameraDot;
              varying vec3 vPosition;
              varying vec4 vScreenPosition;


              float lerp(float s, float e, float t) {
                return s * (1.0 - t) + e * t;
              }    
          `),t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>",`
          #ifdef USE_MAP
  
          vec4 texture11 = texture2D( map, vUv2 );
    
          vec4 sampledDiffuseColor = texture11;
        
          #ifdef DECODE_VIDEO_TEXTURE
        
            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)
        
            diffuseColor *= sampledDiffuseColor;

          #endif
        
          diffuseColor *= sampledDiffuseColor;
        
          #endif
          `),t.fragmentShader=t.fragmentShader.replace("#include <dithering_fragment>",`
                #include <dithering_fragment>


                // vec3 maskDiff = abs(vPosition - maskPosition);
                // if (maskDiff.x <= maskSize.x && maskDiff.y <= maskSize.y && maskDiff.z <= maskSize.z) {
                //   discard;
                // }

                // Convert to NDC space
                vec2 ndc = vScreenPosition.xy / vScreenPosition.w;
                
                // Check if we're within the mask area
                if (abs(ndc.x) < maskSize.x && abs(ndc.y) < maskSize.y) {
                  discard;
                }

                // Calculate quick blend transitions
                float mixFactor1 = smoothstep(0.0, 0.05, uColorChange); // Quick transition to texture1
                float mixFactor2 = smoothstep(0.35, 0.40, uColorChange); // Quick transition to texture2
                float mixFactor3 = smoothstep(0.65, 0.70, uColorChange); // Quick transition to texture3
                float mixFactor4 = smoothstep(0.85, 0.90, uColorChange); // Quick transition to texture4

                // Color 1: #FF1571 (pink/red)
                vec3 color1 = vec3(1.0, 0.0824, 0.4431);

                // Color 2: #6A25FB (purple)
                vec3 color2 = vec3(0.4157, 0.1451, 0.9843);

                // Color 3: #FF2A21 (red)
                vec3 color3 = vec3(1.0, 0.1647, 0.1294);

                // Color 4: #02CEFE (light blue)
                vec3 color4 = vec3(0.0078, 0.8078, 0.9961);

                vec3 result = mix(
                  mix(mix(mix(vec3(1.0,1.0,1.0), color1, mixFactor1), 
                  color2, mixFactor2),
                  color3, mixFactor3),
                  color4, mixFactor4
              );

                // float noise = (sin(dot(gl_FragCoord.xy + (uTime * 0.1), vec2(12.9898, 78.233))) * 43758.5453);

                //  outgoingLight.rbg += (noise * 10.005);
  
                // gl_FragColor = vec4( smoothstep(0.1, 0.1, outgoingLight *  0.1), diffuseColor.a );
                // gl_FragColor = vec4( 1.0, 1.0, 1.0, smoothstep(0.7, 1.0, (1.0 - vDistanceToCamera - (uScreenPosition.x * 1.0))) );
                // gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 + (uScreenPosition.y * 5.0) );

                // gl_FragColor = vec4( 1.0, 1.0, 1.0, smoothstep(0.7, 1.0, (1.0 - vDistanceToCamera)) );
                // gl_FragColor = vec4( 1.0, 1.0, 1.0, diffuseColor.a);
                //  gl_FragColor = vec4( 1.0, 1.0 - (uPulse * 160000.0), 1.0- (uPulse * 20000.0), diffuseColor.a - (1.0 - (uScrolledPercentageTillSticky + (-uPulse * 2000.0))) );

                vec4 eeee = vec4(result, diffuseColor.a - (1.0 - (uScrolledPercentageTillSticky + (-uPulse * 2000.0))));

                // float distanceFromCenter = distance(gl_PointCoord, vec2(0.5));

               // eeee.a = 1.0 - distanceFromCenter;

                gl_FragColor = eeee;

                // gl_FragColor = vec4(1.0,1.0,1.0,1.0);

          `)}})}createMazePattern(){this.element=document.getElementById("gl-space-scene"),this.rect=this.element.getBoundingClientRect();for(let e=0;e<25;e++){let t=(e+1)*this.app.sizes.getVisible(.165).x,i=.015,r=.07,s=.022,o=.065,a=e===0?(e+1)*this.app.sizes.getVisible(.165).x*24:(e+1)*this.app.sizes.getVisible(.165).x*2.5,l;this.app.isMobile?(l=e===0?(e+1)*this.app.sizes.getVisible(.165).x*36:(e+1)*this.app.sizes.getVisible(.165).x*5,l=l*2,a=a*2):l=e===0?(e+1)*this.app.sizes.getVisible(.165).x*36:(e+1)*this.app.sizes.getVisible(.165).x*5;let c=.009,u=.07,h=.019,d=.062;this.addLineShape(e,[new oe(-i*t,-o*t,0),new oe(r*t,s*t,0),new oe(i*t,s*t,0),new oe(i*t,o*t,0),new oe(-r*t,-s*t,0),new oe(-i*t,-s*t,0),new oe(-i*t,-o*t,0)],[new oe(-c*a,-d*a,0),new oe(u*a,h*a,0),new oe(c*a,h*a,0),new oe(c*a,d*a,0),new oe(-u*a,-h*a,0),new oe(-c*a,-h*a,0),new oe(-c*a,-d*a,0)],[new oe(-c*l,-d*l,0),new oe(u*l,h*l,0),new oe(c*l,h*l,0),new oe(c*l,d*l,0),new oe(-u*l,-h*l,0),new oe(-c*l,-h*l,0),new oe(-c*l,-d*l,0)])}}createOutlines(e,t=0,i=0){let r="M357.398 182.976 C208.583 244.082 87.9365 410.642 87.9365 554.97 L351.196 446.857 C682.31 310.888 802.994 144.329 802.994 0 L357.435 182.976 H357.398 Z",s="M445.559 695.991 C594.373 634.885 715.02 468.326 715.02 323.997 L451.761 432.111 C120.684 568.079 0 734.601 0 878.967 L445.559 695.991 Z",o=[],a=e,l=1/0,c=1/0,u=-1/0,h=-1/0,d=v=>{l=Math.min(l,v.x),c=Math.min(c,v.y),u=Math.max(u,v.x),h=Math.max(h,v.y)};[r,s].forEach((v,g)=>{let m=[],x=v.match(/[A-Z][^A-Z]*/g),y=null;x.forEach(_=>{let w=_[0],b=_.slice(1).trim().split(/[\s,]+/).map(Number);switch(w){case"M":case"L":y=new oe(b[0]*a,-b[1]*a,0),m.push(y),d(y);break;case"C":let T=y,A=new oe(b[0]*a,-b[1]*a,0),S=new oe(b[2]*a,-b[3]*a,0),E=new oe(b[4]*a,-b[5]*a,0),R=new qf(T,A,S,E).getPoints(10);R.forEach(d),m.push(...R),y=E;break}}),m.length>0&&m.push(m[0].clone()),o.push(m)});let p=(l+u)/2,f=(c+h)/2;return o.map((v,g)=>v.map(m=>new oe(m.x-p+(g===0?t*-1:t),m.y-f+(g===0?i*-1:i),m.z)))}addLineShape(e,t,i,r){let s=this.createOutlines(15e-5*(e+1),0,e*.002),o=this.createOutlines(e===0?.0015:-15e-5*(e+1),0,e*.002),a=this.createOutlines(3e-4*(e+1),0,e*.002),l=new jc({color:new at("#ffffff"),opacity:Math.exp(-e*.3),side:Di,transparent:!0});for(let c=0;c<s.length;c++){let u=new ki().setFromPoints(s[c]),h=new ki().setFromPoints(o[c]),d=new ki().setFromPoints(a[c]),p=h.getAttribute("position");u.setAttribute("alteredPosition",p);let f=d.getAttribute("position");u.setAttribute("mousePosition",f);let v=new xm(u,l);v.renderOrder=700,v.material.depthTest=!1,v.material.depthWrite=!1,this.arrayOfLinesShapeInstances.push(v),this.instanceGroup.add(v)}}addTestCube(){this.instance2=new wt(new gl(1,1,1),new qh({color:new at("#ffffff"),opacity:1,side:Kr,transparent:!0})),this.instance2.renderOrder=701,this.instance2.material.depthTest=!1,this.instance2.material.depthWrite=!1,this.instance2.position.set(0,0,0)}updateLineShapes(){this.timeline.add(lt.to(this.customUniforms.uWiden,{value:1,duration:1,ease:_t}),0),this.timeline.add(lt.from(this.customUniforms.uColorChange,{value:0,duration:0,ease:_t}),1),this.timeline.add(lt.to(this.customUniforms.uColorChange,{value:.95,duration:Fr,ease:_t}),1),this.timeline.add(lt.to(this.customUniforms.uColorChange,{value:0,duration:0,ease:_t}),Fr+1),setTimeout(()=>{this.timeline.add(lt.from(this.app.world.logoLoader.group.children[5].children[0].children[1].material.uniforms.uColorChange,{value:0,duration:0,ease:_t}),1),this.timeline.add(lt.to(this.app.world.logoLoader.group.children[5].children[0].children[1].material.uniforms.uColorChange,{value:.95,duration:Fr,ease:_t}),1),this.timeline.add(lt.to(this.app.world.logoLoader.group.children[5].children[0].children[1].material.uniforms.uColorChange,{value:0,duration:0,ease:_t}),Fr+1),this.timeline.add(lt.from(this.app.world.logoLoader.group.children[5].children[0].children[1].material.uniforms.uColorChange,{value:0,duration:0,ease:_t}),1),this.timeline.add(lt.to(this.app.world.logoLoader.group.children[5].children[0].children[3].material.uniforms.uColorChange,{value:.95,duration:Fr,ease:_t}),1),this.timeline.add(lt.to(this.app.world.logoLoader.group.children[5].children[0].children[3].material.uniforms.uColorChange,{value:0,duration:0,ease:_t}),Fr+1)},1200),this.timeline.add(lt.to(this.customUniforms.uScrolledPercentageTillSticky,{value:1,duration:1,ease:_t}),0),this.app.world.logoLoader.on("scrolling-enabled",()=>{setTimeout(()=>{mt.create({animation:this.scrollingTimeline2,trigger:".webgl",start:this.app.sizes.height*.1,end:this.app.sizes.height,scrub:2,markers:!1,onEnter:()=>{this.startPulsing=!0}}),this.scrollingTimeline2.fromTo(this.customUniforms.uWiden,{value:1},{value:0,duration:1}),this.scrollingTimeline2.to(this.customUniforms.uWiden,{value:0,duration:3}),mt.create({animation:this.scrollingTimeline5,trigger:".webgl",start:this.app.sizes.height*.1,end:this.app.sizes.height,scrub:2,markers:!1,onLeave:()=>{this.startPulsing=!1}}),this.scrollingTimeline5.fromTo(this.customUniforms.uScrolledPercentageTillSticky,{value:1},{value:0,duration:1}),this.scrollingTimeline5.to(this.customUniforms.uScrolledPercentageTillSticky,{value:0,duration:1}),this.scrollingTimeline5.to(this.customUniforms.uScrolledPercentageTillSticky,{value:0,duration:1})},1e3)})}update(){this.startPulsing?(this.pulse=this.helper.tri(this.app.time.elapsed*5e-4)*1e-4,this.animateGroupPulse.position.z+=this.pulse):this.customUniforms.uPulse.value=0,this.customUniforms.uTime.value=this.app.time.elapsed*.001,this.app.mouse?(this.mouseVelocityLerp=this.helper.lerp(this.mouseVelocityLerp,this.app.mouse.screenPosition.length()*.5,.02),this.customUniforms.uMouseVelocity.value=this.mouseVelocityLerp):this.mouseVelocityLerp=this.helper.lerp(this.mouseVelocityLerp,0,.02)}},UB=`uniform vec2 mouse;
uniform vec2 resolution;
uniform vec3 viewPos;
uniform vec3 color;
uniform vec2 hitUV;
uniform float time;
uniform float scrollPercentageForFade;
uniform float velocity;

uniform float uZoom;
uniform float uZoomDelta;
uniform vec2 uPlaneSize;
uniform vec2 uImageSize;

varying vec2 vUv;
varying vec3 vViewPosition;

#define PI 3.14159

vec2 withRatio(vec2 uv, vec2 canvasSize, vec2 textureSize){
    
    vec2 ratio = vec2(
        min((canvasSize.x / canvasSize.y) / (textureSize.x / textureSize.y), 1.0),
        min((canvasSize.y / canvasSize.x) / (textureSize.y / textureSize.x), 1.0)
      );

    return vec2(
        uv.x * ratio.x + (1.0 - ratio.x) * 0.5,
        uv.y * ratio.y + (1.0 - ratio.y) * 0.5
      );
}

float noise3(vec2 co) {
    return fract(sin(dot(co.xy ,vec2((sin(time) * 10.0), 73))) * 43758.5453);
}

vec3 gammaCorrectedColor(vec3 textureColor){
   return pow(textureColor.rgb, vec3(1.0 / 2.2));
}

float getDistanceForColor(vec2 uv, vec2 position)
{
    return distance(position, uv);
}

vec3 times()
{
    float gt = fract(sin(time) * 0.5) * 3.0;
    float a = clamp(gt - 0.0, 0.0, 1.0);
    float b = clamp(gt - 1.0, 0.0, 1.0);
    float c = clamp(gt - 2.0, 0.0, 1.0);
    return vec3(a, b, c);
}

float rayplane(vec3 o, vec3 r, vec3 p, vec3 n)
{
	return dot(p - o, n) / dot(r, n);
}

vec3 smoke(vec3 o, vec3 r, vec3 f, float t)
{
    vec3 tms = times();
    vec3 sm = vec3(0.0);
    const int c = 32;
    float fc = float(c);
    for (int i = 0; i < c; ++i)
    {
        float j = float(i) / fc;
        float bout = 1.0 + tms.x;
        vec3 p = vec3(cos(j*6.28), 0.0, sin(j*6.28)) * bout;
        p.y = -1.0;
        float pt = rayplane(o, r, p, f);
        if (pt < 0.0) continue;
        if (pt > t)  continue;
        vec3 pp = o + r * pt;
        float cd = length(pp - p);
        vec2 uv = (pp - p).xy * 0.1 + vec2(j,j) * 2.0;
        vec3 tex = vec3(1.0);
        tex *= tex;
        tex = vec3(tex.x + tex.y + tex.z) / 3.0;
        vec3 part = tex;
        part /= 1.0 + cd * cd * 10.0 * tms.x;
        part *= clamp(abs(t - pt), 0.0, 1.0);
        part /= 1.0 + pt * pt;
        part *= clamp(pt, 0.0, 1.0);
        sm += part;
    }
    sm *= 1.0 - smoothstep(0.0, 1.0, tms.x);
    return sm;
}

void main() {

    vec2 modUv = vUv;

    
    vec2 centeredUv = modUv * 2.0 - vec2(1.0, 1.0);

    
    float dist2 = length(centeredUv); 

    
    float radius = 0.5;

    
    float innerRadius = radius - 0.8; 
    float outerRadius = radius + 0.5; 

    
    float alpha = smoothstep(outerRadius, innerRadius, dist2);

    
    vec2 currentUV = vUv; 

    currentUV = currentUV;

    
    float dist = distance(currentUV, hitUV);

    
    vec4 originalColor = vec4(gammaCorrectedColor(color), alpha); 

    
    

    
    
    
    
    
    

    

    

    
    

    

    

    

    

    
    
    gl_FragColor = vec4((originalColor.rgb += (noise3(vUv) * 0.2)), alpha * scrollPercentageForFade);
}`,zB=`uniform vec2 mouse;
uniform vec2 hitUv;
uniform vec3 cameraPos; 
uniform float time; 
uniform float pulse;
uniform float mouseVelocity;
uniform vec2 mouseVelocityVec;

varying vec2 vUv;
varying vec3 vViewPosition;

float radius = 0.37;
float amplitude = 0.09;

void main() {
    vec3 pos = position; 
    vUv = uv;

    vec3 camModPos = cameraPos;

    camModPos.z = -20.0;
    

    
    float dddd = distance(hitUv + (mouse * 0.5), uv); 

    

    if (dddd < radius) {
        float effectFactor = (radius - dddd) / radius;
        effectFactor = clamp(effectFactor, 0.0, 1.0); 

        
        vec3 toCamera = normalize(camModPos - pos);

        
        pos += toCamera * effectFactor * amplitude;
    }

    float effectRadius = 0.2;
    float effectStrength = 0.01;
    float displacementFactor = mouseVelocity;

    vec2 direction = mouseVelocityVec == vec2(0.0) ? vec2(0.0) : normalize(mouseVelocityVec);
    direction.y *= -1.0; 

    float distanceFromHit = distance(vUv, hitUv);

    if(distanceFromHit < effectRadius) {
        float influence = (effectRadius - distanceFromHit) * effectStrength;
        pos.xy += direction * displacementFactor * influence * pulse;
    }

    vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
}`,Yr=class{constructor(e,t,i,r,s,o){this.group=e,this.elementToFollow=t,this.color=i,this.xOffset=r,this.yOffset=s,this.sizeMuliplier=o,this.app=new Bt,this.helper=new Yt,this.mouseVector=new Me,this.previousMovement=new Me,this.velocity=new oe,this.pulse=0,this.mouseVelocityLerped=0,this.pulseLerped=0,this.mouseVelocityVecLerped=new Me,this.velocityMagnitudeLerped=0,this.hitUvLerped=new Me,this.scrollPercentageForFade=0,this.start(),this.resize(),this.scrollFade()}start(){this.createPlane(),this.markerElement=this.elementToFollow,this.rect=this.markerElement.getBoundingClientRect(),this.followTarget(),this.instance.position.x=-50,this.instance.position.y=0,this.instance.position.z=20,this.app.mouse.on("mouse-move",()=>{this.instance.material.uniforms.mouseVelocity.value=this.app.mouse.velocity})}colorChange(e){e[0]!=="#"&&(e="#"+e);let t=new at(e);lt.to(this.instance.material.uniforms.color.value,{r:t.r,duration:.6}),lt.to(this.instance.material.uniforms.color.value,{g:t.g,duration:.6}),lt.to(this.instance.material.uniforms.color.value,{b:t.b,duration:.6})}scrollFade(){this.app.scrollManager.on("scroll",()=>{this.scrollPercentageForFade=Math.min(1,window.scrollY/300)})}createPlane(){this.vFov=this.app.camera.instance.fov*Math.PI/180,this.planeHeight=2*Math.tan(this.vFov/2)*.4,this.planeWidth=this.planeHeight*this.app.camera.instance.aspect,this.planeWidth*=this.sizeMuliplier*1.5,this.geometry=new hi(this.planeWidth,this.planeWidth,16,16),this.material=new ri({side:Di,transparent:!0,fragmentShader:UB,vertexShader:zB,uniforms:{time:{value:0},resolution:{value:new Me(this.app.sizes.width,this.app.sizes.height)},mouse:{value:new Me},color:{value:new at(this.color)},hitUv:{value:new Me},mouseVelocity:{value:new Me},cameraPos:{value:new oe},scrollPercentageForFade:{value:this.scrollPercentageForFade},velocity:{value:0},uZoomDelta:{value:.2},uZoom:{value:0},planeSize:{value:new Me(1,1)},uImageSize:{value:new Me(1,1)},pulse:{value:this.pulse},mouseVelocityVec:{value:new Me}},depthWrite:!1,depthTest:!1}),this.instance=new wt(this.geometry,this.material),this.instance.renderOrder=10,this.group.add(this.instance)}resize(){this.app.sizes.on("resize",()=>{this.vFov=this.app.camera.instance.fov*Math.PI/180,this.planeHeight=2*Math.tan(this.vFov/2)*.4,this.planeWidth=this.planeHeight*this.app.camera.instance.aspect,this.planeWidth*=this.sizeMuliplier*1.5,this.instance.geometry.dispose(),this.instance.geometry=new hi(this.planeWidth,this.planeHeight,16,16),this.instance.material.uniforms.resolution.value.x=this.app.sizes.width,this.instance.material.uniforms.resolution.value.y=this.app.sizes.heightp})}followTarget(){this.targetPosition=this.helper.update3DObjectPositionWithOffsetX(this.markerElement,this.instance,this.app.camera.instance,this.xOffset,this.yOffset),this.instance.position.x=this.helper.lerp(this.instance.position.x,this.targetPosition.x,_t),this.instance.position.y=this.helper.lerp(this.instance.position.y,this.targetPosition.y,_t),this.instance.position.z=this.helper.lerp(this.instance.position.z,this.targetPosition.z,_t)}update(){this.followTarget(),this.mouseVector.x=this.helper.lerp(this.mouseVector.x,this.app.mouse.screenPosition.x,.01),this.mouseVector.y=this.helper.lerp(this.mouseVector.y,this.app.mouse.screenPosition.y,.01),this.velocity.x=this.mouseVector.x-this.previousMovement.x,this.velocity.y=this.mouseVector.y-this.previousMovement.y;let e=this.app.isMobile?100:this.velocity.length();if(this.material.uniforms.time.value=this.app.time.elapsed*.01,this.material.uniforms.mouse.value=this.mouseVector,this.material.uniforms.cameraPos.value=this.app.camera.instance.position,this.instance.material.uniforms.scrollPercentageForFade.value=this.scrollPercentageForFade,this.material.uniforms.velocity.value=this.velocityMagnitudeLerped,this.material.uniforms.pulse.value=this.pulseLerped,this.material.uniforms.mouseVelocity.value=this.mouseVelocityLerped,this.material.uniforms.mouseVelocityVec.value=this.mouseVelocityVecLerped,this.velocityMagnitudeLerped=this.helper.lerp(this.velocityMagnitudeLerped,e,.005),this.mouseVelocityLerped=this.helper.lerp(this.mouseVelocityLerped,this.app.mouse.mouseVelocity,.005),this.pulseLerped=this.helper.lerp(this.pulseLerped,this.pulse,.005),this.mouseVelocityVecLerped.lerpVectors(this.mouseVelocityVecLerped,this.app.mouse.velocity,.005),this.app.world.token){let t=this.app.world.token.raycaster.intersectObjects([this.instance]);if(t.length>0){let i=t[0];this.material.uniforms.hitUv.value=i.uv,this.pulse=1}else this.pulse=0}}},BB=Ht,Zo=class n extends Rs{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,t,i,r){let s=this,o=new ra(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){let t=this;function i(P,C){if(P.nodeType!==1)return;let M=_(P),B=!1,k=null;switch(P.nodeName){case"svg":C=f(P,C);break;case"style":s(P);break;case"g":C=f(P,C);break;case"path":C=f(P,C),P.hasAttribute("d")&&(k=r(P));break;case"rect":C=f(P,C),k=l(P);break;case"polygon":C=f(P,C),k=c(P);break;case"polyline":C=f(P,C),k=u(P);break;case"circle":C=f(P,C),k=h(P);break;case"ellipse":C=f(P,C),k=d(P);break;case"line":C=f(P,C),k=p(P);break;case"defs":B=!0;break;case"use":C=f(P,C);let Y=(P.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),re=P.viewportElement.getElementById(Y);re?i(re,C):console.warn("SVGLoader: 'use node' references non-existent node id: "+Y);break}k&&(C.fill!==void 0&&C.fill!=="none"&&k.color.setStyle(C.fill,BB),b(k,F),D.push(k),k.userData={node:P,style:C});let Q=P.childNodes;for(let Y=0;Y<Q.length;Y++){let re=Q[Y];B&&re.nodeName!=="style"&&re.nodeName!=="defs"||i(re,C)}M&&(L.pop(),L.length>0?F.copy(L[L.length-1]):F.identity())}function r(P){let C=new Js,M=new Me,B=new Me,k=new Me,Q=!0,Y=!1,re=P.getAttribute("d");if(re===""||re==="none")return null;let Z=re.match(/[a-df-z][^a-df-z]*/gi);for(let V=0,ne=Z.length;V<ne;V++){let ie=Z[V],te=ie.charAt(0),j=ie.slice(1).trim();Q===!0&&(Y=!0,Q=!1);let W;switch(te){case"M":W=g(j);for(let H=0,q=W.length;H<q;H+=2)M.x=W[H+0],M.y=W[H+1],B.x=M.x,B.y=M.y,H===0?C.moveTo(M.x,M.y):C.lineTo(M.x,M.y),H===0&&k.copy(M);break;case"H":W=g(j);for(let H=0,q=W.length;H<q;H++)M.x=W[H],B.x=M.x,B.y=M.y,C.lineTo(M.x,M.y),H===0&&Y===!0&&k.copy(M);break;case"V":W=g(j);for(let H=0,q=W.length;H<q;H++)M.y=W[H],B.x=M.x,B.y=M.y,C.lineTo(M.x,M.y),H===0&&Y===!0&&k.copy(M);break;case"L":W=g(j);for(let H=0,q=W.length;H<q;H+=2)M.x=W[H+0],M.y=W[H+1],B.x=M.x,B.y=M.y,C.lineTo(M.x,M.y),H===0&&Y===!0&&k.copy(M);break;case"C":W=g(j);for(let H=0,q=W.length;H<q;H+=6)C.bezierCurveTo(W[H+0],W[H+1],W[H+2],W[H+3],W[H+4],W[H+5]),B.x=W[H+2],B.y=W[H+3],M.x=W[H+4],M.y=W[H+5],H===0&&Y===!0&&k.copy(M);break;case"S":W=g(j);for(let H=0,q=W.length;H<q;H+=4)C.bezierCurveTo(v(M.x,B.x),v(M.y,B.y),W[H+0],W[H+1],W[H+2],W[H+3]),B.x=W[H+0],B.y=W[H+1],M.x=W[H+2],M.y=W[H+3],H===0&&Y===!0&&k.copy(M);break;case"Q":W=g(j);for(let H=0,q=W.length;H<q;H+=4)C.quadraticCurveTo(W[H+0],W[H+1],W[H+2],W[H+3]),B.x=W[H+0],B.y=W[H+1],M.x=W[H+2],M.y=W[H+3],H===0&&Y===!0&&k.copy(M);break;case"T":W=g(j);for(let H=0,q=W.length;H<q;H+=2){let I=v(M.x,B.x),ee=v(M.y,B.y);C.quadraticCurveTo(I,ee,W[H+0],W[H+1]),B.x=I,B.y=ee,M.x=W[H+0],M.y=W[H+1],H===0&&Y===!0&&k.copy(M)}break;case"A":W=g(j,[3,4],7);for(let H=0,q=W.length;H<q;H+=7){if(W[H+5]==M.x&&W[H+6]==M.y)continue;let I=M.clone();M.x=W[H+5],M.y=W[H+6],B.x=M.x,B.y=M.y,o(C,W[H],W[H+1],W[H+2],W[H+3],W[H+4],I,M),H===0&&Y===!0&&k.copy(M)}break;case"m":W=g(j);for(let H=0,q=W.length;H<q;H+=2)M.x+=W[H+0],M.y+=W[H+1],B.x=M.x,B.y=M.y,H===0?C.moveTo(M.x,M.y):C.lineTo(M.x,M.y),H===0&&k.copy(M);break;case"h":W=g(j);for(let H=0,q=W.length;H<q;H++)M.x+=W[H],B.x=M.x,B.y=M.y,C.lineTo(M.x,M.y),H===0&&Y===!0&&k.copy(M);break;case"v":W=g(j);for(let H=0,q=W.length;H<q;H++)M.y+=W[H],B.x=M.x,B.y=M.y,C.lineTo(M.x,M.y),H===0&&Y===!0&&k.copy(M);break;case"l":W=g(j);for(let H=0,q=W.length;H<q;H+=2)M.x+=W[H+0],M.y+=W[H+1],B.x=M.x,B.y=M.y,C.lineTo(M.x,M.y),H===0&&Y===!0&&k.copy(M);break;case"c":W=g(j);for(let H=0,q=W.length;H<q;H+=6)C.bezierCurveTo(M.x+W[H+0],M.y+W[H+1],M.x+W[H+2],M.y+W[H+3],M.x+W[H+4],M.y+W[H+5]),B.x=M.x+W[H+2],B.y=M.y+W[H+3],M.x+=W[H+4],M.y+=W[H+5],H===0&&Y===!0&&k.copy(M);break;case"s":W=g(j);for(let H=0,q=W.length;H<q;H+=4)C.bezierCurveTo(v(M.x,B.x),v(M.y,B.y),M.x+W[H+0],M.y+W[H+1],M.x+W[H+2],M.y+W[H+3]),B.x=M.x+W[H+0],B.y=M.y+W[H+1],M.x+=W[H+2],M.y+=W[H+3],H===0&&Y===!0&&k.copy(M);break;case"q":W=g(j);for(let H=0,q=W.length;H<q;H+=4)C.quadraticCurveTo(M.x+W[H+0],M.y+W[H+1],M.x+W[H+2],M.y+W[H+3]),B.x=M.x+W[H+0],B.y=M.y+W[H+1],M.x+=W[H+2],M.y+=W[H+3],H===0&&Y===!0&&k.copy(M);break;case"t":W=g(j);for(let H=0,q=W.length;H<q;H+=2){let I=v(M.x,B.x),ee=v(M.y,B.y);C.quadraticCurveTo(I,ee,M.x+W[H+0],M.y+W[H+1]),B.x=I,B.y=ee,M.x=M.x+W[H+0],M.y=M.y+W[H+1],H===0&&Y===!0&&k.copy(M)}break;case"a":W=g(j,[3,4],7);for(let H=0,q=W.length;H<q;H+=7){if(W[H+5]==0&&W[H+6]==0)continue;let I=M.clone();M.x+=W[H+5],M.y+=W[H+6],B.x=M.x,B.y=M.y,o(C,W[H],W[H+1],W[H+2],W[H+3],W[H+4],I,M),H===0&&Y===!0&&k.copy(M)}break;case"Z":case"z":C.currentPath.autoClose=!0,C.currentPath.curves.length>0&&(M.copy(k),C.currentPath.currentPoint.copy(M),Q=!0);break;default:console.warn(ie)}Y=!1}return C}function s(P){if(!(!P.sheet||!P.sheet.cssRules||!P.sheet.cssRules.length))for(let C=0;C<P.sheet.cssRules.length;C++){let M=P.sheet.cssRules[C];if(M.type!==1)continue;let B=M.selectorText.split(/,/gm).filter(Boolean).map(k=>k.trim());for(let k=0;k<B.length;k++){let Q=Object.fromEntries(Object.entries(M.style).filter(([,Y])=>Y!==""));z[B[k]]=Object.assign(z[B[k]]||{},Q)}}}function o(P,C,M,B,k,Q,Y,re){if(C==0||M==0){P.lineTo(re.x,re.y);return}B=B*Math.PI/180,C=Math.abs(C),M=Math.abs(M);let Z=(Y.x-re.x)/2,V=(Y.y-re.y)/2,ne=Math.cos(B)*Z+Math.sin(B)*V,ie=-Math.sin(B)*Z+Math.cos(B)*V,te=C*C,j=M*M,W=ne*ne,H=ie*ie,q=W/te+H/j;if(q>1){let Be=Math.sqrt(q);C=Be*C,M=Be*M,te=C*C,j=M*M}let I=te*H+j*W,ee=(te*j-I)/I,me=Math.sqrt(Math.max(0,ee));k===Q&&(me=-me);let pe=me*C*ie/M,ge=-me*M*ne/C,xe=Math.cos(B)*pe-Math.sin(B)*ge+(Y.x+re.x)/2,we=Math.sin(B)*pe+Math.cos(B)*ge+(Y.y+re.y)/2,_e=a(1,0,(ne-pe)/C,(ie-ge)/M),Ie=a((ne-pe)/C,(ie-ge)/M,(-ne-pe)/C,(-ie-ge)/M)%(Math.PI*2);P.currentPath.absellipse(xe,we,C,M,_e,_e+Ie,Q===0,B)}function a(P,C,M,B){let k=P*M+C*B,Q=Math.sqrt(P*P+C*C)*Math.sqrt(M*M+B*B),Y=Math.acos(Math.max(-1,Math.min(1,k/Q)));return P*B-C*M<0&&(Y=-Y),Y}function l(P){let C=y(P.getAttribute("x")||0),M=y(P.getAttribute("y")||0),B=y(P.getAttribute("rx")||P.getAttribute("ry")||0),k=y(P.getAttribute("ry")||P.getAttribute("rx")||0),Q=y(P.getAttribute("width")),Y=y(P.getAttribute("height")),re=1-.551915024494,Z=new Js;return Z.moveTo(C+B,M),Z.lineTo(C+Q-B,M),(B!==0||k!==0)&&Z.bezierCurveTo(C+Q-B*re,M,C+Q,M+k*re,C+Q,M+k),Z.lineTo(C+Q,M+Y-k),(B!==0||k!==0)&&Z.bezierCurveTo(C+Q,M+Y-k*re,C+Q-B*re,M+Y,C+Q-B,M+Y),Z.lineTo(C+B,M+Y),(B!==0||k!==0)&&Z.bezierCurveTo(C+B*re,M+Y,C,M+Y-k*re,C,M+Y-k),Z.lineTo(C,M+k),(B!==0||k!==0)&&Z.bezierCurveTo(C,M+k*re,C+B*re,M,C+B,M),Z}function c(P){function C(Q,Y,re){let Z=y(Y),V=y(re);k===0?B.moveTo(Z,V):B.lineTo(Z,V),k++}let M=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,B=new Js,k=0;return P.getAttribute("points").replace(M,C),B.currentPath.autoClose=!0,B}function u(P){function C(Q,Y,re){let Z=y(Y),V=y(re);k===0?B.moveTo(Z,V):B.lineTo(Z,V),k++}let M=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,B=new Js,k=0;return P.getAttribute("points").replace(M,C),B.currentPath.autoClose=!1,B}function h(P){let C=y(P.getAttribute("cx")||0),M=y(P.getAttribute("cy")||0),B=y(P.getAttribute("r")||0),k=new Xo;k.absarc(C,M,B,0,Math.PI*2);let Q=new Js;return Q.subPaths.push(k),Q}function d(P){let C=y(P.getAttribute("cx")||0),M=y(P.getAttribute("cy")||0),B=y(P.getAttribute("rx")||0),k=y(P.getAttribute("ry")||0),Q=new Xo;Q.absellipse(C,M,B,k,0,Math.PI*2);let Y=new Js;return Y.subPaths.push(Q),Y}function p(P){let C=y(P.getAttribute("x1")||0),M=y(P.getAttribute("y1")||0),B=y(P.getAttribute("x2")||0),k=y(P.getAttribute("y2")||0),Q=new Js;return Q.moveTo(C,M),Q.lineTo(B,k),Q.currentPath.autoClose=!1,Q}function f(P,C){C=Object.assign({},C);let M={};if(P.hasAttribute("class")){let Y=P.getAttribute("class").split(/\s/).filter(Boolean).map(re=>re.trim());for(let re=0;re<Y.length;re++)M=Object.assign(M,z["."+Y[re]])}P.hasAttribute("id")&&(M=Object.assign(M,z["#"+P.getAttribute("id")]));function B(Y,re,Z){Z===void 0&&(Z=function(V){return V.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),V}),P.hasAttribute(Y)&&(C[re]=Z(P.getAttribute(Y))),M[Y]&&(C[re]=Z(M[Y])),P.style&&P.style[Y]!==""&&(C[re]=Z(P.style[Y]))}function k(Y){return Math.max(0,Math.min(1,y(Y)))}function Q(Y){return Math.max(0,y(Y))}return B("fill","fill"),B("fill-opacity","fillOpacity",k),B("fill-rule","fillRule"),B("opacity","opacity",k),B("stroke","stroke"),B("stroke-opacity","strokeOpacity",k),B("stroke-width","strokeWidth",Q),B("stroke-linejoin","strokeLineJoin"),B("stroke-linecap","strokeLineCap"),B("stroke-miterlimit","strokeMiterLimit",Q),B("visibility","visibility"),C}function v(P,C){return P-(C-P)}function g(P,C,M){if(typeof P!="string")throw new TypeError("Invalid input: "+typeof P);let B={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},k=0,Q=1,Y=2,re=3,Z=k,V=!0,ne="",ie="",te=[];function j(I,ee,me){let pe=new SyntaxError('Unexpected character "'+I+'" at index '+ee+".");throw pe.partial=me,pe}function W(){ne!==""&&(ie===""?te.push(Number(ne)):te.push(Number(ne)*Math.pow(10,Number(ie)))),ne="",ie=""}let H,q=P.length;for(let I=0;I<q;I++){if(H=P[I],Array.isArray(C)&&C.includes(te.length%M)&&B.FLAGS.test(H)){Z=Q,ne=H,W();continue}if(Z===k){if(B.WHITESPACE.test(H))continue;if(B.DIGIT.test(H)||B.SIGN.test(H)){Z=Q,ne=H;continue}if(B.POINT.test(H)){Z=Y,ne=H;continue}B.COMMA.test(H)&&(V&&j(H,I,te),V=!0)}if(Z===Q){if(B.DIGIT.test(H)){ne+=H;continue}if(B.POINT.test(H)){ne+=H,Z=Y;continue}if(B.EXP.test(H)){Z=re;continue}B.SIGN.test(H)&&ne.length===1&&B.SIGN.test(ne[0])&&j(H,I,te)}if(Z===Y){if(B.DIGIT.test(H)){ne+=H;continue}if(B.EXP.test(H)){Z=re;continue}B.POINT.test(H)&&ne[ne.length-1]==="."&&j(H,I,te)}if(Z===re){if(B.DIGIT.test(H)){ie+=H;continue}if(B.SIGN.test(H)){if(ie===""){ie+=H;continue}ie.length===1&&B.SIGN.test(ie)&&j(H,I,te)}}B.WHITESPACE.test(H)?(W(),Z=k,V=!1):B.COMMA.test(H)?(W(),Z=k,V=!0):B.SIGN.test(H)?(W(),Z=Q,ne=H):B.POINT.test(H)?(W(),Z=Y,ne=H):j(H,I,te)}return W(),te}let m=["mm","cm","in","pt","pc","px"],x={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function y(P){let C="px";if(typeof P=="string"||P instanceof String)for(let B=0,k=m.length;B<k;B++){let Q=m[B];if(P.endsWith(Q)){C=Q,P=P.substring(0,P.length-Q.length);break}}let M;return C==="px"&&t.defaultUnit!=="px"?M=x.in[t.defaultUnit]/t.defaultDPI:(M=x[C][t.defaultUnit],M<0&&(M=x[C].in*t.defaultDPI)),M*parseFloat(P)}function _(P){if(!(P.hasAttribute("transform")||P.nodeName==="use"&&(P.hasAttribute("x")||P.hasAttribute("y"))))return null;let C=w(P);return L.length>0&&C.premultiply(L[L.length-1]),F.copy(C),L.push(C),C}function w(P){let C=new gt,M=G;if(P.nodeName==="use"&&(P.hasAttribute("x")||P.hasAttribute("y"))){let B=y(P.getAttribute("x")),k=y(P.getAttribute("y"));C.translate(B,k)}if(P.hasAttribute("transform")){let B=P.getAttribute("transform").split(")");for(let k=B.length-1;k>=0;k--){let Q=B[k].trim();if(Q==="")continue;let Y=Q.indexOf("("),re=Q.length;if(Y>0&&Y<re){let Z=Q.slice(0,Y),V=g(Q.slice(Y+1));switch(M.identity(),Z){case"translate":if(V.length>=1){let ne=V[0],ie=0;V.length>=2&&(ie=V[1]),M.translate(ne,ie)}break;case"rotate":if(V.length>=1){let ne=0,ie=0,te=0;ne=V[0]*Math.PI/180,V.length>=3&&(ie=V[1],te=V[2]),J.makeTranslation(-ie,-te),X.makeRotation(ne),N.multiplyMatrices(X,J),J.makeTranslation(ie,te),M.multiplyMatrices(J,N)}break;case"scale":if(V.length>=1){let ne=V[0],ie=ne;V.length>=2&&(ie=V[1]),M.scale(ne,ie)}break;case"skewX":V.length===1&&M.set(1,Math.tan(V[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":V.length===1&&M.set(1,0,0,Math.tan(V[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":V.length===6&&M.set(V[0],V[2],V[4],V[1],V[3],V[5],0,0,1);break}}C.premultiply(M)}}return C}function b(P,C){function M(Y){O.set(Y.x,Y.y,1).applyMatrix3(C),Y.set(O.x,O.y)}function B(Y){let re=Y.xRadius,Z=Y.yRadius,V=Math.cos(Y.aRotation),ne=Math.sin(Y.aRotation),ie=new oe(re*V,re*ne,0),te=new oe(-Z*ne,Z*V,0),j=ie.applyMatrix3(C),W=te.applyMatrix3(C),H=G.set(j.x,W.x,0,j.y,W.y,0,0,0,1),q=J.copy(H).invert(),I=X.copy(q).transpose().multiply(q).elements,ee=R(I[0],I[1],I[4]),me=Math.sqrt(ee.rt1),pe=Math.sqrt(ee.rt2);if(Y.xRadius=1/me,Y.yRadius=1/pe,Y.aRotation=Math.atan2(ee.sn,ee.cs),!((Y.aEndAngle-Y.aStartAngle)%(2*Math.PI)<Number.EPSILON)){let ge=J.set(me,0,0,0,pe,0,0,0,1),xe=X.set(ee.cs,ee.sn,0,-ee.sn,ee.cs,0,0,0,1),we=ge.multiply(xe).multiply(H),_e=Ie=>{let{x:Be,y:Ae}=new oe(Math.cos(Ie),Math.sin(Ie),0).applyMatrix3(we);return Math.atan2(Ae,Be)};Y.aStartAngle=_e(Y.aStartAngle),Y.aEndAngle=_e(Y.aEndAngle),T(C)&&(Y.aClockwise=!Y.aClockwise)}}function k(Y){let re=S(C),Z=E(C);Y.xRadius*=re,Y.yRadius*=Z;let V=re>Number.EPSILON?Math.atan2(C.elements[1],C.elements[0]):Math.atan2(-C.elements[3],C.elements[4]);Y.aRotation+=V,T(C)&&(Y.aStartAngle*=-1,Y.aEndAngle*=-1,Y.aClockwise=!Y.aClockwise)}let Q=P.subPaths;for(let Y=0,re=Q.length;Y<re;Y++){let Z=Q[Y].curves;for(let V=0;V<Z.length;V++){let ne=Z[V];ne.isLineCurve?(M(ne.v1),M(ne.v2)):ne.isCubicBezierCurve?(M(ne.v0),M(ne.v1),M(ne.v2),M(ne.v3)):ne.isQuadraticBezierCurve?(M(ne.v0),M(ne.v1),M(ne.v2)):ne.isEllipseCurve&&(U.set(ne.aX,ne.aY),M(U),ne.aX=U.x,ne.aY=U.y,A(C)?B(ne):k(ne))}}}function T(P){let C=P.elements;return C[0]*C[4]-C[1]*C[3]<0}function A(P){let C=P.elements,M=C[0]*C[3]+C[1]*C[4];if(M===0)return!1;let B=S(P),k=E(P);return Math.abs(M/(B*k))>Number.EPSILON}function S(P){let C=P.elements;return Math.sqrt(C[0]*C[0]+C[1]*C[1])}function E(P){let C=P.elements;return Math.sqrt(C[3]*C[3]+C[4]*C[4])}function R(P,C,M){let B,k,Q,Y,re,Z=P+M,V=P-M,ne=Math.sqrt(V*V+4*C*C);return Z>0?(B=.5*(Z+ne),re=1/B,k=P*re*M-C*re*C):Z<0?k=.5*(Z-ne):(B=.5*ne,k=-.5*ne),V>0?Q=V+ne:Q=V-ne,Math.abs(Q)>2*Math.abs(C)?(re=-2*C/Q,Y=1/Math.sqrt(1+re*re),Q=re*Y):Math.abs(C)===0?(Q=1,Y=0):(re=-.5*Q/C,Q=1/Math.sqrt(1+re*re),Y=re*Q),V>0&&(re=Q,Q=-Y,Y=re),{rt1:B,rt2:k,cs:Q,sn:Y}}let D=[],z={},L=[],G=new gt,J=new gt,X=new gt,N=new gt,U=new Me,O=new oe,F=new gt,$=new DOMParser().parseFromString(e,"image/svg+xml");return i($.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:D,xml:$.documentElement}}static createShapes(e){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},i={loc:t.ORIGIN,t:0};function r(f,v,g,m){let x=f.x,y=v.x,_=g.x,w=m.x,b=f.y,T=v.y,A=g.y,S=m.y,E=(w-_)*(b-A)-(S-A)*(x-_),R=(y-x)*(b-A)-(T-b)*(x-_),D=(S-A)*(y-x)-(w-_)*(T-b),z=E/D,L=R/D;if(D===0&&E!==0||z<=0||z>=1||L<0||L>1)return null;if(E===0&&D===0){for(let G=0;G<2;G++)if(s(G===0?g:m,f,v),i.loc==t.ORIGIN){let J=G===0?g:m;return{x:J.x,y:J.y,t:i.t}}else if(i.loc==t.BETWEEN){let J=+(x+i.t*(y-x)).toPrecision(10),X=+(b+i.t*(T-b)).toPrecision(10);return{x:J,y:X,t:i.t}}return null}else{for(let X=0;X<2;X++)if(s(X===0?g:m,f,v),i.loc==t.ORIGIN){let N=X===0?g:m;return{x:N.x,y:N.y,t:i.t}}let G=+(x+z*(y-x)).toPrecision(10),J=+(b+z*(T-b)).toPrecision(10);return{x:G,y:J,t:z}}}function s(f,v,g){let m=g.x-v.x,x=g.y-v.y,y=f.x-v.x,_=f.y-v.y,w=m*_-y*x;if(f.x===v.x&&f.y===v.y){i.loc=t.ORIGIN,i.t=0;return}if(f.x===g.x&&f.y===g.y){i.loc=t.DESTINATION,i.t=1;return}if(w<-Number.EPSILON){i.loc=t.LEFT;return}if(w>Number.EPSILON){i.loc=t.RIGHT;return}if(m*y<0||x*_<0){i.loc=t.BEHIND;return}if(Math.sqrt(m*m+x*x)<Math.sqrt(y*y+_*_)){i.loc=t.BEYOND;return}let b;m!==0?b=y/m:b=_/x,i.loc=t.BETWEEN,i.t=b}function o(f,v){let g=[],m=[];for(let x=1;x<f.length;x++){let y=f[x-1],_=f[x];for(let w=1;w<v.length;w++){let b=v[w-1],T=v[w],A=r(y,_,b,T);A!==null&&g.find(S=>S.t<=A.t+Number.EPSILON&&S.t>=A.t-Number.EPSILON)===void 0&&(g.push(A),m.push(new Me(A.x,A.y)))}}return m}function a(f,v,g){let m=new Me;v.getCenter(m);let x=[];return g.forEach(y=>{y.boundingBox.containsPoint(m)&&o(f,y.points).forEach(_=>{x.push({identifier:y.identifier,isCW:y.isCW,point:_})})}),x.sort((y,_)=>y.point.x-_.point.x),x}function l(f,v,g,m,x){(x==null||x==="")&&(x="nonzero");let y=new Me;f.boundingBox.getCenter(y);let _=[new Me(g,y.y),new Me(m,y.y)],w=a(_,f.boundingBox,v);w.sort((R,D)=>R.point.x-D.point.x);let b=[],T=[];w.forEach(R=>{R.identifier===f.identifier?b.push(R):T.push(R)});let A=b[0].point.x,S=[],E=0;for(;E<T.length&&T[E].point.x<A;)S.length>0&&S[S.length-1]===T[E].identifier?S.pop():S.push(T[E].identifier),E++;if(S.push(f.identifier),x==="evenodd"){let R=S.length%2===0,D=S[S.length-2];return{identifier:f.identifier,isHole:R,for:D}}else if(x==="nonzero"){let R=!0,D=null,z=null;for(let L=0;L<S.length;L++){let G=S[L];R?(z=v[G].isCW,R=!1,D=G):z!==v[G].isCW&&(z=v[G].isCW,R=!0)}return{identifier:f.identifier,isHole:R,for:D}}else console.warn('fill-rule: "'+x+'" is currently not implemented.')}let c=999999999,u=-999999999,h=e.subPaths.map(f=>{let v=f.getPoints(),g=-999999999,m=999999999,x=-999999999,y=999999999;for(let _=0;_<v.length;_++){let w=v[_];w.y>g&&(g=w.y),w.y<m&&(m=w.y),w.x>x&&(x=w.x),w.x<y&&(y=w.x)}return u<=x&&(u=x+1),c>=y&&(c=y-1),{curves:f.curves,points:v,isCW:ol.isClockWise(v),identifier:-1,boundingBox:new Gy(new Me(y,m),new Me(x,g))}});h=h.filter(f=>f.points.length>1);for(let f=0;f<h.length;f++)h[f].identifier=f;let d=h.map(f=>l(f,h,c,u,e.userData?e.userData.style.fillRule:void 0)),p=[];return h.forEach(f=>{if(!d[f.identifier].isHole){let v=new sl;v.curves=f.curves,d.filter(g=>g.isHole&&g.for===f.identifier).forEach(g=>{let m=h[g.identifier],x=new Xo;x.curves=m.curves,v.holes.push(x)}),p.push(v)}}),p}static getStrokeStyle(e,t,i,r,s){return e=e!==void 0?e:1,t=t!==void 0?t:"#000",i=i!==void 0?i:"miter",r=r!==void 0?r:"butt",s=s!==void 0?s:4,{strokeColor:t,strokeWidth:e,strokeLineJoin:i,strokeLineCap:r,strokeMiterLimit:s}}static pointsToStroke(e,t,i,r){let s=[],o=[],a=[];if(n.pointsToStrokeWithBuffers(e,t,i,r,s,o,a)===0)return null;let l=new ki;return l.setAttribute("position",new Xi(s,3)),l.setAttribute("normal",new Xi(o,3)),l.setAttribute("uv",new Xi(a,2)),l}static pointsToStrokeWithBuffers(e,t,i,r,s,o,a,l){let c=new Me,u=new Me,h=new Me,d=new Me,p=new Me,f=new Me,v=new Me,g=new Me,m=new Me,x=new Me,y=new Me,_=new Me,w=new Me,b=new Me,T=new Me,A=new Me,S=new Me;i=i!==void 0?i:12,r=r!==void 0?r:.001,l=l!==void 0?l:0,e=ne(e);let E=e.length;if(E<2)return 0;let R=e[0].equals(e[E-1]),D,z=e[0],L,G=t.strokeWidth/2,J=1/(E-1),X=0,N,U,O,F,$=!1,P=0,C=l*3,M=l*2;B(e[0],e[1],c).multiplyScalar(G),g.copy(e[0]).sub(c),m.copy(e[0]).add(c),x.copy(g),y.copy(m);for(let ie=1;ie<E;ie++){D=e[ie],ie===E-1?R?L=e[1]:L=void 0:L=e[ie+1];let te=c;if(B(z,D,te),h.copy(te).multiplyScalar(G),_.copy(D).sub(h),w.copy(D).add(h),N=X+J,U=!1,L!==void 0){B(D,L,u),h.copy(u).multiplyScalar(G),b.copy(D).sub(h),T.copy(D).add(h),O=!0,h.subVectors(L,z),te.dot(h)<0&&(O=!1),ie===1&&($=O),h.subVectors(L,D),h.normalize();let j=Math.abs(te.dot(h));if(j>Number.EPSILON){let W=G/j;h.multiplyScalar(-W),d.subVectors(D,z),p.copy(d).setLength(W).add(h),A.copy(p).negate();let H=p.length(),q=d.length();d.divideScalar(q),f.subVectors(L,D);let I=f.length();switch(f.divideScalar(I),d.dot(A)<q&&f.dot(A)<I&&(U=!0),S.copy(p).add(D),A.add(D),F=!1,U?O?(T.copy(A),w.copy(A)):(b.copy(A),_.copy(A)):Y(),t.strokeLineJoin){case"bevel":re(O,U,N);break;case"round":Z(O,U),O?Q(D,_,b,N,0):Q(D,T,w,N,1);break;case"miter":case"miter-clip":default:let ee=G*t.strokeMiterLimit/H;if(ee<1)if(t.strokeLineJoin!=="miter-clip"){re(O,U,N);break}else Z(O,U),O?(f.subVectors(S,_).multiplyScalar(ee).add(_),v.subVectors(S,b).multiplyScalar(ee).add(b),k(_,N,0),k(f,N,0),k(D,N,.5),k(D,N,.5),k(f,N,0),k(v,N,0),k(D,N,.5),k(v,N,0),k(b,N,0)):(f.subVectors(S,w).multiplyScalar(ee).add(w),v.subVectors(S,T).multiplyScalar(ee).add(T),k(w,N,1),k(f,N,1),k(D,N,.5),k(D,N,.5),k(f,N,1),k(v,N,1),k(D,N,.5),k(v,N,1),k(T,N,1));else U?(O?(k(m,X,1),k(g,X,0),k(S,N,0),k(m,X,1),k(S,N,0),k(A,N,1)):(k(m,X,1),k(g,X,0),k(S,N,1),k(g,X,0),k(A,N,0),k(S,N,1)),O?b.copy(S):T.copy(S)):O?(k(_,N,0),k(S,N,0),k(D,N,.5),k(D,N,.5),k(S,N,0),k(b,N,0)):(k(w,N,1),k(S,N,1),k(D,N,.5),k(D,N,.5),k(S,N,1),k(T,N,1)),F=!0;break}}else Y()}else Y();!R&&ie===E-1&&V(e[0],x,y,O,!0,X),X=N,z=D,g.copy(b),m.copy(T)}if(!R)V(D,_,w,O,!1,N);else if(U&&s){let ie=S,te=A;$!==O&&(ie=A,te=S),O?(F||$)&&(te.toArray(s,0*3),te.toArray(s,3*3),F&&ie.toArray(s,1*3)):(F||!$)&&(te.toArray(s,1*3),te.toArray(s,3*3),F&&ie.toArray(s,0*3))}return P;function B(ie,te,j){return j.subVectors(te,ie),j.set(-j.y,j.x).normalize()}function k(ie,te,j){s&&(s[C]=ie.x,s[C+1]=ie.y,s[C+2]=0,o&&(o[C]=0,o[C+1]=0,o[C+2]=1),C+=3,a&&(a[M]=te,a[M+1]=j,M+=2)),P+=3}function Q(ie,te,j,W,H){c.copy(te).sub(ie).normalize(),u.copy(j).sub(ie).normalize();let q=Math.PI,I=c.dot(u);Math.abs(I)<1&&(q=Math.abs(Math.acos(I))),q/=i,h.copy(te);for(let ee=0,me=i-1;ee<me;ee++)d.copy(h).rotateAround(ie,q),k(h,W,H),k(d,W,H),k(ie,W,.5),h.copy(d);k(d,W,H),k(j,W,H),k(ie,W,.5)}function Y(){k(m,X,1),k(g,X,0),k(_,N,0),k(m,X,1),k(_,N,1),k(w,N,0)}function re(ie,te,j){te?ie?(k(m,X,1),k(g,X,0),k(_,N,0),k(m,X,1),k(_,N,0),k(A,N,1),k(_,j,0),k(b,j,0),k(A,j,.5)):(k(m,X,1),k(g,X,0),k(w,N,1),k(g,X,0),k(A,N,0),k(w,N,1),k(w,j,1),k(A,j,0),k(T,j,1)):ie?(k(_,j,0),k(b,j,0),k(D,j,.5)):(k(w,j,1),k(T,j,0),k(D,j,.5))}function Z(ie,te){te&&(ie?(k(m,X,1),k(g,X,0),k(_,N,0),k(m,X,1),k(_,N,0),k(A,N,1),k(_,X,0),k(D,N,.5),k(A,N,1),k(D,N,.5),k(b,X,0),k(A,N,1)):(k(m,X,1),k(g,X,0),k(w,N,1),k(g,X,0),k(A,N,0),k(w,N,1),k(w,X,1),k(A,N,0),k(D,N,.5),k(D,N,.5),k(A,N,0),k(T,X,1)))}function V(ie,te,j,W,H,q){switch(t.strokeLineCap){case"round":H?Q(ie,j,te,q,.5):Q(ie,te,j,q,.5);break;case"square":if(H)c.subVectors(te,ie),u.set(c.y,-c.x),h.addVectors(c,u).add(ie),d.subVectors(u,c).add(ie),W?(h.toArray(s,1*3),d.toArray(s,0*3),d.toArray(s,3*3)):(h.toArray(s,1*3),h.toArray(s,3*3),d.toArray(s,0*3));else{c.subVectors(j,ie),u.set(c.y,-c.x),h.addVectors(c,u).add(ie),d.subVectors(u,c).add(ie);let I=s.length;W?(h.toArray(s,I-1*3),d.toArray(s,I-2*3),d.toArray(s,I-4*3)):(d.toArray(s,I-2*3),h.toArray(s,I-1*3),d.toArray(s,I-4*3))}break}}function ne(ie){let te=!1;for(let W=1,H=ie.length-1;W<H;W++)if(ie[W].distanceTo(ie[W+1])<r){te=!0;break}if(!te)return ie;let j=[];j.push(ie[0]);for(let W=1,H=ie.length-1;W<H;W++)ie[W].distanceTo(ie[W+1])>=r&&j.push(ie[W]);return j.push(ie[ie.length-1]),j}}},NB=`varying vec2 vUv;
uniform float transform;
uniform float opacity;
uniform float uTime;

float vertJerkOpt = 1.0;
float vertMovementOpt = 1.0;

float bottomStaticOpt = 1.0;

float scalinesOpt = 1.0;

float rgbOffsetOpt = 1.0;
float horzFuzzOpt = 1.0;

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v)
  {
  const vec4 C = vec4(0.211324865405187,  
                      0.366025403784439,  
                     -0.577350269189626,  
                      0.024390243902439); 

  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

  vec2 i1;
  
  
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  
  
  
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

  i = mod289(i); 
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
		+ i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

float staticV(vec2 uv) {
    float staticHeight = snoise(vec2(9.0,uTime*1.2+3.0))*0.3+5.0;
    float staticAmount = snoise(vec2(1.0,uTime*1.2-6.0))*0.1+0.3;
    float staticStrength = snoise(vec2(-9.75,uTime*0.6-3.0))*2.0+2.0;
	return (1.0-step(snoise(vec2(5.0*pow(uTime,2.0)+pow(uv.x*7.0,1.2),pow((mod(uTime,100.0)+100.0)*uv.y*0.3+3.0,staticHeight))),staticAmount))*staticStrength;
}

void main() {
    
    

    
    
    

    

    
    
    
    

    
    

    

    
        

    
    
    

    
    
    

    

    

    

    

    

    

    

    

    float uvx = smoothstep(0.86, 1.1, vUv.x);
    float uvy = smoothstep(0.95, 1.1, vUv.y);

    vec2 newUv = vec2(uvx, uvy);

    vec4 pink = vec4(1.0, 129. / 255., 128. / 255., 1.0);
    float d = distance(vUv, vec2(0.5));
    d = 1.0 - smoothstep(0.3, 1.0, d);
    vec3 newPink = d * pink.xyz;

    float xxx = sqrt(vUv.y * vUv.y);
    float xxxx = 1.0 - smoothstep(0.8, 1.0, xxx);

    float ttt = sqrt(vUv.x * vUv.x);
    float tttt = smoothstep(0.9, 1.0, ttt);
    float tMix = mix(ttt, tttt, 0.5) * 0.5;
    float tMix2 = mix(xxxx, tMix, 0.5);
    vec3 outColor = newPink * tMix2;
    vec3 finalOut = mix(vec3(1.0,tMix2, tMix2), vec3(1.0),1.0 - transform);
    

	
	float jerkOffset = (1.0-step(snoise(vec2(uTime*1.3,5.0)),0.8))*0.05;
	
	float fuzzOffset = snoise(vec2(uTime*15.0,newUv.y*80.0))*0.003;
	float largeFuzzOffset = snoise(vec2(uTime*1.0,newUv.y*25.0))*0.004;
    
    float vertMovementOn = (1.0-step(snoise(vec2(uTime*0.2,8.0)),0.4))*vertMovementOpt;
    float vertJerk = (1.0-step(snoise(vec2(uTime*1.5,5.0)),0.6))*vertJerkOpt;
    float vertJerk2 = (1.0-step(snoise(vec2(uTime*5.5,5.0)),0.2))*vertJerkOpt;
    float yOffset = abs(sin(uTime)*4.0)*vertMovementOn+vertJerk*vertJerk2*0.3;
    float y = mod(newUv.y+yOffset,1.0);
    
	
	float xOffset = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt;
    
    float staticVal = 0.0;
   
    for (float y = -1.0; y <= 1.0; y += 1.0) {
        float maxDist = 5.0/200.0;
        float dist = y/200.0;
    	staticVal += staticV(vec2(newUv.x,newUv.y+dist))*(maxDist-abs(dist))*1.5;
    }
        
    staticVal *= bottomStaticOpt;
	
	
	
	

    
	
	

    float red   = newUv.y + xOffset - 0.01 * rgbOffsetOpt + staticVal;
    float green = newUv.y + xOffset + staticVal;
    float blue  = newUv.y + xOffset + 0.01 * rgbOffsetOpt + staticVal;

    
    red = clamp(red, 0.0, 1.0);
    green = clamp(green, 0.0, 1.0);
    blue = clamp(blue, 0.0, 1.0);

	
	vec3 color = vec3(red,green,blue);
	float scanline = sin(newUv.y*800.0)*0.04*scalinesOpt;
	color -= scanline;
	
	vec4 noiseOut = vec4(color,1.0);

    gl_FragColor = vec4(mix(finalOut, noiseOut.xyz, 0.0), opacity);

    

    

    

    

}`,GB=`varying vec2 vUv;

    void main()
    {
        vec4 modelPosition = modelMatrix * vec4(position, 1.0);
        vUv = position.xy * 0.0004 + 0.5;
        vec4 viewPosition = viewMatrix * modelPosition;
        vec4 projectionPosition = projectionMatrix * viewPosition;

        gl_Position = projectionPosition;
    }`,VB=`#define PI 3.1415926535897932384626433832795
#define PIXELSIZE 1.0

uniform float transform;
uniform float opacity;
uniform float uTime;
uniform float depthScale;
uniform sampler2D backdrop1;
uniform sampler2D backdrop2;
uniform sampler2D backdrop3;
uniform sampler2D backdrop4;
uniform sampler2D backdrop1Mask;
uniform sampler2D backdrop2Mask;
uniform sampler2D backdrop3Mask;
uniform sampler2D backdrop4Mask;
uniform sampler2D boltMask;
uniform sampler2D boltMaskOutline;
uniform float factor;
uniform vec3 viewPos;
uniform float turnBrown;
uniform float horizontalAngle; 
uniform float verticalAngle;   
uniform vec2 hitUv;
uniform float velocity;

varying vec2 vUv;
varying vec2 vUv2;
varying vec3 vViewPosition;

float vertJerkOpt = 1.0;
float vertMovementOpt = 1.0;

float bottomStaticOpt = 1.0;

float scalinesOpt = 1.0;

float rgbOffsetOpt = 1.0;
float horzFuzzOpt = 1.0;

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v)
  {
  const vec4 C = vec4(0.211324865405187,  
                      0.366025403784439,  
                     -0.577350269189626,  
                      0.024390243902439); 

  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

  vec2 i1;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

  i = mod289(i); 
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
		+ i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

float staticV(vec2 uv) {
    float staticHeight = snoise(vec2(9.0,uTime*1.2+3.0))*0.3+5.0;
    float staticAmount = snoise(vec2(1.0,uTime*1.2-6.0))*0.1+0.3;
    float staticStrength = snoise(vec2(-9.75,uTime*0.6-3.0))*2.0+2.0;
	return (1.0-step(snoise(vec2(5.0*pow(uTime,2.0)+pow(uv.x*7.0,1.2),pow((mod(uTime,100.0)+100.0)*uv.y*0.3+3.0,staticHeight))),staticAmount))*staticStrength;
}

vec3 gammaCorrectedColor(vec3 textureColor){
   return pow(textureColor.rgb, vec3(1.0 / 2.2));
}

        

vec3 rotateViewDirection(vec3 viewDir, float horizAngle, float vertAngle) {
    
    float cosHoriz = cos(horizAngle);
    float sinHoriz = sin(horizAngle);
    vec3 rotated = vec3(
        cosHoriz * viewDir.x + sinHoriz * viewDir.z,
        viewDir.y,
        cosHoriz * viewDir.z - sinHoriz * viewDir.x
    );

    
    float cosVert = cos(vertAngle);
    float sinVert = sin(vertAngle);
    rotated = vec3(
        rotated.x,
        cosVert * rotated.y - sinVert * rotated.z,
        sinVert * rotated.y + cosVert * rotated.z
    );

    return rotated;
}

float fresnel(vec3 viewDirection, vec3 normal, float fresnelBias, float fresnelScale, float fresnelPower) {
    float NdotV = max(dot(normalize(viewDirection), normal), 0.0);
    return fresnelBias + fresnelScale * pow(1.0 - NdotV, fresnelPower);
}

float fresnelEdgeEffect(vec2 uv, float fresnelPower) {
    float dist = length(uv * 2.0 - 1.0); 
    return pow(1.0 - dist, fresnelPower);
}

float sat( float t ) {
	return clamp( t, 0.0, 1.0 );
}
vec2 sat( vec2 t ) {
	return clamp( t, 0.0, 1.0 );
}

float remap( float t, float a, float b ) {
	return sat( (t - a) / (b - a) );
}

float linterp( float t ) {
	return sat( 1.0 - abs( 2.0*t - 1.0 ) );
}

float rand( vec2 n ) {
  return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);
}

float srand( vec2 n ) {
	return rand(n) * 2.0 - 1.0;
}

float mytrunc( float x, float num_levels )
{
	return floor(x*num_levels) / num_levels;
}
vec2 mytrunc( vec2 x, vec2 num_levels )
{
	return floor(x*num_levels) / num_levels;
}

vec3 rgb2yuv( vec3 rgb )
{
	vec3 yuv;
	yuv.x = dot( rgb, vec3(0.299,0.587,0.114) );
	yuv.y = dot( rgb, vec3(-0.14713, -0.28886, 0.436) );
	yuv.z = dot( rgb, vec3(0.615, -0.51499, -0.10001) );
	return yuv;
 }
 vec3 yuv2rgb( vec3 yuv )
 {
	vec3 rgb;
	rgb.r = yuv.x + yuv.z * 1.13983;
	rgb.g = yuv.x + dot( vec2(-0.39465, -0.58060), yuv.yz );
	rgb.b = yuv.x + yuv.y * 2.03211;
	return rgb;
 }

void main() {
    float uvx = smoothstep(0.917, 0.955, vUv.x);
    float uvy = smoothstep(1.2125, 1.184, vUv.y);
    vec2 newUv = vec2(uvx, uvy);
    vec2 uvF = vUv2;
    
    uvF -= 0.5;
    
    float scaleFactor = 1.0; 
    uvF.x /= scaleFactor * 0.9;
    uvF.y /= (scaleFactor * 0.7);
    
    uvF += 0.5;

	
	float jerkOffset = (1.0-step(snoise(vec2(uTime*1.3,5.0)),0.8))*0.05;
	
	float fuzzOffset = snoise(vec2(uTime*15.0,vUv2.y*80.0))*0.003;
	float largeFuzzOffset = snoise(vec2(uTime*1.0,vUv2.y*25.0))*0.004;
    
  float vertMovementOn = (1.0-step(snoise(vec2(uTime*0.2,8.0)),0.4))*vertMovementOpt;
  float vertJerk = (1.0-step(snoise(vec2(uTime*1.5,5.0)),0.6))*vertJerkOpt;
  float vertJerk2 = (1.0-step(snoise(vec2(uTime*5.5,5.0)),0.2))*vertJerkOpt;
  float yOffset = abs(sin(uTime)*4.0)*vertMovementOn+vertJerk*vertJerk2*0.3;
  float y = mod(vUv2.y+yOffset,1.0);
    
	
	float xOffset = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt;
    
    float staticVal = 0.0;
   
    for (float y = -1.0; y <= 1.0; y += 1.0) {
        float maxDist = 5.0/200.0;
        float dist = y/200.0;
    	staticVal += staticV(vec2(vUv2.x,vUv2.y+dist))*(maxDist-abs(dist))*1.5;
    }
        
    staticVal *= bottomStaticOpt;

    float red   = vUv2.y + xOffset - 0.01 * rgbOffsetOpt + staticVal;
    float green = vUv2.y + xOffset + staticVal;
    float blue  = vUv2.y + xOffset + 0.01 * rgbOffsetOpt + staticVal;

    
    red = clamp(red, 0.0, 1.0);
    green = clamp(green, 0.0, 1.0);
    blue = clamp(blue, 0.0, 1.0);

	
	vec3 color = vec3(red,green,blue);
	float scanline = sin(vUv2.y*800.0)*0.04*scalinesOpt;
	color -= scanline;
	
	vec4 noiseOut = vec4(color,1.0);

  
  float mixFactor1 = smoothstep(0.0, 0.05, factor); 
  float mixFactor2 = smoothstep(0.35, 0.40, factor); 
  float mixFactor3 = smoothstep(0.65, 0.70, factor); 
  float mixFactor4 = smoothstep(0.85, 0.90, factor); 

  
  

  
  

  
  

  
  

  
  
  
  
  
  

  

  
  

  
  vec2 newCoords = vUv2;

  
  vec4 o = vec4(1.0,1.0,1.0, opacity);

  vec4 texture1 = texture2D(backdrop1, newCoords);
  texture1.xyz = gammaCorrectedColor(texture1.xyz);

  vec4 texture2 = texture2D(backdrop2, newCoords);
  texture2.xyz = gammaCorrectedColor(texture2.xyz);

  vec4 texture3 = texture2D(backdrop3, newCoords);
  texture3.xyz = gammaCorrectedColor(texture3.xyz);

  vec4 texture4 = texture2D(backdrop4, newCoords);
  texture4.xyz = gammaCorrectedColor(texture4.xyz);

    
    vec4 result = mix(
        mix(mix(mix(o, texture1, mixFactor1), 
                texture2, mixFactor2),
            texture3, mixFactor3),
        texture4, mixFactor4
    );

  

    
    vec4 texColorAlpha = texture2D(boltMask, uvF);

    vec4 texColorAlpha2 = texture2D(boltMaskOutline, uvF);

    vec3 rrrrr = mix(
        mix(mix(mix(vec3(1.0,1.0,1.0), vec3(1.0, 1.0, 1.0), mixFactor1), 
        vec3(0.0, 1.0, 0.0), mixFactor2),
        vec3(1.0, 0.0, 1.0), mixFactor3),
        vec3(0.0, 0.0, 1.0), mixFactor4
    );

    float theDDoubleD = distance(uvF, hitUv);

    if (texColorAlpha2.a > 0.4) {
      result.xyz = rrrrr; 
    }

      if (texColorAlpha.a < 0.5) {
        noiseOut.x = 0.0; 
                noiseOut.y = 0.0; 
        noiseOut.z = 0.0; 
                noiseOut.a = 0.0; 

      texColorAlpha.x = 0.0; 
    }

	vec2 cor;
	
	cor.x =  gl_FragCoord.x/PIXELSIZE;
	cor.y = (gl_FragCoord.y+PIXELSIZE*1.5*mod(floor(cor.x),2.0))/(PIXELSIZE*3.0);
	
	vec2 ico = floor( cor );
	vec2 fco = fract( cor );
	
	vec3 pix = step( 1.5, mod( vec3(0.0,1.0,2.0) + ico.x, 3.0 ) );
	vec3 ima = result.xyz;
    
	
	
	vec3 col = pix*dot( pix, ima );

    col *= step( abs(fco.x-0.5), 0.4 );
    col *= step( abs(fco.y-0.5), 0.4 );

    vec4 imgPixel = vec4(col, 1.0);

    imgPixel.xyz = mix(gammaCorrectedColor(imgPixel.xyz), imgPixel.xyz, 0.5);

    vec4 imgColMix = mix(result, imgPixel, 0.0);
	
    col *= 1.0;

    
    float fresnelEffect = fresnelEdgeEffect(uvF, 3.0); 
    fresnelEffect = smoothstep(0.0, 0.03, fresnelEffect);
    vec3 fresnelColor = mix(result.xyz, vec3(1.0), fresnelEffect); 
    vec4 brown = vec4(0.10, 0.05, 0.05, (texColorAlpha.a) * opacity);

 
  
  
  
	

	
	
	
	

	
  
	
	
	
	

	

	
	
	
	
	

	
	

	
	

	
	
	
	
	

    

    

    

    

    vec4 gggg = mix(vec4(result.xyz * fresnelColor, (texColorAlpha.a) * opacity), brown, turnBrown);

    

    

    gl_FragColor = gggg;

    

    
    

    

    

    

    

    
    
    
    
}`,HB=`varying vec2 vUv;
varying vec2 vUv2;
varying vec3 vViewPosition;
uniform vec3 viewPos;
uniform vec2 hitUv;
uniform float pulse;
uniform float mouseVelocity;
uniform vec2 mouseVelocityVec;
uniform float uTime;
uniform float quantizationScale;
uniform float waveSpeed; 
uniform float waveAmplitude; 

float calculateEffectStrength(vec2 uv, float dist, float threshold) {
    float normalizedDistance = dist / threshold;
    float effectStrength = 1.0 - smoothstep(0.0, 1.0, normalizedDistance);
    effectStrength = pow(effectStrength, 2.0);
    return effectStrength;
}

float random(vec2 uv) {
    return fract(sin(dot(uv, vec2(12.9898, 78.233))) * 43758.5453123);
}

void main() {
    vUv2 = uv;
    vUv = position.xy * 0.0004 + 0.5;
    vec3 pos = position;
    float size = 0.05;
    float displacementFactor = mouseVelocity;
    vec2 direction = mouseVelocityVec == vec2(0.0) ? vec2(0.0) : normalize(mouseVelocityVec);
    direction.y *= -1.0;

    
    vec2 diff = abs(vUv2 - hitUv);

    
    if (diff.x < size && diff.y < size) {
        
        float influence = calculateEffectStrength(vUv2, min(diff.x, diff.y), size);

        
        float animationFactor = sin(uTime * 2.0 + random(vUv2) * 6.28);

        
        vec2 noiseDirection = vec2(random(vUv2 + uTime * 0.1), random(vUv2 - uTime * 0.1));
        direction = mix(direction, noiseDirection, 0.5);

        
        float distanceFromHitUv = length(vUv2 - hitUv);
        float waveOffset = sin(distanceFromHitUv * waveSpeed + uTime * waveSpeed) * waveAmplitude * influence;

        
        pos.xy += (direction * displacementFactor * influence * pulse * 5.0 * animationFactor) * 0.0004;
        pos.z += waveOffset;
    }

    vec4 modelPosition = modelMatrix * vec4(pos, 1.0);
    vec4 viewPosition = viewMatrix * modelPosition;
    vViewPosition = -viewPosition.xyz;
    vec4 projectionPosition = projectionMatrix * viewPosition;
    gl_Position = projectionPosition;
}`;lt.registerPlugin(mt);var Rx=class extends Sn{constructor(e){super(),this.group=e,this.app=new Bt,this.helper=new Yt,this.loader=new Zo,this.timeline=this.app.sharedAnimationTimeline.timeline,this.scrollingTimeline=this.app.sharedAnimationTimeline.scrollingTimeline,this.scrollingTimeline3=this.app.sharedAnimationTimeline.scrollingTimeline3,xT(.09),this.svg=this.app.resources.svg,this.svgGroupArray=[],this.counterForNames,this.hitUvBuffer=[],this.mouseVectorBuffer=[],this.bufferSize=20,this.localFactor={value:0},this.mouseVelocityLerped=0,this.pulseLerped=0,this.mouseVelocityVecLerped=new Me;for(let r=0;r<this.bufferSize;r++)this.hitUvBuffer.push(new Me);for(let r=0;r<this.bufferSize;r++)this.mouseVectorBuffer.push(new zt);this.element=document.getElementById("gl-space-scene"),this.rect=this.element.getBoundingClientRect();let t=this.rect.width/this.app.sizes.width,i=.165;this.app.isMobile===!1?this.scale=this.app.sizes.getVisible(i).x/.0266*t:this.scale=this.app.sizes.getVisible(i).x/.0166*t,this.movement=new oe,this.targetPositionVector3=new oe,this.currentPositionVector3=new oe,this.pulse=0,this.animationLoopTimeInSeconds=8,this.followBool=!0,this.horizontalAngle=0,this.verticalAngle=0,this.svgGroup=new vt,this.svgGroup.name="svgGroup",e.name="allSvgs",this.start(),this.liftAnimation(),setTimeout(()=>{xT(.9),this.timeline.play(),this.animationGsap(),setTimeout(()=>{this.app.enableScrolling(),this.trigger("scrolling-enabled")},1e3)},500)}liftAnimation(){this.app.world.lift.on("open-lift",e=>{this.markerElement=this.markerElementMarker3,this.app.world.scroller.changeTarget(document.getElementById("gl-space-scene")),setTimeout(()=>{this.app.loader.setLogoOpacity(0)},500)}),this.app.world.lift.on("close-lift",e=>{this.markerElement=this.markerElementMainLogo,this.app.world.scroller.changeTarget(document.getElementById("main-logo")),this.app.loader.setLogoOpacity(1)})}start(){this.loader.load(this.svg,e=>{let t=e.paths;for(let i=0;i<t.length;i++){let r=t[i],s=Zo.createShapes(r);for(let o=0;o<s.length;o++){let a=s[o],l=new Wh(a,{depth:10}),c=new ri({fragmentShader:NB,vertexShader:GB,side:Di,transparent:!0,uniforms:{transform:{value:0},opacity:{value:0},uTime:{value:0}}}),u=new ri({fragmentShader:VB,vertexShader:HB,side:Di,transparent:!0,uniforms:{transform:{value:0},opacity:{value:0},uTime:{value:0},depthScale:{value:.1},viewPos:{value:new oe(0,0,-5)},backdrop1:{value:this.app.resources.items.backdrop1},backdrop2:{value:this.app.resources.items.backdrop2},backdrop3:{value:this.app.resources.items.backdrop3},backdrop4:{value:this.app.resources.items.backdrop4},backdrop1Mask:{value:this.app.resources.items.backdrop1Mask},backdrop2Mask:{value:this.app.resources.items.backdrop2Mask},backdrop3Mask:{value:this.app.resources.items.backdrop3Mask},backdrop4Mask:{value:this.app.resources.items.backdrop4Mask},boltMask:{value:null},boltMaskOutline:{value:null},factor:{value:0},turnBrown:{value:0},horizontalAngle:{value:this.horizontalAngle},verticalAngle:{value:this.verticalAngle},hitUv:{value:new Me(0,0)},pulse:{value:this.pulse},mouseVelocity:{value:0},mouseVelocityVec:{value:new Me},hitUvPositions:{value:[]},mouseVectorPositions:{value:[]}}});if(this.instance=new wt(l,c),this.instance.scale.x=.003,this.instance.scale.y=.003,this.instance.scale.z=.003,this.instance.name=`id${i}${o}`,this.instance.name==="id80"){let h=new vt;h.name="initialLogo",this.instance.rotation.x=Math.PI*1,this.svgGroupArray[0]=h,this.instance.position.x-=3.27,this.instance.position.y+=2.908,this.instance.position.z=0,this.instance.material.uniforms.opacity.value=1,this.instance.renderOrder=997,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,h.scale.x*=this.scale,h.scale.y*=this.scale,h.scale.z*=this.scale,h.add(this.instance)}if(this.instance.name==="id90"){let h=new vt;h.name="fullLogo",this.instance.rotation.x=Math.PI*1,this.svgGroupArray.push(h),this.instance.position.x-=3.27,this.instance.position.y+=3.684,this.instance.position.z=0,this.instance.renderOrder=997,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,h.scale.x*=this.scale,h.scale.y*=this.scale,h.scale.z*=this.scale,h.add(this.instance)}if(this.instance.name==="id100"){let h=new vt;h.name="boltCutout",this.instance.rotation.x=Math.PI*1,this.svgGroupArray.push(h),this.instance.position.x-=3.27,this.instance.position.y+=4.46,this.instance.position.z=0,this.instance.renderOrder=997,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,h.scale.x*=this.scale,h.scale.y*=this.scale,h.scale.z*=this.scale,h.add(this.instance)}if(this.instance.name==="id110"){let h=new hi(.33,.33,16,16),d=new wt(h,u);d.name="id110";let p=new vt;p.name="bolt",this.svgGroupArray.push(p),p.scale.x*=this.scale*1,p.scale.y*=this.scale*1,p.scale.z*=this.scale*1,p.position.x+=.01,p.position.z=0,d.renderOrder=998,d.material.depthTest=!1,d.material.depthWrite=!1,p.add(d)}}}this.group.add(this.svgGroup),this.trigger("svg-loaded")}),this.svgGroup.scale.x*=.01,this.svgGroup.scale.y*=.01,this.svgGroup.scale.z*=.01}animationGsap(){let e=this.app.isMobile?this.app.sizes.getVisible(.165).x/2:this.app.sizes.getVisible(.165).x/4,t={x:this.app.loader.scaleLogoGroup.scale.x,y:this.app.loader.scaleLogoGroup.scale.y,z:this.app.loader.scaleLogoGroup.scale.z};this.timeline.add(lt.to(this.app.loader.scaleLogoGroup.scale,{x:t.x+e,y:t.y+e,z:t.z+e,delay:.5,duration:.5,ease:_t}),0),this.timeline.add(lt.from(this.localFactor,{value:0,duration:0,ease:_t}),1),this.timeline.add(lt.to(this.localFactor,{value:.95,duration:Fr,ease:_t}),1),this.timeline.add(lt.to(this.localFactor,{value:0,duration:0,ease:_t}),Fr+1),mt.create({animation:this.scrollingTimeline,trigger:".webgl",start:this.app.sizes.height*.1,end:this.app.sizes.height,scrub:2,markers:!1,onEnter:()=>{this.timeline.pause(),this.followBool=!1,this.localFactor.value=0,this.group.children[5].children[0].children.forEach(i=>{(i.name==="id00"||i.name==="id10")&&(i.material.uniforms.whiteOut.value=0)})},onLeaveBack:()=>{this.timeline.resume(),this.followBool=!0,this.app.sharedAnimationTimeline.reset(),this.group.children[5].children[0].children.forEach(i=>{(i.name==="id00"||i.name==="id10")&&(i.material.uniforms.whiteOut.value=1)})}}),setTimeout(()=>{mt.create({animation:this.scrollingTimeline3,trigger:".webgl",start:this.app.sizes.height*.1,end:this.app.sizes.height,scrub:2,markers:!1}),this.scrollingTimeline3.fromTo(this.app.loader.scaleLogoGroup.scale,{x:t.x+e,y:t.y+e,z:t.z+e,ease:"none",duration:1},{x:t.x,y:t.y,z:t.z,duration:1,ease:"none"}),this.scrollingTimeline3.to(this.app.loader.scaleLogoGroup.scale,{x:t.x,y:t.y,z:t.z,duration:3,ease:"none"}),this.app.loader.setLogoToWhite()},1e3)}hitUvBufferUpdate(e){for(let t=this.bufferSize-1;t>0;t--){let i=this.hitUvBuffer[t]-this.hitUvBuffer[t-10];this.hitUvBuffer[t].x=this.hitUvBuffer[t-1].x+i.x*1e6,this.hitUvBuffer[t].y=this.hitUvBuffer[t-1].y+i.y*1e6}this.hitUvBuffer[0].x=e.x,this.hitUvBuffer[0].y=e.y}mouseVectorBufferUpdate(e,t,i){for(let r=this.bufferSize-1;r>0;r--)this.mouseVectorBuffer[r].x=this.mouseVectorBuffer[r-1].x,this.mouseVectorBuffer[r].y=this.mouseVectorBuffer[r-1].y;this.mouseVectorBuffer[0].x=e.x,this.mouseVectorBuffer[0].y=e.y,this.mouseVectorBuffer[0].z=t,this.mouseVectorBuffer[0].a=i}update(){this.app.loader.setFactorInMaterial(this.localFactor.value),this.mouseVelocityLerped=this.helper.lerp(this.mouseVelocityLerped,this.app.mouse.mouseVelocity,.04),this.pulseLerped=this.helper.lerp(this.pulseLerped,this.pulse,.04),this.mouseVelocityVecLerped.lerpVectors(this.mouseVelocityVecLerped,this.app.mouse.velocity,.04),this.svgGroupArray.length>0&&(this.svgGroupArray[3].children[0].material.uniforms.uTime.value=this.app.time.elapsed*.001,this.svgGroupArray[3].children[0].material.uniforms.pulse.value=this.pulseLerped,this.svgGroupArray[3].children[0].material.uniforms.mouseVelocity.value=this.mouseVelocityLerped,this.svgGroupArray[3].children[0].material.uniforms.mouseVelocityVec.value=this.mouseVelocityVecLerped,this.svgGroupArray[3].children[0].material.uniforms.hitUvPositions.value=this.hitUvBuffer,this.svgGroupArray[3].children[0].material.uniforms.mouseVectorPositions.value=this.mouseVectorBuffer)}},WB=`uniform sampler2D uTexture1;
uniform sampler2D uTexture2;
varying vec2 vUv;

vec3 gammaCorrectedColor(vec3 textureColor){
   return smoothstep(0.0, 1.0, pow(textureColor.rgb, vec3(1.0 / 3.1)));
}

void main() {
    vec2 alphaMapUv = vUv;

        alphaMapUv *= vec2(1.0);
        alphaMapUv.x += 0.0;
        alphaMapUv.y += 0.0;

    
    
    
    
    

    vec4 texColor = texture2D(uTexture1, vUv);

    texColor.rgb = gammaCorrectedColor(texColor.rgb);

    
    
    
    

    
    
    
    
    
    

       gl_FragColor = vec4(texColor);

    
    

    

        

}`,qB=`varying vec2 vUv;
varying vec3 vViewPosition;

void main() {
    vUv = uv;
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
}`,Lx=class{constructor(e,t){this.group=e,this.lift=t,this.app=new Bt,this.helper=new Yt,this.app.isMobile===!1?this.fuckKnowsMultiplier=1.05:this.fuckKnowsMultiplier=2.05,this.start(),this.animate()}animate(){this.lift.on("open-lift",()=>{lt.to(this.group.position,{x:-this.www*1.05,delay:.5})}),this.lift.on("close-lift",()=>{lt.to(this.group.position,{x:0,delay:0})})}start(){this.maskRatio=this.app.resources.items.leftLiftDoor.source.data.width/this.app.resources.items.leftLiftDoor.source.data.height,this.maskRatioAlt=this.app.resources.items.leftLiftDoor.source.data.height/this.app.resources.items.leftLiftDoor.source.data.width;let e=.165;this.www=this.app.sizes.pixelsToWorldUnits(this.lift.rect.width,e)*this.fuckKnowsMultiplier,this.hhh=this.www*this.maskRatio,this.geometry=new hi(this.www,this.hhh),this.material=new ri({uniforms:{uTexture1:{value:this.app.resources.items.leftLiftDoor},uTexture2:{value:this.app.resources.items.spaceA}},fragmentShader:WB,vertexShader:qB,transparent:!0,stencilWrite:!0,stencilRef:4,stencilFunc:P1}),this.instance=new wt(this.geometry,this.material),this.instance.renderOrder=991,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.group.add(this.instance),this.instance.position.x-=this.www*.5,this.instance.position.y+=.15}update(){}},jB=`uniform sampler2D uTexture1;
uniform sampler2D uTexture2;
varying vec2 vUv;

vec3 gammaCorrectedColor(vec3 textureColor){
   return smoothstep(0.0, 1.0, pow(textureColor.rgb, vec3(1.0 / 3.1)));
}

void main() {
    vec2 alphaMapUv = vUv;

        alphaMapUv *= vec2(1.0);
        alphaMapUv.x += 0.0;
        alphaMapUv.y += 0.0;

    
    vec4 texColorAlpha = texture2D(uTexture2, vUv);
        
        
        

    vec4 texColor = texture2D(uTexture1, vUv);

    texColor.rgb = gammaCorrectedColor(texColor.rgb);

    
    float border = 0.1; 
    float edge = 1.0 - border;
    float tweak = 0.016;

    
    
    
    
    
    

    gl_FragColor = vec4(texColor);

    
    

    

        

}`,XB=`varying vec2 vUv;
varying vec3 vViewPosition;

void main() {
    vUv = uv;
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
}`,Ox=class{constructor(e,t){this.group=e,this.lift=t,this.app=new Bt,this.helper=new Yt,this.app.isMobile===!1?this.fuckKnowsMultiplier=1.05:this.fuckKnowsMultiplier=2.05,this.start(),this.animate()}animate(){this.lift.on("open-lift",()=>{lt.to(this.group.position,{x:this.www*1.05,delay:.5,onComplete:()=>{this.lift.liftDoorsInMotion,this.lift.liftOpen=!0}})}),this.lift.on("close-lift",()=>{lt.to(this.group.position,{x:0,delay:0,onComplete:()=>{this.lift.liftDoorsInMotion,this.lift.liftOpen=!1}})})}start(){this.maskRatio=this.app.resources.items.leftLiftDoor.source.data.width/this.app.resources.items.leftLiftDoor.source.data.height,this.maskRatioAlt=this.app.resources.items.leftLiftDoor.source.data.height/this.app.resources.items.leftLiftDoor.source.data.width;let e=.165;this.www=this.app.sizes.pixelsToWorldUnits(this.lift.rect.width,e)*this.fuckKnowsMultiplier,this.hhh=this.www*this.maskRatio,this.geometry=new hi(this.www,this.hhh),this.material=new ri({uniforms:{uTexture1:{value:this.app.resources.items.rightLiftDoor},uTexture2:{value:this.app.resources.items.spaceA}},fragmentShader:jB,vertexShader:XB,transparent:!0,stencilWrite:!0,stencilRef:4,stencilFunc:P1}),this.instance=new wt(this.geometry,this.material),this.instance.renderOrder=991,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.group.add(this.instance),this.instance.position.x+=this.www*.5,this.instance.position.y+=.15;let t=1;this.instance.scale.x*=t,this.instance.scale.y*=t,this.instance.scale.z*=t}update(){}},Ix=class extends Sn{constructor(e){super(),this.group=e,this.app=new Bt,this.helper=new Yt,this.scaleDownGroup=new vt,this.scaleDownGroup.name="scaleDownGroup",this.bothDoorsGroup=new vt,this.bothDoorsGroup.name="bothDoorsGroup",this.group.add(this.scaleDownGroup),this.scaleDownGroup.add(this.bothDoorsGroup),this.liftOpen=!1,this.liftDoorsInMotion=!1,this.start(),this.setupLiftEvent(),this.app.sizes.on("resize",()=>{this.rect=this.markerElement.getBoundingClientRect(),this.heightFromTop=this.calculateHeightFromTheTop()})}setupLiftEvent(){}start(){this.markerElementMarker2=document.getElementById("gl-space-scene"),this.markerElement=this.markerElementMarker2,this.rect=this.markerElement.getBoundingClientRect(),this.leftLiftDoorGroup=new vt,this.leftLiftDoorGroup.name="leftLiftDoorGroup",this.leftLiftDoor=new Lx(this.leftLiftDoorGroup,this),this.rightLiftDoorGroup=new vt,this.rightLiftDoorGroup.name="rightLiftDoorGroup",this.rightLiftDoor=new Ox(this.rightLiftDoorGroup,this),this.bothDoorsGroup.add(this.leftLiftDoorGroup,this.rightLiftDoorGroup),this.heightFromTop=this.calculateHeightFromTheTop(),this.app.scrollManager.on("scroll",t=>{let i=window.scrollY||document.documentElement.scrollTop;i<this.heightFromTop?this.liftOpen&&this.liftDoorsInMotion===!1&&(this.liftDoorsInMotion,this.trigger("close-lift",["init"])):i>this.heightFromTop&&this.liftOpen===!1&&this.liftDoorsInMotion===!1&&(this.liftDoorsInMotion,this.trigger("open-lift",["lift-open"]))});let e=.6;this.scaleDownGroup.scale.x*=e,this.scaleDownGroup.scale.y*=e,this.scaleDownGroup.scale.z*=e,this.bothDoorsGroup.position.x+=0,this.bothDoorsGroup.position.y-=.15,this.bothDoorsGroup.position.z+=0}calculateHeightFromTheTop(){return this.rect.top+window.scrollY+this.rect.height/2-this.app.sizes.height*.5}update(){this.leftLiftDoor.update(),this.rightLiftDoor.update()}},YB=class{constructor(n,e){this.group=n,this.rect=e,this.app=new Bt,this.helper=new Yt,this.pulse=0,this.mouseVelocityLerped=0,this.pulseLerped=0,this.mouseVelocityVecLerped=new Me,this.start(),this.storedWidth=this.instance.geometry.parameters.width,this.storedHeight=this.instance.geometry.parameters.height,this.currentWidth=this.instance.geometry.parameters.width,this.currentHeight=this.instance.geometry.parameters.height,this.app.sizes.on("resize",()=>{this.currentWidth=this.instance.geometry.parameters.width,this.currentHeight=this.instance.geometry.parameters.height;let t=.165,i=this.rect.height/this.app.sizes.height;this.rrr1=this.app.sizes.getVisible(t).y/.5*i,this.ratio=this.rect.width/this.rect.height,this.hhh=this.rrr1,this.www=this.hhh*this.ratio,this.ratioOfScale=this.currentHeight/this.storedHeight,this.instance.scale.x=this.ratioOfScale,this.instance.scale.y=this.ratioOfScale})}start(){let n=this.rect.height/this.app.sizes.height;this.rrr1=this.app.sizes.getVisible(.165).y/.5*n,this.ratio=this.app.resources.items.text.source.data.width/this.app.resources.items.text.source.data.height,this.hhh=this.rrr1,this.www=this.hhh*this.ratio,this.geometry=new hi(this.www,this.hhh,1,1),this.material=new gr({map:this.app.resources.items.text,transparent:!0,stencilWrite:!1,alphaMap:this.app.resources.items.text}),this.instance=new wt(this.geometry,this.material),this.instance.renderOrder=500,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.group.add(this.instance)}update(){}},$B=`uniform float width;
uniform float height;

varying vec2 vUv;

void main()
{
    float gridMultiplier = 480.0;

    float uvGridX = fract(vUv.x * (width * gridMultiplier));
    float uvGridY = fract(vUv.y * (height * gridMultiplier));
    vec2 gridUvs = vec2(uvGridX, uvGridY);

    float d = distance(gridUvs, vec2(0.5));

    float a = step(0.35, d);
    

    

    gl_FragColor = vec4(0.0, 0.0, 0.0, (1.0 - a) * 0.7);
}`,KB=`varying vec2 vUv;

void main()
{
    vec4 modelPosition = modelMatrix * vec4(position, 1.0);
    vec4 viewPosition = viewMatrix * modelPosition;
    vec4 projectedPosition = projectionMatrix * viewPosition;

    vUv = uv;

    gl_Position = projectedPosition;
}`,Fx=class{constructor(e,t){this.group=e,this.rect=t,this.app=new Bt,this.helper=new Yt,this.start(),this.storedWidth=this.instance.geometry.parameters.width,this.storedHeight=this.instance.geometry.parameters.height,this.currentWidth=this.instance.geometry.parameters.width,this.currentHeight=this.instance.geometry.parameters.height,this.app.sizes.on("resize",()=>{this.currentWidth=this.instance.geometry.parameters.width,this.currentHeight=this.instance.geometry.parameters.height;let i=.165,r=this.rect.height/this.app.sizes.height;this.rrr1=this.app.sizes.getVisible(i).y*r,this.ratio=this.rect.width/this.rect.height,this.currentHeight=this.rrr1*1.2,this.currentWidth=this.hhh*this.ratio*1.1,this.ratioOfScale=this.currentHeight/this.storedHeight,this.mobileScale=this.app.isMobile?4:1,this.instance.scale.x=this.ratioOfScale,this.instance.scale.y=this.ratioOfScale})}start(){let e=this.rect.height/this.app.sizes.height;this.rrr1=this.app.sizes.getVisible(.165).y*e,this.ratio=this.rect.width/this.rect.height,this.hhh=this.rrr1*1.2,this.www=this.hhh*this.ratio;let t=.75,i=.1;this.mobileScale=this.app.isMobile?4:1,this.geometry=new hi(this.www*1.4*this.mobileScale,this.hhh,1),this.material=new ri({transparent:!0,stencilWrite:!1,fragmentShader:$B,vertexShader:KB,uniforms:{width:{value:t},height:{value:i}}}),this.instance=new wt(this.geometry,this.material),this.instance.renderOrder=999,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.group.add(this.instance)}update(){}},kx=class{constructor(e){this.group=e,this.app=new Bt,this.helper=new Yt,this.timeline=lt.timeline(),this.textArray=[],this.scrollControl(),this.createText(),this.reduceSize(),this.createScreen(),this.animate()}scrollControl(){this.markerElementMarker2=document.getElementById("gl-lcd"),this.markerElement=this.markerElementMarker2,this.rect=this.markerElement.getBoundingClientRect();let e=.165;this.animationXShift=this.app.isMobile?this.app.sizes.getVisible(e).x*6.7:this.app.sizes.getVisible(e).x*2.2}createText(){for(let e=0;e<2;e++){let t=new YB(this.group,this.rect);t.instance.position.x=this.animationXShift,this.textArray.push(t)}}createScreen(){this.screen=new Fx(this.group,this.rect)}reduceSize(){this.mobileScale=this.app.isMobile?.4:1,this.group.scale.x=.8*this.mobileScale,this.group.scale.y=.8*this.mobileScale,this.group.scale.z=.8*this.mobileScale}animate(){this.textArray.forEach(e=>{this.timeline.add(lt.to(e.instance.position,{x:-this.animationXShift,duration:12,ease:"none"}),0)}),this.timeline.eventCallback("onComplete",()=>{this.timeline.seek(0).play()})}update(){this.textArray.forEach(e=>{e.update()})}},ZB=`uniform vec2 mouse; 
uniform float u_effectRadius; 
uniform float uTime; 
uniform float uMouseVelocity;

varying vec2 vUv;
varying float vEffectStrength;

void main() {
    vec3 pos = position;
    pos.z += uMouseVelocity * 0.0001;
    vec4 modelPosition = modelMatrix * vec4(pos, 1.0);
    vec4 viewPosition = viewMatrix * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;

    vUv = uv;

    
    float distToMouse = distance(mouse, (modelPosition.xy / modelPosition.w) * 0.5 + 0.5);
    vEffectStrength = smoothstep(0.0, 1.0, 1.0 - distToMouse);
}`,JB=`uniform sampler2D tex1;
uniform sampler2D tex2;
uniform sampler2D stateTexture; 
uniform vec2 mouse;
uniform vec2 lastMousePosition;
uniform float uTime;
uniform vec2 resolution; 
varying vec2 vUv;
varying float vEffectStrength;
uniform vec2 mousePositions[20]; 
uniform float uColorChange;
uniform float uBrightness;
uniform float alpha;
uniform float uMouseVelocity;

float rand(float n){return fract(sin(n) * 43758.5453123);}

float noise(float p){
	float fl = floor(p);
  float fc = fract(p);
	return mix(rand(fl), rand(fl + 1.0), fc);
}

float lineDistance(vec2 a, vec2 b, vec2 p) {
    
    vec2 pa = p - a, ba = b - a;
    float h = clamp(dot(pa, ba) / dot(ba, ba), 0.0, 1.0);
    return distance(p, a + ba * h);
}

void main() {
    vec2 aspectCorrectedUv = vUv;
    aspectCorrectedUv.x *= (resolution.x) / resolution.y;

    float mv = smoothstep(0.0, 1.0, 1.0 - uMouseVelocity);

    float lineEffect = 0.0;
    float alphaStep = 1.0 / 19.0; 

    float distanceShade = 1.0 - distance(aspectCorrectedUv, vec2(0.5 * (resolution.x / resolution.y), 0.5));
    distanceShade = smoothstep(0.3, 2.0, distanceShade);

    float mixFactor1 = smoothstep(0.0, 0.05, uColorChange); 
    float mixFactor2 = smoothstep(0.35, 0.40, uColorChange); 
    float mixFactor3 = smoothstep(0.65, 0.70, uColorChange); 
    float mixFactor4 = smoothstep(0.85, 0.90, uColorChange); 

    

    float dimFactor = 0.2;

    
    
    
    
    
    

        
    vec3 color1 = vec3(1.0, 0.0824, 0.4431);

    
    vec3 color2 = vec3(0.4157, 0.1451, 0.9843);

    
    vec3 color3 = vec3(1.0, 0.1647, 0.1294);

    
    vec3 color4 = vec3(0.0078, 0.8078, 0.9961);

    vec3 result2 = mix(
        mix(mix(mix(vec3(0.0,0.0,0.0), color1 * distanceShade, mixFactor1), 
        color2 * distanceShade, mixFactor2),
        color3 * distanceShade, mixFactor3),
        color4 * distanceShade, mixFactor4
    );

    float noiseFactor = 0.002; 

    for (int i = 0; i < 19; ++i) {
        vec2 start = mousePositions[i];
        vec2 end = mousePositions[i + 1];
        start.x *= resolution.x / resolution.y;
        end.x *= resolution.x / resolution.y;

        float dist = lineDistance(start, end, aspectCorrectedUv);

        
        float noiseValue = noise(uTime + float(i));
        float threshold = 0.05 * (19.0 - float(i)) * (alphaStep * 0.01);

        if (dist < threshold) {
            lineEffect = 1.0;
            lineEffect *= vEffectStrength;
            lineEffect *= mv;
            break;
        }
    }
    vec3 p1 = vec3(lineEffect * result2.x, lineEffect * result2.y, lineEffect * result2.z);

    vec3 o = result2 + (p1 * 5.0);

    gl_FragColor = vec4(o * max((abs((mv * 4.0) - 2.0)), 1.0), alpha);

     

}`;lt.registerPlugin(mt);var Ux=class{constructor(e){this.group=e,this.app=new Bt,this.helper=new Yt,this.scrollingTimeline4=this.app.sharedAnimationTimeline.scrollingTimeline4,this.scaleDownGroup=new vt,this.scaleDownGroup.name="scaleDownGroup",this.group.add(this.scaleDownGroup),this.scrollPercentageForFade=1,this.mouseVelocityLerp=0,this.start(),this.animate(),this.resize(),this.scrollFade()}start(){this.shaderMaterial=new ri({uniforms:{uTime:{value:0},mouse:{value:new Me},lastMousePosition:{value:new Me},resolution:{value:new Me(this.app.sizes.width,this.app.sizes.height)},mousePositions:{value:this.app.mouse.mouseMovementBuffer},uColorChange:{value:0},uBrightness:{value:1},alpha:{value:1},uMouseVelocity:{value:0}},vertexShader:ZB,fragmentShader:JB,transparent:!0,depthTest:!1,depthWrite:!1});let e=.2;this.vFov=this.app.camera.instance.fov*Math.PI/180,this.planeHeight=2*Math.tan(this.vFov/2)*e,this.planeWidth=this.planeHeight*this.app.camera.instance.aspect,this.geometry=new hi(this.planeWidth,this.planeHeight),this.backgroundMesh=new wt(this.geometry,this.shaderMaterial),this.backgroundMesh.renderOrder=0,this.scaleDownGroup.add(this.backgroundMesh)}scrollFade(){this.app.scrollManager.on("scroll",()=>{this.scrollPercentageForFade=1-Math.min(1,window.scrollY/300)})}resize(){this.app.sizes.on("resize",()=>{let e=1/this.group.scale.x,t=.2;this.vFov=this.app.camera.instance.fov*Math.PI/180,this.planeHeight=2*Math.tan(this.vFov/2)*t,this.planeWidth=this.planeHeight*this.app.camera.instance.aspect,this.backgroundMesh.geometry.dispose(),this.backgroundMesh.geometry=new hi(this.planeWidth,this.planeHeight),this.backgroundMesh.material.uniforms.resolution.value.x=this.app.sizes.width,this.backgroundMesh.material.uniforms.resolution.value.y=this.app.sizes.height,this.backgroundMesh.renderOrder=1,this.scaleDownGroup.scale.x=e,this.scaleDownGroup.scale.y=e,this.scaleDownGroup.scale.z=e})}animate(){mt.create({animation:this.scrollingTimeline4,trigger:".webgl",start:this.app.sizes.height*.1,end:this.app.sizes.height,scrub:2,markers:!1}),this.scrollingTimeline4.to(this.backgroundMesh.material.uniforms.uBrightness,{value:0,duration:.5}),this.scrollingTimeline4.to(this.backgroundMesh.material.uniforms.uBrightness,{value:0,duration:3.5})}update(){this.backgroundMesh.material.uniforms.uColorChange.value=this.app.world.lineShapeCreator.customUniforms.uColorChange.value,this.backgroundMesh.material.uniforms.mousePositions.value=this.app.mouse.mouseMovementBuffer,this.backgroundMesh.material.uniforms.uTime.value=this.app.time.elapsed*.001,this.backgroundMesh.material.uniforms.alpha.value=this.scrollPercentageForFade,this.app.mouse?(this.mouseVelocityLerp=this.helper.lerp(this.mouseVelocityLerp,this.app.mouse.screenPosition.length()*.5,.1),this.shaderMaterial.uniforms.uMouseVelocity.value=this.mouseVelocityLerp):this.mouseVelocityLerp=this.helper.lerp(this.mouseVelocityLerp,0,.02)}};function QB(){var n=Object.create(null);function e(r,s){var o=r.id,a=r.name,l=r.dependencies;l===void 0&&(l=[]);var c=r.init;c===void 0&&(c=function(){});var u=r.getTransferables;if(u===void 0&&(u=null),!n[o])try{l=l.map(function(d){return d&&d.isWorkerModule&&(e(d,function(p){if(p instanceof Error)throw p}),d=n[d.id].value),d}),c=i("<"+a+">.init",c),u&&(u=i("<"+a+">.getTransferables",u));var h=null;typeof c=="function"?h=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),n[o]={id:o,value:h,getTransferables:u},s(h)}catch(d){d&&d.noLog||console.error(d),s(d)}}function t(r,s){var o,a=r.id,l=r.args;(!n[a]||typeof n[a].value!="function")&&s(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var c=(o=n[a]).value.apply(o,l);c&&typeof c.then=="function"?c.then(u,function(h){return s(h instanceof Error?h:new Error(""+h))}):u(c)}catch(h){s(h)}function u(h){try{var d=n[a].getTransferables&&n[a].getTransferables(h);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),s(h,d)}catch(p){console.error(p),s(p)}}}function i(r,s){var o=void 0;self.troikaDefine=function(l){return o=l};var a=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(l){console.error(l)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(r){var s=r.data,o=s.messageId,a=s.action,l=s.data;try{a==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof c=="function"}})}),a==="callModule"&&t(l,function(c,u){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:c},u||void 0)})}catch(c){postMessage({messageId:o,success:!1,error:c.stack})}})}function eN(n){var e=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=n.dependencies,i=n.init;t=Array.isArray(t)?t.map(function(s){return s&&s._getInitResult?s._getInitResult():s}):[];var r=Promise.all(t).then(function(s){return i.apply(null,s)});return e._getInitResult=function(){return r},r},e}var _A=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(t){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return _A=function(){return n},n},tN=0,iN=0,Cv=!1,Dh=Object.create(null),Ph=Object.create(null),zx=Object.create(null);function ru(n){if((!n||typeof n.init!="function")&&!Cv)throw new Error("requires `options.init` function");var e=n.dependencies,t=n.init,i=n.getTransferables,r=n.workerId;if(!_A())return eN(n);r==null&&(r="#default");var s="workerModule"+ ++tN,o=n.name||s,a=null;e=e&&e.map(function(c){return typeof c=="function"&&!c.workerModuleData&&(Cv=!0,c=ru({workerId:r,name:"<"+o+"> function dependency: "+c.name,init:`function(){return (
`+bf(c)+`
)}`}),Cv=!1),c&&c.workerModuleData&&(c=c.workerModuleData),c});function l(){for(var c=[],u=arguments.length;u--;)c[u]=arguments[u];if(!a){a=tM(r,"registerModule",l.workerModuleData);var h=function(){a=null,Ph[r].delete(h)};(Ph[r]||(Ph[r]=new Set)).add(h)}return a.then(function(d){var p=d.isCallable;if(p)return tM(r,"callModule",{id:s,args:c});throw new Error("Worker module function was called but `init` did not return a callable function")})}return l.workerModuleData={isWorkerModule:!0,id:s,name:o,dependencies:e,init:bf(t),getTransferables:i&&bf(i)},l}function rN(n){Ph[n]&&Ph[n].forEach(function(e){e()}),Dh[n]&&(Dh[n].terminate(),delete Dh[n])}function bf(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function nN(n){var e=Dh[n];if(!e){var t=bf(QB);e=Dh[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(i){var r=i.data,s=r.messageId,o=zx[s];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete zx[s],o(r)}}return e}function tM(n,e,t){return new Promise(function(i,r){var s=++iN;zx[s]=function(o){o.success?i(o.result):r(new Error("Error in worker "+e+" call: "+o.error))},nN(n).postMessage({messageId:s,action:e,data:t})})}function wA(){var n=function(e){function t(U,O,F,$,P,C,M,B){var k=1-M;B.x=k*k*U+2*k*M*F+M*M*P,B.y=k*k*O+2*k*M*$+M*M*C}function i(U,O,F,$,P,C,M,B,k,Q){var Y=1-k;Q.x=Y*Y*Y*U+3*Y*Y*k*F+3*Y*k*k*P+k*k*k*M,Q.y=Y*Y*Y*O+3*Y*Y*k*$+3*Y*k*k*C+k*k*k*B}function r(U,O){for(var F=/([MLQCZ])([^MLQCZ]*)/g,$,P,C,M,B;$=F.exec(U);){var k=$[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Q){return parseFloat(Q)});switch($[1]){case"M":M=P=k[0],B=C=k[1];break;case"L":(k[0]!==M||k[1]!==B)&&O("L",M,B,M=k[0],B=k[1]);break;case"Q":{O("Q",M,B,M=k[2],B=k[3],k[0],k[1]);break}case"C":{O("C",M,B,M=k[4],B=k[5],k[0],k[1],k[2],k[3]);break}case"Z":(M!==P||B!==C)&&O("L",M,B,P,C);break}}}function s(U,O,F){F===void 0&&(F=16);var $={x:0,y:0};r(U,function(P,C,M,B,k,Q,Y,re,Z){switch(P){case"L":O(C,M,B,k);break;case"Q":{for(var V=C,ne=M,ie=1;ie<F;ie++)t(C,M,Q,Y,B,k,ie/(F-1),$),O(V,ne,$.x,$.y),V=$.x,ne=$.y;break}case"C":{for(var te=C,j=M,W=1;W<F;W++)i(C,M,Q,Y,re,Z,B,k,W/(F-1),$),O(te,j,$.x,$.y),te=$.x,j=$.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(U,O){var F=U.getContext?U.getContext("webgl",c):U,$=l.get(F);if(!$){let te=function(ee){var me=re[ee];if(!me&&(me=re[ee]=F.getExtension(ee),!me))throw new Error(ee+" not supported");return me},j=function(ee,me){var pe=F.createShader(me);return F.shaderSource(pe,ee),F.compileShader(pe),pe},W=function(ee,me,pe,ge){if(!Z[ee]){var xe={},we={},_e=F.createProgram();F.attachShader(_e,j(me,F.VERTEX_SHADER)),F.attachShader(_e,j(pe,F.FRAGMENT_SHADER)),F.linkProgram(_e),Z[ee]={program:_e,transaction:function(Ie){F.useProgram(_e),Ie({setUniform:function(Be,Ae){for(var it=[],se=arguments.length-2;se-- >0;)it[se]=arguments[se+2];var Le=we[Ae]||(we[Ae]=F.getUniformLocation(_e,Ae));F["uniform"+Be].apply(F,[Le].concat(it))},setAttribute:function(Be,Ae,it,se,Le){var Ee=xe[Be];Ee||(Ee=xe[Be]={buf:F.createBuffer(),loc:F.getAttribLocation(_e,Be),data:null}),F.bindBuffer(F.ARRAY_BUFFER,Ee.buf),F.vertexAttribPointer(Ee.loc,Ae,F.FLOAT,!1,0,0),F.enableVertexAttribArray(Ee.loc),Y?F.vertexAttribDivisor(Ee.loc,se):te("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Ee.loc,se),Le!==Ee.data&&(F.bufferData(F.ARRAY_BUFFER,Le,it),Ee.data=Le)}})}}}Z[ee].transaction(ge)},H=function(ee,me){ne++;try{F.activeTexture(F.TEXTURE0+ne);var pe=V[ee];pe||(pe=V[ee]=F.createTexture(),F.bindTexture(F.TEXTURE_2D,pe),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.NEAREST),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.NEAREST)),F.bindTexture(F.TEXTURE_2D,pe),me(pe,ne)}finally{ne--}},q=function(ee,me,pe){var ge=F.createFramebuffer();ie.push(ge),F.bindFramebuffer(F.FRAMEBUFFER,ge),F.activeTexture(F.TEXTURE0+me),F.bindTexture(F.TEXTURE_2D,ee),F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_2D,ee,0);try{pe(ge)}finally{F.deleteFramebuffer(ge),F.bindFramebuffer(F.FRAMEBUFFER,ie[--ie.length-1]||null)}},I=function(){re={},Z={},V={},ne=-1,ie.length=0};var P=te,C=j,M=W,B=H,k=q,Q=I,Y=typeof WebGL2RenderingContext<"u"&&F instanceof WebGL2RenderingContext,re={},Z={},V={},ne=-1,ie=[];F.canvas.addEventListener("webglcontextlost",function(ee){I(),ee.preventDefault()},!1),l.set(F,$={gl:F,isWebGL2:Y,getExtension:te,withProgram:W,withTexture:H,withTextureFramebuffer:q,handleContextLoss:I})}O($)}function h(U,O,F,$,P,C,M,B){M===void 0&&(M=15),B===void 0&&(B=null),u(U,function(k){var Q=k.gl,Y=k.withProgram,re=k.withTexture;re("copy",function(Z,V){Q.texImage2D(Q.TEXTURE_2D,0,Q.RGBA,P,C,0,Q.RGBA,Q.UNSIGNED_BYTE,O),Y("copy",o,a,function(ne){var ie=ne.setUniform,te=ne.setAttribute;te("aUV",2,Q.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ie("1i","image",V),Q.bindFramebuffer(Q.FRAMEBUFFER,B||null),Q.disable(Q.BLEND),Q.colorMask(M&8,M&4,M&2,M&1),Q.viewport(F,$,P,C),Q.scissor(F,$,P,C),Q.drawArrays(Q.TRIANGLES,0,3)})})})}function d(U,O,F){var $=U.width,P=U.height;u(U,function(C){var M=C.gl,B=new Uint8Array($*P*4);M.readPixels(0,0,$,P,M.RGBA,M.UNSIGNED_BYTE,B),U.width=O,U.height=F,h(M,B,0,0,$,P)})}var p=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:h,resizeWebGLCanvasWithoutClearing:d});function f(U,O,F,$,P,C){C===void 0&&(C=1);var M=new Uint8Array(U*O),B=$[2]-$[0],k=$[3]-$[1],Q=[];s(F,function(te,j,W,H){Q.push({x1:te,y1:j,x2:W,y2:H,minX:Math.min(te,W),minY:Math.min(j,H),maxX:Math.max(te,W),maxY:Math.max(j,H)})}),Q.sort(function(te,j){return te.maxX-j.maxX});for(var Y=0;Y<U;Y++)for(var re=0;re<O;re++){var Z=ne($[0]+B*(Y+.5)/U,$[1]+k*(re+.5)/O),V=Math.pow(1-Math.abs(Z)/P,C)/2;Z<0&&(V=1-V),V=Math.max(0,Math.min(255,Math.round(V*255))),M[re*U+Y]=V}return M;function ne(te,j){for(var W=1/0,H=1/0,q=Q.length;q--;){var I=Q[q];if(I.maxX+H<=te)break;if(te+H>I.minX&&j-H<I.maxY&&j+H>I.minY){var ee=m(te,j,I.x1,I.y1,I.x2,I.y2);ee<W&&(W=ee,H=Math.sqrt(W))}}return ie(te,j)&&(H=-H),H}function ie(te,j){for(var W=0,H=Q.length;H--;){var q=Q[H];if(q.maxX<=te)break;var I=q.y1>j!=q.y2>j&&te<(q.x2-q.x1)*(j-q.y1)/(q.y2-q.y1)+q.x1;I&&(W+=q.y1<q.y2?1:-1)}return W!==0}}function v(U,O,F,$,P,C,M,B,k,Q){C===void 0&&(C=1),B===void 0&&(B=0),k===void 0&&(k=0),Q===void 0&&(Q=0),g(U,O,F,$,P,C,M,null,B,k,Q)}function g(U,O,F,$,P,C,M,B,k,Q,Y){C===void 0&&(C=1),k===void 0&&(k=0),Q===void 0&&(Q=0),Y===void 0&&(Y=0);for(var re=f(U,O,F,$,P,C),Z=new Uint8Array(re.length*4),V=0;V<re.length;V++)Z[V*4+Y]=re[V];h(M,Z,k,Q,U,O,1<<3-Y,B)}function m(U,O,F,$,P,C){var M=P-F,B=C-$,k=M*M+B*B,Q=k?Math.max(0,Math.min(1,((U-F)*M+(O-$)*B)/k)):0,Y=U-(F+Q*M),re=O-($+Q*B);return Y*Y+re*re}var x=Object.freeze({__proto__:null,generate:f,generateIntoCanvas:v,generateIntoFramebuffer:g}),y="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",_="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",w="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",b=new Float32Array([0,0,2,0,0,2]),T=null,A=!1,S={},E=new WeakMap;function R(U){if(!A&&!G(U))throw new Error("WebGL generation not supported")}function D(U,O,F,$,P,C,M){if(C===void 0&&(C=1),M===void 0&&(M=null),!M&&(M=T,!M)){var B=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!B)throw new Error("OffscreenCanvas or DOM canvas not supported");M=T=B.getContext("webgl",{depth:!1})}R(M);var k=new Uint8Array(U*O*4);u(M,function(Z){var V=Z.gl,ne=Z.withTexture,ie=Z.withTextureFramebuffer;ne("readable",function(te,j){V.texImage2D(V.TEXTURE_2D,0,V.RGBA,U,O,0,V.RGBA,V.UNSIGNED_BYTE,null),ie(te,j,function(W){L(U,O,F,$,P,C,V,W,0,0,0),V.readPixels(0,0,U,O,V.RGBA,V.UNSIGNED_BYTE,k)})})});for(var Q=new Uint8Array(U*O),Y=0,re=0;Y<k.length;Y+=4)Q[re++]=k[Y];return Q}function z(U,O,F,$,P,C,M,B,k,Q){C===void 0&&(C=1),B===void 0&&(B=0),k===void 0&&(k=0),Q===void 0&&(Q=0),L(U,O,F,$,P,C,M,null,B,k,Q)}function L(U,O,F,$,P,C,M,B,k,Q,Y){C===void 0&&(C=1),k===void 0&&(k=0),Q===void 0&&(Q=0),Y===void 0&&(Y=0),R(M);var re=[];s(F,function(Z,V,ne,ie){re.push(Z,V,ne,ie)}),re=new Float32Array(re),u(M,function(Z){var V=Z.gl,ne=Z.isWebGL2,ie=Z.getExtension,te=Z.withProgram,j=Z.withTexture,W=Z.withTextureFramebuffer,H=Z.handleContextLoss;if(j("rawDistances",function(q,I){(U!==q._lastWidth||O!==q._lastHeight)&&V.texImage2D(V.TEXTURE_2D,0,V.RGBA,q._lastWidth=U,q._lastHeight=O,0,V.RGBA,V.UNSIGNED_BYTE,null),te("main",y,_,function(ee){var me=ee.setAttribute,pe=ee.setUniform,ge=!ne&&ie("ANGLE_instanced_arrays"),xe=!ne&&ie("EXT_blend_minmax");me("aUV",2,V.STATIC_DRAW,0,b),me("aLineSegment",4,V.DYNAMIC_DRAW,1,re),pe.apply(void 0,["4f","uGlyphBounds"].concat($)),pe("1f","uMaxDistance",P),pe("1f","uExponent",C),W(q,I,function(we){V.enable(V.BLEND),V.colorMask(!0,!0,!0,!0),V.viewport(0,0,U,O),V.scissor(0,0,U,O),V.blendFunc(V.ONE,V.ONE),V.blendEquationSeparate(V.FUNC_ADD,ne?V.MAX:xe.MAX_EXT),V.clear(V.COLOR_BUFFER_BIT),ne?V.drawArraysInstanced(V.TRIANGLES,0,3,re.length/4):ge.drawArraysInstancedANGLE(V.TRIANGLES,0,3,re.length/4)})}),te("post",o,w,function(ee){ee.setAttribute("aUV",2,V.STATIC_DRAW,0,b),ee.setUniform("1i","tex",I),V.bindFramebuffer(V.FRAMEBUFFER,B),V.disable(V.BLEND),V.colorMask(Y===0,Y===1,Y===2,Y===3),V.viewport(k,Q,U,O),V.scissor(k,Q,U,O),V.drawArrays(V.TRIANGLES,0,3)})}),V.isContextLost())throw H(),new Error("webgl context lost")})}function G(U){var O=!U||U===T?S:U.canvas||U,F=E.get(O);if(F===void 0){A=!0;var $=null;try{var P=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],C=D(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,U);F=C&&P.length===C.length&&C.every(function(M,B){return M===P[B]}),F||($="bad trial run results",console.info(P,C))}catch(M){F=!1,$=M.message}$&&console.warn("WebGL SDF generation not supported:",$),A=!1,E.set(O,F)}return F}var J=Object.freeze({__proto__:null,generate:D,generateIntoCanvas:z,generateIntoFramebuffer:L,isSupported:G});function X(U,O,F,$,P,C){P===void 0&&(P=Math.max($[2]-$[0],$[3]-$[1])/2),C===void 0&&(C=1);try{return D.apply(J,arguments)}catch(M){return console.info("WebGL SDF generation failed, falling back to JS",M),f.apply(x,arguments)}}function N(U,O,F,$,P,C,M,B,k,Q){P===void 0&&(P=Math.max($[2]-$[0],$[3]-$[1])/2),C===void 0&&(C=1),B===void 0&&(B=0),k===void 0&&(k=0),Q===void 0&&(Q=0);try{return z.apply(J,arguments)}catch(Y){return console.info("WebGL SDF generation failed, falling back to JS",Y),v.apply(x,arguments)}}return e.forEachPathCommand=r,e.generate=X,e.generateIntoCanvas=N,e.javascript=x,e.pathToLineSegments=s,e.webgl=J,e.webglUtils=p,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}function sN(){var n=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},i={},r={};i.L=1,r[1]="L",Object.keys(t).forEach(function(H,q){i[H]=1<<q+1,r[i[H]]=H}),Object.freeze(i);var s=i.LRI|i.RLI|i.FSI,o=i.L|i.R|i.AL,a=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,l=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,c=i.S|i.WS|i.B|s|i.PDI|l,u=null;function h(){if(!u){u=new Map;var H=function(I){if(t.hasOwnProperty(I)){var ee=0;t[I].split(",").forEach(function(me){var pe=me.split("+"),ge=pe[0],xe=pe[1];ge=parseInt(ge,36),xe=xe?parseInt(xe,36):0,u.set(ee+=ge,i[I]);for(var we=0;we<xe;we++)u.set(++ee,i[I])})}};for(var q in t)H(q)}}function d(H){return h(),u.get(H.codePointAt(0))||i.L}function p(H){return r[d(H)]}var f={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function v(H,q){var I=36,ee=0,me=new Map,pe=q&&new Map,ge;return H.split(",").forEach(function xe(we){if(we.indexOf("+")!==-1)for(var _e=+we;_e--;)xe(ge);else{ge=we;var Ie=we.split(">"),Be=Ie[0],Ae=Ie[1];Be=String.fromCodePoint(ee+=parseInt(Be,I)),Ae=String.fromCodePoint(ee+=parseInt(Ae,I)),me.set(Be,Ae),q&&pe.set(Ae,Be)}}),{map:me,reverseMap:pe}}var g,m,x;function y(){if(!g){var H=v(f.pairs,!0),q=H.map,I=H.reverseMap;g=q,m=I,x=v(f.canonical,!1).map}}function _(H){return y(),g.get(H)||null}function w(H){return y(),m.get(H)||null}function b(H){return y(),x.get(H)||null}var T=i.L,A=i.R,S=i.EN,E=i.ES,R=i.ET,D=i.AN,z=i.CS,L=i.B,G=i.S,J=i.ON,X=i.BN,N=i.NSM,U=i.AL,O=i.LRO,F=i.RLO,$=i.LRE,P=i.RLE,C=i.PDF,M=i.LRI,B=i.RLI,k=i.FSI,Q=i.PDI;function Y(H,q){for(var I=125,ee=new Uint32Array(H.length),me=0;me<H.length;me++)ee[me]=d(H[me]);var pe=new Map;function ge(nr,Zn){var Nr=ee[nr];ee[nr]=Zn,pe.set(Nr,pe.get(Nr)-1),Nr&a&&pe.set(a,pe.get(a)-1),pe.set(Zn,(pe.get(Zn)||0)+1),Zn&a&&pe.set(a,(pe.get(a)||0)+1)}for(var xe=new Uint8Array(H.length),we=new Map,_e=[],Ie=null,Be=0;Be<H.length;Be++)Ie||_e.push(Ie={start:Be,end:H.length-1,level:q==="rtl"?1:q==="ltr"?0:y_(Be,!1)}),ee[Be]&L&&(Ie.end=Be,Ie=null);for(var Ae=P|$|F|O|s|Q|C|L,it=function(nr){return nr+(nr&1?1:2)},se=function(nr){return nr+(nr&1?2:1)},Le=0;Le<_e.length;Le++){Ie=_e[Le];var Ee=[{_level:Ie.level,_override:0,_isolate:0}],ke=void 0,We=0,Qe=0,rt=0;pe.clear();for(var Oe=Ie.start;Oe<=Ie.end;Oe++){var Ce=ee[Oe];if(ke=Ee[Ee.length-1],pe.set(Ce,(pe.get(Ce)||0)+1),Ce&a&&pe.set(a,(pe.get(a)||0)+1),Ce&Ae)if(Ce&(P|$)){xe[Oe]=ke._level;var le=(Ce===P?se:it)(ke._level);le<=I&&!We&&!Qe?Ee.push({_level:le,_override:0,_isolate:0}):We||Qe++}else if(Ce&(F|O)){xe[Oe]=ke._level;var Pe=(Ce===F?se:it)(ke._level);Pe<=I&&!We&&!Qe?Ee.push({_level:Pe,_override:Ce&F?A:T,_isolate:0}):We||Qe++}else if(Ce&s){Ce&k&&(Ce=y_(Oe+1,!0)===1?B:M),xe[Oe]=ke._level,ke._override&&ge(Oe,ke._override);var Ve=(Ce===B?se:it)(ke._level);Ve<=I&&We===0&&Qe===0?(rt++,Ee.push({_level:Ve,_override:0,_isolate:1,_isolInitIndex:Oe})):We++}else if(Ce&Q){if(We>0)We--;else if(rt>0){for(Qe=0;!Ee[Ee.length-1]._isolate;)Ee.pop();var et=Ee[Ee.length-1]._isolInitIndex;et!=null&&(we.set(et,Oe),we.set(Oe,et)),Ee.pop(),rt--}ke=Ee[Ee.length-1],xe[Oe]=ke._level,ke._override&&ge(Oe,ke._override)}else Ce&C?(We===0&&(Qe>0?Qe--:!ke._isolate&&Ee.length>1&&(Ee.pop(),ke=Ee[Ee.length-1])),xe[Oe]=ke._level):Ce&L&&(xe[Oe]=Ie.level);else xe[Oe]=ke._level,ke._override&&Ce!==X&&ge(Oe,ke._override)}for(var Je=[],Te=null,Ze=Ie.start;Ze<=Ie.end;Ze++){var Se=ee[Ze];if(!(Se&l)){var ce=xe[Ze],ue=Se&s,de=Se===Q;Te&&ce===Te._level?(Te._end=Ze,Te._endsWithIsolInit=ue):Je.push(Te={_start:Ze,_end:Ze,_level:ce,_startsWithPDI:de,_endsWithIsolInit:ue})}}for(var be=[],Ue=0;Ue<Je.length;Ue++){var Re=Je[Ue];if(!Re._startsWithPDI||Re._startsWithPDI&&!we.has(Re._start)){for(var Ge=[Te=Re],ze=void 0;Te&&Te._endsWithIsolInit&&(ze=we.get(Te._end))!=null;)for(var ve=Ue+1;ve<Je.length;ve++)if(Je[ve]._start===ze){Ge.push(Te=Je[ve]);break}for(var Ne=[],Ye=0;Ye<Ge.length;Ye++)for(var $e=Ge[Ye],He=$e._start;He<=$e._end;He++)Ne.push(He);for(var je=xe[Ne[0]],K=Ie.level,he=Ne[0]-1;he>=0;he--)if(!(ee[he]&l)){K=xe[he];break}var ye=Ne[Ne.length-1],ae=xe[ye],fe=Ie.level;if(!(ee[ye]&s)){for(var Fe=ye+1;Fe<=Ie.end;Fe++)if(!(ee[Fe]&l)){fe=xe[Fe];break}}be.push({_seqIndices:Ne,_sosType:Math.max(K,je)%2?A:T,_eosType:Math.max(fe,ae)%2?A:T})}}for(var tt=0;tt<be.length;tt++){var Ke=be[tt],De=Ke._seqIndices,Xe=Ke._sosType,st=Ke._eosType;if(pe.get(N))for(var ut=0;ut<De.length;ut++){var Ct=De[ut];if(ee[Ct]&N){for(var bt=Xe,yt=ut-1;yt>=0;yt--)if(!(ee[De[yt]]&l)){bt=ee[De[yt]];break}ge(Ct,bt&(s|Q)?J:bt)}}if(pe.get(S))for(var ft=0;ft<De.length;ft++){var St=De[ft];if(ee[St]&S)for(var ot=ft-1;ot>=-1;ot--){var pt=ot===-1?Xe:ee[De[ot]];if(pt&o){pt===U&&ge(St,D);break}}}if(pe.get(U))for(var Nt=0;Nt<De.length;Nt++){var di=De[Nt];ee[di]&U&&ge(di,A)}if(pe.get(E)||pe.get(z))for(var Gt=1;Gt<De.length-1;Gt++){var Wt=De[Gt];if(ee[Wt]&(E|z)){for(var ni=0,Ft=0,$t=Gt-1;$t>=0&&(ni=ee[De[$t]],!!(ni&l));$t--);for(var $i=Gt+1;$i<De.length&&(Ft=ee[De[$i]],!!(Ft&l));$i++);ni===Ft&&(ee[Wt]===E?ni===S:ni&(S|D))&&ge(Wt,ni)}}if(pe.get(S))for(var Kt=0;Kt<De.length;Kt++){var nn=De[Kt];if(ee[nn]&S){for(var fo=Kt-1;fo>=0&&ee[De[fo]]&(R|l);fo--)ge(De[fo],S);for(var Ls=Kt+1;Ls<De.length&&ee[De[Ls]]&(R|l);Ls++)ge(De[Ls],S)}}if(pe.get(R)||pe.get(E)||pe.get(z))for(var kt=0;kt<De.length;kt++){var a_=De[kt];if(ee[a_]&(R|E|z)){ge(a_,J);for(var nd=kt-1;nd>=0&&ee[De[nd]]&l;nd--)ge(De[nd],J);for(var sd=kt+1;sd<De.length&&ee[De[sd]]&l;sd++)ge(De[sd],J)}}if(pe.get(S))for(var Mm=0,l_=Xe;Mm<De.length;Mm++){var c_=De[Mm],Am=ee[c_];Am&S?l_===T&&ge(c_,T):Am&o&&(l_=Am)}if(pe.get(a)){var nu=A|S|D,u_=nu|T,od=[];{for(var El=[],Tl=0;Tl<De.length;Tl++)if(ee[De[Tl]]&a){var su=H[De[Tl]],h_=void 0;if(_(su)!==null)if(El.length<63)El.push({char:su,seqIndex:Tl});else break;else if((h_=w(su))!==null)for(var ou=El.length-1;ou>=0;ou--){var Cm=El[ou].char;if(Cm===h_||Cm===w(b(su))||_(b(Cm))===su){od.push([El[ou].seqIndex,Tl]),El.length=ou;break}}}od.sort(function(nr,Zn){return nr[0]-Zn[0]})}for(var Dm=0;Dm<od.length;Dm++){for(var d_=od[Dm],au=d_[0],ad=d_[1],p_=!1,Kn=0,Pm=au+1;Pm<ad;Pm++){var Rm=De[Pm];if(ee[Rm]&u_){p_=!0;var f_=ee[Rm]&nu?A:T;if(f_===Ml(Rm)){Kn=f_;break}}}if(p_&&!Kn){Kn=Xe;for(var Lm=au-1;Lm>=0;Lm--){var ld=De[Lm];if(ee[ld]&u_){var m_=ee[ld]&nu?A:T;m_!==Ml(ld)?Kn=m_:Kn=Ml(ld);break}}}if(Kn){if(ee[De[au]]=ee[De[ad]]=Kn,Kn!==Ml(De[au])){for(var lu=au+1;lu<De.length;lu++)if(!(ee[De[lu]]&l)){d(H[De[lu]])&N&&(ee[De[lu]]=Kn);break}}if(Kn!==Ml(De[ad])){for(var cu=ad+1;cu<De.length;cu++)if(!(ee[De[cu]]&l)){d(H[De[cu]])&N&&(ee[De[cu]]=Kn);break}}}}for(var mo=0;mo<De.length;mo++)if(ee[De[mo]]&a){for(var g_=mo,Om=mo,Im=Xe,uu=mo-1;uu>=0;uu--)if(ee[De[uu]]&l)g_=uu;else{Im=ee[De[uu]]&nu?A:T;break}for(var v_=st,hu=mo+1;hu<De.length;hu++)if(ee[De[hu]]&(a|l))Om=hu;else{v_=ee[De[hu]]&nu?A:T;break}for(var cd=g_;cd<=Om;cd++)ee[De[cd]]=Im===v_?Im:Ml(De[cd]);mo=Om}}}for(var sn=Ie.start;sn<=Ie.end;sn++){var RA=xe[sn],ud=ee[sn];if(RA&1?ud&(T|S|D)&&xe[sn]++:ud&A?xe[sn]++:ud&(D|S)&&(xe[sn]+=2),ud&l&&(xe[sn]=sn===0?Ie.level:xe[sn-1]),sn===Ie.end||d(H[sn])&(G|L))for(var hd=sn;hd>=0&&d(H[hd])&c;hd--)xe[hd]=Ie.level}}return{levels:xe,paragraphs:_e};function y_(nr,Zn){for(var Nr=nr;Nr<H.length;Nr++){var go=ee[Nr];if(go&(A|U))return 1;if(go&(L|T)||Zn&&go===Q)return 0;if(go&s){var x_=LA(Nr);Nr=x_===-1?H.length:x_}}return 0}function LA(nr){for(var Zn=1,Nr=nr+1;Nr<H.length;Nr++){var go=ee[Nr];if(go&L)break;if(go&Q){if(--Zn===0)return Nr}else go&s&&Zn++}return-1}function Ml(nr){return xe[nr]&1?A:T}}var re="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Z;function V(){if(!Z){var H=v(re,!0),q=H.map,I=H.reverseMap;I.forEach(function(ee,me){q.set(me,ee)}),Z=q}}function ne(H){return V(),Z.get(H)||null}function ie(H,q,I,ee){var me=H.length;I=Math.max(0,I==null?0:+I),ee=Math.min(me-1,ee==null?me-1:+ee);for(var pe=new Map,ge=I;ge<=ee;ge++)if(q[ge]&1){var xe=ne(H[ge]);xe!==null&&pe.set(ge,xe)}return pe}function te(H,q,I,ee){var me=H.length;I=Math.max(0,I==null?0:+I),ee=Math.min(me-1,ee==null?me-1:+ee);var pe=[];return q.paragraphs.forEach(function(ge){var xe=Math.max(I,ge.start),we=Math.min(ee,ge.end);if(xe<we){for(var _e=q.levels.slice(xe,we+1),Ie=we;Ie>=xe&&d(H[Ie])&c;Ie--)_e[Ie]=ge.level;for(var Be=ge.level,Ae=1/0,it=0;it<_e.length;it++){var se=_e[it];se>Be&&(Be=se),se<Ae&&(Ae=se|1)}for(var Le=Be;Le>=Ae;Le--)for(var Ee=0;Ee<_e.length;Ee++)if(_e[Ee]>=Le){for(var ke=Ee;Ee+1<_e.length&&_e[Ee+1]>=Le;)Ee++;Ee>ke&&pe.push([ke+I,Ee+I])}}}),pe}function j(H,q,I,ee){var me=W(H,q,I,ee),pe=[].concat(H);return me.forEach(function(ge,xe){pe[xe]=(q.levels[ge]&1?ne(H[ge]):null)||H[ge]}),pe.join("")}function W(H,q,I,ee){for(var me=te(H,q,I,ee),pe=[],ge=0;ge<H.length;ge++)pe[ge]=ge;return me.forEach(function(xe){for(var we=xe[0],_e=xe[1],Ie=pe.slice(we,_e+1),Be=Ie.length;Be--;)pe[_e-Be]=Ie[Be]}),pe}return e.closingToOpeningBracket=w,e.getBidiCharType=d,e.getBidiCharTypeName=p,e.getCanonicalBracket=b,e.getEmbeddingLevels=Y,e.getMirroredCharacter=ne,e.getMirroredCharactersMap=ie,e.getReorderSegments=te,e.getReorderedIndices=W,e.getReorderedString=j,e.openingToClosingBracket=_,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}var bA=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Bx(n){let e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(i,r){let s=xt[r];return s?Bx(s):i}return n.replace(e,t)}var Qi=[];for(let n=0;n<256;n++)Qi[n]=(n<16?"0":"")+n.toString(16);function oN(){let n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Qi[n&255]+Qi[n>>8&255]+Qi[n>>16&255]+Qi[n>>24&255]+"-"+Qi[e&255]+Qi[e>>8&255]+"-"+Qi[e>>16&15|64]+Qi[e>>24&255]+"-"+Qi[t&63|128]+Qi[t>>8&255]+"-"+Qi[t>>16&255]+Qi[t>>24&255]+Qi[i&255]+Qi[i>>8&255]+Qi[i>>16&255]+Qi[i>>24&255]).toUpperCase()}var Wa=Object.assign||function(){let n=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let i=arguments[e];if(i)for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},aN=Date.now(),iM=new WeakMap,rM=new Map,lN=1e10;function Nx(n,e){let t=dN(e),i=iM.get(n);if(i||iM.set(n,i=Object.create(null)),i[t])return new i[t];let r=`_onBeforeCompile${t}`,s=function(c,u){n.onBeforeCompile.call(this,c,u);let h=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader,d=rM[h];if(!d){let p=cN(this,c,e,t);d=rM[h]=p}c.vertexShader=d.vertexShader,c.fragmentShader=d.fragmentShader,Wa(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-aN}}),this[r]&&this[r](c)},o=function(){return a(e.chained?n:n.clone())},a=function(c){let u=Object.create(c,l);return Object.defineProperty(u,"baseMaterial",{value:n}),Object.defineProperty(u,"id",{value:lN++}),u.uuid=oN(),u.uniforms=Wa({},c.uniforms,e.uniforms),u.defines=Wa({},c.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",u.extensions=Wa({},c.extensions,e.extensions),u._listeners=void 0,u},l={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return s},set(c){this[r]=c}},copy:{writable:!0,configurable:!0,value:function(c){return n.copy.call(this,c),!n.isShaderMaterial&&!n.isDerivedMaterial&&(Wa(this.extensions,c.extensions),Wa(this.defines,c.defines),Wa(this.uniforms,NM.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){let c=new n.constructor;return a(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=Nx(n.isDerivedMaterial?n.getDepthMaterial():new Bf({depthPacking:OM}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=Nx(n.isDerivedMaterial?n.getDistanceMaterial():new Nf,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){let{_depthMaterial:c,_distanceMaterial:u}=this;c&&c.dispose(),u&&u.dispose(),n.dispose.call(this)}}};return i[t]=o,new o}function cN(n,{vertexShader:e,fragmentShader:t},i,r){let{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:h,fragmentColorTransform:d,customRewriter:p,timeUniform:f}=i;if(s=s||"",o=o||"",a=a||"",c=c||"",u=u||"",h=h||"",(l||p)&&(e=Bx(e)),(d||p)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=Bx(t)),p){let v=p({vertexShader:e,fragmentShader:t});e=v.vertexShader,t=v.fragmentShader}if(d){let v=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,g=>(v.push(g),"")),h=`${d}
${v.join(`
`)}
${h}`}if(f){let v=`
uniform float ${f};
`;s=v+s,c=v+c}return l&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,s=`${s}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,o=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(v,g,m,x)=>/\battribute\s+vec[23]\s+$/.test(x.substr(0,m))?g:`troika_${g}_${r}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=nM(e,r,s,o,a),t=nM(t,r,c,u,h),{vertexShader:e,fragmentShader:t}}function nM(n,e,t,i,r){return(i||r||t)&&(n=n.replace(bA,`
${t}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${i}
  troikaOrigMain${e}();
  ${r}
}`),n}function uN(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}var hN=0,sM=new Map;function dN(n){let e=JSON.stringify(n,uN),t=sM.get(e);return t==null&&sM.set(e,t=++hN),t}function pN(){return typeof window>"u"&&(self.window=self),function(n){var e={parse:function(r){var s=e._bin,o=new Uint8Array(r);if(s.readASCII(o,0,4)=="ttcf"){var a=4;s.readUshort(o,a),a+=2,s.readUshort(o,a),a+=2;var l=s.readUint(o,a);a+=4;for(var c=[],u=0;u<l;u++){var h=s.readUint(o,a);a+=4,c.push(e._readFont(o,h))}return c}return[e._readFont(o,0)]},_readFont:function(r,s){var o=e._bin,a=s;o.readFixed(r,s),s+=4;var l=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:r,_offset:a},h={},d=0;d<l;d++){var p=o.readASCII(r,s,4);s+=4,o.readUint(r,s),s+=4;var f=o.readUint(r,s);s+=4;var v=o.readUint(r,s);s+=4,h[p]={offset:f,length:v}}for(d=0;d<c.length;d++){var g=c[d];h[g]&&(u[g.trim()]=e[g.trim()].parse(r,h[g].offset,h[g].length,u))}return u},_tabOffset:function(r,s,o){for(var a=e._bin,l=a.readUshort(r,o+4),c=o+12,u=0;u<l;u++){var h=a.readASCII(r,c,4);c+=4,a.readUint(r,c),c+=4;var d=a.readUint(r,c);if(c+=4,a.readUint(r,c),c+=4,h==s)return d}return 0}};e._bin={readFixed:function(r,s){return(r[s]<<8|r[s+1])+(r[s+2]<<8|r[s+3])/65540},readF2dot14:function(r,s){return e._bin.readShort(r,s)/16384},readInt:function(r,s){return e._bin._view(r).getInt32(s)},readInt8:function(r,s){return e._bin._view(r).getInt8(s)},readShort:function(r,s){return e._bin._view(r).getInt16(s)},readUshort:function(r,s){return e._bin._view(r).getUint16(s)},readUshorts:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(e._bin.readUshort(r,s+2*l));return a},readUint:function(r,s){return e._bin._view(r).getUint32(s)},readUint64:function(r,s){return 4294967296*e._bin.readUint(r,s)+e._bin.readUint(r,s+4)},readASCII:function(r,s,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(r[s+l]);return a},readUnicode:function(r,s,o){for(var a="",l=0;l<o;l++){var c=r[s++]<<8|r[s++];a+=String.fromCharCode(c)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,s,o){var a=e._bin._tdec;return a&&s==0&&o==r.length?a.decode(r):e._bin.readASCII(r,s,o)},readBytes:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(r[s+l]);return a},readASCIIArray:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(String.fromCharCode(r[s+l]));return a},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,s,o,a,l){var c=e._bin,u={},h=s;c.readFixed(r,s),s+=4;var d=c.readUshort(r,s);s+=2;var p=c.readUshort(r,s);s+=2;var f=c.readUshort(r,s);return s+=2,u.scriptList=e._lctf.readScriptList(r,h+d),u.featureList=e._lctf.readFeatureList(r,h+p),u.lookupList=e._lctf.readLookupList(r,h+f,l),u},e._lctf.readLookupList=function(r,s,o){var a=e._bin,l=s,c=[],u=a.readUshort(r,s);s+=2;for(var h=0;h<u;h++){var d=a.readUshort(r,s);s+=2;var p=e._lctf.readLookupTable(r,l+d,o);c.push(p)}return c},e._lctf.readLookupTable=function(r,s,o){var a=e._bin,l=s,c={tabs:[]};c.ltype=a.readUshort(r,s),s+=2,c.flag=a.readUshort(r,s),s+=2;var u=a.readUshort(r,s);s+=2;for(var h=c.ltype,d=0;d<u;d++){var p=a.readUshort(r,s);s+=2;var f=o(r,h,l+p,c);c.tabs.push(f)}return c},e._lctf.numOfOnes=function(r){for(var s=0,o=0;o<32;o++)r>>>o&1&&s++;return s},e._lctf.readClassDef=function(r,s){var o=e._bin,a=[],l=o.readUshort(r,s);if(s+=2,l==1){var c=o.readUshort(r,s);s+=2;var u=o.readUshort(r,s);s+=2;for(var h=0;h<u;h++)a.push(c+h),a.push(c+h),a.push(o.readUshort(r,s)),s+=2}if(l==2){var d=o.readUshort(r,s);for(s+=2,h=0;h<d;h++)a.push(o.readUshort(r,s)),s+=2,a.push(o.readUshort(r,s)),s+=2,a.push(o.readUshort(r,s)),s+=2}return a},e._lctf.getInterval=function(r,s){for(var o=0;o<r.length;o+=3){var a=r[o],l=r[o+1];if(r[o+2],a<=s&&s<=l)return o}return-1},e._lctf.readCoverage=function(r,s){var o=e._bin,a={};a.fmt=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);return s+=2,a.fmt==1&&(a.tab=o.readUshorts(r,s,l)),a.fmt==2&&(a.tab=o.readUshorts(r,s,3*l)),a},e._lctf.coverageIndex=function(r,s){var o=r.tab;if(r.fmt==1)return o.indexOf(s);if(r.fmt==2){var a=e._lctf.getInterval(o,s);if(a!=-1)return o[a+2]+(s-o[a])}return-1},e._lctf.readFeatureList=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readASCII(r,s,4);s+=4;var d=o.readUshort(r,s);s+=2;var p=e._lctf.readFeatureTable(r,a+d);p.tag=h.trim(),l.push(p)}return l},e._lctf.readFeatureTable=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2,c>0&&(l.featureParams=a+c);var u=o.readUshort(r,s);s+=2,l.tab=[];for(var h=0;h<u;h++)l.tab.push(o.readUshort(r,s+2*h));return l},e._lctf.readScriptList=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readASCII(r,s,4);s+=4;var d=o.readUshort(r,s);s+=2,l[h.trim()]=e._lctf.readScriptTable(r,a+d)}return l},e._lctf.readScriptTable=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2,c>0&&(l.default=e._lctf.readLangSysTable(r,a+c));var u=o.readUshort(r,s);s+=2;for(var h=0;h<u;h++){var d=o.readASCII(r,s,4);s+=4;var p=o.readUshort(r,s);s+=2,l[d.trim()]=e._lctf.readLangSysTable(r,a+p)}return l},e._lctf.readLangSysTable=function(r,s){var o=e._bin,a={};o.readUshort(r,s),s+=2,a.reqFeature=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);return s+=2,a.features=o.readUshorts(r,s,l),a},e.CFF={},e.CFF.parse=function(r,s,o){var a=e._bin;(r=new Uint8Array(r.buffer,s,o))[s=0],r[++s],r[++s],r[++s],s++;var l=[];s=e.CFF.readIndex(r,s,l);for(var c=[],u=0;u<l.length-1;u++)c.push(a.readASCII(r,s+l[u],l[u+1]-l[u]));s+=l[l.length-1];var h=[];s=e.CFF.readIndex(r,s,h);var d=[];for(u=0;u<h.length-1;u++)d.push(e.CFF.readDict(r,s+h[u],s+h[u+1]));s+=h[h.length-1];var p=d[0],f=[];s=e.CFF.readIndex(r,s,f);var v=[];for(u=0;u<f.length-1;u++)v.push(a.readASCII(r,s+f[u],f[u+1]-f[u]));if(s+=f[f.length-1],e.CFF.readSubrs(r,s,p),p.CharStrings){s=p.CharStrings,f=[],s=e.CFF.readIndex(r,s,f);var g=[];for(u=0;u<f.length-1;u++)g.push(a.readBytes(r,s+f[u],f[u+1]-f[u]));p.CharStrings=g}if(p.ROS){s=p.FDArray;var m=[];for(s=e.CFF.readIndex(r,s,m),p.FDArray=[],u=0;u<m.length-1;u++){var x=e.CFF.readDict(r,s+m[u],s+m[u+1]);e.CFF._readFDict(r,x,v),p.FDArray.push(x)}s+=m[m.length-1],s=p.FDSelect,p.FDSelect=[];var y=r[s];if(s++,y!=3)throw y;var _=a.readUshort(r,s);for(s+=2,u=0;u<_+1;u++)p.FDSelect.push(a.readUshort(r,s),r[s+2]),s+=3}return p.Encoding&&(p.Encoding=e.CFF.readEncoding(r,p.Encoding,p.CharStrings.length)),p.charset&&(p.charset=e.CFF.readCharset(r,p.charset,p.CharStrings.length)),e.CFF._readFDict(r,p,v),p},e.CFF._readFDict=function(r,s,o){var a;for(var l in s.Private&&(a=s.Private[1],s.Private=e.CFF.readDict(r,a,a+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(r,a+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(s[l]=o[s[l]-426+35])},e.CFF.readSubrs=function(r,s,o){var a=e._bin,l=[];s=e.CFF.readIndex(r,s,l);var c,u=l.length;c=u<1240?107:u<33900?1131:32768,o.Bias=c,o.Subrs=[];for(var h=0;h<l.length-1;h++)o.Subrs.push(a.readBytes(r,s+l[h],l[h+1]-l[h]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,s){for(var o=0;o<r.charset.length;o++)if(r.charset[o]==s)return o;return-1},e.CFF.glyphBySE=function(r,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[s])},e.CFF.readEncoding=function(r,s,o){e._bin;var a=[".notdef"],l=r[s];if(s++,l!=0)throw"error: unknown encoding format: "+l;var c=r[s];s++;for(var u=0;u<c;u++)a.push(r[s+u]);return a},e.CFF.readCharset=function(r,s,o){var a=e._bin,l=[".notdef"],c=r[s];if(s++,c==0)for(var u=0;u<o;u++){var h=a.readUshort(r,s);s+=2,l.push(h)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<o;){h=a.readUshort(r,s),s+=2;var d=0;for(c==1?(d=r[s],s++):(d=a.readUshort(r,s),s+=2),u=0;u<=d;u++)l.push(h),h++}}return l},e.CFF.readIndex=function(r,s,o){var a=e._bin,l=a.readUshort(r,s)+1,c=r[s+=2];if(s++,c==1)for(var u=0;u<l;u++)o.push(r[s+u]);else if(c==2)for(u=0;u<l;u++)o.push(a.readUshort(r,s+2*u));else if(c==3)for(u=0;u<l;u++)o.push(16777215&a.readUint(r,s+3*u-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(s+=l*c)-1},e.CFF.getCharString=function(r,s,o){var a=e._bin,l=r[s],c=r[s+1];r[s+2],r[s+3],r[s+4];var u=1,h=null,d=null;l<=20&&(h=l,u=1),l==12&&(h=100*l+c,u=2),21<=l&&l<=27&&(h=l,u=1),l==28&&(d=a.readShort(r,s+1),u=3),29<=l&&l<=31&&(h=l,u=1),32<=l&&l<=246&&(d=l-139,u=1),247<=l&&l<=250&&(d=256*(l-247)+c+108,u=2),251<=l&&l<=254&&(d=256*-(l-251)-c-108,u=2),l==255&&(d=a.readInt(r,s+1)/65535,u=5),o.val=d!=null?d:"o"+h,o.size=u},e.CFF.readCharString=function(r,s,o){for(var a=s+o,l=e._bin,c=[];s<a;){var u=r[s],h=r[s+1];r[s+2],r[s+3],r[s+4];var d=1,p=null,f=null;u<=20&&(p=u,d=1),u==12&&(p=100*u+h,d=2),u!=19&&u!=20||(p=u,d=2),21<=u&&u<=27&&(p=u,d=1),u==28&&(f=l.readShort(r,s+1),d=3),29<=u&&u<=31&&(p=u,d=1),32<=u&&u<=246&&(f=u-139,d=1),247<=u&&u<=250&&(f=256*(u-247)+h+108,d=2),251<=u&&u<=254&&(f=256*-(u-251)-h-108,d=2),u==255&&(f=l.readInt(r,s+1)/65535,d=5),c.push(f!=null?f:"o"+p),s+=d}return c},e.CFF.readDict=function(r,s,o){for(var a=e._bin,l={},c=[];s<o;){var u=r[s],h=r[s+1];r[s+2],r[s+3],r[s+4];var d=1,p=null,f=null;if(u==28&&(f=a.readShort(r,s+1),d=3),u==29&&(f=a.readInt(r,s+1),d=5),32<=u&&u<=246&&(f=u-139,d=1),247<=u&&u<=250&&(f=256*(u-247)+h+108,d=2),251<=u&&u<=254&&(f=256*-(u-251)-h-108,d=2),u==255)throw f=a.readInt(r,s+1)/65535,d=5,"unknown number";if(u==30){var v=[];for(d=1;;){var g=r[s+d];d++;var m=g>>4,x=15&g;if(m!=15&&v.push(m),x!=15&&v.push(x),x==15)break}for(var y="",_=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],w=0;w<v.length;w++)y+=_[v[w]];f=parseFloat(y)}u<=21&&(p=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],d=1,u==12&&(p=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][h],d=2)),p!=null?(l[p]=c.length==1?c[0]:c,c=[]):c.push(f),s+=d}return l},e.cmap={},e.cmap.parse=function(r,s,o){r=new Uint8Array(r.buffer,s,o),s=0;var a=e._bin,l={};a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2;var u=[];l.tables=[];for(var h=0;h<c;h++){var d=a.readUshort(r,s);s+=2;var p=a.readUshort(r,s);s+=2;var f=a.readUint(r,s);s+=4;var v="p"+d+"e"+p,g=u.indexOf(f);if(g==-1){var m;g=l.tables.length,u.push(f);var x=a.readUshort(r,f);x==0?m=e.cmap.parse0(r,f):x==4?m=e.cmap.parse4(r,f):x==6?m=e.cmap.parse6(r,f):x==12?m=e.cmap.parse12(r,f):console.debug("unknown format: "+x,d,p,f),l.tables.push(m)}if(l[v]!=null)throw"multiple tables for one platform+encoding";l[v]=g}return l},e.cmap.parse0=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,a.map=[];for(var c=0;c<l-6;c++)a.map.push(r[s+c]);return a},e.cmap.parse4=function(r,s){var o=e._bin,a=s,l={};l.format=o.readUshort(r,s),s+=2;var c=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2;var u=o.readUshort(r,s);s+=2;var h=u/2;l.searchRange=o.readUshort(r,s),s+=2,l.entrySelector=o.readUshort(r,s),s+=2,l.rangeShift=o.readUshort(r,s),s+=2,l.endCount=o.readUshorts(r,s,h),s+=2*h,s+=2,l.startCount=o.readUshorts(r,s,h),s+=2*h,l.idDelta=[];for(var d=0;d<h;d++)l.idDelta.push(o.readShort(r,s)),s+=2;for(l.idRangeOffset=o.readUshorts(r,s,h),s+=2*h,l.glyphIdArray=[];s<a+c;)l.glyphIdArray.push(o.readUshort(r,s)),s+=2;return l},e.cmap.parse6=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,a.firstCode=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2,a.glyphIdArray=[];for(var c=0;c<l;c++)a.glyphIdArray.push(o.readUshort(r,s)),s+=2;return a},e.cmap.parse12=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2,s+=2,o.readUint(r,s),s+=4,o.readUint(r,s),s+=4;var l=o.readUint(r,s);s+=4,a.groups=[];for(var c=0;c<l;c++){var u=s+12*c,h=o.readUint(r,u+0),d=o.readUint(r,u+4),p=o.readUint(r,u+8);a.groups.push([h,d,p])}return a},e.glyf={},e.glyf.parse=function(r,s,o,a){for(var l=[],c=0;c<a.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(r,s){var o=e._bin,a=r._data,l=e._tabOffset(a,"glyf",r._offset)+r.loca[s];if(r.loca[s]==r.loca[s+1])return null;var c={};if(c.noc=o.readShort(a,l),l+=2,c.xMin=o.readShort(a,l),l+=2,c.yMin=o.readShort(a,l),l+=2,c.xMax=o.readShort(a,l),l+=2,c.yMax=o.readShort(a,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var u=0;u<c.noc;u++)c.endPts.push(o.readUshort(a,l)),l+=2;var h=o.readUshort(a,l);if(l+=2,a.length-l<h)return null;c.instructions=o.readBytes(a,l,h),l+=h;var d=c.endPts[c.noc-1]+1;for(c.flags=[],u=0;u<d;u++){var p=a[l];if(l++,c.flags.push(p),(8&p)!=0){var f=a[l];l++;for(var v=0;v<f;v++)c.flags.push(p),u++}}for(c.xs=[],u=0;u<d;u++){var g=(2&c.flags[u])!=0,m=(16&c.flags[u])!=0;g?(c.xs.push(m?a[l]:-a[l]),l++):m?c.xs.push(0):(c.xs.push(o.readShort(a,l)),l+=2)}for(c.ys=[],u=0;u<d;u++)g=(4&c.flags[u])!=0,m=(32&c.flags[u])!=0,g?(c.ys.push(m?a[l]:-a[l]),l++):m?c.ys.push(0):(c.ys.push(o.readShort(a,l)),l+=2);var x=0,y=0;for(u=0;u<d;u++)x+=c.xs[u],y+=c.ys[u],c.xs[u]=x,c.ys[u]=y}else{var _;c.parts=[];do{_=o.readUshort(a,l),l+=2;var w={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(w),w.glyphIndex=o.readUshort(a,l),l+=2,1&_){var b=o.readShort(a,l);l+=2;var T=o.readShort(a,l);l+=2}else b=o.readInt8(a,l),l++,T=o.readInt8(a,l),l++;2&_?(w.m.tx=b,w.m.ty=T):(w.p1=b,w.p2=T),8&_?(w.m.a=w.m.d=o.readF2dot14(a,l),l+=2):64&_?(w.m.a=o.readF2dot14(a,l),l+=2,w.m.d=o.readF2dot14(a,l),l+=2):128&_&&(w.m.a=o.readF2dot14(a,l),l+=2,w.m.b=o.readF2dot14(a,l),l+=2,w.m.c=o.readF2dot14(a,l),l+=2,w.m.d=o.readF2dot14(a,l),l+=2)}while(32&_);if(256&_){var A=o.readUshort(a,l);for(l+=2,c.instr=[],u=0;u<A;u++)c.instr.push(a[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(r,s,o,a){var l=s;s+=4;var c=e._bin.readUshort(r,s);return{glyphClassDef:c===0?null:e._lctf.readClassDef(r,l+c)}},e.GPOS={},e.GPOS.parse=function(r,s,o,a){return e._lctf.parse(r,s,o,a,e.GPOS.subt)},e.GPOS.subt=function(r,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(r,o),o+=2,s==1||s==2||s==3||s==7||s==8&&u.fmt<=2){var h=l.readUshort(r,o);o+=2,u.coverage=e._lctf.readCoverage(r,h+c)}if(s==1&&u.fmt==1){var d=l.readUshort(r,o);o+=2,d!=0&&(u.pos=e.GPOS.readValueRecord(r,o,d))}else if(s==2&&u.fmt>=1&&u.fmt<=2){d=l.readUshort(r,o),o+=2;var p=l.readUshort(r,o);o+=2;var f=e._lctf.numOfOnes(d),v=e._lctf.numOfOnes(p);if(u.fmt==1){u.pairsets=[];var g=l.readUshort(r,o);o+=2;for(var m=0;m<g;m++){var x=c+l.readUshort(r,o);o+=2;var y=l.readUshort(r,x);x+=2;for(var _=[],w=0;w<y;w++){var b=l.readUshort(r,x);x+=2,d!=0&&(D=e.GPOS.readValueRecord(r,x,d),x+=2*f),p!=0&&(z=e.GPOS.readValueRecord(r,x,p),x+=2*v),_.push({gid2:b,val1:D,val2:z})}u.pairsets.push(_)}}if(u.fmt==2){var T=l.readUshort(r,o);o+=2;var A=l.readUshort(r,o);o+=2;var S=l.readUshort(r,o);o+=2;var E=l.readUshort(r,o);for(o+=2,u.classDef1=e._lctf.readClassDef(r,c+T),u.classDef2=e._lctf.readClassDef(r,c+A),u.matrix=[],m=0;m<S;m++){var R=[];for(w=0;w<E;w++){var D=null,z=null;d!=0&&(D=e.GPOS.readValueRecord(r,o,d),o+=2*f),p!=0&&(z=e.GPOS.readValueRecord(r,o,p),o+=2*v),R.push({val1:D,val2:z})}u.matrix.push(R)}}}else if(s==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(r,l.readUshort(r,o)+c),u.baseCoverage=e._lctf.readCoverage(r,l.readUshort(r,o+2)+c),u.markClassCount=l.readUshort(r,o+4),u.markArray=e.GPOS.readMarkArray(r,l.readUshort(r,o+6)+c),u.baseArray=e.GPOS.readBaseArray(r,l.readUshort(r,o+8)+c,u.markClassCount);else if(s==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(r,l.readUshort(r,o)+c),u.mark2Coverage=e._lctf.readCoverage(r,l.readUshort(r,o+2)+c),u.markClassCount=l.readUshort(r,o+4),u.mark1Array=e.GPOS.readMarkArray(r,l.readUshort(r,o+6)+c),u.mark2Array=e.GPOS.readBaseArray(r,l.readUshort(r,o+8)+c,u.markClassCount);else{if(s==9&&u.fmt==1){var L=l.readUshort(r,o);o+=2;var G=l.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=L;else if(a.ltype!=L)throw"invalid extension substitution";return e.GPOS.subt(r,a.ltype,c+G)}console.debug("unsupported GPOS table LookupType",s,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(r,s,o){var a=e._bin,l=[];return l.push(1&o?a.readShort(r,s):0),s+=1&o?2:0,l.push(2&o?a.readShort(r,s):0),s+=2&o?2:0,l.push(4&o?a.readShort(r,s):0),s+=4&o?2:0,l.push(8&o?a.readShort(r,s):0),s+=8&o?2:0,l},e.GPOS.readBaseArray=function(r,s,o){var a=e._bin,l=[],c=s,u=a.readUshort(r,s);s+=2;for(var h=0;h<u;h++){for(var d=[],p=0;p<o;p++)d.push(e.GPOS.readAnchorRecord(r,c+a.readUshort(r,s))),s+=2;l.push(d)}return l},e.GPOS.readMarkArray=function(r,s){var o=e._bin,a=[],l=s,c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=e.GPOS.readAnchorRecord(r,o.readUshort(r,s+2)+l);h.markClass=o.readUshort(r,s),a.push(h),s+=4}return a},e.GPOS.readAnchorRecord=function(r,s){var o=e._bin,a={};return a.fmt=o.readUshort(r,s),a.x=o.readShort(r,s+2),a.y=o.readShort(r,s+4),a},e.GSUB={},e.GSUB.parse=function(r,s,o,a){return e._lctf.parse(r,s,o,a,e.GSUB.subt)},e.GSUB.subt=function(r,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(r,o),o+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&u.fmt<=2||s==6&&u.fmt<=2){var h=l.readUshort(r,o);o+=2,u.coverage=e._lctf.readCoverage(r,c+h)}if(s==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=l.readShort(r,o),o+=2;else if(u.fmt==2){var d=l.readUshort(r,o);o+=2,u.newg=l.readUshorts(r,o,d),o+=2*u.newg.length}}else if(s==2&&u.fmt==1){d=l.readUshort(r,o),o+=2,u.seqs=[];for(var p=0;p<d;p++){var f=l.readUshort(r,o)+c;o+=2;var v=l.readUshort(r,f);u.seqs.push(l.readUshorts(r,f+2,v))}}else if(s==4)for(u.vals=[],d=l.readUshort(r,o),o+=2,p=0;p<d;p++){var g=l.readUshort(r,o);o+=2,u.vals.push(e.GSUB.readLigatureSet(r,c+g))}else if(s==5&&u.fmt==2){if(u.fmt==2){var m=l.readUshort(r,o);o+=2,u.cDef=e._lctf.readClassDef(r,c+m),u.scset=[];var x=l.readUshort(r,o);for(o+=2,p=0;p<x;p++){var y=l.readUshort(r,o);o+=2,u.scset.push(y==0?null:e.GSUB.readSubClassSet(r,c+y))}}}else if(s==6&&u.fmt==3){if(u.fmt==3){for(p=0;p<3;p++){d=l.readUshort(r,o),o+=2;for(var _=[],w=0;w<d;w++)_.push(e._lctf.readCoverage(r,c+l.readUshort(r,o+2*w)));o+=2*d,p==0&&(u.backCvg=_),p==1&&(u.inptCvg=_),p==2&&(u.ahedCvg=_)}d=l.readUshort(r,o),o+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(r,o,d)}}else{if(s==7&&u.fmt==1){var b=l.readUshort(r,o);o+=2;var T=l.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=b;else if(a.ltype!=b)throw"invalid extension substitution";return e.GSUB.subt(r,a.ltype,c+T)}console.debug("unsupported GSUB table LookupType",s,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(r,s){var o=e._bin.readUshort,a=s,l=[],c=o(r,s);s+=2;for(var u=0;u<c;u++){var h=o(r,s);s+=2,l.push(e.GSUB.readSubClassRule(r,a+h))}return l},e.GSUB.readSubClassRule=function(r,s){var o=e._bin.readUshort,a={},l=o(r,s),c=o(r,s+=2);s+=2,a.input=[];for(var u=0;u<l-1;u++)a.input.push(o(r,s)),s+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(r,s,c),a},e.GSUB.readSubstLookupRecords=function(r,s,o){for(var a=e._bin.readUshort,l=[],c=0;c<o;c++)l.push(a(r,s),a(r,s+2)),s+=4;return l},e.GSUB.readChainSubClassSet=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readUshort(r,s);s+=2,l.push(e.GSUB.readChainSubClassRule(r,a+h))}return l},e.GSUB.readChainSubClassRule=function(r,s){for(var o=e._bin,a={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var u=o.readUshort(r,s);s+=2,c==1&&u--,a[l[c]]=o.readUshorts(r,s,u),s+=2*a[l[c]].length}return u=o.readUshort(r,s),s+=2,a.subst=o.readUshorts(r,s,2*u),s+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readUshort(r,s);s+=2,l.push(e.GSUB.readLigature(r,a+h))}return l},e.GSUB.readLigature=function(r,s){var o=e._bin,a={chain:[]};a.nglyph=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2;for(var c=0;c<l-1;c++)a.chain.push(o.readUshort(r,s)),s+=2;return a},e.head={},e.head.parse=function(r,s,o){var a=e._bin,l={};return a.readFixed(r,s),s+=4,l.fontRevision=a.readFixed(r,s),s+=4,a.readUint(r,s),s+=4,a.readUint(r,s),s+=4,l.flags=a.readUshort(r,s),s+=2,l.unitsPerEm=a.readUshort(r,s),s+=2,l.created=a.readUint64(r,s),s+=8,l.modified=a.readUint64(r,s),s+=8,l.xMin=a.readShort(r,s),s+=2,l.yMin=a.readShort(r,s),s+=2,l.xMax=a.readShort(r,s),s+=2,l.yMax=a.readShort(r,s),s+=2,l.macStyle=a.readUshort(r,s),s+=2,l.lowestRecPPEM=a.readUshort(r,s),s+=2,l.fontDirectionHint=a.readShort(r,s),s+=2,l.indexToLocFormat=a.readShort(r,s),s+=2,l.glyphDataFormat=a.readShort(r,s),s+=2,l},e.hhea={},e.hhea.parse=function(r,s,o){var a=e._bin,l={};return a.readFixed(r,s),s+=4,l.ascender=a.readShort(r,s),s+=2,l.descender=a.readShort(r,s),s+=2,l.lineGap=a.readShort(r,s),s+=2,l.advanceWidthMax=a.readUshort(r,s),s+=2,l.minLeftSideBearing=a.readShort(r,s),s+=2,l.minRightSideBearing=a.readShort(r,s),s+=2,l.xMaxExtent=a.readShort(r,s),s+=2,l.caretSlopeRise=a.readShort(r,s),s+=2,l.caretSlopeRun=a.readShort(r,s),s+=2,l.caretOffset=a.readShort(r,s),s+=2,s+=8,l.metricDataFormat=a.readShort(r,s),s+=2,l.numberOfHMetrics=a.readUshort(r,s),s+=2,l},e.hmtx={},e.hmtx.parse=function(r,s,o,a){for(var l=e._bin,c={aWidth:[],lsBearing:[]},u=0,h=0,d=0;d<a.maxp.numGlyphs;d++)d<a.hhea.numberOfHMetrics&&(u=l.readUshort(r,s),s+=2,h=l.readShort(r,s),s+=2),c.aWidth.push(u),c.lsBearing.push(h);return c},e.kern={},e.kern.parse=function(r,s,o,a){var l=e._bin,c=l.readUshort(r,s);if(s+=2,c==1)return e.kern.parseV1(r,s-2,o,a);var u=l.readUshort(r,s);s+=2;for(var h={glyph1:[],rval:[]},d=0;d<u;d++){s+=2,o=l.readUshort(r,s),s+=2;var p=l.readUshort(r,s);s+=2;var f=p>>>8;if((f&=15)!=0)throw"unknown kern table format: "+f;s=e.kern.readFormat0(r,s,h)}return h},e.kern.parseV1=function(r,s,o,a){var l=e._bin;l.readFixed(r,s),s+=4;var c=l.readUint(r,s);s+=4;for(var u={glyph1:[],rval:[]},h=0;h<c;h++){l.readUint(r,s),s+=4;var d=l.readUshort(r,s);s+=2,l.readUshort(r,s),s+=2;var p=d>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;s=e.kern.readFormat0(r,s,u)}return u},e.kern.readFormat0=function(r,s,o){var a=e._bin,l=-1,c=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2;for(var u=0;u<c;u++){var h=a.readUshort(r,s);s+=2;var d=a.readUshort(r,s);s+=2;var p=a.readShort(r,s);s+=2,h!=l&&(o.glyph1.push(h),o.rval.push({glyph2:[],vals:[]}));var f=o.rval[o.rval.length-1];f.glyph2.push(d),f.vals.push(p),l=h}return s},e.loca={},e.loca.parse=function(r,s,o,a){var l=e._bin,c=[],u=a.head.indexToLocFormat,h=a.maxp.numGlyphs+1;if(u==0)for(var d=0;d<h;d++)c.push(l.readUshort(r,s+(d<<1))<<1);if(u==1)for(d=0;d<h;d++)c.push(l.readUint(r,s+(d<<2)));return c},e.maxp={},e.maxp.parse=function(r,s,o){var a=e._bin,l={},c=a.readUint(r,s);return s+=4,l.numGlyphs=a.readUshort(r,s),s+=2,c==65536&&(l.maxPoints=a.readUshort(r,s),s+=2,l.maxContours=a.readUshort(r,s),s+=2,l.maxCompositePoints=a.readUshort(r,s),s+=2,l.maxCompositeContours=a.readUshort(r,s),s+=2,l.maxZones=a.readUshort(r,s),s+=2,l.maxTwilightPoints=a.readUshort(r,s),s+=2,l.maxStorage=a.readUshort(r,s),s+=2,l.maxFunctionDefs=a.readUshort(r,s),s+=2,l.maxInstructionDefs=a.readUshort(r,s),s+=2,l.maxStackElements=a.readUshort(r,s),s+=2,l.maxSizeOfInstructions=a.readUshort(r,s),s+=2,l.maxComponentElements=a.readUshort(r,s),s+=2,l.maxComponentDepth=a.readUshort(r,s),s+=2),l},e.name={},e.name.parse=function(r,s,o){var a=e._bin,l={};a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2,a.readUshort(r,s);for(var u,h=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=s+=2,p=0;p<c;p++){var f=a.readUshort(r,s);s+=2;var v=a.readUshort(r,s);s+=2;var g=a.readUshort(r,s);s+=2;var m=a.readUshort(r,s);s+=2;var x=a.readUshort(r,s);s+=2;var y=a.readUshort(r,s);s+=2;var _,w=h[m],b=d+12*c+y;if(f==0)_=a.readUnicode(r,b,x/2);else if(f==3&&v==0)_=a.readUnicode(r,b,x/2);else if(v==0)_=a.readASCII(r,b,x);else if(v==1)_=a.readUnicode(r,b,x/2);else if(v==3)_=a.readUnicode(r,b,x/2);else{if(f!=1)throw"unknown encoding "+v+", platformID: "+f;_=a.readASCII(r,b,x),console.debug("reading unknown MAC encoding "+v+" as ASCII")}var T="p"+f+","+g.toString(16);l[T]==null&&(l[T]={}),l[T][w!==void 0?w:m]=_,l[T]._lang=g}for(var A in l)if(l[A].postScriptName!=null&&l[A]._lang==1033)return l[A];for(var A in l)if(l[A].postScriptName!=null&&l[A]._lang==0)return l[A];for(var A in l)if(l[A].postScriptName!=null&&l[A]._lang==3084)return l[A];for(var A in l)if(l[A].postScriptName!=null)return l[A];for(var A in l){u=A;break}return console.debug("returning name table with languageID "+l[u]._lang),l[u]},e["OS/2"]={},e["OS/2"].parse=function(r,s,o){var a=e._bin.readUshort(r,s);s+=2;var l={};if(a==0)e["OS/2"].version0(r,s,l);else if(a==1)e["OS/2"].version1(r,s,l);else if(a==2||a==3||a==4)e["OS/2"].version2(r,s,l);else{if(a!=5)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(r,s,l)}return l},e["OS/2"].version0=function(r,s,o){var a=e._bin;return o.xAvgCharWidth=a.readShort(r,s),s+=2,o.usWeightClass=a.readUshort(r,s),s+=2,o.usWidthClass=a.readUshort(r,s),s+=2,o.fsType=a.readUshort(r,s),s+=2,o.ySubscriptXSize=a.readShort(r,s),s+=2,o.ySubscriptYSize=a.readShort(r,s),s+=2,o.ySubscriptXOffset=a.readShort(r,s),s+=2,o.ySubscriptYOffset=a.readShort(r,s),s+=2,o.ySuperscriptXSize=a.readShort(r,s),s+=2,o.ySuperscriptYSize=a.readShort(r,s),s+=2,o.ySuperscriptXOffset=a.readShort(r,s),s+=2,o.ySuperscriptYOffset=a.readShort(r,s),s+=2,o.yStrikeoutSize=a.readShort(r,s),s+=2,o.yStrikeoutPosition=a.readShort(r,s),s+=2,o.sFamilyClass=a.readShort(r,s),s+=2,o.panose=a.readBytes(r,s,10),s+=10,o.ulUnicodeRange1=a.readUint(r,s),s+=4,o.ulUnicodeRange2=a.readUint(r,s),s+=4,o.ulUnicodeRange3=a.readUint(r,s),s+=4,o.ulUnicodeRange4=a.readUint(r,s),s+=4,o.achVendID=[a.readInt8(r,s),a.readInt8(r,s+1),a.readInt8(r,s+2),a.readInt8(r,s+3)],s+=4,o.fsSelection=a.readUshort(r,s),s+=2,o.usFirstCharIndex=a.readUshort(r,s),s+=2,o.usLastCharIndex=a.readUshort(r,s),s+=2,o.sTypoAscender=a.readShort(r,s),s+=2,o.sTypoDescender=a.readShort(r,s),s+=2,o.sTypoLineGap=a.readShort(r,s),s+=2,o.usWinAscent=a.readUshort(r,s),s+=2,o.usWinDescent=a.readUshort(r,s),s+=2},e["OS/2"].version1=function(r,s,o){var a=e._bin;return s=e["OS/2"].version0(r,s,o),o.ulCodePageRange1=a.readUint(r,s),s+=4,o.ulCodePageRange2=a.readUint(r,s),s+=4},e["OS/2"].version2=function(r,s,o){var a=e._bin;return s=e["OS/2"].version1(r,s,o),o.sxHeight=a.readShort(r,s),s+=2,o.sCapHeight=a.readShort(r,s),s+=2,o.usDefault=a.readUshort(r,s),s+=2,o.usBreak=a.readUshort(r,s),s+=2,o.usMaxContext=a.readUshort(r,s),s+=2},e["OS/2"].version5=function(r,s,o){var a=e._bin;return s=e["OS/2"].version2(r,s,o),o.usLowerOpticalPointSize=a.readUshort(r,s),s+=2,o.usUpperOpticalPointSize=a.readUshort(r,s),s+=2},e.post={},e.post.parse=function(r,s,o){var a=e._bin,l={};return l.version=a.readFixed(r,s),s+=4,l.italicAngle=a.readFixed(r,s),s+=4,l.underlinePosition=a.readShort(r,s),s+=2,l.underlineThickness=a.readShort(r,s),s+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,s){var o=r.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var l=o.tables[a];if(l.format==0)return s>=l.map.length?0:l.map[s];if(l.format==4){for(var c=-1,u=0;u<l.endCount.length;u++)if(s<=l.endCount[u]){c=u;break}return c==-1||l.startCount[c]>s?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[s-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:s+l.idDelta[c])}if(l.format==12){if(s>l.groups[l.groups.length-1][1])return 0;for(u=0;u<l.groups.length;u++){var h=l.groups[u];if(h[0]<=s&&s<=h[1])return h[2]+(s-h[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(r,s){var o={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[s]){var a=r.SVG.entries[s];return a==null?o:(typeof a=="string"&&(a=e.SVG.toPath(a),r.SVG.entries[s]=a),a)}if(r.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},c=r.CFF,u=r.CFF.Private;if(c.ROS){for(var h=0;c.FDSelect[h+2]<=s;)h+=2;u=c.FDArray[c.FDSelect[h+1]].Private}e.U._drawCFF(r.CFF.CharStrings[s],l,c,u,o)}else r.glyf&&e.U._drawGlyf(s,r,o);return o},e.U._drawGlyf=function(r,s,o){var a=s.glyf[r];a==null&&(a=s.glyf[r]=e.glyf._parseGlyf(s,r)),a!=null&&(a.noc>-1?e.U._simpleGlyph(a,o):e.U._compoGlyph(a,s,o))},e.U._simpleGlyph=function(r,s){for(var o=0;o<r.noc;o++){for(var a=o==0?0:r.endPts[o-1]+1,l=r.endPts[o],c=a;c<=l;c++){var u=c==a?l:c-1,h=c==l?a:c+1,d=1&r.flags[c],p=1&r.flags[u],f=1&r.flags[h],v=r.xs[c],g=r.ys[c];if(c==a)if(d){if(!p){e.U.P.moveTo(s,v,g);continue}e.U.P.moveTo(s,r.xs[u],r.ys[u])}else p?e.U.P.moveTo(s,r.xs[u],r.ys[u]):e.U.P.moveTo(s,(r.xs[u]+v)/2,(r.ys[u]+g)/2);d?p&&e.U.P.lineTo(s,v,g):f?e.U.P.qcurveTo(s,v,g,r.xs[h],r.ys[h]):e.U.P.qcurveTo(s,v,g,(v+r.xs[h])/2,(g+r.ys[h])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(r,s,o){for(var a=0;a<r.parts.length;a++){var l={cmds:[],crds:[]},c=r.parts[a];e.U._drawGlyf(c.glyphIndex,s,l);for(var u=c.m,h=0;h<l.crds.length;h+=2){var d=l.crds[h],p=l.crds[h+1];o.crds.push(d*u.a+p*u.b+u.tx),o.crds.push(d*u.c+p*u.d+u.ty)}for(h=0;h<l.cmds.length;h++)o.cmds.push(l.cmds[h])}},e.U._getGlyphClass=function(r,s){var o=e._lctf.getInterval(s,r);return o==-1?0:s[o+2]},e.U._applySubs=function(r,s,o,a){for(var l=r.length-s-1,c=0;c<o.tabs.length;c++)if(o.tabs[c]!=null){var u,h=o.tabs[c];if(!h.coverage||(u=e._lctf.coverageIndex(h.coverage,r[s]))!=-1){if(o.ltype==1)r[s],h.fmt==1?r[s]=r[s]+h.delta:r[s]=h.newg[u];else if(o.ltype==4)for(var d=h.vals[u],p=0;p<d.length;p++){var f=d[p],v=f.chain.length;if(!(v>l)){for(var g=!0,m=0,x=0;x<v;x++){for(;r[s+m+(1+x)]==-1;)m++;f.chain[x]!=r[s+m+(1+x)]&&(g=!1)}if(g){for(r[s]=f.nglyph,x=0;x<v+m;x++)r[s+x+1]=-1;break}}}else if(o.ltype==5&&h.fmt==2)for(var y=e._lctf.getInterval(h.cDef,r[s]),_=h.cDef[y+2],w=h.scset[_],b=0;b<w.length;b++){var T=w[b],A=T.input;if(!(A.length>l)){for(g=!0,x=0;x<A.length;x++){var S=e._lctf.getInterval(h.cDef,r[s+1+x]);if(y==-1&&h.cDef[S+2]!=A[x]){g=!1;break}}if(g){var E=T.substLookupRecords;for(p=0;p<E.length;p+=2)E[p],E[p+1]}}}else if(o.ltype==6&&h.fmt==3){if(!e.U._glsCovered(r,h.backCvg,s-h.backCvg.length)||!e.U._glsCovered(r,h.inptCvg,s)||!e.U._glsCovered(r,h.ahedCvg,s+h.inptCvg.length))continue;var R=h.lookupRec;for(b=0;b<R.length;b+=2){y=R[b];var D=a[R[b+1]];e.U._applySubs(r,s+y,D,a)}}}}},e.U._glsCovered=function(r,s,o){for(var a=0;a<s.length;a++)if(e._lctf.coverageIndex(s[a],r[o+a])==-1)return!1;return!0},e.U.glyphsToPath=function(r,s,o){for(var a={cmds:[],crds:[]},l=0,c=0;c<s.length;c++){var u=s[c];if(u!=-1){for(var h=c<s.length-1&&s[c+1]!=-1?s[c+1]:0,d=e.U.glyphToPath(r,u),p=0;p<d.crds.length;p+=2)a.crds.push(d.crds[p]+l),a.crds.push(d.crds[p+1]);for(o&&a.cmds.push(o),p=0;p<d.cmds.length;p++)a.cmds.push(d.cmds[p]);o&&a.cmds.push("X"),l+=r.hmtx.aWidth[u],c<s.length-1&&(l+=e.U.getPairAdjustment(r,u,h))}}return a},e.U.P={},e.U.P.moveTo=function(r,s,o){r.cmds.push("M"),r.crds.push(s,o)},e.U.P.lineTo=function(r,s,o){r.cmds.push("L"),r.crds.push(s,o)},e.U.P.curveTo=function(r,s,o,a,l,c,u){r.cmds.push("C"),r.crds.push(s,o,a,l,c,u)},e.U.P.qcurveTo=function(r,s,o,a,l){r.cmds.push("Q"),r.crds.push(s,o,a,l)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,s,o,a,l){for(var c=s.stack,u=s.nStems,h=s.haveWidth,d=s.width,p=s.open,f=0,v=s.x,g=s.y,m=0,x=0,y=0,_=0,w=0,b=0,T=0,A=0,S=0,E=0,R={val:0,size:0};f<r.length;){e.CFF.getCharString(r,f,R);var D=R.val;if(f+=R.size,D=="o1"||D=="o18")c.length%2!=0&&!h&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,h=!0;else if(D=="o3"||D=="o23")c.length%2!=0&&!h&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,h=!0;else if(D=="o4")c.length>1&&!h&&(d=c.shift()+a.nominalWidthX,h=!0),p&&e.U.P.closePath(l),g+=c.pop(),e.U.P.moveTo(l,v,g),p=!0;else if(D=="o5")for(;c.length>0;)v+=c.shift(),g+=c.shift(),e.U.P.lineTo(l,v,g);else if(D=="o6"||D=="o7")for(var z=c.length,L=D=="o6",G=0;G<z;G++){var J=c.shift();L?v+=J:g+=J,L=!L,e.U.P.lineTo(l,v,g)}else if(D=="o8"||D=="o24"){z=c.length;for(var X=0;X+6<=z;)m=v+c.shift(),x=g+c.shift(),y=m+c.shift(),_=x+c.shift(),v=y+c.shift(),g=_+c.shift(),e.U.P.curveTo(l,m,x,y,_,v,g),X+=6;D=="o24"&&(v+=c.shift(),g+=c.shift(),e.U.P.lineTo(l,v,g))}else{if(D=="o11")break;if(D=="o1234"||D=="o1235"||D=="o1236"||D=="o1237")D=="o1234"&&(x=g,y=(m=v+c.shift())+c.shift(),E=_=x+c.shift(),b=_,A=g,v=(T=(w=(S=y+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,m,x,y,_,S,E),e.U.P.curveTo(l,w,b,T,A,v,g)),D=="o1235"&&(m=v+c.shift(),x=g+c.shift(),y=m+c.shift(),_=x+c.shift(),S=y+c.shift(),E=_+c.shift(),w=S+c.shift(),b=E+c.shift(),T=w+c.shift(),A=b+c.shift(),v=T+c.shift(),g=A+c.shift(),c.shift(),e.U.P.curveTo(l,m,x,y,_,S,E),e.U.P.curveTo(l,w,b,T,A,v,g)),D=="o1236"&&(m=v+c.shift(),x=g+c.shift(),y=m+c.shift(),E=_=x+c.shift(),b=_,T=(w=(S=y+c.shift())+c.shift())+c.shift(),A=b+c.shift(),v=T+c.shift(),e.U.P.curveTo(l,m,x,y,_,S,E),e.U.P.curveTo(l,w,b,T,A,v,g)),D=="o1237"&&(m=v+c.shift(),x=g+c.shift(),y=m+c.shift(),_=x+c.shift(),S=y+c.shift(),E=_+c.shift(),w=S+c.shift(),b=E+c.shift(),T=w+c.shift(),A=b+c.shift(),Math.abs(T-v)>Math.abs(A-g)?v=T+c.shift():g=A+c.shift(),e.U.P.curveTo(l,m,x,y,_,S,E),e.U.P.curveTo(l,w,b,T,A,v,g));else if(D=="o14"){if(c.length>0&&!h&&(d=c.shift()+o.nominalWidthX,h=!0),c.length==4){var N=c.shift(),U=c.shift(),O=c.shift(),F=c.shift(),$=e.CFF.glyphBySE(o,O),P=e.CFF.glyphBySE(o,F);e.U._drawCFF(o.CharStrings[$],s,o,a,l),s.x=N,s.y=U,e.U._drawCFF(o.CharStrings[P],s,o,a,l)}p&&(e.U.P.closePath(l),p=!1)}else if(D=="o19"||D=="o20")c.length%2!=0&&!h&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,h=!0,f+=u+7>>3;else if(D=="o21")c.length>2&&!h&&(d=c.shift()+a.nominalWidthX,h=!0),g+=c.pop(),v+=c.pop(),p&&e.U.P.closePath(l),e.U.P.moveTo(l,v,g),p=!0;else if(D=="o22")c.length>1&&!h&&(d=c.shift()+a.nominalWidthX,h=!0),v+=c.pop(),p&&e.U.P.closePath(l),e.U.P.moveTo(l,v,g),p=!0;else if(D=="o25"){for(;c.length>6;)v+=c.shift(),g+=c.shift(),e.U.P.lineTo(l,v,g);m=v+c.shift(),x=g+c.shift(),y=m+c.shift(),_=x+c.shift(),v=y+c.shift(),g=_+c.shift(),e.U.P.curveTo(l,m,x,y,_,v,g)}else if(D=="o26")for(c.length%2&&(v+=c.shift());c.length>0;)m=v,x=g+c.shift(),v=y=m+c.shift(),g=(_=x+c.shift())+c.shift(),e.U.P.curveTo(l,m,x,y,_,v,g);else if(D=="o27")for(c.length%2&&(g+=c.shift());c.length>0;)x=g,y=(m=v+c.shift())+c.shift(),_=x+c.shift(),v=y+c.shift(),g=_,e.U.P.curveTo(l,m,x,y,_,v,g);else if(D=="o10"||D=="o29"){var C=D=="o10"?a:o;if(c.length==0)console.debug("error: empty stack");else{var M=c.pop(),B=C.Subrs[M+C.Bias];s.x=v,s.y=g,s.nStems=u,s.haveWidth=h,s.width=d,s.open=p,e.U._drawCFF(B,s,o,a,l),v=s.x,g=s.y,u=s.nStems,h=s.haveWidth,d=s.width,p=s.open}}else if(D=="o30"||D=="o31"){var k=c.length,Q=(X=0,D=="o31");for(X+=k-(z=-3&k);X<z;)Q?(x=g,y=(m=v+c.shift())+c.shift(),g=(_=x+c.shift())+c.shift(),z-X==5?(v=y+c.shift(),X++):v=y,Q=!1):(m=v,x=g+c.shift(),y=m+c.shift(),_=x+c.shift(),v=y+c.shift(),z-X==5?(g=_+c.shift(),X++):g=_,Q=!0),e.U.P.curveTo(l,m,x,y,_,v,g),X+=4}else{if((D+"").charAt(0)=="o")throw console.debug("Unknown operation: "+D,r),D;c.push(D)}}}s.x=v,s.y=g,s.nStems=u,s.haveWidth=h,s.width=d,s.open=p};var t=e,i={Typr:t};return n.Typr=t,n.default=i,Object.defineProperty(n,"__esModule",{value:!0}),n}({}).Typr}function fN(){return function(n){var e=Uint8Array,t=Uint16Array,i=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(D,z){for(var L=new t(31),G=0;G<31;++G)L[G]=z+=1<<D[G-1];var J=new i(L[30]);for(G=1;G<30;++G)for(var X=L[G];X<L[G+1];++X)J[X]=X-L[G]<<5|G;return[L,J]},l=a(r,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var h=a(s,0)[0],d=new t(32768),p=0;p<32768;++p){var f=(43690&p)>>>1|(21845&p)<<1;f=(61680&(f=(52428&f)>>>2|(13107&f)<<2))>>>4|(3855&f)<<4,d[p]=((65280&f)>>>8|(255&f)<<8)>>>1}var v=function(D,z,L){for(var G=D.length,J=0,X=new t(z);J<G;++J)++X[D[J]-1];var N,U=new t(z);for(J=0;J<z;++J)U[J]=U[J-1]+X[J-1]<<1;if(L){N=new t(1<<z);var O=15-z;for(J=0;J<G;++J)if(D[J])for(var F=J<<4|D[J],$=z-D[J],P=U[D[J]-1]++<<$,C=P|(1<<$)-1;P<=C;++P)N[d[P]>>>O]=F}else for(N=new t(G),J=0;J<G;++J)D[J]&&(N[J]=d[U[D[J]-1]++]>>>15-D[J]);return N},g=new e(288);for(p=0;p<144;++p)g[p]=8;for(p=144;p<256;++p)g[p]=9;for(p=256;p<280;++p)g[p]=7;for(p=280;p<288;++p)g[p]=8;var m=new e(32);for(p=0;p<32;++p)m[p]=5;var x=v(g,9,1),y=v(m,5,1),_=function(D){for(var z=D[0],L=1;L<D.length;++L)D[L]>z&&(z=D[L]);return z},w=function(D,z,L){var G=z/8|0;return(D[G]|D[G+1]<<8)>>(7&z)&L},b=function(D,z){var L=z/8|0;return(D[L]|D[L+1]<<8|D[L+2]<<16)>>(7&z)},T=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],A=function(D,z,L){var G=new Error(z||T[D]);if(G.code=D,Error.captureStackTrace&&Error.captureStackTrace(G,A),!L)throw G;return G},S=function(D,z,L){var G=D.length;if(!G||L&&!L.l&&G<5)return z||new e(0);var J=!z||L,X=!L||L.i;L||(L={}),z||(z=new e(3*G));var N,U=function(ke){var We=z.length;if(ke>We){var Qe=new e(Math.max(2*We,ke));Qe.set(z),z=Qe}},O=L.f||0,F=L.p||0,$=L.b||0,P=L.l,C=L.d,M=L.m,B=L.n,k=8*G;do{if(!P){L.f=O=w(D,F,1);var Q=w(D,F+1,3);if(F+=3,!Q){var Y=D[(I=((N=F)/8|0)+(7&N&&1)+4)-4]|D[I-3]<<8,re=I+Y;if(re>G){X&&A(0);break}J&&U($+Y),z.set(D.subarray(I,re),$),L.b=$+=Y,L.p=F=8*re;continue}if(Q==1)P=x,C=y,M=9,B=5;else if(Q==2){var Z=w(D,F,31)+257,V=w(D,F+10,15)+4,ne=Z+w(D,F+5,31)+1;F+=14;for(var ie=new e(ne),te=new e(19),j=0;j<V;++j)te[o[j]]=w(D,F+3*j,7);F+=3*V;var W=_(te),H=(1<<W)-1,q=v(te,W,1);for(j=0;j<ne;){var I,ee=q[w(D,F,H)];if(F+=15&ee,(I=ee>>>4)<16)ie[j++]=I;else{var me=0,pe=0;for(I==16?(pe=3+w(D,F,3),F+=2,me=ie[j-1]):I==17?(pe=3+w(D,F,7),F+=3):I==18&&(pe=11+w(D,F,127),F+=7);pe--;)ie[j++]=me}}var ge=ie.subarray(0,Z),xe=ie.subarray(Z);M=_(ge),B=_(xe),P=v(ge,M,1),C=v(xe,B,1)}else A(1);if(F>k){X&&A(0);break}}J&&U($+131072);for(var we=(1<<M)-1,_e=(1<<B)-1,Ie=F;;Ie=F){var Be=(me=P[b(D,F)&we])>>>4;if((F+=15&me)>k){X&&A(0);break}if(me||A(2),Be<256)z[$++]=Be;else{if(Be==256){Ie=F,P=null;break}var Ae=Be-254;if(Be>264){var it=r[j=Be-257];Ae=w(D,F,(1<<it)-1)+c[j],F+=it}var se=C[b(D,F)&_e],Le=se>>>4;if(se||A(3),F+=15&se,xe=h[Le],Le>3&&(it=s[Le],xe+=b(D,F)&(1<<it)-1,F+=it),F>k){X&&A(0);break}J&&U($+131072);for(var Ee=$+Ae;$<Ee;$+=4)z[$]=z[$-xe],z[$+1]=z[$+1-xe],z[$+2]=z[$+2-xe],z[$+3]=z[$+3-xe];$=Ee}}L.l=P,L.p=Ie,L.b=$,P&&(O=1,L.m=M,L.d=C,L.n=B)}while(!O);return $==z.length?z:function(ke,We,Qe){(We==null||We<0)&&(We=0),(Qe==null||Qe>ke.length)&&(Qe=ke.length);var rt=new(ke instanceof t?t:ke instanceof i?i:e)(Qe-We);return rt.set(ke.subarray(We,Qe)),rt}(z,0,$)},E=new e(0),R=typeof TextDecoder<"u"&&new TextDecoder;try{R.decode(E,{stream:!0})}catch{}return n.convert_streams=function(D){var z=new DataView(D),L=0;function G(){var Z=z.getUint16(L);return L+=2,Z}function J(){var Z=z.getUint32(L);return L+=4,Z}function X(Z){Y.setUint16(re,Z),re+=2}function N(Z){Y.setUint32(re,Z),re+=4}for(var U={signature:J(),flavor:J(),length:J(),numTables:G(),reserved:G(),totalSfntSize:J(),majorVersion:G(),minorVersion:G(),metaOffset:J(),metaLength:J(),metaOrigLength:J(),privOffset:J(),privLength:J()},O=0;Math.pow(2,O)<=U.numTables;)O++;O--;for(var F=16*Math.pow(2,O),$=16*U.numTables-F,P=12,C=[],M=0;M<U.numTables;M++)C.push({tag:J(),offset:J(),compLength:J(),origLength:J(),origChecksum:J()}),P+=16;var B,k=new Uint8Array(12+16*C.length+C.reduce(function(Z,V){return Z+V.origLength+4},0)),Q=k.buffer,Y=new DataView(Q),re=0;return N(U.flavor),X(U.numTables),X(F),X(O),X($),C.forEach(function(Z){N(Z.tag),N(Z.origChecksum),N(P),N(Z.origLength),Z.outOffset=P,(P+=Z.origLength)%4!=0&&(P+=4-P%4)}),C.forEach(function(Z){var V,ne=D.slice(Z.offset,Z.offset+Z.compLength);if(Z.compLength!=Z.origLength){var ie=new Uint8Array(Z.origLength);V=new Uint8Array(ne,2),S(V,ie)}else ie=new Uint8Array(ne);k.set(ie,Z.outOffset);var te=0;(P=Z.outOffset+Z.origLength)%4!=0&&(te=4-P%4),k.set(new Uint8Array(te).buffer,Z.outOffset+Z.origLength),B=P+te}),Q.slice(0,B)},Object.defineProperty(n,"__esModule",{value:!0}),n}({}).convert_streams}function mN(n,e){let t={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,s=2,o=4,a=8,l=16,c=32,u;function h(T){if(!u){let A={R:s,L:r,D:o,C:l,U:c,T:a};u=new Map;for(let S in i){let E=0;i[S].split(",").forEach(R=>{let[D,z]=R.split("+");D=parseInt(D,36),z=z?parseInt(z,36):0,u.set(E+=D,A[S]);for(let L=z;L--;)u.set(++E,A[S])})}}return u.get(T)||c}let d=1,p=2,f=3,v=4,g=[null,"isol","init","fina","medi"];function m(T){let A=new Uint8Array(T.length),S=c,E=d,R=-1;for(let D=0;D<T.length;D++){let z=T.codePointAt(D),L=h(z)|0,G=d;L&a||(S&(r|o|l)?L&(s|o|l)?(G=f,(E===d||E===f)&&A[R]++):L&(r|c)&&(E===p||E===v)&&A[R]--:S&(s|c)&&(E===p||E===v)&&A[R]--,E=A[D]=G,S=L,R=D,z>65535&&D++)}return A}function x(T,A){let S=[];for(let R=0;R<A.length;R++){let D=A.codePointAt(R);D>65535&&R++,S.push(n.U.codeToGlyph(T,D))}let E=T.GSUB;if(E){let{lookupList:R,featureList:D}=E,z,L=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,G=[];D.forEach(J=>{if(L.test(J.tag))for(let X=0;X<J.tab.length;X++){if(G[J.tab[X]])continue;G[J.tab[X]]=!0;let N=R[J.tab[X]],U=/^(isol|init|fina|medi)$/.test(J.tag);U&&!z&&(z=m(A));for(let O=0;O<S.length;O++)(!z||!U||g[z[O]]===J.tag)&&n.U._applySubs(S,O,N,R)}})}return S}function y(T,A){let S=new Int16Array(A.length*3),E=0;for(;E<A.length;E++){let L=A[E];if(L===-1)continue;S[E*3+2]=T.hmtx.aWidth[L];let G=T.GPOS;if(G){let J=G.lookupList;for(let X=0;X<J.length;X++){let N=J[X];for(let U=0;U<N.tabs.length;U++){let O=N.tabs[U];if(N.ltype===1){if(n._lctf.coverageIndex(O.coverage,L)!==-1&&O.pos){z(O.pos,E);break}}else if(N.ltype===2){let F=null,$=R();if($!==-1){let P=n._lctf.coverageIndex(O.coverage,A[$]);if(P!==-1){if(O.fmt===1){let C=O.pairsets[P];for(let M=0;M<C.length;M++)C[M].gid2===L&&(F=C[M])}else if(O.fmt===2){let C=n.U._getGlyphClass(A[$],O.classDef1),M=n.U._getGlyphClass(L,O.classDef2);F=O.matrix[C][M]}if(F){F.val1&&z(F.val1,$),F.val2&&z(F.val2,E);break}}}}else if(N.ltype===4){let F=n._lctf.coverageIndex(O.markCoverage,L);if(F!==-1){let $=R(D),P=$===-1?-1:n._lctf.coverageIndex(O.baseCoverage,A[$]);if(P!==-1){let C=O.markArray[F],M=O.baseArray[P][C.markClass];S[E*3]=M.x-C.x+S[$*3]-S[$*3+2],S[E*3+1]=M.y-C.y+S[$*3+1];break}}}else if(N.ltype===6){let F=n._lctf.coverageIndex(O.mark1Coverage,L);if(F!==-1){let $=R();if($!==-1){let P=A[$];if(_(T,P)===3){let C=n._lctf.coverageIndex(O.mark2Coverage,P);if(C!==-1){let M=O.mark1Array[F],B=O.mark2Array[C][M.markClass];S[E*3]=B.x-M.x+S[$*3]-S[$*3+2],S[E*3+1]=B.y-M.y+S[$*3+1];break}}}}}}}}else if(T.kern&&!T.cff){let J=R();if(J!==-1){let X=T.kern.glyph1.indexOf(A[J]);if(X!==-1){let N=T.kern.rval[X].glyph2.indexOf(L);N!==-1&&(S[J*3+2]+=T.kern.rval[X].vals[N])}}}}return S;function R(L){for(let G=E-1;G>=0;G--)if(A[G]!==-1&&(!L||L(A[G])))return G;return-1}function D(L){return _(T,L)===1}function z(L,G){for(let J=0;J<3;J++)S[G*3+J]+=L[J]||0}}function _(T,A){let S=T.GDEF&&T.GDEF.glyphClassDef;return S?n.U._getGlyphClass(A,S):0}function w(...T){for(let A=0;A<T.length;A++)if(typeof T[A]=="number")return T[A]}function b(T){let A=Object.create(null),S=T["OS/2"],E=T.hhea,R=T.head.unitsPerEm,D=w(S&&S.sTypoAscender,E&&E.ascender,R),z={unitsPerEm:R,ascender:D,descender:w(S&&S.sTypoDescender,E&&E.descender,0),capHeight:w(S&&S.sCapHeight,D),xHeight:w(S&&S.sxHeight,D),lineGap:w(S&&S.sTypoLineGap,E&&E.lineGap),supportsCodePoint(L){return n.U.codeToGlyph(T,L)>0},forEachGlyph(L,G,J,X){let N=0,U=1/z.unitsPerEm*G,O=x(T,L),F=0,$=y(T,O);return O.forEach((P,C)=>{if(P!==-1){let M=A[P];if(!M){let{cmds:B,crds:k}=n.U.glyphToPath(T,P),Q="",Y=0;for(let ie=0,te=B.length;ie<te;ie++){let j=t[B[ie]];Q+=B[ie];for(let W=1;W<=j;W++)Q+=(W>1?",":"")+k[Y++]}let re,Z,V,ne;if(k.length){re=Z=1/0,V=ne=-1/0;for(let ie=0,te=k.length;ie<te;ie+=2){let j=k[ie],W=k[ie+1];j<re&&(re=j),W<Z&&(Z=W),j>V&&(V=j),W>ne&&(ne=W)}}else re=V=Z=ne=0;M=A[P]={index:P,advanceWidth:T.hmtx.aWidth[P],xMin:re,yMin:Z,xMax:V,yMax:ne,path:Q}}X.call(null,M,N+$[C*3]*U,$[C*3+1]*U,F),N+=$[C*3+2]*U,J&&(N+=J*G)}F+=L.codePointAt(F)>65535?2:1}),N}};return z}return function(T){let A=new Uint8Array(T,0,4),S=n._bin.readASCII(A,0,4);if(S==="wOFF")T=e(T);else if(S==="wOF2")throw new Error("woff2 fonts not supported");return b(n.parse(T)[0])}}var gN=ru({name:"Typr Font Parser",dependencies:[pN,fN,mN],init(n,e,t){let i=n(),r=e();return t(i,r)}});function vN(){return function(n){var e=function(){this.buckets=new Map};e.prototype.add=function(y){var _=y>>5;this.buckets.set(_,(this.buckets.get(_)||0)|1<<(31&y))},e.prototype.has=function(y){var _=this.buckets.get(y>>5);return _!==void 0&&(_&1<<(31&y))!=0},e.prototype.serialize=function(){var y=[];return this.buckets.forEach(function(_,w){y.push((+w).toString(36)+":"+_.toString(36))}),y.join(",")},e.prototype.deserialize=function(y){var _=this;this.buckets.clear(),y.split(",").forEach(function(w){var b=w.split(":");_.buckets.set(parseInt(b[0],36),parseInt(b[1],36))})};var t=Math.pow(2,8),i=t-1,r=~i;function s(y){var _=function(b){return b&r}(y).toString(16),w=function(b){return(b&r)+t-1}(y).toString(16);return"codepoint-index/plane"+(y>>16)+"/"+_+"-"+w+".json"}function o(y,_){var w=y&i,b=_.codePointAt(w/6|0);return((b=(b||48)-48)&1<<w%6)!=0}function a(y,_){var w;(w=y,w.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(b){return b.split("-").map(function(T){return parseInt(T.trim(),16)})})).forEach(function(b){var T=b[0],A=b[1];A===void 0&&(A=T),_(T,A)})}function l(y,_){a(y,function(w,b){for(var T=w;T<=b;T++)_(T)})}var c={},u={},h=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function p(y){var _=h.get(y);return _||(_=new e,l(y.ranges,function(w){return _.add(w)}),h.set(y,_)),_}var f,v=new Map;function g(y,_,w){return y[_]?_:y[w]?w:function(b){for(var T in b)return T}(y)}function m(y,_){var w=_;if(!y.includes(w)){w=1/0;for(var b=0;b<y.length;b++)Math.abs(y[b]-_)<Math.abs(w-_)&&(w=y[b])}return w}function x(y){return f||(f=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(_){f.add(_)})),f.has(y)}return n.CodePointSet=e,n.clearCache=function(){c={},u={}},n.getFontsForString=function(y,_){_===void 0&&(_={});var w,b=_.lang;b===void 0&&(b=/\p{Script=Hangul}/u.test(w=y)?"ko":/\p{Script=Hiragana}|\p{Script=Katakana}/u.test(w)?"ja":"en");var T=_.category;T===void 0&&(T="sans-serif");var A=_.style;A===void 0&&(A="normal");var S=_.weight;S===void 0&&(S=400);var E=(_.dataUrl||d).replace(/\/$/g,""),R=new Map,D=new Uint8Array(y.length),z={},L={},G=new Array(y.length),J=new Map,X=!1;function N(F){var $=v.get(F);return $||($=fetch(E+"/"+F).then(function(P){if(!P.ok)throw new Error(P.statusText);return P.json().then(function(C){if(!Array.isArray(C)||C[0]!==1)throw new Error("Incorrect schema version; need 1, got "+C[0]);return C[1]})}).catch(function(P){if(E!==d)return X||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+E+'", trying default CDN. '+P.message),X=!0),E=d,v.delete(F),N(F);throw P}),v.set(F,$)),$}for(var U=function(F){var $=y.codePointAt(F),P=s($);G[F]=P,c[P]||J.has(P)||J.set(P,N(P).then(function(C){c[P]=C})),$>65535&&(F++,O=F)},O=0;O<y.length;O++)U(O);return Promise.all(J.values()).then(function(){J.clear();for(var F=function(P){var C=y.codePointAt(P),M=null,B=c[G[P]],k=void 0;for(var Q in B){var Y=L[Q];if(Y===void 0&&(Y=L[Q]=new RegExp(Q).test(b||"en")),Y){for(var re in k=Q,B[Q])if(o(C,B[Q][re])){M=re;break}break}}if(!M){e:for(var Z in B)if(Z!==k){for(var V in B[Z])if(o(C,B[Z][V])){M=V;break e}}}M||(console.debug("No font coverage for U+"+C.toString(16)),M="latin"),G[P]=M,u[M]||J.has(M)||J.set(M,N("font-meta/"+M+".json").then(function(ne){u[M]=ne})),C>65535&&(P++,$=P)},$=0;$<y.length;$++)F($);return Promise.all(J.values())}).then(function(){for(var F,$=null,P=0;P<y.length;P++){var C=y.codePointAt(P);if($&&(x(C)||p($).has(C)))D[P]=D[P-1];else{$=u[G[P]];var M=z[$.id];if(!M){var B=$.typeforms,k=g(B,T,"sans-serif"),Q=g(B[k],A,"normal"),Y=m((F=B[k])===null||F===void 0?void 0:F[Q],S);M=z[$.id]=E+"/font-files/"+$.id+"/"+k+"."+Q+"."+Y+".woff"}var re=R.get(M);re==null&&(re=R.size,R.set(M,re)),D[P]=re}C>65535&&(P++,D[P]=D[P-1])}return{fontUrls:Array.from(R.keys()),chars:D}})},Object.defineProperty(n,"__esModule",{value:!0}),n}({})}function yN(n,e){let t=Object.create(null),i=Object.create(null);function r(o,a){let l=c=>{console.error(`Failure loading font ${o}`,c)};try{let c=new XMLHttpRequest;c.open("get",o,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{let u=n(c.response);u.src=o,a(u)}catch(u){l(u)}},c.onerror=l,c.send()}catch(c){l(c)}}function s(o,a){let l=t[o];l?a(l):i[o]?i[o].push(a):(i[o]=[a],r(o,c=>{c.src=o,t[o]=c,i[o].forEach(u=>u(c)),delete i[o]}))}return function(o,a,{lang:l,fonts:c=[],style:u="normal",weight:h="normal",unicodeFontsURL:d}={}){let p=new Uint8Array(o.length),f=[];o.length||x();let v=new Map,g=[];if(u!=="italic"&&(u="normal"),typeof h!="number"&&(h=h==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(_=>!_.lang||_.lang.test(l)).reverse(),c.length){let _=0;(function w(b=0){for(let T=b,A=o.length;T<A;T++){let S=o.codePointAt(T);if(_===1&&f[p[T-1]].supportsCodePoint(S)||/\s/.test(o[T]))p[T]=p[T-1],_===2&&(g[g.length-1][1]=T);else for(let E=p[T],R=c.length;E<=R;E++)if(E===R){let D=_===2?g[g.length-1]:g[g.length]=[T,T];D[1]=T,_=2}else{p[T]=E;let{src:D,unicodeRange:z}=c[E];if(!z||y(S,z)){let L=t[D];if(!L){s(D,()=>{w(T)});return}if(L.supportsCodePoint(S)){let G=v.get(L);typeof G!="number"&&(G=f.length,f.push(L),v.set(L,G)),p[T]=G,_=1;break}}}S>65535&&T+1<A&&(p[T+1]=p[T],T++,_===2&&(g[g.length-1][1]=T))}m()})()}else g.push([0,o.length-1]),m();function m(){if(g.length){let _=g.map(w=>o.substring(w[0],w[1]+1)).join(`
`);e.getFontsForString(_,{lang:l||void 0,style:u,weight:h,dataUrl:d}).then(({fontUrls:w,chars:b})=>{let T=f.length,A=0;g.forEach(E=>{for(let R=0,D=E[1]-E[0];R<=D;R++)p[E[0]+R]=b[A++]+T;A++});let S=0;w.forEach((E,R)=>{s(E,D=>{f[R+T]=D,++S===w.length&&x()})})})}else x()}function x(){a({chars:p,fonts:f})}function y(_,w){for(let b=0;b<w.length;b++){let[T,A=T]=w[b];if(T<=_&&_<=A)return!0}return!1}}}var xN=ru({name:"FontResolver",dependencies:[yN,gN,vN],init(n,e,t){return n(e,t())}});function _N(n,e){let t=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,i="[^\\S\\u00A0]",r=new RegExp(`${i}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function s({text:p,lang:f,fonts:v,style:g,weight:m,preResolvedFonts:x,unicodeFontsURL:y},_){let w=({chars:b,fonts:T})=>{let A,S,E=[];for(let R=0;R<b.length;R++)b[R]!==S?(S=b[R],E.push(A={start:R,end:R,fontObj:T[b[R]]})):A.end=R;_(E)};x?w(x):n(p,w,{lang:f,fonts:v,style:g,weight:m,unicodeFontsURL:y})}function o({text:p="",font:f,lang:v,sdfGlyphSize:g=64,fontSize:m=400,fontWeight:x=1,fontStyle:y="normal",letterSpacing:_=0,lineHeight:w="normal",maxWidth:b=1/0,direction:T,textAlign:A="left",textIndent:S=0,whiteSpace:E="normal",overflowWrap:R="normal",anchorX:D=0,anchorY:z=0,metricsOnly:L=!1,unicodeFontsURL:G,preResolvedFonts:J=null,includeCaretPositions:X=!1,chunkedBoundsSize:N=8192,colorRanges:U=null},O){let F=u(),$={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),m=+m,_=+_,b=+b,w=w||"normal",S=+S,s({text:p,lang:v,style:y,weight:x,fonts:typeof f=="string"?[{src:f}]:f,unicodeFontsURL:G,preResolvedFonts:J},P=>{$.fontLoad=u()-F;let C=isFinite(b),M=null,B=null,k=null,Q=null,Y=null,re=null,Z=null,V=null,ne=0,ie=0,te=E!=="nowrap",j=new Map,W=u(),H=S,q=0,I=new h,ee=[I];P.forEach(we=>{let{fontObj:_e}=we,{ascender:Ie,descender:Be,unitsPerEm:Ae,lineGap:it,capHeight:se,xHeight:Le}=_e,Ee=j.get(_e);if(!Ee){let Oe=m/Ae,Ce=w==="normal"?(Ie-Be+it)*Oe:w*m,le=(Ce-(Ie-Be)*Oe)/2,Pe=Math.min(Ce,(Ie-Be)*Oe),Ve=(Ie+Be)/2*Oe+Pe/2;Ee={index:j.size,src:_e.src,fontObj:_e,fontSizeMult:Oe,unitsPerEm:Ae,ascender:Ie*Oe,descender:Be*Oe,capHeight:se*Oe,xHeight:Le*Oe,lineHeight:Ce,baseline:-le-Ie*Oe,caretTop:(Ie+Be)/2*Oe+Pe/2,caretBottom:Ve-Pe},j.set(_e,Ee)}let{fontSizeMult:ke}=Ee,We=p.slice(we.start,we.end+1),Qe,rt;_e.forEachGlyph(We,m,_,(Oe,Ce,le,Pe)=>{Ce+=q,Pe+=we.start,Qe=Ce,rt=Oe;let Ve=p.charAt(Pe),et=Oe.advanceWidth*ke,Je=I.count,Te;if("isEmpty"in Oe||(Oe.isWhitespace=!!Ve&&new RegExp(i).test(Ve),Oe.canBreakAfter=!!Ve&&r.test(Ve),Oe.isEmpty=Oe.xMin===Oe.xMax||Oe.yMin===Oe.yMax||t.test(Ve)),!Oe.isWhitespace&&!Oe.isEmpty&&ie++,te&&C&&!Oe.isWhitespace&&Ce+et+H>b&&Je){if(I.glyphAt(Je-1).glyphObj.canBreakAfter)Te=new h,H=-Ce;else for(let Se=Je;Se--;)if(Se===0&&R==="break-word"){Te=new h,H=-Ce;break}else if(I.glyphAt(Se).glyphObj.canBreakAfter){Te=I.splitAt(Se+1);let ce=Te.glyphAt(0).x;H-=ce;for(let ue=Te.count;ue--;)Te.glyphAt(ue).x-=ce;break}Te&&(I.isSoftWrapped=!0,I=Te,ee.push(I),ne=b)}let Ze=I.glyphAt(I.count);Ze.glyphObj=Oe,Ze.x=Ce+H,Ze.y=le,Ze.width=et,Ze.charIndex=Pe,Ze.fontData=Ee,Ve===`
`&&(I=new h,ee.push(I),H=-(Ce+et+_*m)+S)}),q=Qe+rt.advanceWidth*ke+_*m});let me=0;ee.forEach(we=>{let _e=!0;for(let Ie=we.count;Ie--;){let Be=we.glyphAt(Ie);_e&&!Be.glyphObj.isWhitespace&&(we.width=Be.x+Be.width,we.width>ne&&(ne=we.width),_e=!1);let{lineHeight:Ae,capHeight:it,xHeight:se,baseline:Le}=Be.fontData;Ae>we.lineHeight&&(we.lineHeight=Ae);let Ee=Le-we.baseline;Ee<0&&(we.baseline+=Ee,we.cap+=Ee,we.ex+=Ee),we.cap=Math.max(we.cap,we.baseline+it),we.ex=Math.max(we.ex,we.baseline+se)}we.baseline-=me,we.cap-=me,we.ex-=me,me+=we.lineHeight});let pe=0,ge=0;if(D&&(typeof D=="number"?pe=-D:typeof D=="string"&&(pe=-ne*(D==="left"?0:D==="center"?.5:D==="right"?1:l(D)))),z&&(typeof z=="number"?ge=-z:typeof z=="string"&&(ge=z==="top"?0:z==="top-baseline"?-ee[0].baseline:z==="top-cap"?-ee[0].cap:z==="top-ex"?-ee[0].ex:z==="middle"?me/2:z==="bottom"?me:z==="bottom-baseline"?ee[ee.length-1].baseline:l(z)*me)),!L){let we=e.getEmbeddingLevels(p,T);M=new Uint16Array(ie),B=new Uint8Array(ie),k=new Float32Array(ie*2),Q={},Z=[1/0,1/0,-1/0,-1/0],V=[],X&&(re=new Float32Array(p.length*4)),U&&(Y=new Uint8Array(ie*3));let _e=0,Ie=-1,Be=-1,Ae,it;if(ee.forEach((se,Le)=>{let{count:Ee,width:ke}=se;if(Ee>0){let We=0;for(let Pe=Ee;Pe--&&se.glyphAt(Pe).glyphObj.isWhitespace;)We++;let Qe=0,rt=0;if(A==="center")Qe=(ne-ke)/2;else if(A==="right")Qe=ne-ke;else if(A==="justify"&&se.isSoftWrapped){let Pe=0;for(let Ve=Ee-We;Ve--;)se.glyphAt(Ve).glyphObj.isWhitespace&&Pe++;rt=(ne-ke)/Pe}if(rt||Qe){let Pe=0;for(let Ve=0;Ve<Ee;Ve++){let et=se.glyphAt(Ve),Je=et.glyphObj;et.x+=Qe+Pe,rt!==0&&Je.isWhitespace&&Ve<Ee-We&&(Pe+=rt,et.width+=rt)}}let Oe=e.getReorderSegments(p,we,se.glyphAt(0).charIndex,se.glyphAt(se.count-1).charIndex);for(let Pe=0;Pe<Oe.length;Pe++){let[Ve,et]=Oe[Pe],Je=1/0,Te=-1/0;for(let Ze=0;Ze<Ee;Ze++)if(se.glyphAt(Ze).charIndex>=Ve){let Se=Ze,ce=Ze;for(;ce<Ee;ce++){let ue=se.glyphAt(ce);if(ue.charIndex>et)break;ce<Ee-We&&(Je=Math.min(Je,ue.x),Te=Math.max(Te,ue.x+ue.width))}for(let ue=Se;ue<ce;ue++){let de=se.glyphAt(ue);de.x=Te-(de.x+de.width-Je)}break}}let Ce,le=Pe=>Ce=Pe;for(let Pe=0;Pe<Ee;Pe++){let Ve=se.glyphAt(Pe);Ce=Ve.glyphObj;let et=Ce.index,Je=we.levels[Ve.charIndex]&1;if(Je){let Te=e.getMirroredCharacter(p[Ve.charIndex]);Te&&Ve.fontData.fontObj.forEachGlyph(Te,0,0,le)}if(X){let{charIndex:Te,fontData:Ze}=Ve,Se=Ve.x+pe,ce=Ve.x+Ve.width+pe;re[Te*4]=Je?ce:Se,re[Te*4+1]=Je?Se:ce,re[Te*4+2]=se.baseline+Ze.caretBottom+ge,re[Te*4+3]=se.baseline+Ze.caretTop+ge;let ue=Te-Ie;ue>1&&c(re,Ie,ue),Ie=Te}if(U){let{charIndex:Te}=Ve;for(;Te>Be;)Be++,U.hasOwnProperty(Be)&&(it=U[Be])}if(!Ce.isWhitespace&&!Ce.isEmpty){let Te=_e++,{fontSizeMult:Ze,src:Se,index:ce}=Ve.fontData,ue=Q[Se]||(Q[Se]={});ue[et]||(ue[et]={path:Ce.path,pathBounds:[Ce.xMin,Ce.yMin,Ce.xMax,Ce.yMax]});let de=Ve.x+pe,be=Ve.y+se.baseline+ge;k[Te*2]=de,k[Te*2+1]=be;let Ue=de+Ce.xMin*Ze,Re=be+Ce.yMin*Ze,Ge=de+Ce.xMax*Ze,ze=be+Ce.yMax*Ze;Ue<Z[0]&&(Z[0]=Ue),Re<Z[1]&&(Z[1]=Re),Ge>Z[2]&&(Z[2]=Ge),ze>Z[3]&&(Z[3]=ze),Te%N===0&&(Ae={start:Te,end:Te,rect:[1/0,1/0,-1/0,-1/0]},V.push(Ae)),Ae.end++;let ve=Ae.rect;if(Ue<ve[0]&&(ve[0]=Ue),Re<ve[1]&&(ve[1]=Re),Ge>ve[2]&&(ve[2]=Ge),ze>ve[3]&&(ve[3]=ze),M[Te]=et,B[Te]=ce,U){let Ne=Te*3;Y[Ne]=it>>16&255,Y[Ne+1]=it>>8&255,Y[Ne+2]=it&255}}}}}),re){let se=p.length-Ie;se>1&&c(re,Ie,se)}}let xe=[];j.forEach(({index:we,src:_e,unitsPerEm:Ie,ascender:Be,descender:Ae,lineHeight:it,capHeight:se,xHeight:Le})=>{xe[we]={src:_e,unitsPerEm:Ie,ascender:Be,descender:Ae,lineHeight:it,capHeight:se,xHeight:Le}}),$.typesetting=u()-W,O({glyphIds:M,glyphFontIndices:B,glyphPositions:k,glyphData:Q,fontData:xe,caretPositions:re,glyphColors:Y,chunkedBounds:V,fontSize:m,topBaseline:ge+ee[0].baseline,blockBounds:[pe,ge-me,pe+ne,ge],visibleBounds:Z,timings:$})})}function a(p,f){o({...p,metricsOnly:!0},v=>{let[g,m,x,y]=v.blockBounds;f({width:x-g,height:y-m})})}function l(p){let f=p.match(/^([\d.]+)%$/),v=f?parseFloat(f[1]):NaN;return isNaN(v)?0:v/100}function c(p,f,v){let g=p[f*4],m=p[f*4+1],x=p[f*4+2],y=p[f*4+3],_=(m-g)/v;for(let w=0;w<v;w++){let b=(f+w)*4;p[b]=g+_*w,p[b+1]=g+_*(w+1),p[b+2]=x,p[b+3]=y}}function u(){return(self.performance||Date).now()}function h(){this.data=[]}let d=["glyphObj","x","y","width","charIndex","fontData"];return h.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/d.length)},glyphAt(p){let f=h.flyweight;return f.data=this.data,f.index=p,f},splitAt(p){let f=new h;return f.data=this.data.splice(p*d.length),f}},h.flyweight=d.reduce((p,f,v,g)=>(Object.defineProperty(p,f,{get(){return this.data[this.index*d.length+v]},set(m){this.data[this.index*d.length+v]=m}}),p),{data:null,index:0}),{typeset:o,measure:a}}var fl=()=>(self.performance||Date).now(),Tm=wA(),oM;function wN(n,e,t,i,r,s,o,a,l,c,u=!0){return u?SN(n,e,t,i,r,s,o,a,l,c).then(null,h=>(oM||(console.warn("WebGL SDF generation failed, falling back to JS",h),oM=!0),lM(n,e,t,i,r,s,o,a,l,c))):lM(n,e,t,i,r,s,o,a,l,c)}var Sf=[],bN=5,Gx=0;function SA(){let n=fl();for(;Sf.length&&fl()-n<bN;)Sf.shift()();Gx=Sf.length?setTimeout(SA,0):0}var SN=(...n)=>new Promise((e,t)=>{Sf.push(()=>{let i=fl();try{Tm.webgl.generateIntoCanvas(...n),e({timing:fl()-i})}catch(r){t(r)}}),Gx||(Gx=setTimeout(SA,0))}),EN=4,TN=2e3,aM={},MN=0;function lM(n,e,t,i,r,s,o,a,l,c){let u="TroikaTextSDFGenerator_JS_"+MN++%EN,h=aM[u];return h||(h=aM[u]={workerModule:ru({name:u,workerId:u,dependencies:[wA,fl],init(d,p){let f=d().javascript.generate;return function(...v){let g=p();return{textureData:f(...v),timing:p()-g}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),h.requests++,clearTimeout(h.idleTimer),h.workerModule(n,e,t,i,r,s).then(({textureData:d,timing:p})=>{let f=fl(),v=new Uint8Array(d.length*4);for(let g=0;g<d.length;g++)v[g*4+c]=d[g];return Tm.webglUtils.renderImageData(o,v,a,l,n,e,1<<3-c),p+=fl()-f,--h.requests===0&&(h.idleTimer=setTimeout(()=>{rN(u)},TN)),{timing:p}})}function AN(n){n._warm||(Tm.webgl.isSupported(n),n._warm=!0)}var CN=Tm.webglUtils.resizeWebGLCanvasWithoutClearing,_c={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},DN=new at;function vc(){return(self.performance||Date).now()}var cM=Object.create(null);function PN(n,e){n=LN({},n);let t=vc(),{defaultFontURL:i}=_c,r=[];if(i&&r.push({label:"default",src:uM(i)}),n.font&&r.push({label:"user",src:uM(n.font)}),n.font=r,n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||_c.sdfGlyphSize,n.unicodeFontsURL=n.unicodeFontsURL||_c.unicodeFontsURL,n.colorRanges!=null){let d={};for(let p in n.colorRanges)if(n.colorRanges.hasOwnProperty(p)){let f=n.colorRanges[p];typeof f!="number"&&(f=DN.set(f).getHex()),d[p]=f}n.colorRanges=d}Object.freeze(n);let{textureWidth:s,sdfExponent:o}=_c,{sdfGlyphSize:a}=n,l=s/a*4,c=cM[a];if(!c){let d=document.createElement("canvas");d.width=s,d.height=a*256/l,c=cM[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:d,sdfTexture:new xr(d,void 0,void 0,void 0,fr,fr),contextLost:!1,glyphsByFont:new Map},c.sdfTexture.generateMipmaps=!1,RN(c)}let{sdfTexture:u,sdfCanvas:h}=c;IN(n).then(d=>{let{glyphIds:p,glyphFontIndices:f,fontData:v,glyphPositions:g,fontSize:m,timings:x}=d,y=[],_=new Float32Array(p.length*4),w=0,b=0,T=vc(),A=v.map(z=>{let L=c.glyphsByFont.get(z.src);return L||c.glyphsByFont.set(z.src,L=new Map),L});p.forEach((z,L)=>{let G=f[L],{src:J,unitsPerEm:X}=v[G],N=A[G].get(z);if(!N){let{path:P,pathBounds:C}=d.glyphData[J][z],M=Math.max(C[2]-C[0],C[3]-C[1])/a*(_c.sdfMargin*a+.5),B=c.glyphCount++,k=[C[0]-M,C[1]-M,C[2]+M,C[3]+M];A[G].set(z,N={path:P,atlasIndex:B,sdfViewBox:k}),y.push(N)}let{sdfViewBox:U}=N,O=g[b++],F=g[b++],$=m/X;_[w++]=O+U[0]*$,_[w++]=F+U[1]*$,_[w++]=O+U[2]*$,_[w++]=F+U[3]*$,p[L]=N.atlasIndex}),x.quads=(x.quads||0)+(vc()-T);let S=vc();x.sdf={};let E=h.height,R=Math.ceil(c.glyphCount/l),D=Math.pow(2,Math.ceil(Math.log2(R*a)));D>E&&(console.info(`Increasing SDF texture size ${E}->${D}`),CN(h,s,D),u.dispose()),Promise.all(y.map(z=>EA(z,c,n.gpuAccelerateSDF).then(({timing:L})=>{x.sdf[z.atlasIndex]=L}))).then(()=>{y.length&&!c.contextLost&&(TA(c),u.needsUpdate=!0),x.sdfTotal=vc()-S,x.total=vc()-t,e(Object.freeze({parameters:n,sdfTexture:u,sdfGlyphSize:a,sdfExponent:o,glyphBounds:_,glyphAtlasIndices:p,glyphColors:d.glyphColors,caretPositions:d.caretPositions,chunkedBounds:d.chunkedBounds,ascender:d.ascender,descender:d.descender,lineHeight:d.lineHeight,capHeight:d.capHeight,xHeight:d.xHeight,topBaseline:d.topBaseline,blockBounds:d.blockBounds,visibleBounds:d.visibleBounds,timings:d.timings}))})}),Promise.resolve().then(()=>{c.contextLost||AN(h)})}function EA({path:n,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:i,sdfCanvas:r,contextLost:s},o){if(s)return Promise.resolve({timing:-1});let{textureWidth:a,sdfExponent:l}=_c,c=Math.max(t[2]-t[0],t[3]-t[1]),u=Math.floor(e/4),h=u%(a/i)*i,d=Math.floor(u/(a/i))*i,p=e%4;return wN(i,i,n,t,c,l,r,h,d,p,o)}function RN(n){let e=n.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),n.contextLost=!1;let i=[];n.glyphsByFont.forEach(r=>{r.forEach(s=>{i.push(EA(s,n,!0))})}),Promise.all(i).then(()=>{TA(n),n.sdfTexture.needsUpdate=!0})})}function LN(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}var of;function uM(n){return of||(of=typeof document>"u"?{}:document.createElement("a")),of.href=n,of.href}function TA(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");let{sdfCanvas:e,sdfTexture:t}=n,{width:i,height:r}=e,s=n.sdfCanvas.getContext("webgl"),o=t.image.data;(!o||o.length!==i*r*4)&&(o=new Uint8Array(i*r*4),t.image={width:i,height:r,data:o},t.flipY=!1,t.isDataTexture=!0),s.readPixels(0,0,i,r,s.RGBA,s.UNSIGNED_BYTE,o)}}var ON=ru({name:"Typesetter",dependencies:[_N,xN,sN],init(n,e,t){return n(e,t())}}),IN=ru({name:"Typesetter",dependencies:[ON],init(n){return function(e){return new Promise(t=>{n.typeset(e,t)})}},getTransferables(n){let e=[];for(let t in n)n[t]&&n[t].buffer&&e.push(n[t].buffer);return e}}),hM={};function FN(n){let e=hM[n];if(!e){let t=new hi(1,1,n,n),i=t.clone(),r=t.attributes,s=i.attributes,o=new ki,a=r.uv.count;for(let l=0;l<a;l++)s.position.array[l*3]*=-1,s.normal.array[l*3+2]*=-1;["position","normal","uv"].forEach(l=>{o.setAttribute(l,new Xi([...r[l].array,...s[l].array],r[l].itemSize))}),o.setIndex([...t.index.array,...i.index.array.map(l=>l+a)]),o.translate(.5,.5,0),e=hM[n]=o}return e}var kN="aTroikaGlyphBounds",dM="aTroikaGlyphIndex",UN="aTroikaGlyphColor",Vx=class extends Fy{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new bn,this.boundingBox=new tn}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){let t=this.getIndex().count;this.setDrawRange(e===Br?t/2:0,e===Kr?t:t/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=FN(e);["position","normal","uv"].forEach(i=>{this.attributes[i]=t.attributes[i].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,i,r,s){Dv(this,kN,e,4),Dv(this,dM,t,1),Dv(this,UN,s,3),this._blockBounds=i,this._chunkedBounds=r,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){let e=this._blockBounds;if(e){let{curveRadius:t,boundingBox:i}=this;if(t){let{PI:r,floor:s,min:o,max:a,sin:l,cos:c}=Math,u=r/2,h=r*2,d=Math.abs(t),p=e[0]/d,f=e[2]/d,v=s((p+u)/h)!==s((f+u)/h)?-d:o(l(p)*d,l(f)*d),g=s((p-u)/h)!==s((f-u)/h)?d:a(l(p)*d,l(f)*d),m=s((p+r)/h)!==s((f+r)/h)?d*2:a(d-c(p)*d,d-c(f)*d);i.min.set(v,e[1],t<0?-m:0),i.max.set(g,e[3],t<0?0:m)}else i.min.set(e[0],e[1],0),i.max.set(e[2],e[3],0);i.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(dM).count,i=this._chunkedBounds;if(i)for(let r=i.length;r--;){t=i[r].end;let s=i[r].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=t}};function Dv(n,e,t,i){let r=n.getAttribute(e);t?r&&r.array.length===t.length?(r.array.set(t),r.needsUpdate=!0):(n.setAttribute(e,new qc(t,i)),delete n._maxInstanceCount,n.dispose()):r&&n.deleteAttribute(e)}var zN=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,BN=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,NN=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,GN=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function VN(n){let e=Nx(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Me},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new zt(0,0,0,0)},uTroikaClipRect:{value:new zt(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Me},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new at},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new gt},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:zN,vertexTransform:BN,fragmentDefs:NN,fragmentColorTransform:GN,customRewriter({vertexShader:t,fragmentShader:i}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(i)&&(i=i.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(t)||(t=t.replace(bA,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:i}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}var o_=new gr({color:16777215,side:Kr,transparent:!0}),pM=8421504,fM=new Et,af=new oe,Pv=new oe,nh=[],HN=new oe,Rv="+x+y";function mM(n){return Array.isArray(n)?n[0]:n}var MA=()=>{let n=new wt(new hi(1,1),o_);return MA=()=>n,n},AA=()=>{let n=new wt(new hi(1,1,32,1),o_);return AA=()=>n,n},WN={type:"syncstart"},qN={type:"synccomplete"},CA=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],jN=CA.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail"),to=class extends wt{constructor(){let e=new Vx;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=pM,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Rv,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(WN),PN({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);let i=this._queuedSyncs;i&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{i.forEach(r=>r&&r())})),this.dispatchEvent(qN),e&&e()})))}onBeforeRender(e,t,i,r,s,o){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s),s._hadOwnSide=s.hasOwnProperty("side"),this.geometry.setSide(s._actualSide=s.side),s.side=Di}onAfterRender(e,t,i,r,s,o){s._hadOwnSide?s.side=s._actualSide:delete s.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial,t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=o_.clone());if((!e||e.baseMaterial!==t)&&(e=this._derivedMaterial=VN(t),t.addEventListener("dispose",function i(){t.removeEventListener("dispose",i),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let i=e._outlineMtl;return i||(i=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),i.isTextOutlineMaterial=!0,i.depthWrite=!1,i.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),i.dispose()})),[i,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return mM(this.material).getDepthMaterial()}get customDistanceMaterial(){return mM(this.material).getDistanceMaterial()}_prepareForRender(e){let t=e.isTextOutlineMaterial,i=e.uniforms,r=this.textRenderInfo;if(r){let{sdfTexture:a,blockBounds:l}=r;i.uTroikaSDFTexture.value=a,i.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),i.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,i.uTroikaSDFExponent.value=r.sdfExponent,i.uTroikaTotalBounds.value.fromArray(l),i.uTroikaUseGlyphColors.value=!t&&!!r.glyphColors;let c=0,u=0,h=0,d,p,f,v=0,g=0;if(t){let{outlineWidth:x,outlineOffsetX:y,outlineOffsetY:_,outlineBlur:w,outlineOpacity:b}=this;c=this._parsePercent(x)||0,u=Math.max(0,this._parsePercent(w)||0),d=b,v=this._parsePercent(y)||0,g=this._parsePercent(_)||0}else h=Math.max(0,this._parsePercent(this.strokeWidth)||0),h&&(f=this.strokeColor,i.uTroikaStrokeColor.value.set(f!=null?f:pM),p=this.strokeOpacity,p==null&&(p=1)),d=this.fillOpacity;i.uTroikaDistanceOffset.value=c,i.uTroikaPositionOffset.value.set(v,g),i.uTroikaBlurRadius.value=u,i.uTroikaStrokeWidth.value=h,i.uTroikaStrokeOpacity.value=p,i.uTroikaFillOpacity.value=d!=null?d:1,i.uTroikaCurveRadius.value=this.curveRadius||0;let m=this.clipRect;if(m&&Array.isArray(m)&&m.length===4)i.uTroikaClipRect.value.fromArray(m);else{let x=(this.fontSize||.1)*100;i.uTroikaClipRect.value.set(l[0]-x,l[1]-x,l[2]+x,l[3]+x)}this.geometry.applyClipRect(i.uTroikaClipRect.value)}i.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;let s=t?this.outlineColor||0:this.color;if(s==null)delete e.color;else{let a=e.hasOwnProperty("color")?e.color:e.color=new at;(s!==a._input||typeof s=="object")&&a.set(a._input=s)}let o=this.orientation||Rv;if(o!==e._orientation){let a=i.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let l=o!==Rv&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,u,h,d]=l;af.set(0,0,0)[u]=c==="-"?1:-1,Pv.set(0,0,0)[d]=h==="-"?-1:1,fM.lookAt(HN,af.cross(Pv),Pv),a.setFromMatrix4(fM)}else a.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),i=t?parseFloat(t[1]):NaN;e=(isNaN(i)?0:i/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new Me){t.copy(e);let i=this.curveRadius;return i&&(t.x=Math.atan2(e.x,Math.abs(i)-Math.abs(e.z))*Math.abs(i)),t}worldPositionToTextCoords(e,t=new Me){return af.copy(e),this.localPositionToTextCoords(this.worldToLocal(af),t)}raycast(e,t){let{textRenderInfo:i,curveRadius:r}=this;if(i){let s=i.blockBounds,o=r?AA():MA(),a=o.geometry,{position:l,uv:c}=a.attributes;for(let u=0;u<c.count;u++){let h=s[0]+c.getX(u)*(s[2]-s[0]),d=s[1]+c.getY(u)*(s[3]-s[1]),p=0;r&&(p=r-Math.cos(h/r)*r,h=Math.sin(h/r)*r),l.setXYZ(u,h,d,p)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,nh.length=0,o.raycast(e,nh);for(let u=0;u<nh.length;u++)nh[u].object=this,t.push(nh[u])}}copy(e){let t=this.geometry;return super.copy(e),this.geometry=t,jN.forEach(i=>{this[i]=e[i]}),this}clone(){return new this.constructor().copy(this)}};CA.forEach(n=>{let e="_private_"+n;Object.defineProperty(to.prototype,n,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});lt.registerPlugin(mt);var Hx=class{constructor(e){this.group=e,this.app=new Bt,this.helper=new Yt,this.timeline=this.app.sharedAnimationTimeline.timeline,this.scrollingTimeline=this.app.sharedAnimationTimeline.scrollingTimeline,this.textArray=[],this.allTextGroup=new vt,this.allTextGroup.name="allTextGroup",this.allTextGroupStatic=new vt,this.allTextGroupStatic.name="allTextGroupStatic",this.group.add(this.allTextGroupStatic),this.allTextGroupStatic.add(this.allTextGroup),this.font=this.app.resources.font,this.element=document.getElementById("gl-space-scene"),this.rect=this.element.getBoundingClientRect(),this.app.sizes.width/this.app.sizes.width;let t=.165;this.ratioA=this.app.sizes.pixelsToWorldUnits(this.app.sizes.width*.025,t),this.ratioAMobile=this.app.sizes.pixelsToWorldUnits(this.app.sizes.width<400?this.app.sizes.width*.045:this.app.sizes.width<=500?this.app.sizes.width*.035:this.app.sizes.width*.025,t),this.ratioB=this.app.sizes.getVisible(t).x*-.46,this.ratioBMobile=this.app.sizes.getVisible(t).x*-.23,this.ratioC=this.app.sizes.getVisible(t).x*.22,this.ratioCMobile=this.app.sizes.getVisible(t).x*-.26,this.fontSize=this.app.isMobile?this.ratioAMobile:this.ratioA,this.positionLeft=this.app.isMobile?this.ratioBMobile:this.ratioB,this.positionRight=this.app.isMobile?this.ratioCMobile:this.ratioC,this.yMoveShifter1=this.app.isMobile?-.064:0,this.yMoveShifter2=this.app.isMobile?-.072:0,this.mask(),this.fontSetup(),this.animation(),this.textArray.forEach(i=>{i.renderOrder=999}),this.app.world.logoLoader.on("scrolling-enabled",()=>{this.textMesh.sync(()=>{this.allTextGroupStatic.add(this.textMesh)}),this.textMesh2.sync(()=>{this.allTextGroup.add(this.textMesh2)}),this.textMesh3.sync(()=>{this.allTextGroup.add(this.textMesh3)}),this.textMesh4.sync(()=>{this.allTextGroup.add(this.textMesh4)}),this.textMesh5.sync(()=>{this.allTextGroup.add(this.textMesh5)}),this.textMesh6.sync(()=>{this.allTextGroup.add(this.textMesh6)})})}fontSetup(){let e=new ri({uniforms:{opacity:{value:1}},vertexShader:`
            varying vec2 vUv;
            void main() {
              vUv = uv;
              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
            `,fragmentShader:`
            uniform float opacity;
            varying vec2 vUv;
            void main() {
              gl_FragColor = vec4(1.0, 1.0, 1.0, opacity);
              // gl_FragColor = vec4(vUv, 1.0, 1.0);
    
            }
            `,transparent:!0,stencilWrite:!0,stencilFunc:P1,stencilRef:1,stencilZPass:ja,depthTest:!1,depthWrite:!1}),t=new ri({uniforms:{opacity:{value:1}},vertexShader:`
            varying vec2 vUv;
            void main() {
              vUv = uv;
              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
            `,fragmentShader:`
            uniform float opacity;
            varying vec2 vUv;
            void main() {
              gl_FragColor = vec4(1.0, 1.0, 1.0, opacity);
              // gl_FragColor = vec4(vUv, 1.0, 1.0);
    
            }
            `,transparent:!0,stencilWrite:!0,depthTest:!1,depthWrite:!1});this.textMesh=new to,this.textMesh.text="WHERE GAMES",this.textMesh.fontSize=this.fontSize,this.textMesh.position.set(this.positionLeft,0+this.yMoveShifter1,0),this.textMesh.material=t,this.textMesh.material.depthTest=!1,this.textMesh.material.depthWrite=!1,this.textMesh.material.transparent=!0,this.textMesh.font=this.font,this.textArray.push(this.textMesh),this.textMesh2=new to,this.textMesh2.text="INFINITELY SCALE",this.textMesh2.fontSize=this.fontSize;let i=this.positionRight-5e-4;this.textMesh2.position.set(this.isMobile?this.positionRight:i,0+this.yMoveShifter2,0),this.textMesh2.material=e,this.textMesh2.material.depthTest=!1,this.textMesh2.material.depthWrite=!1,this.textMesh2.material.transparent=!0,this.textMesh2.font=this.font,this.textArray.push(this.textMesh2),this.textMesh3=new to,this.textMesh3.text="BREAK BOUNDARIES",this.textMesh3.fontSize=this.fontSize;let r=this.positionRight-.0045;this.textMesh3.position.set(this.isMobile?this.positionRight:r,-.02+this.yMoveShifter2,0),this.textMesh3.material=e,this.textMesh3.material.depthTest=!1,this.textMesh3.material.depthWrite=!1,this.textMesh3.material.transparent=!0,this.textMesh3.font=this.font,this.textArray.push(this.textMesh3),this.textMesh4=new to,this.textMesh4.text="RUN ENDLESSLY",this.textMesh4.fontSize=this.fontSize;let s=this.positionRight+22e-5;this.textMesh4.position.set(this.isMobile?this.positionRight:s,-.04+this.yMoveShifter2,0),this.textMesh4.material=e,this.textMesh4.material.depthTest=!1,this.textMesh4.material.depthWrite=!1,this.textMesh4.material.transparent=!0,this.textMesh4.font=this.font,this.textArray.push(this.textMesh4),this.textMesh5=new to,this.textMesh5.text="REIMAGINE PLAY",this.textMesh5.fontSize=this.fontSize;let o=this.positionRight-.0045;this.textMesh5.position.set(this.isMobile?this.positionRight:o,-.06+this.yMoveShifter2,0),this.textMesh5.material=e,this.textMesh5.material.depthTest=!1,this.textMesh5.material.depthWrite=!1,this.textMesh5.material.transparent=!0,this.textMesh5.font=this.font,this.textArray.push(this.textMesh5),this.textMesh6=new to,this.textMesh6.text="INFINITELY SCALE",this.textMesh6.fontSize=this.fontSize,this.textMesh6.position.set(this.IsMobile?this.positionRight:i,-.08+this.yMoveShifter2,0),this.textMesh6.material=e,this.textMesh6.material.depthTest=!1,this.textMesh6.material.depthWrite=!1,this.textMesh6.material.transparent=!0,this.textMesh6.font=this.font,this.textArray.push(this.textMesh6),this.app.world.logoLoader.on("scrolling-enabled",()=>{mt.create({animation:this.scrollingTimeline,trigger:".webgl",start:this.app.sizes.height*.1,end:this.app.sizes.height,scrub:2,onEnter:()=>{let a=[.1,.16,.2],l=Math.floor(Math.random()*3)+2,c=a[Math.floor(Math.random()*a.length)];lt.fromTo(e.uniforms.opacity,{value:1},{value:0,duration:c,repeat:l,ease:"none",delay:0,onComplete:()=>{e.uniforms.opacity.value=0}}),lt.fromTo(t.uniforms.opacity,{value:1},{value:0,duration:c,repeat:l,ease:"none",delay:0,onComplete:()=>{t.uniforms.opacity.value=0}})},onLeaveBack:()=>{let a=[.1,.16,.2],l=Math.floor(Math.random()*3)+2,c=a[Math.floor(Math.random()*a.length)];lt.fromTo(e.uniforms.opacity,{value:0},{value:1,duration:c,repeat:l,ease:"none",delay:0,onComplete:()=>{e.uniforms.opacity.value=1}}),lt.fromTo(t.uniforms.opacity,{value:0},{value:1,duration:c,repeat:l,ease:"none",delay:0,onComplete:()=>{t.uniforms.opacity.value=1}})}})})}mask(){this.maskGroup=new vt,this.maskGroup.name="maskGroup",this.group.add(this.maskGroup),this.app.isMobile?this.maskGeometry=new hi(3,1*this.ratioAMobile):this.maskGeometry=new hi(3,1*this.ratioA),this.maskMaterial=new gr({color:new at(1,1,1),opacity:0,transparent:!0,depthTest:!1,depthWrite:!1,stencilWrite:!0,stencilFunc:Vv,stencilRef:1,stencilZPass:IM}),this.instanceMask=new wt(this.maskGeometry,this.maskMaterial),this.app.isMobile?this.instanceMask.position.set(0,-.0745,0):this.instanceMask.position.set(0,-this.ratioA*.5,0),this.maskGroup.add(this.instanceMask),this.instanceMask.renderOrder=998,this.instanceMask.depthTest=!1,this.instanceMask.depthWrite=!1}animation(){this.timeline.add(lt.to(this.allTextGroup.position,{y:0,duration:1,ease:_t}),0),this.timeline.add(lt.to(this.allTextGroup.position,{y:0,duration:2,ease:_t}),1),this.timeline.add(lt.to(this.allTextGroup.position,{y:.02,duration:1,ease:_t}),Fr*.25),this.timeline.add(lt.to(this.allTextGroup.position,{y:.02,duration:.3,ease:_t}),Fr*.333333333333333),this.timeline.add(lt.to(this.allTextGroup.position,{y:.04,duration:1,ease:_t}),Fr*.5),this.timeline.add(lt.to(this.allTextGroup.position,{y:.04,duration:.3,ease:_t}),Fr*.583333333333333),this.timeline.add(lt.to(this.allTextGroup.position,{y:.06,duration:1,ease:_t}),Fr*.75),this.timeline.add(lt.to(this.allTextGroup.position,{y:.06,duration:.3,ease:_t}),Fr*.833333333333333),this.timeline.add(lt.to(this.allTextGroup.position,{y:.08,duration:1,ease:_t}),Fr)}update(){}};function lf(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var DA={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,r,s){function o(c,u){if(!r[c]){if(!i[c]){var h=typeof lf=="function"&&lf;if(!u&&h)return h(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+c+"'")}var d=r[c]={exports:{}};i[c][0].call(d.exports,function(p){var f=i[c][1][p];return o(f||p)},d,d.exports,t,i,r,s)}return r[c].exports}for(var a=typeof lf=="function"&&lf,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,i,r){i.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(t,i,r){i.exports={version:t("../package.json").version,AABB:t("./collision/AABB"),ArrayCollisionMatrix:t("./collision/ArrayCollisionMatrix"),Body:t("./objects/Body"),Box:t("./shapes/Box"),Broadphase:t("./collision/Broadphase"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),Narrowphase:t("./world/Narrowphase"),ConeTwistConstraint:t("./constraints/ConeTwistConstraint"),ContactMaterial:t("./material/ContactMaterial"),ConvexPolyhedron:t("./shapes/ConvexPolyhedron"),Cylinder:t("./shapes/Cylinder"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventTarget:t("./utils/EventTarget"),FrictionEquation:t("./equations/FrictionEquation"),GSSolver:t("./solver/GSSolver"),GridBroadphase:t("./collision/GridBroadphase"),Heightfield:t("./shapes/Heightfield"),HingeConstraint:t("./constraints/HingeConstraint"),LockConstraint:t("./constraints/LockConstraint"),Mat3:t("./math/Mat3"),Material:t("./material/Material"),NaiveBroadphase:t("./collision/NaiveBroadphase"),ObjectCollisionMatrix:t("./collision/ObjectCollisionMatrix"),Pool:t("./utils/Pool"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),PointToPointConstraint:t("./constraints/PointToPointConstraint"),Quaternion:t("./math/Quaternion"),Ray:t("./collision/Ray"),RaycastVehicle:t("./objects/RaycastVehicle"),RaycastResult:t("./collision/RaycastResult"),RigidVehicle:t("./objects/RigidVehicle"),RotationalEquation:t("./equations/RotationalEquation"),RotationalMotorEquation:t("./equations/RotationalMotorEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),SPHSystem:t("./objects/SPHSystem"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Sphere:t("./shapes/Sphere"),SplitSolver:t("./solver/SplitSolver"),Spring:t("./objects/Spring"),Trimesh:t("./shapes/Trimesh"),Vec3:t("./math/Vec3"),Vec3Pool:t("./utils/Vec3Pool"),World:t("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(t,i,r){var s=t("../math/Vec3");t("../utils/Utils"),i.exports=o;function o(c){c=c||{},this.lowerBound=new s,c.lowerBound&&this.lowerBound.copy(c.lowerBound),this.upperBound=new s,c.upperBound&&this.upperBound.copy(c.upperBound)}var a=new s;o.prototype.setFromPoints=function(c,u,h,d){var p=this.lowerBound,f=this.upperBound,v=h;p.copy(c[0]),v&&v.vmult(p,p),f.copy(p);for(var g=1;g<c.length;g++){var m=c[g];v&&(v.vmult(m,a),m=a),m.x>f.x&&(f.x=m.x),m.x<p.x&&(p.x=m.x),m.y>f.y&&(f.y=m.y),m.y<p.y&&(p.y=m.y),m.z>f.z&&(f.z=m.z),m.z<p.z&&(p.z=m.z)}return u&&(u.vadd(p,p),u.vadd(f,f)),d&&(p.x-=d,p.y-=d,p.z-=d,f.x+=d,f.y+=d,f.z+=d),this},o.prototype.copy=function(c){return this.lowerBound.copy(c.lowerBound),this.upperBound.copy(c.upperBound),this},o.prototype.clone=function(){return new o().copy(this)},o.prototype.extend=function(c){var u=c.lowerBound.x;this.lowerBound.x>u&&(this.lowerBound.x=u);var h=c.upperBound.x;this.upperBound.x<h&&(this.upperBound.x=h);var u=c.lowerBound.y;this.lowerBound.y>u&&(this.lowerBound.y=u);var h=c.upperBound.y;this.upperBound.y<h&&(this.upperBound.y=h);var u=c.lowerBound.z;this.lowerBound.z>u&&(this.lowerBound.z=u);var h=c.upperBound.z;this.upperBound.z<h&&(this.upperBound.z=h)},o.prototype.overlaps=function(c){var u=this.lowerBound,h=this.upperBound,d=c.lowerBound,p=c.upperBound;return(d.x<=h.x&&h.x<=p.x||u.x<=p.x&&p.x<=h.x)&&(d.y<=h.y&&h.y<=p.y||u.y<=p.y&&p.y<=h.y)&&(d.z<=h.z&&h.z<=p.z||u.z<=p.z&&p.z<=h.z)},o.prototype.contains=function(c){var u=this.lowerBound,h=this.upperBound,d=c.lowerBound,p=c.upperBound;return u.x<=d.x&&h.x>=p.x&&u.y<=d.y&&h.y>=p.y&&u.z<=d.z&&h.z>=p.z},o.prototype.getCorners=function(c,u,h,d,p,f,v,g){var m=this.lowerBound,x=this.upperBound;c.copy(m),u.set(x.x,m.y,m.z),h.set(x.x,x.y,m.z),d.set(m.x,x.y,x.z),p.set(x.x,m.y,m.z),f.set(m.x,x.y,m.z),v.set(m.x,m.y,x.z),g.copy(x)};var l=[new s,new s,new s,new s,new s,new s,new s,new s];o.prototype.toLocalFrame=function(c,u){var h=l,d=h[0],p=h[1],f=h[2],v=h[3],g=h[4],m=h[5],x=h[6],y=h[7];this.getCorners(d,p,f,v,g,m,x,y);for(var _=0;_!==8;_++){var w=h[_];c.pointToLocal(w,w)}return u.setFromPoints(h)},o.prototype.toWorldFrame=function(c,u){var h=l,d=h[0],p=h[1],f=h[2],v=h[3],g=h[4],m=h[5],x=h[6],y=h[7];this.getCorners(d,p,f,v,g,m,x,y);for(var _=0;_!==8;_++){var w=h[_];c.pointToWorld(w,w)}return u.setFromPoints(h)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(t,i,r){i.exports=s;function s(){this.matrix=[]}s.prototype.get=function(o,a){if(o=o.index,a=a.index,a>o){var l=a;a=o,o=l}return this.matrix[(o*(o+1)>>1)+a-1]},s.prototype.set=function(o,a,l){if(o=o.index,a=a.index,a>o){var c=a;a=o,o=c}this.matrix[(o*(o+1)>>1)+a-1]=l?1:0},s.prototype.reset=function(){for(var o=0,a=this.matrix.length;o!==a;o++)this.matrix[o]=0},s.prototype.setNumObjects=function(o){this.matrix.length=o*(o-1)>>1}},{}],5:[function(t,i,r){var s=t("../objects/Body"),o=t("../math/Vec3"),a=t("../math/Quaternion");t("../shapes/Shape"),t("../shapes/Plane"),i.exports=l;function l(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}l.prototype.collisionPairs=function(v,g,m){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var c=s.STATIC|s.KINEMATIC;l.prototype.needBroadphaseCollision=function(v,g){return!(!(v.collisionFilterGroup&g.collisionFilterMask)||!(g.collisionFilterGroup&v.collisionFilterMask)||(v.type&c||v.sleepState===s.SLEEPING)&&(g.type&c||g.sleepState===s.SLEEPING))},l.prototype.intersectionTest=function(v,g,m,x){this.useBoundingBoxes?this.doBoundingBoxBroadphase(v,g,m,x):this.doBoundingSphereBroadphase(v,g,m,x)};var u=new o;new o,new a,new o,l.prototype.doBoundingSphereBroadphase=function(v,g,m,x){var y=u;g.position.vsub(v.position,y);var _=Math.pow(v.boundingRadius+g.boundingRadius,2),w=y.norm2();w<_&&(m.push(v),x.push(g))},l.prototype.doBoundingBoxBroadphase=function(v,g,m,x){v.aabbNeedsUpdate&&v.computeAABB(),g.aabbNeedsUpdate&&g.computeAABB(),v.aabb.overlaps(g.aabb)&&(m.push(v),x.push(g))};var h={keys:[]},d=[],p=[];l.prototype.makePairsUnique=function(v,g){for(var m=h,x=d,y=p,_=v.length,w=0;w!==_;w++)x[w]=v[w],y[w]=g[w];v.length=0,g.length=0;for(var w=0;w!==_;w++){var b=x[w].id,T=y[w].id,A=b<T?b+","+T:T+","+b;m[A]=w,m.keys.push(A)}for(var w=0;w!==m.keys.length;w++){var A=m.keys.pop(),S=m[A];v.push(x[S]),g.push(y[S]),delete m[A]}},l.prototype.setWorld=function(v){};var f=new o;l.boundingSphereCheck=function(v,g){var m=f;return v.position.vsub(g.position,m),Math.pow(v.shape.boundingSphereRadius+g.shape.boundingSphereRadius,2)>m.norm2()},l.prototype.aabbQuery=function(v,g,m){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(t,i,r){i.exports=l;var s=t("./Broadphase"),o=t("../math/Vec3"),a=t("../shapes/Shape");function l(u,h,d,p,f){s.apply(this),this.nx=d||10,this.ny=p||10,this.nz=f||10,this.aabbMin=u||new o(100,100,100),this.aabbMax=h||new o(-100,-100,-100);var v=this.nx*this.ny*this.nz;if(v<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=v,this.binLengths.length=v;for(var g=0;g<v;g++)this.bins[g]=[],this.binLengths[g]=0}l.prototype=new s,l.prototype.constructor=l;var c=new o;new o,l.prototype.collisionPairs=function(u,h,d){var p=u.numObjects(),f=u.bodies,k=this.aabbMax,B=this.aabbMin,v=this.nx,g=this.ny,m=this.nz,x=g*m,y=m,_=1,w=k.x,b=k.y,T=k.z,A=B.x,S=B.y,E=B.z,R=v/(w-A),D=g/(b-S),z=m/(T-E),L=(w-A)/v,G=(b-S)/g,J=(T-E)/m,X=Math.sqrt(L*L+G*G+J*J)*.5,N=a.types,U=N.SPHERE,O=N.PLANE;N.BOX,N.COMPOUND,N.CONVEXPOLYHEDRON;for(var F=this.bins,$=this.binLengths,P=this.bins.length,C=0;C!==P;C++)$[C]=0;var M=Math.ceil,B=Math.min,k=Math.max;function Q(Ae,it,se,Le,Ee,ke,We){var Qe=(Ae-A)*R|0,rt=(it-S)*D|0,Oe=(se-E)*z|0,Ce=M((Le-A)*R),le=M((Ee-S)*D),Pe=M((ke-E)*z);Qe<0?Qe=0:Qe>=v&&(Qe=v-1),rt<0?rt=0:rt>=g&&(rt=g-1),Oe<0?Oe=0:Oe>=m&&(Oe=m-1),Ce<0?Ce=0:Ce>=v&&(Ce=v-1),le<0?le=0:le>=g&&(le=g-1),Pe<0?Pe=0:Pe>=m&&(Pe=m-1),Qe*=x,rt*=y,Oe*=_,Ce*=x,le*=y,Pe*=_;for(var Ve=Qe;Ve<=Ce;Ve+=x)for(var et=rt;et<=le;et+=y)for(var Je=Oe;Je<=Pe;Je+=_){var Te=Ve+et+Je;F[Te][$[Te]++]=We}}for(var C=0;C!==p;C++){var Y=f[C],re=Y.shape;switch(re.type){case U:var Z=Y.position.x,V=Y.position.y,ne=Y.position.z,ie=re.radius;Q(Z-ie,V-ie,ne-ie,Z+ie,V+ie,ne+ie,Y);break;case O:re.worldNormalNeedsUpdate&&re.computeWorldNormal(Y.quaternion);var te=re.worldNormal,j=A+L*.5-Y.position.x,W=S+G*.5-Y.position.y,H=E+J*.5-Y.position.z,q=c;q.set(j,W,H);for(var I=0,ee=0;I!==v;I++,ee+=x,q.y=W,q.x+=L)for(var me=0,pe=0;me!==g;me++,pe+=y,q.z=H,q.y+=G)for(var ge=0,xe=0;ge!==m;ge++,xe+=_,q.z+=J)if(q.dot(te)<X){var we=ee+pe+xe;F[we][$[we]++]=Y}break;default:Y.aabbNeedsUpdate&&Y.computeAABB(),Q(Y.aabb.lowerBound.x,Y.aabb.lowerBound.y,Y.aabb.lowerBound.z,Y.aabb.upperBound.x,Y.aabb.upperBound.y,Y.aabb.upperBound.z,Y);break}}for(var C=0;C!==P;C++){var _e=$[C];if(_e>1)for(var Ie=F[C],I=0;I!==_e;I++)for(var Y=Ie[I],me=0;me!==I;me++){var Be=Ie[me];this.needBroadphaseCollision(Y,Be)&&this.intersectionTest(Y,Be,h,d)}}this.makePairsUnique(h,d)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(t,i,r){i.exports=a;var s=t("./Broadphase"),o=t("./AABB");function a(){s.apply(this)}a.prototype=new s,a.prototype.constructor=a,a.prototype.collisionPairs=function(l,c,u){var h=l.bodies,d=h.length,p,f,v,g;for(p=0;p!==d;p++)for(f=0;f!==p;f++)v=h[p],g=h[f],this.needBroadphaseCollision(v,g)&&this.intersectionTest(v,g,c,u)},new o,a.prototype.aabbQuery=function(l,c,u){u=u||[];for(var h=0;h<l.bodies.length;h++){var d=l.bodies[h];d.aabbNeedsUpdate&&d.computeAABB(),d.aabb.overlaps(c)&&u.push(d)}return u}},{"./AABB":3,"./Broadphase":5}],8:[function(t,i,r){i.exports=s;function s(){this.matrix={}}s.prototype.get=function(o,a){if(o=o.id,a=a.id,a>o){var l=a;a=o,o=l}return o+"-"+a in this.matrix},s.prototype.set=function(o,a,l){if(o=o.id,a=a.id,a>o){var c=a;a=o,o=c}l?this.matrix[o+"-"+a]=!0:delete this.matrix[o+"-"+a]},s.prototype.reset=function(){this.matrix={}},s.prototype.setNumObjects=function(o){}},{}],9:[function(t,i,r){i.exports=h;var s=t("../math/Vec3"),o=t("../math/Quaternion"),a=t("../math/Transform");t("../shapes/ConvexPolyhedron"),t("../shapes/Box");var l=t("../collision/RaycastResult"),c=t("../shapes/Shape"),u=t("../collision/AABB");function h(P,C){this.from=P?P.clone():new s,this.to=C?C.clone():new s,this._direction=new s,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=h.ANY,this.result=new l,this.hasHit=!1,this.callback=function(M){}}h.prototype.constructor=h,h.CLOSEST=1,h.ANY=2,h.ALL=4;var d=new u,p=[];h.prototype.intersectWorld=function(P,C){return this.mode=C.mode||h.ANY,this.result=C.result||new l,this.skipBackfaces=!!C.skipBackfaces,this.collisionFilterMask=typeof C.collisionFilterMask<"u"?C.collisionFilterMask:-1,this.collisionFilterGroup=typeof C.collisionFilterGroup<"u"?C.collisionFilterGroup:-1,C.from&&this.from.copy(C.from),C.to&&this.to.copy(C.to),this.callback=C.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(d),p.length=0,P.broadphase.aabbQuery(P,d,p),this.intersectBodies(p),this.hasHit};var f=new s,v=new s;h.pointInTriangle=g;function g(P,C,M,B){B.vsub(C,O),M.vsub(C,f),P.vsub(C,v);var k=O.dot(O),Q=O.dot(f),Y=O.dot(v),re=f.dot(f),Z=f.dot(v),V,ne;return(V=re*Y-Q*Z)>=0&&(ne=k*Z-Q*Y)>=0&&V+ne<k*re-Q*Q}var m=new s,x=new o;h.prototype.intersectBody=function(P,C){C&&(this.result=C,this._updateDirection());var M=this.checkCollisionResponse;if(!(M&&!P.collisionResponse)&&!(!(this.collisionFilterGroup&P.collisionFilterMask)||!(P.collisionFilterGroup&this.collisionFilterMask)))for(var B=m,k=x,Q=0,Y=P.shapes.length;Q<Y;Q++){var re=P.shapes[Q];if(!(M&&!re.collisionResponse)&&(P.quaternion.mult(P.shapeOrientations[Q],k),P.quaternion.vmult(P.shapeOffsets[Q],B),B.vadd(P.position,B),this.intersectShape(re,k,B,P),this.result._shouldStop))break}},h.prototype.intersectBodies=function(P,C){C&&(this.result=C,this._updateDirection());for(var M=0,B=P.length;!this.result._shouldStop&&M<B;M++)this.intersectBody(P[M])},h.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},h.prototype.intersectShape=function(P,C,M,B){var k=this.from,Q=$(k,this._direction,M);if(!(Q>P.boundingSphereRadius)){var Y=this[P.type];Y&&Y.call(this,P,C,M,B)}},new s,new s;var y=new s,_=new s,w=new s,b=new s;new s,new l,h.prototype.intersectBox=function(P,C,M,B){return this.intersectConvex(P.convexPolyhedronRepresentation,C,M,B)},h.prototype[c.types.BOX]=h.prototype.intersectBox,h.prototype.intersectPlane=function(P,C,M,B){var k=this.from,Q=this.to,Y=this._direction,re=new s(0,0,1);C.vmult(re,re);var Z=new s;k.vsub(M,Z);var V=Z.dot(re);Q.vsub(M,Z);var ne=Z.dot(re);if(!(V*ne>0)&&!(k.distanceTo(Q)<V)){var ie=re.dot(Y);if(!(Math.abs(ie)<this.precision)){var te=new s,j=new s,W=new s;k.vsub(M,te);var H=-re.dot(te)/ie;Y.scale(H,j),k.vadd(j,W),this.reportIntersection(re,W,P,B,-1)}}},h.prototype[c.types.PLANE]=h.prototype.intersectPlane,h.prototype.getAABB=function(P){var C=this.to,M=this.from;P.lowerBound.x=Math.min(C.x,M.x),P.lowerBound.y=Math.min(C.y,M.y),P.lowerBound.z=Math.min(C.z,M.z),P.upperBound.x=Math.max(C.x,M.x),P.upperBound.y=Math.max(C.y,M.y),P.upperBound.z=Math.max(C.z,M.z)};var T={faceList:[0]};h.prototype.intersectHeightfield=function(P,C,M,B){P.data,P.elementSize;var k=new s,Q=new h(this.from,this.to);a.pointToLocalFrame(M,C,Q.from,Q.from),a.pointToLocalFrame(M,C,Q.to,Q.to);var Y=[],re=null,Z=null,V=null,ne=null,ie=P.getIndexOfPosition(Q.from.x,Q.from.y,Y,!1);if(ie&&(re=Y[0],Z=Y[1],V=Y[0],ne=Y[1]),ie=P.getIndexOfPosition(Q.to.x,Q.to.y,Y,!1),ie&&((re===null||Y[0]<re)&&(re=Y[0]),(V===null||Y[0]>V)&&(V=Y[0]),(Z===null||Y[1]<Z)&&(Z=Y[1]),(ne===null||Y[1]>ne)&&(ne=Y[1])),re!==null){var te=[];P.getRectMinMax(re,Z,V,ne,te),te[0],te[1];for(var j=re;j<=V;j++)for(var W=Z;W<=ne;W++){if(this.result._shouldStop||(P.getConvexTrianglePillar(j,W,!1),a.pointToWorldFrame(M,C,P.pillarOffset,k),this.intersectConvex(P.pillarConvex,C,k,B,T),this.result._shouldStop))return;P.getConvexTrianglePillar(j,W,!0),a.pointToWorldFrame(M,C,P.pillarOffset,k),this.intersectConvex(P.pillarConvex,C,k,B,T)}}},h.prototype[c.types.HEIGHTFIELD]=h.prototype.intersectHeightfield;var A=new s,S=new s;h.prototype.intersectSphere=function(P,C,M,B){var k=this.from,Q=this.to,Y=P.radius,re=Math.pow(Q.x-k.x,2)+Math.pow(Q.y-k.y,2)+Math.pow(Q.z-k.z,2),Z=2*((Q.x-k.x)*(k.x-M.x)+(Q.y-k.y)*(k.y-M.y)+(Q.z-k.z)*(k.z-M.z)),V=Math.pow(k.x-M.x,2)+Math.pow(k.y-M.y,2)+Math.pow(k.z-M.z,2)-Math.pow(Y,2),ne=Math.pow(Z,2)-4*re*V,ie=A,te=S;if(!(ne<0))if(ne===0)k.lerp(Q,ne,ie),ie.vsub(M,te),te.normalize(),this.reportIntersection(te,ie,P,B,-1);else{var j=(-Z-Math.sqrt(ne))/(2*re),W=(-Z+Math.sqrt(ne))/(2*re);if(j>=0&&j<=1&&(k.lerp(Q,j,ie),ie.vsub(M,te),te.normalize(),this.reportIntersection(te,ie,P,B,-1)),this.result._shouldStop)return;W>=0&&W<=1&&(k.lerp(Q,W,ie),ie.vsub(M,te),te.normalize(),this.reportIntersection(te,ie,P,B,-1))}},h.prototype[c.types.SPHERE]=h.prototype.intersectSphere;var E=new s;new s,new s;var R=new s;h.prototype.intersectConvex=function(P,C,M,B,k){for(var Q=E,Y=R,re=k&&k.faceList||null,Z=P.faces,V=P.vertices,ne=P.faceNormals,ie=this._direction,te=this.from,j=this.to,W=te.distanceTo(j),H=re?re.length:Z.length,q=this.result,I=0;!q._shouldStop&&I<H;I++){var ee=re?re[I]:I,me=Z[ee],pe=ne[ee],ge=C,xe=M;Y.copy(V[me[0]]),ge.vmult(Y,Y),Y.vadd(xe,Y),Y.vsub(te,Y),ge.vmult(pe,Q);var we=ie.dot(Q);if(!(Math.abs(we)<this.precision)){var _e=Q.dot(Y)/we;if(!(_e<0)){ie.mult(_e,y),y.vadd(te,y),_.copy(V[me[0]]),ge.vmult(_,_),xe.vadd(_,_);for(var Ie=1;!q._shouldStop&&Ie<me.length-1;Ie++){w.copy(V[me[Ie]]),b.copy(V[me[Ie+1]]),ge.vmult(w,w),ge.vmult(b,b),xe.vadd(w,w),xe.vadd(b,b);var Be=y.distanceTo(te);!(g(y,_,w,b)||g(y,w,_,b))||Be>W||this.reportIntersection(Q,y,P,B,ee)}}}}},h.prototype[c.types.CONVEXPOLYHEDRON]=h.prototype.intersectConvex;var D=new s,z=new s,L=new s,G=new s,J=new s,X=new s;new u;var N=[],U=new a;h.prototype.intersectTrimesh=function(P,C,M,B,k){var Q=D,Y=N,re=U,Z=R,V=z,ne=L,ie=G,te=X,j=J;k&&k.faceList;var W=P.indices;P.vertices,P.faceNormals;var H=this.from,q=this.to,I=this._direction;re.position.copy(M),re.quaternion.copy(C),a.vectorToLocalFrame(M,C,I,V),a.pointToLocalFrame(M,C,H,ne),a.pointToLocalFrame(M,C,q,ie);var ee=ne.distanceSquared(ie);P.tree.rayQuery(this,re,Y);for(var me=0,pe=Y.length;!this.result._shouldStop&&me!==pe;me++){var ge=Y[me];P.getNormal(ge,Q),P.getVertex(W[ge*3],_),_.vsub(ne,Z);var xe=V.dot(Q),we=Q.dot(Z)/xe;if(!(we<0)){V.scale(we,y),y.vadd(ne,y),P.getVertex(W[ge*3+1],w),P.getVertex(W[ge*3+2],b);var _e=y.distanceSquared(ne);!(g(y,w,_,b)||g(y,_,w,b))||_e>ee||(a.vectorToWorldFrame(C,Q,j),a.pointToWorldFrame(M,C,y,te),this.reportIntersection(j,te,P,B,ge))}}Y.length=0},h.prototype[c.types.TRIMESH]=h.prototype.intersectTrimesh,h.prototype.reportIntersection=function(P,C,M,B,k){var Q=this.from,Y=this.to,re=Q.distanceTo(C),Z=this.result;if(!(this.skipBackfaces&&P.dot(this._direction)>0))switch(Z.hitFaceIndex=typeof k<"u"?k:-1,this.mode){case h.ALL:this.hasHit=!0,Z.set(Q,Y,P,C,M,B,re),Z.hasHit=!0,this.callback(Z);break;case h.CLOSEST:(re<Z.distance||!Z.hasHit)&&(this.hasHit=!0,Z.hasHit=!0,Z.set(Q,Y,P,C,M,B,re));break;case h.ANY:this.hasHit=!0,Z.hasHit=!0,Z.set(Q,Y,P,C,M,B,re),Z._shouldStop=!0;break}};var O=new s,F=new s;function $(P,C,M){M.vsub(P,O);var B=O.dot(C);C.mult(B,F),F.vadd(P,F);var k=M.distanceTo(F);return k}},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(t,i,r){var s=t("../math/Vec3");i.exports=o;function o(){this.rayFromWorld=new s,this.rayToWorld=new s,this.hitNormalWorld=new s,this.hitPointWorld=new s,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}o.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},o.prototype.abort=function(){this._shouldStop=!0},o.prototype.set=function(a,l,c,u,h,d,p){this.rayFromWorld.copy(a),this.rayToWorld.copy(l),this.hitNormalWorld.copy(c),this.hitPointWorld.copy(u),this.shape=h,this.body=d,this.distance=p}},{"../math/Vec3":30}],11:[function(t,i,r){t("../shapes/Shape");var s=t("../collision/Broadphase");i.exports=o;function o(a){s.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var l=this.axisList;this._addBodyHandler=function(c){l.push(c.body)},this._removeBodyHandler=function(c){var u=l.indexOf(c.body);u!==-1&&l.splice(u,1)},a&&this.setWorld(a)}o.prototype=new s,o.prototype.setWorld=function(a){this.axisList.length=0;for(var l=0;l<a.bodies.length;l++)this.axisList.push(a.bodies[l]);a.removeEventListener("addBody",this._addBodyHandler),a.removeEventListener("removeBody",this._removeBodyHandler),a.addEventListener("addBody",this._addBodyHandler),a.addEventListener("removeBody",this._removeBodyHandler),this.world=a,this.dirty=!0},o.insertionSortX=function(a){for(var l=1,c=a.length;l<c;l++){for(var u=a[l],h=l-1;h>=0&&!(a[h].aabb.lowerBound.x<=u.aabb.lowerBound.x);h--)a[h+1]=a[h];a[h+1]=u}return a},o.insertionSortY=function(a){for(var l=1,c=a.length;l<c;l++){for(var u=a[l],h=l-1;h>=0&&!(a[h].aabb.lowerBound.y<=u.aabb.lowerBound.y);h--)a[h+1]=a[h];a[h+1]=u}return a},o.insertionSortZ=function(a){for(var l=1,c=a.length;l<c;l++){for(var u=a[l],h=l-1;h>=0&&!(a[h].aabb.lowerBound.z<=u.aabb.lowerBound.z);h--)a[h+1]=a[h];a[h+1]=u}return a},o.prototype.collisionPairs=function(a,l,c){var u=this.axisList,h=u.length,d=this.axisIndex,p,f;for(this.dirty&&(this.sortList(),this.dirty=!1),p=0;p!==h;p++){var v=u[p];for(f=p+1;f<h;f++){var g=u[f];if(this.needBroadphaseCollision(v,g)){if(!o.checkBounds(v,g,d))break;this.intersectionTest(v,g,l,c)}}}},o.prototype.sortList=function(){for(var a=this.axisList,l=this.axisIndex,c=a.length,u=0;u!==c;u++){var h=a[u];h.aabbNeedsUpdate&&h.computeAABB()}l===0?o.insertionSortX(a):l===1?o.insertionSortY(a):l===2&&o.insertionSortZ(a)},o.checkBounds=function(a,l,c){var u,h;c===0?(u=a.position.x,h=l.position.x):c===1?(u=a.position.y,h=l.position.y):c===2&&(u=a.position.z,h=l.position.z);var d=a.boundingRadius,p=l.boundingRadius,f=u+d,v=h-p;return v<f},o.prototype.autoDetectAxis=function(){for(var a=0,l=0,c=0,u=0,h=0,d=0,p=this.axisList,f=p.length,v=1/f,g=0;g!==f;g++){var m=p[g],x=m.position.x;a+=x,l+=x*x;var y=m.position.y;c+=y,u+=y*y;var _=m.position.z;h+=_,d+=_*_}var w=l-a*a*v,b=u-c*c*v,T=d-h*h*v;w>b?w>T?this.axisIndex=0:this.axisIndex=2:b>T?this.axisIndex=1:this.axisIndex=2},o.prototype.aabbQuery=function(a,l,c){c=c||[],this.dirty&&(this.sortList(),this.dirty=!1);var u=this.axisIndex,h="x";u===1&&(h="y"),u===2&&(h="z");var d=this.axisList;l.lowerBound[h],l.upperBound[h];for(var p=0;p<d.length;p++){var f=d[p];f.aabbNeedsUpdate&&f.computeAABB(),f.aabb.overlaps(l)&&c.push(f)}return c}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(t,i,r){i.exports=c,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/ConeEquation"),a=t("../equations/RotationalEquation");t("../equations/ContactEquation");var l=t("../math/Vec3");function c(u,h,d){d=d||{};var p=typeof d.maxForce<"u"?d.maxForce:1e6,f=d.pivotA?d.pivotA.clone():new l,v=d.pivotB?d.pivotB.clone():new l;this.axisA=d.axisA?d.axisA.clone():new l,this.axisB=d.axisB?d.axisB.clone():new l,s.call(this,u,f,h,v,p),this.collideConnected=!!d.collideConnected,this.angle=typeof d.angle<"u"?d.angle:0;var g=this.coneEquation=new o(u,h,d),m=this.twistEquation=new a(u,h,d);this.twistAngle=typeof d.twistAngle<"u"?d.twistAngle:0,g.maxForce=0,g.minForce=-p,m.maxForce=0,m.minForce=-p,this.equations.push(g,m)}c.prototype=new s,c.constructor=c,new l,new l,c.prototype.update=function(){var u=this.bodyA,h=this.bodyB,d=this.coneEquation,p=this.twistEquation;s.prototype.update.call(this),u.vectorToWorldFrame(this.axisA,d.axisA),h.vectorToWorldFrame(this.axisB,d.axisB),this.axisA.tangents(p.axisA,p.axisA),u.vectorToWorldFrame(p.axisA,p.axisA),this.axisB.tangents(p.axisB,p.axisB),h.vectorToWorldFrame(p.axisB,p.axisB),d.angle=this.angle,p.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(t,i,r){i.exports=o;var s=t("../utils/Utils");function o(a,l,c){c=s.defaults(c,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=a,this.bodyB=l,this.id=o.idCounter++,this.collideConnected=c.collideConnected,c.wakeUpBodies&&(a&&a.wakeUp(),l&&l.wakeUp())}o.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},o.prototype.enable=function(){for(var a=this.equations,l=0;l<a.length;l++)a[l].enabled=!0},o.prototype.disable=function(){for(var a=this.equations,l=0;l<a.length;l++)a[l].enabled=!1},o.idCounter=0},{"../utils/Utils":53}],14:[function(t,i,r){i.exports=a;var s=t("./Constraint"),o=t("../equations/ContactEquation");function a(l,c,u,h){s.call(this,l,c),typeof u>"u"&&(u=l.position.distanceTo(c.position)),typeof h>"u"&&(h=1e6),this.distance=u;var d=this.distanceEquation=new o(l,c);this.equations.push(d),d.minForce=-h,d.maxForce=h}a.prototype=new s,a.prototype.update=function(){var l=this.bodyA,c=this.bodyB,u=this.distanceEquation,h=this.distance*.5,d=u.ni;c.position.vsub(l.position,d),d.normalize(),d.mult(h,u.ri),d.mult(-h,u.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(t,i,r){i.exports=c,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/RotationalEquation"),a=t("../equations/RotationalMotorEquation");t("../equations/ContactEquation");var l=t("../math/Vec3");function c(d,p,f){f=f||{};var v=typeof f.maxForce<"u"?f.maxForce:1e6,g=f.pivotA?f.pivotA.clone():new l,m=f.pivotB?f.pivotB.clone():new l;s.call(this,d,g,p,m,v);var x=this.axisA=f.axisA?f.axisA.clone():new l(1,0,0);x.normalize();var y=this.axisB=f.axisB?f.axisB.clone():new l(1,0,0);y.normalize();var _=this.rotationalEquation1=new o(d,p,f),w=this.rotationalEquation2=new o(d,p,f),b=this.motorEquation=new a(d,p,v);b.enabled=!1,this.equations.push(_,w,b)}c.prototype=new s,c.constructor=c,c.prototype.enableMotor=function(){this.motorEquation.enabled=!0},c.prototype.disableMotor=function(){this.motorEquation.enabled=!1},c.prototype.setMotorSpeed=function(d){this.motorEquation.targetVelocity=d},c.prototype.setMotorMaxForce=function(d){this.motorEquation.maxForce=d,this.motorEquation.minForce=-d};var u=new l,h=new l;c.prototype.update=function(){var d=this.bodyA,p=this.bodyB,f=this.motorEquation,v=this.rotationalEquation1,g=this.rotationalEquation2,m=u,x=h,y=this.axisA,_=this.axisB;s.prototype.update.call(this),d.quaternion.vmult(y,m),p.quaternion.vmult(_,x),m.tangents(v.axisA,g.axisA),v.axisB.copy(x),g.axisB.copy(x),this.motorEquation.enabled&&(d.quaternion.vmult(this.axisA,f.axisA),p.quaternion.vmult(this.axisB,f.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(t,i,r){i.exports=l,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/RotationalEquation");t("../equations/RotationalMotorEquation"),t("../equations/ContactEquation");var a=t("../math/Vec3");function l(c,u,h){h=h||{};var d=typeof h.maxForce<"u"?h.maxForce:1e6,p=new a,f=new a,v=new a;c.position.vadd(u.position,v),v.scale(.5,v),u.pointToLocalFrame(v,f),c.pointToLocalFrame(v,p),s.call(this,c,p,u,f,d);var g=this.rotationalEquation1=new o(c,u,h),m=this.rotationalEquation2=new o(c,u,h),x=this.rotationalEquation3=new o(c,u,h);this.equations.push(g,m,x)}l.prototype=new s,l.constructor=l,new a,new a,l.prototype.update=function(){var c=this.bodyA,u=this.bodyB;this.motorEquation;var h=this.rotationalEquation1,d=this.rotationalEquation2,p=this.rotationalEquation3;s.prototype.update.call(this),c.vectorToWorldFrame(a.UNIT_X,h.axisA),u.vectorToWorldFrame(a.UNIT_Y,h.axisB),c.vectorToWorldFrame(a.UNIT_Y,d.axisA),u.vectorToWorldFrame(a.UNIT_Z,d.axisB),c.vectorToWorldFrame(a.UNIT_Z,p.axisA),u.vectorToWorldFrame(a.UNIT_X,p.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(t,i,r){i.exports=l;var s=t("./Constraint"),o=t("../equations/ContactEquation"),a=t("../math/Vec3");function l(c,u,h,d,p){s.call(this,c,h),p=typeof p<"u"?p:1e6,this.pivotA=u?u.clone():new a,this.pivotB=d?d.clone():new a;var f=this.equationX=new o(c,h),v=this.equationY=new o(c,h),g=this.equationZ=new o(c,h);this.equations.push(f,v,g),f.minForce=v.minForce=g.minForce=-p,f.maxForce=v.maxForce=g.maxForce=p,f.ni.set(1,0,0),v.ni.set(0,1,0),g.ni.set(0,0,1)}l.prototype=new s,l.prototype.update=function(){var c=this.bodyA,u=this.bodyB,h=this.equationX,d=this.equationY,p=this.equationZ;c.quaternion.vmult(this.pivotA,h.ri),u.quaternion.vmult(this.pivotB,h.rj),d.ri.copy(h.ri),d.rj.copy(h.rj),p.ri.copy(h.ri),p.rj.copy(h.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(t,i,r){i.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(u,h,d){d=d||{};var p=typeof d.maxForce<"u"?d.maxForce:1e6;o.call(this,u,h,-p,p),this.axisA=d.axisA?d.axisA.clone():new s(1,0,0),this.axisB=d.axisB?d.axisB.clone():new s(0,1,0),this.angle=typeof d.angle<"u"?d.angle:0}a.prototype=new o,a.prototype.constructor=a;var l=new s,c=new s;a.prototype.computeB=function(u){var h=this.a,d=this.b,p=this.axisA,f=this.axisB,v=l,g=c,m=this.jacobianElementA,x=this.jacobianElementB;p.cross(f,v),f.cross(p,g),m.rotational.copy(g),x.rotational.copy(v);var y=Math.cos(this.angle)-p.dot(f),_=this.computeGW(),w=this.computeGiMf(),b=-y*h-_*d-u*w;return b}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(t,i,r){i.exports=a;var s=t("./Equation"),o=t("../math/Vec3");t("../math/Mat3");function a(g,m,x){x=typeof x<"u"?x:1e6,s.call(this,g,m,0,x),this.restitution=0,this.ri=new o,this.rj=new o,this.ni=new o}a.prototype=new s,a.prototype.constructor=a;var l=new o,c=new o,u=new o;a.prototype.computeB=function(g){var m=this.a,x=this.b,y=this.bi,_=this.bj,w=this.ri,b=this.rj,T=l,A=c,S=y.velocity,E=y.angularVelocity;y.force,y.torque;var R=_.velocity,D=_.angularVelocity;_.force,_.torque;var z=u,L=this.jacobianElementA,G=this.jacobianElementB,J=this.ni;w.cross(J,T),b.cross(J,A),J.negate(L.spatial),T.negate(L.rotational),G.spatial.copy(J),G.rotational.copy(A),z.copy(_.position),z.vadd(b,z),z.vsub(y.position,z),z.vsub(w,z);var X=J.dot(z),N=this.restitution+1,U=N*R.dot(J)-N*S.dot(J)+D.dot(A)-E.dot(T),O=this.computeGiMf(),F=-X*m-U*x-g*O;return F};var h=new o,d=new o,p=new o,f=new o,v=new o;a.prototype.getImpactVelocityAlongNormal=function(){var g=h,m=d,x=p,y=f,_=v;return this.bi.position.vadd(this.ri,x),this.bj.position.vadd(this.rj,y),this.bi.getVelocityAtWorldPoint(x,g),this.bj.getVelocityAtWorldPoint(y,m),g.vsub(m,_),this.ni.dot(_)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(t,i,r){i.exports=a;var s=t("../math/JacobianElement"),o=t("../math/Vec3");function a(v,g,m,x){this.id=a.id++,this.minForce=typeof m>"u"?-1e6:m,this.maxForce=typeof x>"u"?1e6:x,this.bi=v,this.bj=g,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new s,this.jacobianElementB=new s,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}a.prototype.constructor=a,a.id=0,a.prototype.setSpookParams=function(v,g,m){var x=g,y=v,_=m;this.a=4/(_*(1+4*x)),this.b=4*x/(1+4*x),this.eps=4/(_*_*y*(1+4*x))},a.prototype.computeB=function(v,g,m){var x=this.computeGW(),y=this.computeGq(),_=this.computeGiMf();return-y*v-x*g-_*m},a.prototype.computeGq=function(){var v=this.jacobianElementA,g=this.jacobianElementB,m=this.bi,x=this.bj,y=m.position,_=x.position;return v.spatial.dot(y)+g.spatial.dot(_)};var l=new o;a.prototype.computeGW=function(){var v=this.jacobianElementA,g=this.jacobianElementB,m=this.bi,x=this.bj,y=m.velocity,_=x.velocity,w=m.angularVelocity||l,b=x.angularVelocity||l;return v.multiplyVectors(y,w)+g.multiplyVectors(_,b)},a.prototype.computeGWlambda=function(){var v=this.jacobianElementA,g=this.jacobianElementB,m=this.bi,x=this.bj,y=m.vlambda,_=x.vlambda,w=m.wlambda||l,b=x.wlambda||l;return v.multiplyVectors(y,w)+g.multiplyVectors(_,b)};var c=new o,u=new o,h=new o,d=new o;a.prototype.computeGiMf=function(){var v=this.jacobianElementA,g=this.jacobianElementB,m=this.bi,x=this.bj,y=m.force,_=m.torque,w=x.force,b=x.torque,T=m.invMassSolve,A=x.invMassSolve;return m.invInertiaWorldSolve?m.invInertiaWorldSolve.vmult(_,h):h.set(0,0,0),x.invInertiaWorldSolve?x.invInertiaWorldSolve.vmult(b,d):d.set(0,0,0),y.mult(T,c),w.mult(A,u),v.multiplyVectors(c,h)+g.multiplyVectors(u,d)};var p=new o;a.prototype.computeGiMGt=function(){var v=this.jacobianElementA,g=this.jacobianElementB,m=this.bi,x=this.bj,y=m.invMassSolve,_=x.invMassSolve,w=m.invInertiaWorldSolve,b=x.invInertiaWorldSolve,T=y+_;return w&&(w.vmult(v.rotational,p),T+=p.dot(v.rotational)),b&&(b.vmult(g.rotational,p),T+=p.dot(g.rotational)),T};var f=new o;new o,new o,new o,new o,new o,a.prototype.addToWlambda=function(v){var g=this.jacobianElementA,m=this.jacobianElementB,x=this.bi,y=this.bj,_=f;g.spatial.mult(x.invMassSolve*v,_),x.vlambda.vadd(_,x.vlambda),m.spatial.mult(y.invMassSolve*v,_),y.vlambda.vadd(_,y.vlambda),x.invInertiaWorldSolve&&(x.invInertiaWorldSolve.vmult(g.rotational,_),_.mult(v,_),x.wlambda.vadd(_,x.wlambda)),y.invInertiaWorldSolve&&(y.invInertiaWorldSolve.vmult(m.rotational,_),_.mult(v,_),y.wlambda.vadd(_,y.wlambda))},a.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(t,i,r){i.exports=a;var s=t("./Equation"),o=t("../math/Vec3");t("../math/Mat3");function a(u,h,d){s.call(this,u,h,-d,d),this.ri=new o,this.rj=new o,this.t=new o}a.prototype=new s,a.prototype.constructor=a;var l=new o,c=new o;a.prototype.computeB=function(u){this.a;var h=this.b;this.bi,this.bj;var d=this.ri,p=this.rj,f=l,v=c,g=this.t;d.cross(g,f),p.cross(g,v);var m=this.jacobianElementA,x=this.jacobianElementB;g.negate(m.spatial),f.negate(m.rotational),x.spatial.copy(g),x.rotational.copy(v);var y=this.computeGW(),_=this.computeGiMf(),w=-y*h-u*_;return w}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(t,i,r){i.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(u,h,d){d=d||{};var p=typeof d.maxForce<"u"?d.maxForce:1e6;o.call(this,u,h,-p,p),this.axisA=d.axisA?d.axisA.clone():new s(1,0,0),this.axisB=d.axisB?d.axisB.clone():new s(0,1,0),this.maxAngle=Math.PI/2}a.prototype=new o,a.prototype.constructor=a;var l=new s,c=new s;a.prototype.computeB=function(u){var h=this.a,d=this.b,p=this.axisA,f=this.axisB,v=l,g=c,m=this.jacobianElementA,x=this.jacobianElementB;p.cross(f,v),f.cross(p,g),m.rotational.copy(g),x.rotational.copy(v);var y=Math.cos(this.maxAngle)-p.dot(f),_=this.computeGW(),w=this.computeGiMf(),b=-y*h-_*d-u*w;return b}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(t,i,r){i.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(l,c,u){u=typeof u<"u"?u:1e6,o.call(this,l,c,-u,u),this.axisA=new s,this.axisB=new s,this.targetVelocity=0}a.prototype=new o,a.prototype.constructor=a,a.prototype.computeB=function(l){this.a;var c=this.b;this.bi,this.bj;var u=this.axisA,h=this.axisB,d=this.jacobianElementA,p=this.jacobianElementB;d.rotational.copy(u),h.negate(p.rotational);var f=this.computeGW()-this.targetVelocity,v=this.computeGiMf(),g=-f*c-l*v;return g}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(t,i,r){var s=t("../utils/Utils");i.exports=o;function o(a,l,c){c=s.defaults(c,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=o.idCounter++,this.materials=[a,l],this.friction=c.friction,this.restitution=c.restitution,this.contactEquationStiffness=c.contactEquationStiffness,this.contactEquationRelaxation=c.contactEquationRelaxation,this.frictionEquationStiffness=c.frictionEquationStiffness,this.frictionEquationRelaxation=c.frictionEquationRelaxation}o.idCounter=0},{"../utils/Utils":53}],25:[function(t,i,r){i.exports=s;function s(o){var a="";o=o||{},typeof o=="string"?(a=o,o={}):typeof o=="object"&&(a=""),this.name=a,this.id=s.idCounter++,this.friction=typeof o.friction<"u"?o.friction:-1,this.restitution=typeof o.restitution<"u"?o.restitution:-1}s.idCounter=0},{}],26:[function(t,i,r){i.exports=o;var s=t("./Vec3");function o(){this.spatial=new s,this.rotational=new s}o.prototype.multiplyElement=function(a){return a.spatial.dot(this.spatial)+a.rotational.dot(this.rotational)},o.prototype.multiplyVectors=function(a,l){return a.dot(this.spatial)+l.dot(this.rotational)}},{"./Vec3":30}],27:[function(t,i,r){i.exports=o;var s=t("./Vec3");function o(a){a?this.elements=a:this.elements=[0,0,0,0,0,0,0,0,0]}o.prototype.identity=function(){var a=this.elements;a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1},o.prototype.setZero=function(){var a=this.elements;a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=0,a[6]=0,a[7]=0,a[8]=0},o.prototype.setTrace=function(a){var l=this.elements;l[0]=a.x,l[4]=a.y,l[8]=a.z},o.prototype.getTrace=function(l){var l=l||new s,c=this.elements;l.x=c[0],l.y=c[4],l.z=c[8]},o.prototype.vmult=function(a,l){l=l||new s;var c=this.elements,u=a.x,h=a.y,d=a.z;return l.x=c[0]*u+c[1]*h+c[2]*d,l.y=c[3]*u+c[4]*h+c[5]*d,l.z=c[6]*u+c[7]*h+c[8]*d,l},o.prototype.smult=function(a){for(var l=0;l<this.elements.length;l++)this.elements[l]*=a},o.prototype.mmult=function(a,l){for(var c=l||new o,u=0;u<3;u++)for(var h=0;h<3;h++){for(var d=0,p=0;p<3;p++)d+=a.elements[u+p*3]*this.elements[p+h*3];c.elements[u+h*3]=d}return c},o.prototype.scale=function(a,l){l=l||new o;for(var c=this.elements,u=l.elements,h=0;h!==3;h++)u[3*h+0]=a.x*c[3*h+0],u[3*h+1]=a.y*c[3*h+1],u[3*h+2]=a.z*c[3*h+2];return l},o.prototype.solve=function(a,l){l=l||new s;for(var c=3,u=4,h=[],d=0;d<c*u;d++)h.push(0);var d,p;for(d=0;d<3;d++)for(p=0;p<3;p++)h[d+u*p]=this.elements[d+3*p];h[3+4*0]=a.x,h[3+4*1]=a.y,h[3+4*2]=a.z;var f=3,v=f,g,m=4,x;do{if(d=v-f,h[d+u*d]===0){for(p=d+1;p<v;p++)if(h[d+u*p]!==0){g=m;do x=m-g,h[x+u*d]+=h[x+u*p];while(--g);break}}if(h[d+u*d]!==0)for(p=d+1;p<v;p++){var y=h[d+u*p]/h[d+u*d];g=m;do x=m-g,h[x+u*p]=x<=d?0:h[x+u*p]-h[x+u*d]*y;while(--g)}}while(--f);if(l.z=h[2*u+3]/h[2*u+2],l.y=(h[1*u+3]-h[1*u+2]*l.z)/h[1*u+1],l.x=(h[0*u+3]-h[0*u+2]*l.z-h[0*u+1]*l.y)/h[0*u+0],isNaN(l.x)||isNaN(l.y)||isNaN(l.z)||l.x===1/0||l.y===1/0||l.z===1/0)throw"Could not solve equation! Got x=["+l.toString()+"], b=["+a.toString()+"], A=["+this.toString()+"]";return l},o.prototype.e=function(a,l,c){if(c===void 0)return this.elements[l+3*a];this.elements[l+3*a]=c},o.prototype.copy=function(a){for(var l=0;l<a.elements.length;l++)this.elements[l]=a.elements[l];return this},o.prototype.toString=function(){for(var a="",l=",",c=0;c<9;c++)a+=this.elements[c]+l;return a},o.prototype.reverse=function(a){a=a||new o;for(var l=3,c=6,u=[],h=0;h<l*c;h++)u.push(0);var h,d;for(h=0;h<3;h++)for(d=0;d<3;d++)u[h+c*d]=this.elements[h+3*d];u[3+6*0]=1,u[3+6*1]=0,u[3+6*2]=0,u[4+6*0]=0,u[4+6*1]=1,u[4+6*2]=0,u[5+6*0]=0,u[5+6*1]=0,u[5+6*2]=1;var p=3,f=p,v,g=c,m;do{if(h=f-p,u[h+c*h]===0){for(d=h+1;d<f;d++)if(u[h+c*d]!==0){v=g;do m=g-v,u[m+c*h]+=u[m+c*d];while(--v);break}}if(u[h+c*h]!==0)for(d=h+1;d<f;d++){var x=u[h+c*d]/u[h+c*h];v=g;do m=g-v,u[m+c*d]=m<=h?0:u[m+c*d]-u[m+c*h]*x;while(--v)}}while(--p);h=2;do{d=h-1;do{var x=u[h+c*d]/u[h+c*h];v=c;do m=c-v,u[m+c*d]=u[m+c*d]-u[m+c*h]*x;while(--v)}while(d--)}while(--h);h=2;do{var x=1/u[h+c*h];v=c;do m=c-v,u[m+c*h]=u[m+c*h]*x;while(--v)}while(h--);h=2;do{d=2;do{if(m=u[l+d+c*h],isNaN(m)||m===1/0)throw"Could not reverse! A=["+this.toString()+"]";a.e(h,d,m)}while(d--)}while(h--);return a},o.prototype.setRotationFromQuaternion=function(a){var l=a.x,c=a.y,u=a.z,h=a.w,d=l+l,p=c+c,f=u+u,v=l*d,g=l*p,m=l*f,x=c*p,y=c*f,_=u*f,w=h*d,b=h*p,T=h*f,A=this.elements;return A[3*0+0]=1-(x+_),A[3*0+1]=g-T,A[3*0+2]=m+b,A[3*1+0]=g+T,A[3*1+1]=1-(v+_),A[3*1+2]=y-w,A[3*2+0]=m-b,A[3*2+1]=y+w,A[3*2+2]=1-(v+x),this},o.prototype.transpose=function(a){a=a||new o;for(var l=a.elements,c=this.elements,u=0;u!==3;u++)for(var h=0;h!==3;h++)l[3*u+h]=c[3*h+u];return a}},{"./Vec3":30}],28:[function(t,i,r){i.exports=o;var s=t("./Vec3");function o(d,p,f,v){this.x=d!==void 0?d:0,this.y=p!==void 0?p:0,this.z=f!==void 0?f:0,this.w=v!==void 0?v:1}o.prototype.set=function(d,p,f,v){this.x=d,this.y=p,this.z=f,this.w=v},o.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},o.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},o.prototype.setFromAxisAngle=function(d,p){var f=Math.sin(p*.5);this.x=d.x*f,this.y=d.y*f,this.z=d.z*f,this.w=Math.cos(p*.5)},o.prototype.toAxisAngle=function(d){d=d||new s,this.normalize();var p=2*Math.acos(this.w),f=Math.sqrt(1-this.w*this.w);return f<.001?(d.x=this.x,d.y=this.y,d.z=this.z):(d.x=this.x/f,d.y=this.y/f,d.z=this.z/f),[d,p]};var a=new s,l=new s;o.prototype.setFromVectors=function(d,p){if(d.isAntiparallelTo(p)){var f=a,v=l;d.tangents(f,v),this.setFromAxisAngle(f,Math.PI)}else{var g=d.cross(p);this.x=g.x,this.y=g.y,this.z=g.z,this.w=Math.sqrt(Math.pow(d.norm(),2)*Math.pow(p.norm(),2))+d.dot(p),this.normalize()}};var c=new s,u=new s,h=new s;o.prototype.mult=function(d,p){p=p||new o;var f=this.w,v=c,g=u,m=h;return v.set(this.x,this.y,this.z),g.set(d.x,d.y,d.z),p.w=f*d.w-v.dot(g),v.cross(g,m),p.x=f*g.x+d.w*v.x+m.x,p.y=f*g.y+d.w*v.y+m.y,p.z=f*g.z+d.w*v.z+m.z,p},o.prototype.inverse=function(d){var p=this.x,f=this.y,v=this.z,g=this.w;d=d||new o,this.conjugate(d);var m=1/(p*p+f*f+v*v+g*g);return d.x*=m,d.y*=m,d.z*=m,d.w*=m,d},o.prototype.conjugate=function(d){return d=d||new o,d.x=-this.x,d.y=-this.y,d.z=-this.z,d.w=this.w,d},o.prototype.normalize=function(){var d=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);d===0?(this.x=0,this.y=0,this.z=0,this.w=0):(d=1/d,this.x*=d,this.y*=d,this.z*=d,this.w*=d)},o.prototype.normalizeFast=function(){var d=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;d===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=d,this.y*=d,this.z*=d,this.w*=d)},o.prototype.vmult=function(d,p){p=p||new s;var f=d.x,v=d.y,g=d.z,m=this.x,x=this.y,y=this.z,_=this.w,w=_*f+x*g-y*v,b=_*v+y*f-m*g,T=_*g+m*v-x*f,A=-m*f-x*v-y*g;return p.x=w*_+A*-m+b*-y-T*-x,p.y=b*_+A*-x+T*-m-w*-y,p.z=T*_+A*-y+w*-x-b*-m,p},o.prototype.copy=function(d){return this.x=d.x,this.y=d.y,this.z=d.z,this.w=d.w,this},o.prototype.toEuler=function(d,p){p=p||"YZX";var f,v,g,m=this.x,x=this.y,y=this.z,_=this.w;switch(p){case"YZX":var w=m*x+y*_;if(w>.499&&(f=2*Math.atan2(m,_),v=Math.PI/2,g=0),w<-.499&&(f=-2*Math.atan2(m,_),v=-Math.PI/2,g=0),isNaN(f)){var b=m*m,T=x*x,A=y*y;f=Math.atan2(2*x*_-2*m*y,1-2*T-2*A),v=Math.asin(2*w),g=Math.atan2(2*m*_-2*x*y,1-2*b-2*A)}break;default:throw new Error("Euler order "+p+" not supported yet.")}d.y=f,d.z=v,d.x=g},o.prototype.setFromEuler=function(d,p,f,v){v=v||"XYZ";var g=Math.cos(d/2),m=Math.cos(p/2),x=Math.cos(f/2),y=Math.sin(d/2),_=Math.sin(p/2),w=Math.sin(f/2);return v==="XYZ"?(this.x=y*m*x+g*_*w,this.y=g*_*x-y*m*w,this.z=g*m*w+y*_*x,this.w=g*m*x-y*_*w):v==="YXZ"?(this.x=y*m*x+g*_*w,this.y=g*_*x-y*m*w,this.z=g*m*w-y*_*x,this.w=g*m*x+y*_*w):v==="ZXY"?(this.x=y*m*x-g*_*w,this.y=g*_*x+y*m*w,this.z=g*m*w+y*_*x,this.w=g*m*x-y*_*w):v==="ZYX"?(this.x=y*m*x-g*_*w,this.y=g*_*x+y*m*w,this.z=g*m*w-y*_*x,this.w=g*m*x+y*_*w):v==="YZX"?(this.x=y*m*x+g*_*w,this.y=g*_*x+y*m*w,this.z=g*m*w-y*_*x,this.w=g*m*x-y*_*w):v==="XZY"&&(this.x=y*m*x-g*_*w,this.y=g*_*x-y*m*w,this.z=g*m*w+y*_*x,this.w=g*m*x+y*_*w),this},o.prototype.clone=function(){return new o(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(t,i,r){var s=t("./Vec3"),o=t("./Quaternion");i.exports=a;function a(c){c=c||{},this.position=new s,c.position&&this.position.copy(c.position),this.quaternion=new o,c.quaternion&&this.quaternion.copy(c.quaternion)}var l=new o;a.pointToLocalFrame=function(c,u,h,p){var p=p||new s;return h.vsub(c,p),u.conjugate(l),l.vmult(p,p),p},a.prototype.pointToLocal=function(c,u){return a.pointToLocalFrame(this.position,this.quaternion,c,u)},a.pointToWorldFrame=function(c,u,h,p){var p=p||new s;return u.vmult(h,p),p.vadd(c,p),p},a.prototype.pointToWorld=function(c,u){return a.pointToWorldFrame(this.position,this.quaternion,c,u)},a.prototype.vectorToWorldFrame=function(c,h){var h=h||new s;return this.quaternion.vmult(c,h),h},a.vectorToWorldFrame=function(c,u,h){return c.vmult(u,h),h},a.vectorToLocalFrame=function(c,u,h,p){var p=p||new s;return u.w*=-1,u.vmult(h,p),u.w*=-1,p}},{"./Quaternion":28,"./Vec3":30}],30:[function(t,i,r){i.exports=o;var s=t("./Mat3");function o(u,h,d){this.x=u||0,this.y=h||0,this.z=d||0}o.ZERO=new o(0,0,0),o.UNIT_X=new o(1,0,0),o.UNIT_Y=new o(0,1,0),o.UNIT_Z=new o(0,0,1),o.prototype.cross=function(u,h){var d=u.x,p=u.y,f=u.z,v=this.x,g=this.y,m=this.z;return h=h||new o,h.x=g*f-m*p,h.y=m*d-v*f,h.z=v*p-g*d,h},o.prototype.set=function(u,h,d){return this.x=u,this.y=h,this.z=d,this},o.prototype.setZero=function(){this.x=this.y=this.z=0},o.prototype.vadd=function(u,h){if(h)h.x=u.x+this.x,h.y=u.y+this.y,h.z=u.z+this.z;else return new o(this.x+u.x,this.y+u.y,this.z+u.z)},o.prototype.vsub=function(u,h){if(h)h.x=this.x-u.x,h.y=this.y-u.y,h.z=this.z-u.z;else return new o(this.x-u.x,this.y-u.y,this.z-u.z)},o.prototype.crossmat=function(){return new s([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},o.prototype.normalize=function(){var u=this.x,h=this.y,d=this.z,p=Math.sqrt(u*u+h*h+d*d);if(p>0){var f=1/p;this.x*=f,this.y*=f,this.z*=f}else this.x=0,this.y=0,this.z=0;return p},o.prototype.unit=function(u){u=u||new o;var h=this.x,d=this.y,p=this.z,f=Math.sqrt(h*h+d*d+p*p);return f>0?(f=1/f,u.x=h*f,u.y=d*f,u.z=p*f):(u.x=1,u.y=0,u.z=0),u},o.prototype.norm=function(){var u=this.x,h=this.y,d=this.z;return Math.sqrt(u*u+h*h+d*d)},o.prototype.length=o.prototype.norm,o.prototype.norm2=function(){return this.dot(this)},o.prototype.lengthSquared=o.prototype.norm2,o.prototype.distanceTo=function(u){var h=this.x,d=this.y,p=this.z,f=u.x,v=u.y,g=u.z;return Math.sqrt((f-h)*(f-h)+(v-d)*(v-d)+(g-p)*(g-p))},o.prototype.distanceSquared=function(u){var h=this.x,d=this.y,p=this.z,f=u.x,v=u.y,g=u.z;return(f-h)*(f-h)+(v-d)*(v-d)+(g-p)*(g-p)},o.prototype.mult=function(u,h){h=h||new o;var d=this.x,p=this.y,f=this.z;return h.x=u*d,h.y=u*p,h.z=u*f,h},o.prototype.scale=o.prototype.mult,o.prototype.dot=function(u){return this.x*u.x+this.y*u.y+this.z*u.z},o.prototype.isZero=function(){return this.x===0&&this.y===0&&this.z===0},o.prototype.negate=function(u){return u=u||new o,u.x=-this.x,u.y=-this.y,u.z=-this.z,u};var a=new o,l=new o;o.prototype.tangents=function(u,h){var d=this.norm();if(d>0){var p=a,f=1/d;p.set(this.x*f,this.y*f,this.z*f);var v=l;Math.abs(p.x)<.9?(v.set(1,0,0),p.cross(v,u)):(v.set(0,1,0),p.cross(v,u)),p.cross(u,h)}else u.set(1,0,0),h.set(0,1,0)},o.prototype.toString=function(){return this.x+","+this.y+","+this.z},o.prototype.toArray=function(){return[this.x,this.y,this.z]},o.prototype.copy=function(u){return this.x=u.x,this.y=u.y,this.z=u.z,this},o.prototype.lerp=function(u,h,d){var p=this.x,f=this.y,v=this.z;d.x=p+(u.x-p)*h,d.y=f+(u.y-f)*h,d.z=v+(u.z-v)*h},o.prototype.almostEquals=function(u,h){return h===void 0&&(h=1e-6),!(Math.abs(this.x-u.x)>h||Math.abs(this.y-u.y)>h||Math.abs(this.z-u.z)>h)},o.prototype.almostZero=function(u){return u===void 0&&(u=1e-6),!(Math.abs(this.x)>u||Math.abs(this.y)>u||Math.abs(this.z)>u)};var c=new o;o.prototype.isAntiparallelTo=function(u,h){return this.negate(c),c.almostEquals(u,h)},o.prototype.clone=function(){return new o(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(t,i,r){i.exports=h;var s=t("../utils/EventTarget");t("../shapes/Shape");var o=t("../math/Vec3"),a=t("../math/Mat3"),l=t("../math/Quaternion");t("../material/Material");var c=t("../collision/AABB"),u=t("../shapes/Box");function h(R){R=R||{},s.apply(this),this.id=h.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new o,this.collisionFilterGroup=typeof R.collisionFilterGroup=="number"?R.collisionFilterGroup:1,this.collisionFilterMask=typeof R.collisionFilterMask=="number"?R.collisionFilterMask:1,this.collisionResponse=!0,this.position=new o,R.position&&this.position.copy(R.position),this.previousPosition=new o,this.initPosition=new o,this.velocity=new o,R.velocity&&this.velocity.copy(R.velocity),this.initVelocity=new o,this.force=new o;var D=typeof R.mass=="number"?R.mass:0;this.mass=D,this.invMass=D>0?1/D:0,this.material=R.material||null,this.linearDamping=typeof R.linearDamping=="number"?R.linearDamping:.01,this.type=D<=0?h.STATIC:h.DYNAMIC,typeof R.type==typeof h.STATIC&&(this.type=R.type),this.allowSleep=typeof R.allowSleep<"u"?R.allowSleep:!0,this.sleepState=0,this.sleepSpeedLimit=typeof R.sleepSpeedLimit<"u"?R.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof R.sleepTimeLimit<"u"?R.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new o,this.quaternion=new l,R.quaternion&&this.quaternion.copy(R.quaternion),this.initQuaternion=new l,this.angularVelocity=new o,R.angularVelocity&&this.angularVelocity.copy(R.angularVelocity),this.initAngularVelocity=new o,this.interpolatedPosition=new o,this.interpolatedQuaternion=new l,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new o,this.invInertia=new o,this.invInertiaWorld=new a,this.invMassSolve=0,this.invInertiaSolve=new o,this.invInertiaWorldSolve=new a,this.fixedRotation=typeof R.fixedRotation<"u"?R.fixedRotation:!1,this.angularDamping=typeof R.angularDamping<"u"?R.angularDamping:.01,this.aabb=new c,this.aabbNeedsUpdate=!0,this.wlambda=new o,R.shape&&this.addShape(R.shape),this.updateMassProperties()}h.prototype=new s,h.prototype.constructor=h,h.DYNAMIC=1,h.STATIC=2,h.KINEMATIC=4,h.AWAKE=0,h.SLEEPY=1,h.SLEEPING=2,h.idCounter=0,h.prototype.wakeUp=function(){var R=this.sleepState;this.sleepState=0,R===h.SLEEPING&&this.dispatchEvent({type:"wakeup"})},h.prototype.sleep=function(){this.sleepState=h.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},h.sleepyEvent={type:"sleepy"},h.sleepEvent={type:"sleep"},h.prototype.sleepTick=function(R){if(this.allowSleep){var D=this.sleepState,z=this.velocity.norm2()+this.angularVelocity.norm2(),L=Math.pow(this.sleepSpeedLimit,2);D===h.AWAKE&&z<L?(this.sleepState=h.SLEEPY,this.timeLastSleepy=R,this.dispatchEvent(h.sleepyEvent)):D===h.SLEEPY&&z>L?this.wakeUp():D===h.SLEEPY&&R-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(h.sleepEvent))}},h.prototype.updateSolveMassProperties=function(){this.sleepState===h.SLEEPING||this.type===h.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},h.prototype.pointToLocalFrame=function(R,z){var z=z||new o;return R.vsub(this.position,z),this.quaternion.conjugate().vmult(z,z),z},h.prototype.vectorToLocalFrame=function(R,z){var z=z||new o;return this.quaternion.conjugate().vmult(R,z),z},h.prototype.pointToWorldFrame=function(R,z){var z=z||new o;return this.quaternion.vmult(R,z),z.vadd(this.position,z),z},h.prototype.vectorToWorldFrame=function(R,z){var z=z||new o;return this.quaternion.vmult(R,z),z};var d=new o,p=new l;h.prototype.addShape=function(R,D,z){var L=new o,G=new l;return D&&L.copy(D),z&&G.copy(z),this.shapes.push(R),this.shapeOffsets.push(L),this.shapeOrientations.push(G),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},h.prototype.updateBoundingRadius=function(){for(var R=this.shapes,D=this.shapeOffsets,z=R.length,L=0,G=0;G!==z;G++){var J=R[G];J.updateBoundingSphereRadius();var X=D[G].norm(),N=J.boundingSphereRadius;X+N>L&&(L=X+N)}this.boundingRadius=L};var f=new c;h.prototype.computeAABB=function(){for(var R=this.shapes,D=this.shapeOffsets,z=this.shapeOrientations,L=R.length,G=d,J=p,X=this.quaternion,N=this.aabb,U=f,O=0;O!==L;O++){var F=R[O];z[O].mult(X,J),J.vmult(D[O],G),G.vadd(this.position,G),F.calculateWorldAABB(G,J,U.lowerBound,U.upperBound),O===0?N.copy(U):N.extend(U)}this.aabbNeedsUpdate=!1};var v=new a,g=new a;new a,h.prototype.updateInertiaWorld=function(R){var D=this.invInertia;if(!(D.x===D.y&&D.y===D.z&&!R)){var z=v,L=g;z.setRotationFromQuaternion(this.quaternion),z.transpose(L),z.scale(D,z),z.mmult(L,this.invInertiaWorld)}};var m=new o,x=new o;h.prototype.applyForce=function(R,D){if(this.type===h.DYNAMIC){var z=m;D.vsub(this.position,z);var L=x;z.cross(R,L),this.force.vadd(R,this.force),this.torque.vadd(L,this.torque)}};var y=new o,_=new o;h.prototype.applyLocalForce=function(R,D){if(this.type===h.DYNAMIC){var z=y,L=_;this.vectorToWorldFrame(R,z),this.pointToWorldFrame(D,L),this.applyForce(z,L)}};var w=new o,b=new o,T=new o;h.prototype.applyImpulse=function(R,D){if(this.type===h.DYNAMIC){var z=w;D.vsub(this.position,z);var L=b;L.copy(R),L.mult(this.invMass,L),this.velocity.vadd(L,this.velocity);var G=T;z.cross(R,G),this.invInertiaWorld.vmult(G,G),this.angularVelocity.vadd(G,this.angularVelocity)}};var A=new o,S=new o;h.prototype.applyLocalImpulse=function(R,D){if(this.type===h.DYNAMIC){var z=A,L=S;this.vectorToWorldFrame(R,z),this.pointToWorldFrame(D,L),this.applyImpulse(z,L)}};var E=new o;h.prototype.updateMassProperties=function(){var R=E;this.invMass=this.mass>0?1/this.mass:0;var D=this.inertia,z=this.fixedRotation;this.computeAABB(),R.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),u.calculateInertia(R,this.mass,D),this.invInertia.set(D.x>0&&!z?1/D.x:0,D.y>0&&!z?1/D.y:0,D.z>0&&!z?1/D.z:0),this.updateInertiaWorld(!0)},h.prototype.getVelocityAtWorldPoint=function(R,D){var z=new o;return R.vsub(this.position,z),this.angularVelocity.cross(z,D),this.velocity.vadd(D,D),D}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(t,i,r){t("./Body");var s=t("../math/Vec3"),o=t("../math/Quaternion");t("../collision/RaycastResult");var a=t("../collision/Ray"),l=t("../objects/WheelInfo");i.exports=c;function c(X){this.chassisBody=X.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=typeof X.indexRightAxis<"u"?X.indexRightAxis:1,this.indexForwardAxis=typeof X.indexForwardAxis<"u"?X.indexForwardAxis:0,this.indexUpAxis=typeof X.indexUpAxis<"u"?X.indexUpAxis:2}new s,new s,new s;var u=new s,h=new s,d=new s;new a,c.prototype.addWheel=function(X){X=X||{};var N=new l(X),U=this.wheelInfos.length;return this.wheelInfos.push(N),U},c.prototype.setSteeringValue=function(X,N){var U=this.wheelInfos[N];U.steering=X},new s,c.prototype.applyEngineForce=function(X,N){this.wheelInfos[N].engineForce=X},c.prototype.setBrake=function(X,N){this.wheelInfos[N].brake=X},c.prototype.addToWorld=function(X){this.constraints,X.add(this.chassisBody);var N=this;this.preStepCallback=function(){N.updateVehicle(X.dt)},X.addEventListener("preStep",this.preStepCallback),this.world=X},c.prototype.getVehicleAxisWorld=function(X,N){N.set(X===0?1:0,X===1?1:0,X===2?1:0),this.chassisBody.vectorToWorldFrame(N,N)},c.prototype.updateVehicle=function(X){for(var N=this.wheelInfos,U=N.length,O=this.chassisBody,F=0;F<U;F++)this.updateWheelTransform(F);this.currentVehicleSpeedKmHour=3.6*O.velocity.norm();var $=new s;this.getVehicleAxisWorld(this.indexForwardAxis,$),$.dot(O.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(var F=0;F<U;F++)this.castRay(N[F]);this.updateSuspension(X);for(var P=new s,C=new s,F=0;F<U;F++){var M=N[F],B=M.suspensionForce;B>M.maxSuspensionForce&&(B=M.maxSuspensionForce),M.raycastResult.hitNormalWorld.scale(B*X,P),M.raycastResult.hitPointWorld.vsub(O.position,C),O.applyImpulse(P,M.raycastResult.hitPointWorld)}this.updateFriction(X);var k=new s,Q=new s,Y=new s;for(F=0;F<U;F++){var M=N[F];O.getVelocityAtWorldPoint(M.chassisConnectionPointWorld,Y);var re=1;switch(this.indexUpAxis){case 1:re=-1;break}if(M.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,Q);var Z=Q.dot(M.raycastResult.hitNormalWorld);M.raycastResult.hitNormalWorld.scale(Z,k),Q.vsub(k,Q);var V=Q.dot(Y);M.deltaRotation=re*V*X/M.radius}(M.sliding||!M.isInContact)&&M.engineForce!==0&&M.useCustomSlidingRotationalSpeed&&(M.deltaRotation=(M.engineForce>0?1:-1)*M.customSlidingRotationalSpeed*X),Math.abs(M.brake)>Math.abs(M.engineForce)&&(M.deltaRotation=0),M.rotation+=M.deltaRotation,M.deltaRotation*=.99}},c.prototype.updateSuspension=function(X){for(var N=this.chassisBody,U=N.mass,O=this.wheelInfos,F=O.length,$=0;$<F;$++){var P=O[$];if(P.isInContact){var C,M=P.suspensionRestLength,B=P.suspensionLength,k=M-B;C=P.suspensionStiffness*k*P.clippedInvContactDotSuspension;var Q=P.suspensionRelativeVelocity,Y;Q<0?Y=P.dampingCompression:Y=P.dampingRelaxation,C-=Y*Q,P.suspensionForce=C*U,P.suspensionForce<0&&(P.suspensionForce=0)}else P.suspensionForce=0}},c.prototype.removeFromWorld=function(X){this.constraints,X.remove(this.chassisBody),X.removeEventListener("preStep",this.preStepCallback),this.world=null};var p=new s,f=new s;c.prototype.castRay=function(X){var N=p,U=f;this.updateWheelTransformWorld(X);var O=this.chassisBody,F=-1,$=X.suspensionRestLength+X.radius;X.directionWorld.scale($,N);var P=X.chassisConnectionPointWorld;P.vadd(N,U);var C=X.raycastResult;C.reset();var M=O.collisionResponse;O.collisionResponse=!1,this.world.rayTest(P,U,C),O.collisionResponse=M;var B=C.body;if(X.raycastResult.groundObject=0,B){F=C.distance,X.raycastResult.hitNormalWorld=C.hitNormalWorld,X.isInContact=!0;var k=C.distance;X.suspensionLength=k-X.radius;var Q=X.suspensionRestLength-X.maxSuspensionTravel,Y=X.suspensionRestLength+X.maxSuspensionTravel;X.suspensionLength<Q&&(X.suspensionLength=Q),X.suspensionLength>Y&&(X.suspensionLength=Y,X.raycastResult.reset());var re=X.raycastResult.hitNormalWorld.dot(X.directionWorld),Z=new s;O.getVelocityAtWorldPoint(X.raycastResult.hitPointWorld,Z);var V=X.raycastResult.hitNormalWorld.dot(Z);if(re>=-.1)X.suspensionRelativeVelocity=0,X.clippedInvContactDotSuspension=1/.1;else{var ne=-1/re;X.suspensionRelativeVelocity=V*ne,X.clippedInvContactDotSuspension=ne}}else X.suspensionLength=X.suspensionRestLength+0*X.maxSuspensionTravel,X.suspensionRelativeVelocity=0,X.directionWorld.scale(-1,X.raycastResult.hitNormalWorld),X.clippedInvContactDotSuspension=1;return F},c.prototype.updateWheelTransformWorld=function(X){X.isInContact=!1;var N=this.chassisBody;N.pointToWorldFrame(X.chassisConnectionPointLocal,X.chassisConnectionPointWorld),N.vectorToWorldFrame(X.directionLocal,X.directionWorld),N.vectorToWorldFrame(X.axleLocal,X.axleWorld)},c.prototype.updateWheelTransform=function(X){var N=u,U=h,O=d,F=this.wheelInfos[X];this.updateWheelTransformWorld(F),F.directionLocal.scale(-1,N),U.copy(F.axleLocal),N.cross(U,O),O.normalize(),U.normalize();var $=F.steering,P=new o;P.setFromAxisAngle(N,$);var C=new o;C.setFromAxisAngle(U,F.rotation);var M=F.worldTransform.quaternion;this.chassisBody.quaternion.mult(P,M),M.mult(C,M),M.normalize();var B=F.worldTransform.position;B.copy(F.directionWorld),B.scale(F.suspensionLength,B),B.vadd(F.chassisConnectionPointWorld,B)};var v=[new s(1,0,0),new s(0,1,0),new s(0,0,1)];c.prototype.getWheelTransformWorld=function(X){return this.wheelInfos[X].worldTransform};var g=new s,m=[],x=[],y=1;c.prototype.updateFriction=function(X){for(var N=g,U=this.wheelInfos,O=U.length,F=this.chassisBody,$=x,P=m,C=0;C<O;C++){var M=U[C],B=M.raycastResult.body;M.sideImpulse=0,M.forwardImpulse=0,$[C]||($[C]=new s),P[C]||(P[C]=new s)}for(var C=0;C<O;C++){var M=U[C],B=M.raycastResult.body;if(B){var k=P[C],Q=this.getWheelTransformWorld(C);Q.vectorToWorldFrame(v[this.indexRightAxis],k);var Y=M.raycastResult.hitNormalWorld,re=k.dot(Y);Y.scale(re,N),k.vsub(N,k),k.normalize(),Y.cross(k,$[C]),$[C].normalize(),M.sideImpulse=J(F,M.raycastResult.hitPointWorld,B,M.raycastResult.hitPointWorld,k),M.sideImpulse*=y}}var Z=1,V=.5;this.sliding=!1;for(var C=0;C<O;C++){var M=U[C],B=M.raycastResult.body,ne=0;if(M.slipInfo=1,B){var ie=0,te=M.brake?M.brake:ie;ne=T(F,B,M.raycastResult.hitPointWorld,$[C],te),ne+=M.engineForce*X;var j=te/ne;M.slipInfo*=j}if(M.forwardImpulse=0,M.skidInfo=1,B){M.skidInfo=1;var W=M.suspensionForce*X*M.frictionSlip,H=W,q=W*H;M.forwardImpulse=ne;var I=M.forwardImpulse*V,ee=M.sideImpulse*Z,me=I*I+ee*ee;if(M.sliding=!1,me>q){this.sliding=!0,M.sliding=!0;var j=W/Math.sqrt(me);M.skidInfo*=j}}}if(this.sliding)for(var C=0;C<O;C++){var M=U[C];M.sideImpulse!==0&&M.skidInfo<1&&(M.forwardImpulse*=M.skidInfo,M.sideImpulse*=M.skidInfo)}for(var C=0;C<O;C++){var M=U[C],pe=new s;if(pe.copy(M.raycastResult.hitPointWorld),M.forwardImpulse!==0){var ge=new s;$[C].scale(M.forwardImpulse,ge),F.applyImpulse(ge,pe)}if(M.sideImpulse!==0){var B=M.raycastResult.body,xe=new s;xe.copy(M.raycastResult.hitPointWorld);var we=new s;P[C].scale(M.sideImpulse,we),F.pointToLocalFrame(pe,pe),pe["xyz"[this.indexUpAxis]]*=M.rollInfluence,F.pointToWorldFrame(pe,pe),F.applyImpulse(we,pe),we.scale(-1,we),B.applyImpulse(we,xe)}}};var _=new s,w=new s,b=new s;function T(X,N,U,O,F){var $=0,P=U,C=_,M=w,B=b;X.getVelocityAtWorldPoint(P,C),N.getVelocityAtWorldPoint(P,M),C.vsub(M,B);var k=O.dot(B),Q=D(X,U,O),Y=D(N,U,O),re=1,Z=re/(Q+Y);return $=-k*Z,F<$&&($=F),$<-F&&($=-F),$}var A=new s,S=new s,E=new s,R=new s;function D(X,N,U){var O=A,F=S,$=E,P=R;return N.vsub(X.position,O),O.cross(U,F),X.invInertiaWorld.vmult(F,P),P.cross(O,$),X.invMass+U.dot($)}var z=new s,L=new s,G=new s;function J(X,N,U,O,F,re){var P=F.norm2();if(P>1.1)return 0;var C=z,M=L,B=G;X.getVelocityAtWorldPoint(N,C),U.getVelocityAtWorldPoint(O,M),C.vsub(M,B);var k=F.dot(B),Q=.2,Y=1/(X.invMass+U.invMass),re=-Q*k*Y;return re}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(t,i,r){var s=t("./Body"),o=t("../shapes/Sphere"),a=t("../shapes/Box"),l=t("../math/Vec3"),c=t("../constraints/HingeConstraint");i.exports=u;function u(p){if(this.wheelBodies=[],this.coordinateSystem=typeof p.coordinateSystem>"u"?new l(1,2,3):p.coordinateSystem.clone(),this.chassisBody=p.chassisBody,!this.chassisBody){var f=new a(new l(5,2,.5));this.chassisBody=new s(1,f)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}u.prototype.addWheel=function(p){p=p||{};var f=p.body;f||(f=new s(1,new o(1.2))),this.wheelBodies.push(f),this.wheelForces.push(0),new l;var v=typeof p.position<"u"?p.position.clone():new l,g=new l;this.chassisBody.pointToWorldFrame(v,g),f.position.set(g.x,g.y,g.z);var m=typeof p.axis<"u"?p.axis.clone():new l(0,1,0);this.wheelAxes.push(m);var x=new c(this.chassisBody,f,{pivotA:v,axisA:m,pivotB:l.ZERO,axisB:m,collideConnected:!1});return this.constraints.push(x),this.wheelBodies.length-1},u.prototype.setSteeringValue=function(p,f){var v=this.wheelAxes[f],g=Math.cos(p),m=Math.sin(p),x=v.x,y=v.y;this.constraints[f].axisA.set(g*x-m*y,m*x+g*y,0)},u.prototype.setMotorSpeed=function(p,f){var v=this.constraints[f];v.enableMotor(),v.motorTargetVelocity=p},u.prototype.disableMotor=function(p){var f=this.constraints[p];f.disableMotor()};var h=new l;u.prototype.setWheelForce=function(p,f){this.wheelForces[f]=p},u.prototype.applyWheelForce=function(p,f){var v=this.wheelAxes[f],g=this.wheelBodies[f],m=g.torque;v.scale(p,h),g.vectorToWorldFrame(h,h),m.vadd(h,m)},u.prototype.addToWorld=function(p){for(var f=this.constraints,v=this.wheelBodies.concat([this.chassisBody]),g=0;g<v.length;g++)p.add(v[g]);for(var g=0;g<f.length;g++)p.addConstraint(f[g]);p.addEventListener("preStep",this._update.bind(this))},u.prototype._update=function(){for(var p=this.wheelForces,f=0;f<p.length;f++)this.applyWheelForce(p[f],f)},u.prototype.removeFromWorld=function(p){for(var f=this.constraints,v=this.wheelBodies.concat([this.chassisBody]),g=0;g<v.length;g++)p.remove(v[g]);for(var g=0;g<f.length;g++)p.removeConstraint(f[g])};var d=new l;u.prototype.getWheelSpeed=function(p){var f=this.wheelAxes[p],v=this.wheelBodies[p],g=v.angularVelocity;return this.chassisBody.vectorToWorldFrame(f,d),g.dot(d)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(t,i,r){i.exports=o,t("../shapes/Shape");var s=t("../math/Vec3");t("../math/Quaternion"),t("../shapes/Particle"),t("../objects/Body"),t("../material/Material");function o(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}o.prototype.add=function(f){this.particles.push(f),this.neighbors.length<this.particles.length&&this.neighbors.push([])},o.prototype.remove=function(f){var v=this.particles.indexOf(f);v!==-1&&(this.particles.splice(v,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var a=new s;o.prototype.getNeighbors=function(f,v){for(var g=this.particles.length,m=f.id,x=this.smoothingRadius*this.smoothingRadius,y=a,_=0;_!==g;_++){var w=this.particles[_];w.position.vsub(f.position,y),m!==w.id&&y.norm2()<x&&v.push(w)}};var l=new s,c=new s,u=new s,h=new s,d=new s,p=new s;o.prototype.update=function(){for(var f=this.particles.length,v=l,g=this.speedOfSound,m=this.eps,x=0;x!==f;x++){var y=this.particles[x],_=this.neighbors[x];_.length=0,this.getNeighbors(y,_),_.push(this.particles[x]);for(var w=_.length,b=0,T=0;T!==w;T++){y.position.vsub(_[T].position,v);var A=v.norm(),S=this.w(A);b+=_[T].mass*S}this.densities[x]=b,this.pressures[x]=g*g*(this.densities[x]-this.density)}for(var E=c,R=u,D=h,z=d,L=p,x=0;x!==f;x++){var G=this.particles[x];E.set(0,0,0),R.set(0,0,0);for(var J,X,_=this.neighbors[x],w=_.length,T=0;T!==w;T++){var N=_[T];G.position.vsub(N.position,z);var U=z.norm();J=-N.mass*(this.pressures[x]/(this.densities[x]*this.densities[x]+m)+this.pressures[T]/(this.densities[T]*this.densities[T]+m)),this.gradw(z,D),D.mult(J,D),E.vadd(D,E),N.velocity.vsub(G.velocity,L),L.mult(1/(1e-4+this.densities[x]*this.densities[T])*this.viscosity*N.mass,L),X=this.nablaw(U),L.mult(X,L),R.vadd(L,R)}R.mult(G.mass,R),E.mult(G.mass,E),G.force.vadd(R,G.force),G.force.vadd(E,G.force)}},o.prototype.w=function(f){var v=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(v,9))*Math.pow(v*v-f*f,3)},o.prototype.gradw=function(f,v){var g=f.norm(),m=this.smoothingRadius;f.mult(945/(32*Math.PI*Math.pow(m,9))*Math.pow(m*m-g*g,2),v)},o.prototype.nablaw=function(f){var v=this.smoothingRadius,g=945/(32*Math.PI*Math.pow(v,9))*(v*v-f*f)*(7*f*f-3*v*v);return g}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(t,i,r){var s=t("../math/Vec3");i.exports=o;function o(x,y,_){_=_||{},this.restLength=typeof _.restLength=="number"?_.restLength:1,this.stiffness=_.stiffness||100,this.damping=_.damping||1,this.bodyA=x,this.bodyB=y,this.localAnchorA=new s,this.localAnchorB=new s,_.localAnchorA&&this.localAnchorA.copy(_.localAnchorA),_.localAnchorB&&this.localAnchorB.copy(_.localAnchorB),_.worldAnchorA&&this.setWorldAnchorA(_.worldAnchorA),_.worldAnchorB&&this.setWorldAnchorB(_.worldAnchorB)}o.prototype.setWorldAnchorA=function(x){this.bodyA.pointToLocalFrame(x,this.localAnchorA)},o.prototype.setWorldAnchorB=function(x){this.bodyB.pointToLocalFrame(x,this.localAnchorB)},o.prototype.getWorldAnchorA=function(x){this.bodyA.pointToWorldFrame(this.localAnchorA,x)},o.prototype.getWorldAnchorB=function(x){this.bodyB.pointToWorldFrame(this.localAnchorB,x)};var a=new s,l=new s,c=new s,u=new s,h=new s,d=new s,p=new s,f=new s,v=new s,g=new s,m=new s;o.prototype.applyForce=function(){var x=this.stiffness,y=this.damping,_=this.restLength,w=this.bodyA,b=this.bodyB,T=a,A=l,S=c,E=u,R=m,D=h,z=d,L=p,G=f,J=v,X=g;this.getWorldAnchorA(D),this.getWorldAnchorB(z),D.vsub(w.position,L),z.vsub(b.position,G),z.vsub(D,T);var N=T.norm();A.copy(T),A.normalize(),b.velocity.vsub(w.velocity,S),b.angularVelocity.cross(G,R),S.vadd(R,S),w.angularVelocity.cross(L,R),S.vsub(R,S),A.mult(-x*(N-_)-y*S.dot(A),E),w.force.vsub(E,w.force),b.force.vadd(E,b.force),L.cross(E,J),G.cross(E,X),w.torque.vsub(J,w.torque),b.torque.vadd(X,b.torque)}},{"../math/Vec3":30}],36:[function(t,i,r){var s=t("../math/Vec3"),o=t("../math/Transform"),a=t("../collision/RaycastResult"),l=t("../utils/Utils");i.exports=c;function c(d){d=l.defaults(d,{chassisConnectionPointLocal:new s,chassisConnectionPointWorld:new s,directionLocal:new s,directionWorld:new s,axleLocal:new s,axleWorld:new s,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=d.maxSuspensionTravel,this.customSlidingRotationalSpeed=d.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=d.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=d.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=d.chassisConnectionPointWorld.clone(),this.directionLocal=d.directionLocal.clone(),this.directionWorld=d.directionWorld.clone(),this.axleLocal=d.axleLocal.clone(),this.axleWorld=d.axleWorld.clone(),this.suspensionRestLength=d.suspensionRestLength,this.suspensionMaxLength=d.suspensionMaxLength,this.radius=d.radius,this.suspensionStiffness=d.suspensionStiffness,this.dampingCompression=d.dampingCompression,this.dampingRelaxation=d.dampingRelaxation,this.frictionSlip=d.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=d.rollInfluence,this.maxSuspensionForce=d.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=d.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new a,this.worldTransform=new o,this.isInContact=!1}var h=new s,u=new s,h=new s;c.prototype.updateWheel=function(d){var p=this.raycastResult;if(this.isInContact){var f=p.hitNormalWorld.dot(p.directionWorld);p.hitPointWorld.vsub(d.position,u),d.getVelocityAtWorldPoint(u,h);var v=p.hitNormalWorld.dot(h);if(f>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=1/.1;else{var g=-1/f;this.suspensionRelativeVelocity=v*g,this.clippedInvContactDotSuspension=g}}else p.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,p.directionWorld.scale(-1,p.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(t,i,r){i.exports=l;var s=t("./Shape"),o=t("../math/Vec3"),a=t("./ConvexPolyhedron");function l(h){s.call(this),this.type=s.types.BOX,this.halfExtents=h,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}l.prototype=new s,l.prototype.constructor=l,l.prototype.updateConvexPolyhedronRepresentation=function(){var h=this.halfExtents.x,d=this.halfExtents.y,p=this.halfExtents.z,f=o,v=[new f(-h,-d,-p),new f(h,-d,-p),new f(h,d,-p),new f(-h,d,-p),new f(-h,-d,p),new f(h,-d,p),new f(h,d,p),new f(-h,d,p)],g=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]];new f(0,0,1),new f(0,1,0),new f(1,0,0);var m=new a(v,g);this.convexPolyhedronRepresentation=m,m.material=this.material},l.prototype.calculateLocalInertia=function(h,d){return d=d||new o,l.calculateInertia(this.halfExtents,h,d),d},l.calculateInertia=function(h,d,p){var f=h;p.x=1/12*d*(2*f.y*2*f.y+2*f.z*2*f.z),p.y=1/12*d*(2*f.x*2*f.x+2*f.z*2*f.z),p.z=1/12*d*(2*f.y*2*f.y+2*f.x*2*f.x)},l.prototype.getSideNormals=function(h,d){var p=h,f=this.halfExtents;if(p[0].set(f.x,0,0),p[1].set(0,f.y,0),p[2].set(0,0,f.z),p[3].set(-f.x,0,0),p[4].set(0,-f.y,0),p[5].set(0,0,-f.z),d!==void 0)for(var v=0;v!==p.length;v++)d.vmult(p[v],p[v]);return p},l.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},l.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var c=new o;new o,l.prototype.forEachWorldCorner=function(h,d,p){for(var f=this.halfExtents,v=[[f.x,f.y,f.z],[-f.x,f.y,f.z],[-f.x,-f.y,f.z],[-f.x,-f.y,-f.z],[f.x,-f.y,-f.z],[f.x,f.y,-f.z],[-f.x,f.y,-f.z],[f.x,-f.y,f.z]],g=0;g<v.length;g++)c.set(v[g][0],v[g][1],v[g][2]),d.vmult(c,c),h.vadd(c,c),p(c.x,c.y,c.z)};var u=[new o,new o,new o,new o,new o,new o,new o,new o];l.prototype.calculateWorldAABB=function(h,d,p,f){var v=this.halfExtents;u[0].set(v.x,v.y,v.z),u[1].set(-v.x,v.y,v.z),u[2].set(-v.x,-v.y,v.z),u[3].set(-v.x,-v.y,-v.z),u[4].set(v.x,-v.y,-v.z),u[5].set(v.x,v.y,-v.z),u[6].set(-v.x,v.y,-v.z),u[7].set(v.x,-v.y,v.z);var g=u[0];d.vmult(g,g),h.vadd(g,g),f.copy(g),p.copy(g);for(var m=1;m<8;m++){var g=u[m];d.vmult(g,g),h.vadd(g,g);var x=g.x,y=g.y,_=g.z;x>f.x&&(f.x=x),y>f.y&&(f.y=y),_>f.z&&(f.z=_),x<p.x&&(p.x=x),y<p.y&&(p.y=y),_<p.z&&(p.z=_)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(t,i,r){i.exports=l;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("../math/Transform");function l(F,$,P){s.call(this),this.type=s.types.CONVEXPOLYHEDRON,this.vertices=F||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=$||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=P?P.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}l.prototype=new s,l.prototype.constructor=l;var c=new o;l.prototype.computeEdges=function(){var F=this.faces,$=this.vertices;$.length;var P=this.uniqueEdges;P.length=0;for(var C=c,M=0;M!==F.length;M++)for(var B=F[M],k=B.length,Q=0;Q!==k;Q++){var Y=(Q+1)%k;$[B[Q]].vsub($[B[Y]],C),C.normalize();for(var re=!1,Z=0;Z!==P.length;Z++)if(P[Z].almostEquals(C)||P[Z].almostEquals(C)){re=!0;break}re||P.push(C.clone())}},l.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var F=0;F<this.faces.length;F++){for(var $=0;$<this.faces[F].length;$++)if(!this.vertices[this.faces[F][$]])throw new Error("Vertex "+this.faces[F][$]+" not found!");var P=this.faceNormals[F]||new o;this.getFaceNormal(F,P),P.negate(P),this.faceNormals[F]=P;var C=this.vertices[this.faces[F][0]];if(P.dot(C)<0){console.error(".faceNormals["+F+"] = Vec3("+P.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var $=0;$<this.faces[F].length;$++)console.warn(".vertices["+this.faces[F][$]+"] = Vec3("+this.vertices[this.faces[F][$]].toString()+")")}}};var u=new o,h=new o;l.computeNormal=function(F,$,P,C){$.vsub(F,h),P.vsub($,u),u.cross(h,C),C.isZero()||C.normalize()},l.prototype.getFaceNormal=function(F,$){var P=this.faces[F],C=this.vertices[P[0]],M=this.vertices[P[1]],B=this.vertices[P[2]];return l.computeNormal(C,M,B,$)};var d=new o;l.prototype.clipAgainstHull=function(F,$,P,C,M,B,k,Q,Y){for(var re=d,Z=-1,V=-Number.MAX_VALUE,ne=0;ne<P.faces.length;ne++){re.copy(P.faceNormals[ne]),M.vmult(re,re);var ie=re.dot(B);ie>V&&(V=ie,Z=ne)}for(var te=[],j=P.faces[Z],W=j.length,H=0;H<W;H++){var q=P.vertices[j[H]],I=new o;I.copy(q),M.vmult(I,I),C.vadd(I,I),te.push(I)}Z>=0&&this.clipFaceAgainstHull(B,F,$,te,k,Q,Y)};var p=new o,f=new o,v=new o,g=new o,m=new o,x=new o;l.prototype.findSeparatingAxis=function(F,$,P,C,M,B,k,Q){var Y=p,re=f,Z=v,V=g,ne=m,ie=x,te=Number.MAX_VALUE,j=this;if(j.uniqueAxes)for(var W=0;W!==j.uniqueAxes.length;W++){P.vmult(j.uniqueAxes[W],Y);var H=j.testSepAxis(Y,F,$,P,C,M);if(H===!1)return!1;H<te&&(te=H,B.copy(Y))}else for(var q=k?k.length:j.faces.length,W=0;W<q;W++){var I=k?k[W]:W;Y.copy(j.faceNormals[I]),P.vmult(Y,Y);var H=j.testSepAxis(Y,F,$,P,C,M);if(H===!1)return!1;H<te&&(te=H,B.copy(Y))}if(F.uniqueAxes)for(var W=0;W!==F.uniqueAxes.length;W++){M.vmult(F.uniqueAxes[W],re);var H=j.testSepAxis(re,F,$,P,C,M);if(H===!1)return!1;H<te&&(te=H,B.copy(re))}else for(var ee=Q?Q.length:F.faces.length,W=0;W<ee;W++){var I=Q?Q[W]:W;re.copy(F.faceNormals[I]),M.vmult(re,re);var H=j.testSepAxis(re,F,$,P,C,M);if(H===!1)return!1;H<te&&(te=H,B.copy(re))}for(var me=0;me!==j.uniqueEdges.length;me++){P.vmult(j.uniqueEdges[me],V);for(var pe=0;pe!==F.uniqueEdges.length;pe++)if(M.vmult(F.uniqueEdges[pe],ne),V.cross(ne,ie),!ie.almostZero()){ie.normalize();var ge=j.testSepAxis(ie,F,$,P,C,M);if(ge===!1)return!1;ge<te&&(te=ge,B.copy(ie))}}return C.vsub($,Z),Z.dot(B)>0&&B.negate(B),!0};var y=[],_=[];l.prototype.testSepAxis=function(F,$,P,C,M,B){var k=this;l.project(k,F,P,C,y),l.project($,F,M,B,_);var Q=y[0],Y=y[1],re=_[0],Z=_[1],V=Q-Z,ne=re-Y,ie=V<ne?V:ne;return ie};var w=new o,b=new o;l.prototype.calculateLocalInertia=function(F,$){this.computeLocalAABB(w,b);var P=b.x-w.x,C=b.y-w.y,M=b.z-w.z;$.x=1/12*F*(2*C*2*C+2*M*2*M),$.y=1/12*F*(2*P*2*P+2*M*2*M),$.z=1/12*F*(2*C*2*C+2*P*2*P)},l.prototype.getPlaneConstantOfFace=function(F){var $=this.faces[F],P=this.faceNormals[F],C=this.vertices[$[0]],M=-P.dot(C);return M};var T=new o,A=new o,S=new o,E=new o,R=new o,D=new o,z=new o,L=new o;l.prototype.clipFaceAgainstHull=function(F,$,P,C,M,B,k){for(var Q=T,Y=A,re=S,Z=E,V=R,ne=D,ie=z,te=L,j=this,W=[],H=C,q=W,I=-1,ee=Number.MAX_VALUE,me=0;me<j.faces.length;me++){Q.copy(j.faceNormals[me]),P.vmult(Q,Q);var pe=Q.dot(F);pe<ee&&(ee=pe,I=me)}if(!(I<0)){var ge=j.faces[I];ge.connectedFaces=[];for(var xe=0;xe<j.faces.length;xe++)for(var we=0;we<j.faces[xe].length;we++)ge.indexOf(j.faces[xe][we])!==-1&&xe!==I&&ge.connectedFaces.indexOf(xe)===-1&&ge.connectedFaces.push(xe);H.length;for(var _e=ge.length,Ie=0;Ie<_e;Ie++){var Be=j.vertices[ge[Ie]],Ae=j.vertices[ge[(Ie+1)%_e]];Be.vsub(Ae,Y),re.copy(Y),P.vmult(re,re),$.vadd(re,re),Z.copy(this.faceNormals[I]),P.vmult(Z,Z),$.vadd(Z,Z),re.cross(Z,V),V.negate(V),ne.copy(Be),P.vmult(ne,ne),$.vadd(ne,ne),-ne.dot(V);var it;{var se=ge.connectedFaces[Ie];ie.copy(this.faceNormals[se]);var Le=this.getPlaneConstantOfFace(se);te.copy(ie),P.vmult(te,te);var it=Le-te.dot($)}for(this.clipFaceAgainstPlane(H,q,te,it);H.length;)H.shift();for(;q.length;)H.push(q.shift())}ie.copy(this.faceNormals[I]);var Le=this.getPlaneConstantOfFace(I);te.copy(ie),P.vmult(te,te);for(var it=Le-te.dot($),xe=0;xe<H.length;xe++){var Ee=te.dot(H[xe])+it;if(Ee<=M&&(console.log("clamped: depth="+Ee+" to minDist="+(M+"")),Ee=M),Ee<=B){var ke=H[xe];if(Ee<=0){var We={point:ke,normal:te,depth:Ee};k.push(We)}}}}},l.prototype.clipFaceAgainstPlane=function(F,$,P,C){var M,B,k=F.length;if(k<2)return $;var Q=F[F.length-1],Y=F[0];M=P.dot(Q)+C;for(var re=0;re<k;re++){if(Y=F[re],B=P.dot(Y)+C,M<0)if(B<0){var Z=new o;Z.copy(Y),$.push(Z)}else{var Z=new o;Q.lerp(Y,M/(M-B),Z),$.push(Z)}else if(B<0){var Z=new o;Q.lerp(Y,M/(M-B),Z),$.push(Z),$.push(Y)}Q=Y,M=B}return $},l.prototype.computeWorldVertices=function(F,$){for(var P=this.vertices.length;this.worldVertices.length<P;)this.worldVertices.push(new o);for(var C=this.vertices,M=this.worldVertices,B=0;B!==P;B++)$.vmult(C[B],M[B]),F.vadd(M[B],M[B]);this.worldVerticesNeedsUpdate=!1},new o,l.prototype.computeLocalAABB=function(F,$){var P=this.vertices.length,C=this.vertices;F.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),$.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var M=0;M<P;M++){var B=C[M];B.x<F.x?F.x=B.x:B.x>$.x&&($.x=B.x),B.y<F.y?F.y=B.y:B.y>$.y&&($.y=B.y),B.z<F.z?F.z=B.z:B.z>$.z&&($.z=B.z)}},l.prototype.computeWorldFaceNormals=function(F){for(var $=this.faceNormals.length;this.worldFaceNormals.length<$;)this.worldFaceNormals.push(new o);for(var P=this.faceNormals,C=this.worldFaceNormals,M=0;M!==$;M++)F.vmult(P[M],C[M]);this.worldFaceNormalsNeedsUpdate=!1},l.prototype.updateBoundingSphereRadius=function(){for(var F=0,$=this.vertices,P=0,C=$.length;P!==C;P++){var M=$[P].norm2();M>F&&(F=M)}this.boundingSphereRadius=Math.sqrt(F)};var G=new o;l.prototype.calculateWorldAABB=function(F,$,P,C){for(var M=this.vertices.length,B=this.vertices,k,Q,Y,re,Z,V,ne=0;ne<M;ne++){G.copy(B[ne]),$.vmult(G,G),F.vadd(G,G);var ie=G;ie.x<k||k===void 0?k=ie.x:(ie.x>re||re===void 0)&&(re=ie.x),ie.y<Q||Q===void 0?Q=ie.y:(ie.y>Z||Z===void 0)&&(Z=ie.y),ie.z<Y||Y===void 0?Y=ie.z:(ie.z>V||V===void 0)&&(V=ie.z)}P.set(k,Q,Y),C.set(re,Z,V)},l.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},l.prototype.getAveragePointLocal=function(F){F=F||new o;for(var $=this.vertices.length,P=this.vertices,C=0;C<$;C++)F.vadd(P[C],F);return F.mult(1/$,F),F},l.prototype.transformAllPoints=function(F,$){var P=this.vertices.length,C=this.vertices;if($){for(var M=0;M<P;M++){var B=C[M];$.vmult(B,B)}for(var M=0;M<this.faceNormals.length;M++){var B=this.faceNormals[M];$.vmult(B,B)}}if(F)for(var M=0;M<P;M++){var B=C[M];B.vadd(F,B)}};var J=new o,X=new o,N=new o;l.prototype.pointIsInside=function(F){var $=this.vertices.length,P=this.vertices,C=this.faces,M=this.faceNormals,B=null,k=this.faces.length,Q=J;this.getAveragePointLocal(Q);for(var Y=0;Y<k;Y++){this.faces[Y].length;var $=M[Y],re=P[C[Y][0]],Z=X;F.vsub(re,Z);var V=$.dot(Z),ne=N;Q.vsub(re,ne);var ie=$.dot(ne);if(V<0&&ie>0||V>0&&ie<0)return!1}return B?1:-1},new o;var U=new o,O=new o;l.project=function(F,$,P,C,M){var B=F.vertices.length,k=U,Q=0,Y=0,re=O,Z=F.vertices;re.setZero(),a.vectorToLocalFrame(P,C,$,k),a.pointToLocalFrame(P,C,re,re);var V=re.dot(k);Y=Q=Z[0].dot(k);for(var ne=1;ne<B;ne++){var ie=Z[ne].dot(k);ie>Q&&(Q=ie),ie<Y&&(Y=ie)}if(Y-=V,Q-=V,Y>Q){var te=Y;Y=Q,Q=te}M[0]=Q,M[1]=Y}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(t,i,r){i.exports=l;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("./ConvexPolyhedron");function l(c,u,h,d){var p=d,f=[],v=[],g=[],m=[],x=[],y=Math.cos,_=Math.sin;f.push(new o(u*y(0),u*_(0),-h*.5)),m.push(0),f.push(new o(c*y(0),c*_(0),h*.5)),x.push(1);for(var w=0;w<p;w++){var b=2*Math.PI/p*(w+1),T=2*Math.PI/p*(w+.5);w<p-1?(f.push(new o(u*y(b),u*_(b),-h*.5)),m.push(2*w+2),f.push(new o(c*y(b),c*_(b),h*.5)),x.push(2*w+3),g.push([2*w+2,2*w+3,2*w+1,2*w])):g.push([0,1,2*w+1,2*w]),(p%2===1||w<p/2)&&v.push(new o(y(T),_(T),0))}g.push(x),v.push(new o(0,0,1));for(var A=[],w=0;w<m.length;w++)A.push(m[m.length-w-1]);g.push(A),this.type=s.types.CONVEXPOLYHEDRON,a.call(this,f,g,v)}l.prototype=new a},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(t,i,r){var s=t("./Shape"),o=t("./ConvexPolyhedron"),a=t("../math/Vec3"),l=t("../utils/Utils");i.exports=c;function c(u,h){h=l.defaults(h,{maxValue:null,minValue:null,elementSize:1}),this.data=u,this.maxValue=h.maxValue,this.minValue=h.minValue,this.elementSize=h.elementSize,h.minValue===null&&this.updateMinValue(),h.maxValue===null&&this.updateMaxValue(),this.cacheEnabled=!0,s.call(this),this.pillarConvex=new o,this.pillarOffset=new a,this.type=s.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}c.prototype=new s,c.prototype.update=function(){this._cachedPillars={}},c.prototype.updateMinValue=function(){for(var u=this.data,h=u[0][0],d=0;d!==u.length;d++)for(var p=0;p!==u[d].length;p++){var f=u[d][p];f<h&&(h=f)}this.minValue=h},c.prototype.updateMaxValue=function(){for(var u=this.data,h=u[0][0],d=0;d!==u.length;d++)for(var p=0;p!==u[d].length;p++){var f=u[d][p];f>h&&(h=f)}this.maxValue=h},c.prototype.setHeightValueAtIndex=function(u,h,d){var p=this.data;p[u][h]=d,this.clearCachedConvexTrianglePillar(u,h,!1),u>0&&(this.clearCachedConvexTrianglePillar(u-1,h,!0),this.clearCachedConvexTrianglePillar(u-1,h,!1)),h>0&&(this.clearCachedConvexTrianglePillar(u,h-1,!0),this.clearCachedConvexTrianglePillar(u,h-1,!1)),h>0&&u>0&&this.clearCachedConvexTrianglePillar(u-1,h-1,!0)},c.prototype.getRectMinMax=function(u,h,d,p,f){f=f||[];for(var v=this.data,g=this.minValue,m=u;m<=d;m++)for(var x=h;x<=p;x++){var y=v[m][x];y>g&&(g=y)}f[0]=this.minValue,f[1]=g},c.prototype.getIndexOfPosition=function(u,h,d,p){var f=this.elementSize,v=this.data,g=Math.floor(u/f),m=Math.floor(h/f);return d[0]=g,d[1]=m,p&&(g<0&&(g=0),m<0&&(m=0),g>=v.length-1&&(g=v.length-1),m>=v[0].length-1&&(m=v[0].length-1)),!(g<0||m<0||g>=v.length-1||m>=v[0].length-1)},c.prototype.getHeightAt=function(u,h,d){var p=[];this.getIndexOfPosition(u,h,p,d);var f=[];return this.getRectMinMax(p[0],p[1]+1,p[0],p[1]+1,f),(f[0]+f[1])/2},c.prototype.getCacheConvexTrianglePillarKey=function(u,h,d){return u+"_"+h+"_"+(d?1:0)},c.prototype.getCachedConvexTrianglePillar=function(u,h,d){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(u,h,d)]},c.prototype.setCachedConvexTrianglePillar=function(u,h,d,p,f){this._cachedPillars[this.getCacheConvexTrianglePillarKey(u,h,d)]={convex:p,offset:f}},c.prototype.clearCachedConvexTrianglePillar=function(u,h,d){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(u,h,d)]},c.prototype.getConvexTrianglePillar=function(u,h,d){var p=this.pillarConvex,f=this.pillarOffset;if(this.cacheEnabled){var v=this.getCachedConvexTrianglePillar(u,h,d);if(v){this.pillarConvex=v.convex,this.pillarOffset=v.offset;return}p=new o,f=new a,this.pillarConvex=p,this.pillarOffset=f}var v=this.data,g=this.elementSize,m=p.faces;p.vertices.length=6;for(var x=0;x<6;x++)p.vertices[x]||(p.vertices[x]=new a);m.length=5;for(var x=0;x<5;x++)m[x]||(m[x]=[]);var y=p.vertices,_=(Math.min(v[u][h],v[u+1][h],v[u][h+1],v[u+1][h+1])-this.minValue)/2+this.minValue;d?(f.set((u+.75)*g,(h+.75)*g,_),y[0].set(.25*g,.25*g,v[u+1][h+1]-_),y[1].set(-.75*g,.25*g,v[u][h+1]-_),y[2].set(.25*g,-.75*g,v[u+1][h]-_),y[3].set(.25*g,.25*g,-_-1),y[4].set(-.75*g,.25*g,-_-1),y[5].set(.25*g,-.75*g,-_-1),m[0][0]=0,m[0][1]=1,m[0][2]=2,m[1][0]=5,m[1][1]=4,m[1][2]=3,m[2][0]=2,m[2][1]=5,m[2][2]=3,m[2][3]=0,m[3][0]=3,m[3][1]=4,m[3][2]=1,m[3][3]=0,m[4][0]=1,m[4][1]=4,m[4][2]=5,m[4][3]=2):(f.set((u+.25)*g,(h+.25)*g,_),y[0].set(-.25*g,-.25*g,v[u][h]-_),y[1].set(.75*g,-.25*g,v[u+1][h]-_),y[2].set(-.25*g,.75*g,v[u][h+1]-_),y[3].set(-.25*g,-.25*g,-_-1),y[4].set(.75*g,-.25*g,-_-1),y[5].set(-.25*g,.75*g,-_-1),m[0][0]=0,m[0][1]=1,m[0][2]=2,m[1][0]=5,m[1][1]=4,m[1][2]=3,m[2][0]=0,m[2][1]=2,m[2][2]=5,m[2][3]=3,m[3][0]=1,m[3][1]=0,m[3][2]=3,m[3][3]=4,m[4][0]=4,m[4][1]=5,m[4][2]=2,m[4][3]=1),p.computeNormals(),p.computeEdges(),p.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(u,h,d,p,f)},c.prototype.calculateLocalInertia=function(u,h){return h=h||new a,h.set(0,0,0),h},c.prototype.volume=function(){return Number.MAX_VALUE},c.prototype.calculateWorldAABB=function(u,h,d,p){d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),p.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},c.prototype.updateBoundingSphereRadius=function(){var u=this.data,h=this.elementSize;this.boundingSphereRadius=new a(u.length*h,u[0].length*h,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(t,i,r){i.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(){s.call(this),this.type=s.types.PARTICLE}a.prototype=new s,a.prototype.constructor=a,a.prototype.calculateLocalInertia=function(l,c){return c=c||new o,c.set(0,0,0),c},a.prototype.volume=function(){return 0},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},a.prototype.calculateWorldAABB=function(l,c,u,h){u.copy(l),h.copy(l)}},{"../math/Vec3":30,"./Shape":43}],42:[function(t,i,r){i.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(){s.call(this),this.type=s.types.PLANE,this.worldNormal=new o,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}a.prototype=new s,a.prototype.constructor=a,a.prototype.computeWorldNormal=function(c){var u=this.worldNormal;u.set(0,0,1),c.vmult(u,u),this.worldNormalNeedsUpdate=!1},a.prototype.calculateLocalInertia=function(c,u){return u=u||new o,u},a.prototype.volume=function(){return Number.MAX_VALUE};var l=new o;a.prototype.calculateWorldAABB=function(c,u,h,d){l.set(0,0,1),u.vmult(l,l);var p=Number.MAX_VALUE;h.set(-p,-p,-p),d.set(p,p,p),l.x===1&&(d.x=c.x),l.y===1&&(d.y=c.y),l.z===1&&(d.z=c.z),l.x===-1&&(h.x=c.x),l.y===-1&&(h.y=c.y),l.z===-1&&(h.z=c.z)},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(t,i,r){i.exports=s;var s=t("./Shape");t("../math/Vec3"),t("../math/Quaternion"),t("../material/Material");function s(){this.id=s.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}s.prototype.constructor=s,s.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},s.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},s.prototype.calculateLocalInertia=function(o,a){throw"calculateLocalInertia() not implemented for shape type "+this.type},s.idCounter=0,s.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(t,i,r){i.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(l){if(s.call(this),this.radius=l!==void 0?Number(l):1,this.type=s.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}a.prototype=new s,a.prototype.constructor=a,a.prototype.calculateLocalInertia=function(l,c){c=c||new o;var u=2*l*this.radius*this.radius/5;return c.x=u,c.y=u,c.z=u,c},a.prototype.volume=function(){return 4*Math.PI*this.radius/3},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},a.prototype.calculateWorldAABB=function(l,c,u,h){for(var d=this.radius,p=["x","y","z"],f=0;f<p.length;f++){var v=p[f];u[v]=l[v]-d,h[v]=l[v]+d}}},{"../math/Vec3":30,"./Shape":43}],45:[function(t,i,r){i.exports=u;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("../math/Transform"),l=t("../collision/AABB"),c=t("../utils/Octree");function u(A,S){s.call(this),this.type=s.types.TRIMESH,this.vertices=new Float32Array(A),this.indices=new Int16Array(S),this.normals=new Float32Array(S.length),this.aabb=new l,this.edges=null,this.scale=new o(1,1,1),this.tree=new c,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}u.prototype=new s,u.prototype.constructor=u;var h=new o;u.prototype.updateTree=function(){var A=this.tree;A.reset(),A.aabb.copy(this.aabb);var S=this.scale;A.aabb.lowerBound.x*=1/S.x,A.aabb.lowerBound.y*=1/S.y,A.aabb.lowerBound.z*=1/S.z,A.aabb.upperBound.x*=1/S.x,A.aabb.upperBound.y*=1/S.y,A.aabb.upperBound.z*=1/S.z;for(var E=new l,R=new o,D=new o,z=new o,L=[R,D,z],G=0;G<this.indices.length/3;G++){var J=G*3;this._getUnscaledVertex(this.indices[J],R),this._getUnscaledVertex(this.indices[J+1],D),this._getUnscaledVertex(this.indices[J+2],z),E.setFromPoints(L),A.insert(E,G)}A.removeEmptyNodes()};var d=new l;u.prototype.getTrianglesInAABB=function(A,S){d.copy(A);var E=this.scale,R=E.x,D=E.y,z=E.z,L=d.lowerBound,G=d.upperBound;return L.x/=R,L.y/=D,L.z/=z,G.x/=R,G.y/=D,G.z/=z,this.tree.aabbQuery(d,S)},u.prototype.setScale=function(A){var S=this.scale.x===this.scale.y===this.scale.z,E=A.x===A.y===A.z;S&&E||this.updateNormals(),this.scale.copy(A),this.updateAABB(),this.updateBoundingSphereRadius()},u.prototype.updateNormals=function(){for(var A=h,S=this.normals,E=0;E<this.indices.length/3;E++){var R=E*3,D=this.indices[R],z=this.indices[R+1],L=this.indices[R+2];this.getVertex(D,m),this.getVertex(z,x),this.getVertex(L,y),u.computeNormal(x,m,y,A),S[R]=A.x,S[R+1]=A.y,S[R+2]=A.z}},u.prototype.updateEdges=function(){for(var A={},S=function(J,X){var N=D<z?D+"_"+z:z+"_"+D;A[N]=!0},E=0;E<this.indices.length/3;E++){var R=E*3,D=this.indices[R],z=this.indices[R+1];this.indices[R+2],S(),S(),S()}var L=Object.keys(A);this.edges=new Int16Array(L.length*2);for(var E=0;E<L.length;E++){var G=L[E].split("_");this.edges[2*E]=parseInt(G[0],10),this.edges[2*E+1]=parseInt(G[1],10)}},u.prototype.getEdgeVertex=function(A,S,E){var R=this.edges[A*2+(S?1:0)];this.getVertex(R,E)};var p=new o,f=new o;u.prototype.getEdgeVector=function(A,S){var E=p,R=f;this.getEdgeVertex(A,0,E),this.getEdgeVertex(A,1,R),R.vsub(E,S)};var v=new o,g=new o;u.computeNormal=function(A,S,E,R){S.vsub(A,g),E.vsub(S,v),v.cross(g,R),R.isZero()||R.normalize()};var m=new o,x=new o,y=new o;u.prototype.getVertex=function(A,S){var E=this.scale;return this._getUnscaledVertex(A,S),S.x*=E.x,S.y*=E.y,S.z*=E.z,S},u.prototype._getUnscaledVertex=function(A,S){var E=A*3,R=this.vertices;return S.set(R[E],R[E+1],R[E+2])},u.prototype.getWorldVertex=function(A,S,E,R){return this.getVertex(A,R),a.pointToWorldFrame(S,E,R,R),R},u.prototype.getTriangleVertices=function(A,S,E,R){var D=A*3;this.getVertex(this.indices[D],S),this.getVertex(this.indices[D+1],E),this.getVertex(this.indices[D+2],R)},u.prototype.getNormal=function(A,S){var E=A*3;return S.set(this.normals[E],this.normals[E+1],this.normals[E+2])};var _=new l;u.prototype.calculateLocalInertia=function(A,S){this.computeLocalAABB(_);var E=_.upperBound.x-_.lowerBound.x,R=_.upperBound.y-_.lowerBound.y,D=_.upperBound.z-_.lowerBound.z;return S.set(1/12*A*(2*R*2*R+2*D*2*D),1/12*A*(2*E*2*E+2*D*2*D),1/12*A*(2*R*2*R+2*E*2*E))};var w=new o;u.prototype.computeLocalAABB=function(A){var S=A.lowerBound,E=A.upperBound,R=this.vertices.length;this.vertices;var D=w;this.getVertex(0,D),S.copy(D),E.copy(D);for(var z=0;z!==R;z++)this.getVertex(z,D),D.x<S.x?S.x=D.x:D.x>E.x&&(E.x=D.x),D.y<S.y?S.y=D.y:D.y>E.y&&(E.y=D.y),D.z<S.z?S.z=D.z:D.z>E.z&&(E.z=D.z)},u.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},u.prototype.updateBoundingSphereRadius=function(){for(var A=0,S=this.vertices,E=new o,R=0,D=S.length/3;R!==D;R++){this.getVertex(R,E);var z=E.norm2();z>A&&(A=z)}this.boundingSphereRadius=Math.sqrt(A)},new o;var b=new a,T=new l;u.prototype.calculateWorldAABB=function(A,S,E,R){var D=b,z=T;D.position=A,D.quaternion=S,this.aabb.toWorldFrame(D,z),E.copy(z.lowerBound),R.copy(z.upperBound)},u.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},u.createTorus=function(A,S,E,R,D){A=A||1,S=S||.5,E=E||8,R=R||6,D=D||Math.PI*2;for(var z=[],L=[],G=0;G<=E;G++)for(var J=0;J<=R;J++){var X=J/R*D,N=G/E*Math.PI*2,U=(A+S*Math.cos(N))*Math.cos(X),O=(A+S*Math.cos(N))*Math.sin(X),F=S*Math.sin(N);z.push(U,O,F)}for(var G=1;G<=E;G++)for(var J=1;J<=R;J++){var $=(R+1)*G+J-1,P=(R+1)*(G-1)+J-1,C=(R+1)*(G-1)+J,M=(R+1)*G+J;L.push($,P,M),L.push(P,C,M)}return new u(z,L)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(t,i,r){i.exports=o,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver");function o(){s.call(this),this.iterations=10,this.tolerance=1e-7}o.prototype=new s;var a=[],l=[],c=[];o.prototype.solve=function(u,h){var d=0,p=this.iterations,f=this.tolerance*this.tolerance,v=this.equations,g=v.length,m=h.bodies,x=m.length,y=u,_,w,b,T,A,S;if(g!==0)for(var E=0;E!==x;E++)m[E].updateSolveMassProperties();var R=l,D=c,z=a;R.length=g,D.length=g,z.length=g;for(var E=0;E!==g;E++){var L=v[E];z[E]=0,D[E]=L.computeB(y),R[E]=1/L.computeC()}if(g!==0){for(var E=0;E!==x;E++){var G=m[E],J=G.vlambda,X=G.wlambda;J.set(0,0,0),X&&X.set(0,0,0)}for(d=0;d!==p;d++){T=0;for(var N=0;N!==g;N++){var L=v[N];_=D[N],w=R[N],S=z[N],A=L.computeGWlambda(),b=w*(_-A-L.eps*S),S+b<L.minForce?b=L.minForce-S:S+b>L.maxForce&&(b=L.maxForce-S),z[N]+=b,T+=b>0?b:-b,L.addToWlambda(b)}if(T*T<f)break}for(var E=0;E!==x;E++){var G=m[E],U=G.velocity,O=G.angularVelocity;U.vadd(G.vlambda,U),O&&O.vadd(G.wlambda,O)}}return d}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(t,i,r){i.exports=s;function s(){this.equations=[]}s.prototype.solve=function(o,a){return 0},s.prototype.addEquation=function(o){o.enabled&&this.equations.push(o)},s.prototype.removeEquation=function(o){var a=this.equations,l=a.indexOf(o);l!==-1&&a.splice(l,1)},s.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(t,i,r){i.exports=a,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver"),o=t("../objects/Body");function a(m){for(s.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=m,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}a.prototype=new s;var l=[],c=[],u={bodies:[]},h=o.STATIC;function d(m){for(var x=m.length,y=0;y!==x;y++){var _=m[y];if(!_.visited&&!(_.body.type&h))return _}return!1}var p=[];function f(m,x,y,_){for(p.push(m),m.visited=!0,x(m,y,_);p.length;)for(var w=p.pop(),b;b=d(w.children);)b.visited=!0,x(b,y,_),p.push(b)}function v(m,x,y){x.push(m.body);for(var _=m.eqs.length,w=0;w!==_;w++){var b=m.eqs[w];y.indexOf(b)===-1&&y.push(b)}}a.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},a.prototype.solve=function(m,x){for(var y=l,_=this.nodePool,w=x.bodies,b=this.equations,T=b.length,A=w.length,S=this.subsolver;_.length<A;)_.push(this.createNode());y.length=A;for(var E=0;E<A;E++)y[E]=_[E];for(var E=0;E!==A;E++){var R=y[E];R.body=w[E],R.children.length=0,R.eqs.length=0,R.visited=!1}for(var D=0;D!==T;D++){var z=b[D],E=w.indexOf(z.bi),L=w.indexOf(z.bj),G=y[E],J=y[L];G.children.push(J),G.eqs.push(z),J.children.push(G),J.eqs.push(z)}var X,N=0,U=c;S.tolerance=this.tolerance,S.iterations=this.iterations;for(var O=u;X=d(y);){U.length=0,O.bodies.length=0,f(X,v,O.bodies,U);var F=U.length;U=U.sort(g);for(var E=0;E!==F;E++)S.addEquation(U[E]);S.solve(m,O),S.removeAllEquations(),N++}return N};function g(m,x){return x.id-m.id}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(t,i,r){var s=function(){};i.exports=s,s.prototype={constructor:s,addEventListener:function(o,a){this._listeners===void 0&&(this._listeners={});var l=this._listeners;return l[o]===void 0&&(l[o]=[]),l[o].indexOf(a)===-1&&l[o].push(a),this},hasEventListener:function(o,a){if(this._listeners===void 0)return!1;var l=this._listeners;return l[o]!==void 0&&l[o].indexOf(a)!==-1},removeEventListener:function(o,a){if(this._listeners===void 0)return this;var l=this._listeners;if(l[o]===void 0)return this;var c=l[o].indexOf(a);return c!==-1&&l[o].splice(c,1),this},dispatchEvent:function(o){if(this._listeners===void 0)return this;var a=this._listeners,l=a[o.type];if(l!==void 0){o.target=this;for(var c=0,u=l.length;c<u;c++)l[c].call(this,o)}return this}}},{}],50:[function(t,i,r){var s=t("../collision/AABB"),o=t("../math/Vec3");i.exports=l;function a(h){h=h||{},this.root=h.root||null,this.aabb=h.aabb?h.aabb.clone():new s,this.data=[],this.children=[]}function l(h,d){d=d||{},d.root=null,d.aabb=h,a.call(this,d),this.maxDepth=typeof d.maxDepth<"u"?d.maxDepth:8}l.prototype=new a,a.prototype.reset=function(h,d){this.children.length=this.data.length=0},a.prototype.insert=function(h,d,p){var f=this.data;if(p=p||0,!this.aabb.contains(h))return!1;var v=this.children;if(p<(this.maxDepth||this.root.maxDepth)){var g=!1;v.length||(this.subdivide(),g=!0);for(var m=0;m!==8;m++)if(v[m].insert(h,d,p+1))return!0;g&&(v.length=0)}return f.push(d),!0};var c=new o;a.prototype.subdivide=function(){var h=this.aabb,d=h.lowerBound,p=h.upperBound,f=this.children;f.push(new a({aabb:new s({lowerBound:new o(0,0,0)})}),new a({aabb:new s({lowerBound:new o(1,0,0)})}),new a({aabb:new s({lowerBound:new o(1,1,0)})}),new a({aabb:new s({lowerBound:new o(1,1,1)})}),new a({aabb:new s({lowerBound:new o(0,1,1)})}),new a({aabb:new s({lowerBound:new o(0,0,1)})}),new a({aabb:new s({lowerBound:new o(1,0,1)})}),new a({aabb:new s({lowerBound:new o(0,1,0)})})),p.vsub(d,c),c.scale(.5,c);for(var v=this.root||this,g=0;g!==8;g++){var m=f[g];m.root=v;var x=m.aabb.lowerBound;x.x*=c.x,x.y*=c.y,x.z*=c.z,x.vadd(d,x),x.vadd(c,m.aabb.upperBound)}},a.prototype.aabbQuery=function(h,d){this.data,this.children;for(var p=[this];p.length;){var f=p.pop();f.aabb.overlaps(h)&&Array.prototype.push.apply(d,f.data),Array.prototype.push.apply(p,f.children)}return d};var u=new s;a.prototype.rayQuery=function(h,d,p){return h.getAABB(u),u.toLocalFrame(d,u),this.aabbQuery(u,p),p},a.prototype.removeEmptyNodes=function(){for(var h=[this];h.length;){for(var d=h.pop(),p=d.children.length-1;p>=0;p--)d.children[p].data.length||d.children.splice(p,1);Array.prototype.push.apply(h,d.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(t,i,r){i.exports=s;function s(){this.objects=[],this.type=Object}s.prototype.release=function(){for(var o=arguments.length,a=0;a!==o;a++)this.objects.push(arguments[a])},s.prototype.get=function(){return this.objects.length===0?this.constructObject():this.objects.pop()},s.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(t,i,r){i.exports=s;function s(){this.data={keys:[]}}s.prototype.get=function(o,a){if(o>a){var l=a;a=o,o=l}return this.data[o+"-"+a]},s.prototype.set=function(o,a,l){if(o>a){var c=a;a=o,o=c}var u=o+"-"+a;this.get(o,a)||this.data.keys.push(u),this.data[u]=l},s.prototype.reset=function(){for(var o=this.data,a=o.keys;a.length>0;){var l=a.pop();delete o[l]}}},{}],53:[function(t,i,r){function s(){}i.exports=s,s.defaults=function(o,a){o=o||{};for(var l in a)l in o||(o[l]=a[l]);return o}},{}],54:[function(t,i,r){i.exports=a;var s=t("../math/Vec3"),o=t("./Pool");function a(){o.call(this),this.type=s}a.prototype=new o,a.prototype.constructObject=function(){return new s}},{"../math/Vec3":30,"./Pool":51}],55:[function(t,i,r){i.exports=f;var s=t("../collision/AABB"),o=t("../shapes/Shape"),a=t("../collision/Ray"),l=t("../math/Vec3"),c=t("../math/Transform");t("../shapes/ConvexPolyhedron");var u=t("../math/Quaternion");t("../solver/Solver");var h=t("../utils/Vec3Pool"),d=t("../equations/ContactEquation"),p=t("../equations/FrictionEquation");function f(ce){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new h,this.world=ce,this.currentContactMaterial=null,this.enableFrictionReduction=!1}f.prototype.createContactEquation=function(ce,ue,de,be,Ue,Re){var Ge;this.contactPointPool.length?(Ge=this.contactPointPool.pop(),Ge.bi=ce,Ge.bj=ue):Ge=new d(ce,ue),Ge.enabled=ce.collisionResponse&&ue.collisionResponse&&de.collisionResponse&&be.collisionResponse;var ze=this.currentContactMaterial;Ge.restitution=ze.restitution,Ge.setSpookParams(ze.contactEquationStiffness,ze.contactEquationRelaxation,this.world.dt);var ve=de.material||ce.material,Ne=be.material||ue.material;return ve&&Ne&&ve.restitution>=0&&Ne.restitution>=0&&(Ge.restitution=ve.restitution*Ne.restitution),Ge.si=Ue||de,Ge.sj=Re||be,Ge},f.prototype.createFrictionEquationsFromContact=function(ce,ue){var de=ce.bi,be=ce.bj,Ue=ce.si,Re=ce.sj,Ge=this.world,ze=this.currentContactMaterial,ve=ze.friction,Ne=Ue.material||de.material,Ye=Re.material||be.material;if(Ne&&Ye&&Ne.friction>=0&&Ye.friction>=0&&(ve=Ne.friction*Ye.friction),ve>0){var $e=ve*Ge.gravity.length(),He=de.invMass+be.invMass;He>0&&(He=1/He);var je=this.frictionEquationPool,K=je.length?je.pop():new p(de,be,$e*He),he=je.length?je.pop():new p(de,be,$e*He);return K.bi=he.bi=de,K.bj=he.bj=be,K.minForce=he.minForce=-$e*He,K.maxForce=he.maxForce=$e*He,K.ri.copy(ce.ri),K.rj.copy(ce.rj),he.ri.copy(ce.ri),he.rj.copy(ce.rj),ce.ni.tangents(K.t,he.t),K.setSpookParams(ze.frictionEquationStiffness,ze.frictionEquationRelaxation,Ge.dt),he.setSpookParams(ze.frictionEquationStiffness,ze.frictionEquationRelaxation,Ge.dt),K.enabled=he.enabled=ce.enabled,ue.push(K,he),!0}return!1};var v=new l,g=new l,m=new l;f.prototype.createFrictionFromAverage=function(ce){var ue=this.result[this.result.length-1];if(!(!this.createFrictionEquationsFromContact(ue,this.frictionResult)||ce===1)){var de=this.frictionResult[this.frictionResult.length-2],be=this.frictionResult[this.frictionResult.length-1];v.setZero(),g.setZero(),m.setZero();var Ue=ue.bi;ue.bj;for(var Re=0;Re!==ce;Re++)ue=this.result[this.result.length-1-Re],ue.bodyA!==Ue?(v.vadd(ue.ni,v),g.vadd(ue.ri,g),m.vadd(ue.rj,m)):(v.vsub(ue.ni,v),g.vadd(ue.rj,g),m.vadd(ue.ri,m));var Ge=1/ce;g.scale(Ge,de.ri),m.scale(Ge,de.rj),be.ri.copy(de.ri),be.rj.copy(de.rj),v.normalize(),v.tangents(de.t,be.t)}};var x=new l,y=new l,_=new u,w=new u;f.prototype.getContacts=function(ce,ue,de,be,Ue,Re,Ge){this.contactPointPool=Ue,this.frictionEquationPool=Ge,this.result=be,this.frictionResult=Re;for(var ze=_,ve=w,Ne=x,Ye=y,$e=0,He=ce.length;$e!==He;$e++){var je=ce[$e],K=ue[$e],he=null;je.material&&K.material&&(he=de.getContactMaterial(je.material,K.material)||null);for(var ye=0;ye<je.shapes.length;ye++){je.quaternion.mult(je.shapeOrientations[ye],ze),je.quaternion.vmult(je.shapeOffsets[ye],Ne),Ne.vadd(je.position,Ne);for(var ae=je.shapes[ye],fe=0;fe<K.shapes.length;fe++){K.quaternion.mult(K.shapeOrientations[fe],ve),K.quaternion.vmult(K.shapeOffsets[fe],Ye),Ye.vadd(K.position,Ye);var Fe=K.shapes[fe];if(!(Ne.distanceTo(Ye)>ae.boundingSphereRadius+Fe.boundingSphereRadius)){var tt=null;ae.material&&Fe.material&&(tt=de.getContactMaterial(ae.material,Fe.material)||null),this.currentContactMaterial=tt||he||de.defaultContactMaterial;var Ke=this[ae.type|Fe.type];Ke&&(ae.type<Fe.type?Ke.call(this,ae,Fe,Ne,Ye,ze,ve,je,K,ae,Fe):Ke.call(this,Fe,ae,Ye,Ne,ve,ze,K,je,ae,Fe))}}}}},f.prototype[o.types.BOX|o.types.BOX]=f.prototype.boxBox=function(ce,ue,de,be,Ue,Re,Ge,ze){ce.convexPolyhedronRepresentation.material=ce.material,ue.convexPolyhedronRepresentation.material=ue.material,ce.convexPolyhedronRepresentation.collisionResponse=ce.collisionResponse,ue.convexPolyhedronRepresentation.collisionResponse=ue.collisionResponse,this.convexConvex(ce.convexPolyhedronRepresentation,ue.convexPolyhedronRepresentation,de,be,Ue,Re,Ge,ze,ce,ue)},f.prototype[o.types.BOX|o.types.CONVEXPOLYHEDRON]=f.prototype.boxConvex=function(ce,ue,de,be,Ue,Re,Ge,ze){ce.convexPolyhedronRepresentation.material=ce.material,ce.convexPolyhedronRepresentation.collisionResponse=ce.collisionResponse,this.convexConvex(ce.convexPolyhedronRepresentation,ue,de,be,Ue,Re,Ge,ze,ce,ue)},f.prototype[o.types.BOX|o.types.PARTICLE]=f.prototype.boxParticle=function(ce,ue,de,be,Ue,Re,Ge,ze){ce.convexPolyhedronRepresentation.material=ce.material,ce.convexPolyhedronRepresentation.collisionResponse=ce.collisionResponse,this.convexParticle(ce.convexPolyhedronRepresentation,ue,de,be,Ue,Re,Ge,ze,ce,ue)},f.prototype[o.types.SPHERE]=f.prototype.sphereSphere=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=this.createContactEquation(Ge,ze,ce,ue);be.vsub(de,ve.ni),ve.ni.normalize(),ve.ri.copy(ve.ni),ve.rj.copy(ve.ni),ve.ri.mult(ce.radius,ve.ri),ve.rj.mult(-ue.radius,ve.rj),ve.ri.vadd(de,ve.ri),ve.ri.vsub(Ge.position,ve.ri),ve.rj.vadd(be,ve.rj),ve.rj.vsub(ze.position,ve.rj),this.result.push(ve),this.createFrictionEquationsFromContact(ve,this.frictionResult)};var b=new l,T=new l,A=new l;f.prototype[o.types.PLANE|o.types.TRIMESH]=f.prototype.planeTrimesh=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=new l,Ne=b;Ne.set(0,0,1),Ue.vmult(Ne,Ne);for(var Ye=0;Ye<ue.vertices.length/3;Ye++){ue.getVertex(Ye,ve);var $e=new l;$e.copy(ve),c.pointToWorldFrame(be,Re,$e,ve);var He=T;ve.vsub(de,He);var je=Ne.dot(He);if(je<=0){var K=this.createContactEquation(Ge,ze,ce,ue);K.ni.copy(Ne);var he=A;Ne.scale(He.dot(Ne),he),ve.vsub(he,he),K.ri.copy(he),K.ri.vsub(Ge.position,K.ri),K.rj.copy(ve),K.rj.vsub(ze.position,K.rj),this.result.push(K),this.createFrictionEquationsFromContact(K,this.frictionResult)}}};var S=new l,E=new l;new l;var R=new l,D=new l,z=new l,L=new l,G=new l,J=new l,X=new l,N=new l,U=new l,O=new l,F=new l,$=new s,P=[];f.prototype[o.types.SPHERE|o.types.TRIMESH]=f.prototype.sphereTrimesh=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=z,Ne=L,Ye=G,$e=J,He=X,je=N,K=$,he=D,ye=E,ae=P;c.pointToLocalFrame(be,Re,de,He);var fe=ce.radius;K.lowerBound.set(He.x-fe,He.y-fe,He.z-fe),K.upperBound.set(He.x+fe,He.y+fe,He.z+fe),ue.getTrianglesInAABB(K,ae);for(var Fe=R,tt=ce.radius*ce.radius,Ke=0;Ke<ae.length;Ke++)for(var De=0;De<3;De++)if(ue.getVertex(ue.indices[ae[Ke]*3+De],Fe),Fe.vsub(He,ye),ye.norm2()<=tt){he.copy(Fe),c.pointToWorldFrame(be,Re,he,Fe),Fe.vsub(de,ye);var Xe=this.createContactEquation(Ge,ze,ce,ue);Xe.ni.copy(ye),Xe.ni.normalize(),Xe.ri.copy(Xe.ni),Xe.ri.scale(ce.radius,Xe.ri),Xe.ri.vadd(de,Xe.ri),Xe.ri.vsub(Ge.position,Xe.ri),Xe.rj.copy(Fe),Xe.rj.vsub(ze.position,Xe.rj),this.result.push(Xe),this.createFrictionEquationsFromContact(Xe,this.frictionResult)}for(var Ke=0;Ke<ae.length;Ke++)for(var De=0;De<3;De++){ue.getVertex(ue.indices[ae[Ke]*3+De],ve),ue.getVertex(ue.indices[ae[Ke]*3+(De+1)%3],Ne),Ne.vsub(ve,Ye),He.vsub(Ne,je);var st=je.dot(Ye);He.vsub(ve,je);var ut=je.dot(Ye);if(ut>0&&st<0){He.vsub(ve,je),$e.copy(Ye),$e.normalize(),ut=je.dot($e),$e.scale(ut,je),je.vadd(ve,je);var Ct=je.distanceTo(He);if(Ct<ce.radius){var Xe=this.createContactEquation(Ge,ze,ce,ue);je.vsub(He,Xe.ni),Xe.ni.normalize(),Xe.ni.scale(ce.radius,Xe.ri),c.pointToWorldFrame(be,Re,je,je),je.vsub(ze.position,Xe.rj),c.vectorToWorldFrame(Re,Xe.ni,Xe.ni),c.vectorToWorldFrame(Re,Xe.ri,Xe.ri),this.result.push(Xe),this.createFrictionEquationsFromContact(Xe,this.frictionResult)}}}for(var bt=U,yt=O,ft=F,St=S,Ke=0,ot=ae.length;Ke!==ot;Ke++){ue.getTriangleVertices(ae[Ke],bt,yt,ft),ue.getNormal(ae[Ke],St),He.vsub(bt,je);var Ct=je.dot(St);if(St.scale(Ct,je),He.vsub(je,je),Ct=je.distanceTo(He),a.pointInTriangle(je,bt,yt,ft)&&Ct<ce.radius){var Xe=this.createContactEquation(Ge,ze,ce,ue);je.vsub(He,Xe.ni),Xe.ni.normalize(),Xe.ni.scale(ce.radius,Xe.ri),c.pointToWorldFrame(be,Re,je,je),je.vsub(ze.position,Xe.rj),c.vectorToWorldFrame(Re,Xe.ni,Xe.ni),c.vectorToWorldFrame(Re,Xe.ri,Xe.ri),this.result.push(Xe),this.createFrictionEquationsFromContact(Xe,this.frictionResult)}}ae.length=0};var C=new l,M=new l;f.prototype[o.types.SPHERE|o.types.PLANE]=f.prototype.spherePlane=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=this.createContactEquation(Ge,ze,ce,ue);if(ve.ni.set(0,0,1),Re.vmult(ve.ni,ve.ni),ve.ni.negate(ve.ni),ve.ni.normalize(),ve.ni.mult(ce.radius,ve.ri),de.vsub(be,C),ve.ni.mult(ve.ni.dot(C),M),C.vsub(M,ve.rj),-C.dot(ve.ni)<=ce.radius){var Ne=ve.ri,Ye=ve.rj;Ne.vadd(de,Ne),Ne.vsub(Ge.position,Ne),Ye.vadd(be,Ye),Ye.vsub(ze.position,Ye),this.result.push(ve),this.createFrictionEquationsFromContact(ve,this.frictionResult)}};var B=new l,k=new l,Q=new l;function Y(ce,ue,de){for(var be=null,Ue=ce.length,Re=0;Re!==Ue;Re++){var Ge=ce[Re],ze=B;ce[(Re+1)%Ue].vsub(Ge,ze);var ve=k;ze.cross(ue,ve);var Ne=Q;de.vsub(Ge,Ne);var Ye=ve.dot(Ne);if(be===null||Ye>0&&be===!0||Ye<=0&&be===!1){be===null&&(be=Ye>0);continue}else return!1}return!0}var re=new l,Z=new l,V=new l,ne=new l,ie=[new l,new l,new l,new l,new l,new l],te=new l,j=new l,W=new l,H=new l;f.prototype[o.types.SPHERE|o.types.BOX]=f.prototype.sphereBox=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=this.v3pool,Ne=ie;de.vsub(be,re),ue.getSideNormals(Ne,Re);for(var Ye=ce.radius,$e=!1,He=j,je=W,K=H,he=null,ye=0,ae=0,fe=0,Fe=null,tt=0,Ke=Ne.length;tt!==Ke&&$e===!1;tt++){var De=Z;De.copy(Ne[tt]);var Xe=De.norm();De.normalize();var st=re.dot(De);if(st<Xe+Ye&&st>0){var ut=V,Ct=ne;ut.copy(Ne[(tt+1)%3]),Ct.copy(Ne[(tt+2)%3]);var bt=ut.norm(),yt=Ct.norm();ut.normalize(),Ct.normalize();var ft=re.dot(ut),St=re.dot(Ct);if(ft<bt&&ft>-bt&&St<yt&&St>-yt){var ot=Math.abs(st-Xe-Ye);(Fe===null||ot<Fe)&&(Fe=ot,ae=ft,fe=St,he=Xe,He.copy(De),je.copy(ut),K.copy(Ct),ye++)}}}if(ye){$e=!0;var pt=this.createContactEquation(Ge,ze,ce,ue);He.mult(-Ye,pt.ri),pt.ni.copy(He),pt.ni.negate(pt.ni),He.mult(he,He),je.mult(ae,je),He.vadd(je,He),K.mult(fe,K),He.vadd(K,pt.rj),pt.ri.vadd(de,pt.ri),pt.ri.vsub(Ge.position,pt.ri),pt.rj.vadd(be,pt.rj),pt.rj.vsub(ze.position,pt.rj),this.result.push(pt),this.createFrictionEquationsFromContact(pt,this.frictionResult)}for(var Nt=ve.get(),di=te,Gt=0;Gt!==2&&!$e;Gt++)for(var Wt=0;Wt!==2&&!$e;Wt++)for(var ni=0;ni!==2&&!$e;ni++)if(Nt.set(0,0,0),Gt?Nt.vadd(Ne[0],Nt):Nt.vsub(Ne[0],Nt),Wt?Nt.vadd(Ne[1],Nt):Nt.vsub(Ne[1],Nt),ni?Nt.vadd(Ne[2],Nt):Nt.vsub(Ne[2],Nt),be.vadd(Nt,di),di.vsub(de,di),di.norm2()<Ye*Ye){$e=!0;var pt=this.createContactEquation(Ge,ze,ce,ue);pt.ri.copy(di),pt.ri.normalize(),pt.ni.copy(pt.ri),pt.ri.mult(Ye,pt.ri),pt.rj.copy(Nt),pt.ri.vadd(de,pt.ri),pt.ri.vsub(Ge.position,pt.ri),pt.rj.vadd(be,pt.rj),pt.rj.vsub(ze.position,pt.rj),this.result.push(pt),this.createFrictionEquationsFromContact(pt,this.frictionResult)}ve.release(Nt),Nt=null;for(var Ft=ve.get(),$t=ve.get(),pt=ve.get(),$i=ve.get(),ot=ve.get(),Kt=Ne.length,Gt=0;Gt!==Kt&&!$e;Gt++)for(var Wt=0;Wt!==Kt&&!$e;Wt++)if(Gt%3!==Wt%3){Ne[Wt].cross(Ne[Gt],Ft),Ft.normalize(),Ne[Gt].vadd(Ne[Wt],$t),pt.copy(de),pt.vsub($t,pt),pt.vsub(be,pt);var nn=pt.dot(Ft);Ft.mult(nn,$i);for(var ni=0;ni===Gt%3||ni===Wt%3;)ni++;ot.copy(de),ot.vsub($i,ot),ot.vsub($t,ot),ot.vsub(be,ot);var fo=Math.abs(nn),Ls=ot.norm();if(fo<Ne[ni].norm()&&Ls<Ye){$e=!0;var kt=this.createContactEquation(Ge,ze,ce,ue);$t.vadd($i,kt.rj),kt.rj.copy(kt.rj),ot.negate(kt.ni),kt.ni.normalize(),kt.ri.copy(kt.rj),kt.ri.vadd(be,kt.ri),kt.ri.vsub(de,kt.ri),kt.ri.normalize(),kt.ri.mult(Ye,kt.ri),kt.ri.vadd(de,kt.ri),kt.ri.vsub(Ge.position,kt.ri),kt.rj.vadd(be,kt.rj),kt.rj.vsub(ze.position,kt.rj),this.result.push(kt),this.createFrictionEquationsFromContact(kt,this.frictionResult)}}ve.release(Ft,$t,pt,$i,ot)};var q=new l,I=new l,ee=new l,me=new l,pe=new l,ge=new l,xe=new l,we=new l,_e=new l,Ie=new l;f.prototype[o.types.SPHERE|o.types.CONVEXPOLYHEDRON]=f.prototype.sphereConvex=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=this.v3pool;de.vsub(be,q);for(var Ne=ue.faceNormals,Ye=ue.faces,$e=ue.vertices,He=ce.radius,je=0;je!==$e.length;je++){var K=$e[je],he=pe;Re.vmult(K,he),be.vadd(he,he);var ye=me;if(he.vsub(de,ye),ye.norm2()<He*He){fe=!0;var ae=this.createContactEquation(Ge,ze,ce,ue);ae.ri.copy(ye),ae.ri.normalize(),ae.ni.copy(ae.ri),ae.ri.mult(He,ae.ri),he.vsub(be,ae.rj),ae.ri.vadd(de,ae.ri),ae.ri.vsub(Ge.position,ae.ri),ae.rj.vadd(be,ae.rj),ae.rj.vsub(ze.position,ae.rj),this.result.push(ae),this.createFrictionEquationsFromContact(ae,this.frictionResult);return}}for(var fe=!1,je=0,Fe=Ye.length;je!==Fe&&fe===!1;je++){var tt=Ne[je],Ke=Ye[je],De=ge;Re.vmult(tt,De);var Xe=xe;Re.vmult($e[Ke[0]],Xe),Xe.vadd(be,Xe);var st=we;De.mult(-He,st),de.vadd(st,st);var ut=_e;st.vsub(Xe,ut);var Ct=ut.dot(De),bt=Ie;if(de.vsub(Xe,bt),Ct<0&&bt.dot(De)>0){for(var yt=[],ft=0,St=Ke.length;ft!==St;ft++){var ot=ve.get();Re.vmult($e[Ke[ft]],ot),be.vadd(ot,ot),yt.push(ot)}if(Y(yt,De,de)){fe=!0;var ae=this.createContactEquation(Ge,ze,ce,ue);De.mult(-He,ae.ri),De.negate(ae.ni);var pt=ve.get();De.mult(-Ct,pt);var Nt=ve.get();De.mult(-He,Nt),de.vsub(be,ae.rj),ae.rj.vadd(Nt,ae.rj),ae.rj.vadd(pt,ae.rj),ae.rj.vadd(be,ae.rj),ae.rj.vsub(ze.position,ae.rj),ae.ri.vadd(de,ae.ri),ae.ri.vsub(Ge.position,ae.ri),ve.release(pt),ve.release(Nt),this.result.push(ae),this.createFrictionEquationsFromContact(ae,this.frictionResult);for(var ft=0,di=yt.length;ft!==di;ft++)ve.release(yt[ft]);return}else for(var ft=0;ft!==Ke.length;ft++){var Gt=ve.get(),Wt=ve.get();Re.vmult($e[Ke[(ft+1)%Ke.length]],Gt),Re.vmult($e[Ke[(ft+2)%Ke.length]],Wt),be.vadd(Gt,Gt),be.vadd(Wt,Wt);var ni=I;Wt.vsub(Gt,ni);var Ft=ee;ni.unit(Ft);var $t=ve.get(),$i=ve.get();de.vsub(Gt,$i);var Kt=$i.dot(Ft);Ft.mult(Kt,$t),$t.vadd(Gt,$t);var nn=ve.get();if($t.vsub(de,nn),Kt>0&&Kt*Kt<ni.norm2()&&nn.norm2()<He*He){var ae=this.createContactEquation(Ge,ze,ce,ue);$t.vsub(be,ae.rj),$t.vsub(de,ae.ni),ae.ni.normalize(),ae.ni.mult(He,ae.ri),ae.rj.vadd(be,ae.rj),ae.rj.vsub(ze.position,ae.rj),ae.ri.vadd(de,ae.ri),ae.ri.vsub(Ge.position,ae.ri),this.result.push(ae),this.createFrictionEquationsFromContact(ae,this.frictionResult);for(var ft=0,di=yt.length;ft!==di;ft++)ve.release(yt[ft]);ve.release(Gt),ve.release(Wt),ve.release($t),ve.release(nn),ve.release($i);return}ve.release(Gt),ve.release(Wt),ve.release($t),ve.release(nn),ve.release($i)}for(var ft=0,di=yt.length;ft!==di;ft++)ve.release(yt[ft])}}},new l,new l,f.prototype[o.types.PLANE|o.types.BOX]=f.prototype.planeBox=function(ce,ue,de,be,Ue,Re,Ge,ze){ue.convexPolyhedronRepresentation.material=ue.material,ue.convexPolyhedronRepresentation.collisionResponse=ue.collisionResponse,this.planeConvex(ce,ue.convexPolyhedronRepresentation,de,be,Ue,Re,Ge,ze)};var Be=new l,Ae=new l,it=new l,se=new l;f.prototype[o.types.PLANE|o.types.CONVEXPOLYHEDRON]=f.prototype.planeConvex=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=Be,Ne=Ae;Ne.set(0,0,1),Ue.vmult(Ne,Ne);for(var Ye=0,$e=it,He=0;He!==ue.vertices.length;He++){ve.copy(ue.vertices[He]),Re.vmult(ve,ve),be.vadd(ve,ve),ve.vsub(de,$e);var je=Ne.dot($e);if(je<=0){var K=this.createContactEquation(Ge,ze,ce,ue),he=se;Ne.mult(Ne.dot($e),he),ve.vsub(he,he),he.vsub(de,K.ri),K.ni.copy(Ne),ve.vsub(be,K.rj),K.ri.vadd(de,K.ri),K.ri.vsub(Ge.position,K.ri),K.rj.vadd(be,K.rj),K.rj.vsub(ze.position,K.rj),this.result.push(K),Ye++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(K,this.frictionResult)}}this.enableFrictionReduction&&Ye&&this.createFrictionFromAverage(Ye)};var Le=new l,Ee=new l;f.prototype[o.types.CONVEXPOLYHEDRON]=f.prototype.convexConvex=function(ce,ue,de,be,Ue,Re,Ge,ze,ve,Ne,Ye,$e){var He=Le;if(!(de.distanceTo(be)>ce.boundingSphereRadius+ue.boundingSphereRadius)&&ce.findSeparatingAxis(ue,de,Ue,be,Re,He,Ye,$e)){var je=[],K=Ee;ce.clipAgainstHull(de,Ue,ue,be,Re,He,-100,100,je);for(var he=0,ye=0;ye!==je.length;ye++){var ae=this.createContactEquation(Ge,ze,ce,ue,ve,Ne),fe=ae.ri,Fe=ae.rj;He.negate(ae.ni),je[ye].normal.negate(K),K.mult(je[ye].depth,K),je[ye].point.vadd(K,fe),Fe.copy(je[ye].point),fe.vsub(de,fe),Fe.vsub(be,Fe),fe.vadd(de,fe),fe.vsub(Ge.position,fe),Fe.vadd(be,Fe),Fe.vsub(ze.position,Fe),this.result.push(ae),he++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(ae,this.frictionResult)}this.enableFrictionReduction&&he&&this.createFrictionFromAverage(he)}};var ke=new l,We=new l,Qe=new l;f.prototype[o.types.PLANE|o.types.PARTICLE]=f.prototype.planeParticle=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=ke;ve.set(0,0,1),Ge.quaternion.vmult(ve,ve);var Ne=We;be.vsub(Ge.position,Ne);var Ye=ve.dot(Ne);if(Ye<=0){var $e=this.createContactEquation(ze,Ge,ue,ce);$e.ni.copy(ve),$e.ni.negate($e.ni),$e.ri.set(0,0,0);var He=Qe;ve.mult(ve.dot(be),He),be.vsub(He,He),$e.rj.copy(He),this.result.push($e),this.createFrictionEquationsFromContact($e,this.frictionResult)}};var rt=new l;f.prototype[o.types.PARTICLE|o.types.SPHERE]=f.prototype.sphereParticle=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=rt;ve.set(0,0,1),be.vsub(de,ve);var Ne=ve.norm2();if(Ne<=ce.radius*ce.radius){var Ye=this.createContactEquation(ze,Ge,ue,ce);ve.normalize(),Ye.rj.copy(ve),Ye.rj.mult(ce.radius,Ye.rj),Ye.ni.copy(ve),Ye.ni.negate(Ye.ni),Ye.ri.set(0,0,0),this.result.push(Ye),this.createFrictionEquationsFromContact(Ye,this.frictionResult)}};var Oe=new u,Ce=new l;new l;var le=new l,Pe=new l,Ve=new l;f.prototype[o.types.PARTICLE|o.types.CONVEXPOLYHEDRON]=f.prototype.convexParticle=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=-1,Ne=le,Ye=Ve,$e=null,He=Ce;if(He.copy(be),He.vsub(de,He),Ue.conjugate(Oe),Oe.vmult(He,He),ce.pointIsInside(He)){ce.worldVerticesNeedsUpdate&&ce.computeWorldVertices(de,Ue),ce.worldFaceNormalsNeedsUpdate&&ce.computeWorldFaceNormals(Ue);for(var je=0,K=ce.faces.length;je!==K;je++){var he=[ce.worldVertices[ce.faces[je][0]]],ye=ce.worldFaceNormals[je];be.vsub(he[0],Pe);var ae=-ye.dot(Pe);($e===null||Math.abs(ae)<Math.abs($e))&&($e=ae,ve=je,Ne.copy(ye))}if(ve!==-1){var fe=this.createContactEquation(ze,Ge,ue,ce);Ne.mult($e,Ye),Ye.vadd(be,Ye),Ye.vsub(de,Ye),fe.rj.copy(Ye),Ne.negate(fe.ni),fe.ri.set(0,0,0);var Fe=fe.ri,tt=fe.rj;Fe.vadd(be,Fe),Fe.vsub(ze.position,Fe),tt.vadd(de,tt),tt.vsub(Ge.position,tt),this.result.push(fe),this.createFrictionEquationsFromContact(fe,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},f.prototype[o.types.BOX|o.types.HEIGHTFIELD]=f.prototype.boxHeightfield=function(ce,ue,de,be,Ue,Re,Ge,ze){ce.convexPolyhedronRepresentation.material=ce.material,ce.convexPolyhedronRepresentation.collisionResponse=ce.collisionResponse,this.convexHeightfield(ce.convexPolyhedronRepresentation,ue,de,be,Ue,Re,Ge,ze)};var et=new l,Je=new l,Te=[0];f.prototype[o.types.CONVEXPOLYHEDRON|o.types.HEIGHTFIELD]=f.prototype.convexHeightfield=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=ue.data,Ne=ue.elementSize,Ye=ce.boundingSphereRadius,$e=Je,He=Te,je=et;c.pointToLocalFrame(be,Re,de,je);var K=Math.floor((je.x-Ye)/Ne)-1,he=Math.ceil((je.x+Ye)/Ne)+1,ye=Math.floor((je.y-Ye)/Ne)-1,ae=Math.ceil((je.y+Ye)/Ne)+1;if(!(he<0||ae<0||K>ve.length||ye>ve[0].length)){K<0&&(K=0),he<0&&(he=0),ye<0&&(ye=0),ae<0&&(ae=0),K>=ve.length&&(K=ve.length-1),he>=ve.length&&(he=ve.length-1),ae>=ve[0].length&&(ae=ve[0].length-1),ye>=ve[0].length&&(ye=ve[0].length-1);var fe=[];ue.getRectMinMax(K,ye,he,ae,fe);var Fe=fe[0],tt=fe[1];if(!(je.z-Ye>tt||je.z+Ye<Fe))for(var Ke=K;Ke<he;Ke++)for(var De=ye;De<ae;De++)ue.getConvexTrianglePillar(Ke,De,!1),c.pointToWorldFrame(be,Re,ue.pillarOffset,$e),de.distanceTo($e)<ue.pillarConvex.boundingSphereRadius+ce.boundingSphereRadius&&this.convexConvex(ce,ue.pillarConvex,de,$e,Ue,Re,Ge,ze,null,null,He,null),ue.getConvexTrianglePillar(Ke,De,!0),c.pointToWorldFrame(be,Re,ue.pillarOffset,$e),de.distanceTo($e)<ue.pillarConvex.boundingSphereRadius+ce.boundingSphereRadius&&this.convexConvex(ce,ue.pillarConvex,de,$e,Ue,Re,Ge,ze,null,null,He,null)}};var Ze=new l,Se=new l;f.prototype[o.types.SPHERE|o.types.HEIGHTFIELD]=f.prototype.sphereHeightfield=function(ce,ue,de,be,Ue,Re,Ge,ze){var ve=ue.data,Ne=ce.radius,Ye=ue.elementSize,$e=Se,He=Ze;c.pointToLocalFrame(be,Re,de,He);var je=Math.floor((He.x-Ne)/Ye)-1,K=Math.ceil((He.x+Ne)/Ye)+1,he=Math.floor((He.y-Ne)/Ye)-1,ye=Math.ceil((He.y+Ne)/Ye)+1;if(!(K<0||ye<0||je>ve.length||ye>ve[0].length)){je<0&&(je=0),K<0&&(K=0),he<0&&(he=0),ye<0&&(ye=0),je>=ve.length&&(je=ve.length-1),K>=ve.length&&(K=ve.length-1),ye>=ve[0].length&&(ye=ve[0].length-1),he>=ve[0].length&&(he=ve[0].length-1);var ae=[];ue.getRectMinMax(je,he,K,ye,ae);var fe=ae[0],Fe=ae[1];if(!(He.z-Ne>Fe||He.z+Ne<fe))for(var tt=this.result,Ke=je;Ke<K;Ke++)for(var De=he;De<ye;De++){var Xe=tt.length;ue.getConvexTrianglePillar(Ke,De,!1),c.pointToWorldFrame(be,Re,ue.pillarOffset,$e),de.distanceTo($e)<ue.pillarConvex.boundingSphereRadius+ce.boundingSphereRadius&&this.sphereConvex(ce,ue.pillarConvex,de,$e,Ue,Re,Ge,ze),ue.getConvexTrianglePillar(Ke,De,!0),c.pointToWorldFrame(be,Re,ue.pillarOffset,$e),de.distanceTo($e)<ue.pillarConvex.boundingSphereRadius+ce.boundingSphereRadius&&this.sphereConvex(ce,ue.pillarConvex,de,$e,Ue,Re,Ge,ze);var st=tt.length-Xe;if(st>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(t,i,r){i.exports=_;var s=t("../shapes/Shape"),o=t("../math/Vec3"),a=t("../math/Quaternion"),l=t("../solver/GSSolver");t("../utils/Vec3Pool"),t("../equations/ContactEquation"),t("../equations/FrictionEquation");var c=t("./Narrowphase"),u=t("../utils/EventTarget"),h=t("../collision/ArrayCollisionMatrix"),d=t("../material/Material"),p=t("../material/ContactMaterial"),f=t("../objects/Body"),v=t("../utils/TupleDictionary"),g=t("../collision/RaycastResult"),m=t("../collision/AABB"),x=t("../collision/Ray"),y=t("../collision/NaiveBroadphase");function _(){u.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new o,this.broadphase=new y,this.bodies=[],this.solver=new l,this.constraints=[],this.narrowphase=new c(this),this.collisionMatrix=new h,this.collisionMatrixPrevious=new h,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new v,this.defaultMaterial=new d("default"),this.defaultContactMaterial=new p(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}_.prototype=new u,new m;var w=new x;if(_.prototype.getContactMaterial=function(N,U){return this.contactMaterialTable.get(N.id,U.id)},_.prototype.numObjects=function(){return this.bodies.length},_.prototype.collisionMatrixTick=function(){var N=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=N,this.collisionMatrix.reset()},_.prototype.add=_.prototype.addBody=function(N){this.bodies.indexOf(N)===-1&&(N.index=this.bodies.length,this.bodies.push(N),N.world=this,N.initPosition.copy(N.position),N.initVelocity.copy(N.velocity),N.timeLastSleepy=this.time,N instanceof f&&(N.initAngularVelocity.copy(N.angularVelocity),N.initQuaternion.copy(N.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=N,this.dispatchEvent(this.addBodyEvent))},_.prototype.addConstraint=function(N){this.constraints.push(N)},_.prototype.removeConstraint=function(N){var U=this.constraints.indexOf(N);U!==-1&&this.constraints.splice(U,1)},_.prototype.rayTest=function(N,U,O){O instanceof g?this.raycastClosest(N,U,{skipBackfaces:!0},O):this.raycastAll(N,U,{skipBackfaces:!0},O)},_.prototype.raycastAll=function(N,U,O,F){return O.mode=x.ALL,O.from=N,O.to=U,O.callback=F,w.intersectWorld(this,O)},_.prototype.raycastAny=function(N,U,O,F){return O.mode=x.ANY,O.from=N,O.to=U,O.result=F,w.intersectWorld(this,O)},_.prototype.raycastClosest=function(N,U,O,F){return O.mode=x.CLOSEST,O.from=N,O.to=U,O.result=F,w.intersectWorld(this,O)},_.prototype.remove=function(N){N.world=null;var U=this.bodies.length-1,O=this.bodies,F=O.indexOf(N);if(F!==-1){O.splice(F,1);for(var $=0;$!==O.length;$++)O[$].index=$;this.collisionMatrix.setNumObjects(U),this.removeBodyEvent.body=N,this.dispatchEvent(this.removeBodyEvent)}},_.prototype.removeBody=_.prototype.remove,_.prototype.addMaterial=function(N){this.materials.push(N)},_.prototype.addContactMaterial=function(N){this.contactmaterials.push(N),this.contactMaterialTable.set(N.materials[0].id,N.materials[1].id,N)},typeof performance>"u"&&(performance={}),!performance.now){var b=Date.now();performance.timing&&performance.timing.navigationStart&&(b=performance.timing.navigationStart),performance.now=function(){return Date.now()-b}}var T=new o;_.prototype.step=function(N,U,O){if(O=O||10,U=U||0,U===0)this.internalStep(N),this.time+=N;else{var F=Math.floor((this.time+U)/N)-Math.floor(this.time/N);F=Math.min(F,O);for(var $=performance.now(),P=0;P!==F&&(this.internalStep(N),!(performance.now()-$>N*1e3));P++);this.time+=U;for(var C=this.time%N,M=C/N,B=T,k=this.bodies,Q=0;Q!==k.length;Q++){var Y=k[Q];Y.type!==f.STATIC&&Y.sleepState!==f.SLEEPING?(Y.position.vsub(Y.previousPosition,B),B.scale(M,B),Y.position.vadd(B,Y.interpolatedPosition)):(Y.interpolatedPosition.copy(Y.position),Y.interpolatedQuaternion.copy(Y.quaternion))}}};var A={type:"postStep"},S={type:"preStep"},E={type:"collide",body:null,contact:null},R=[],D=[],z=[],L=[];new o,new o,new o,new o,new o,new o,new o,new o,new o,new a;var G=new a,J=new a,X=new o;_.prototype.internalStep=function(N){this.dt=N;var U=this.contacts,O=z,F=L,$=this.numObjects(),P=this.bodies,C=this.solver,M=this.gravity,B=this.doProfiling,k=this.profile,Q=f.DYNAMIC,Y,re=this.constraints,Z=D;M.norm();var V=M.x,ne=M.y,ie=M.z,te=0;for(B&&(Y=performance.now()),te=0;te!==$;te++){var j=P[te];if(j.type&Q){var W=j.force,H=j.mass;W.x+=H*V,W.y+=H*ne,W.z+=H*ie}}for(var te=0,q=this.subsystems.length;te!==q;te++)this.subsystems[te].update();B&&(Y=performance.now()),O.length=0,F.length=0,this.broadphase.collisionPairs(this,O,F),B&&(k.broadphase=performance.now()-Y);var Le=re.length;for(te=0;te!==Le;te++){var I=re[te];if(!I.collideConnected)for(var ee=O.length-1;ee>=0;ee-=1)(I.bodyA===O[ee]&&I.bodyB===F[ee]||I.bodyB===O[ee]&&I.bodyA===F[ee])&&(O.splice(ee,1),F.splice(ee,1))}this.collisionMatrixTick(),B&&(Y=performance.now());var me=R,pe=U.length;for(te=0;te!==pe;te++)me.push(U[te]);U.length=0;var ge=this.frictionEquations.length;for(te=0;te!==ge;te++)Z.push(this.frictionEquations[te]);this.frictionEquations.length=0,this.narrowphase.getContacts(O,F,this,U,me,this.frictionEquations,Z),B&&(k.narrowphase=performance.now()-Y),B&&(Y=performance.now());for(var te=0;te<this.frictionEquations.length;te++)C.addEquation(this.frictionEquations[te]);for(var xe=U.length,we=0;we!==xe;we++){var I=U[we],j=I.bi,_e=I.bj;I.si,I.sj;var Ie;if(j.material&&_e.material?Ie=this.getContactMaterial(j.material,_e.material)||this.defaultContactMaterial:Ie=this.defaultContactMaterial,Ie.friction,j.material&&_e.material&&(j.material.friction>=0&&_e.material.friction>=0&&j.material.friction*_e.material.friction,j.material.restitution>=0&&_e.material.restitution>=0&&(I.restitution=j.material.restitution*_e.material.restitution)),C.addEquation(I),j.allowSleep&&j.type===f.DYNAMIC&&j.sleepState===f.SLEEPING&&_e.sleepState===f.AWAKE&&_e.type!==f.STATIC){var Be=_e.velocity.norm2()+_e.angularVelocity.norm2(),Ae=Math.pow(_e.sleepSpeedLimit,2);Be>=Ae*2&&(j._wakeUpAfterNarrowphase=!0)}if(_e.allowSleep&&_e.type===f.DYNAMIC&&_e.sleepState===f.SLEEPING&&j.sleepState===f.AWAKE&&j.type!==f.STATIC){var it=j.velocity.norm2()+j.angularVelocity.norm2(),se=Math.pow(j.sleepSpeedLimit,2);it>=se*2&&(_e._wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(j,_e,!0),this.collisionMatrixPrevious.get(j,_e)||(E.body=_e,E.contact=I,j.dispatchEvent(E),E.body=j,_e.dispatchEvent(E))}for(B&&(k.makeContactConstraints=performance.now()-Y,Y=performance.now()),te=0;te!==$;te++){var j=P[te];j._wakeUpAfterNarrowphase&&(j.wakeUp(),j._wakeUpAfterNarrowphase=!1)}var Le=re.length;for(te=0;te!==Le;te++){var I=re[te];I.update();for(var ee=0,Ee=I.equations.length;ee!==Ee;ee++){var ke=I.equations[ee];C.addEquation(ke)}}C.solve(N,this),B&&(k.solve=performance.now()-Y),C.removeAllEquations();var We=Math.pow;for(te=0;te!==$;te++){var j=P[te];if(j.type&Q){var Qe=We(1-j.linearDamping,N),rt=j.velocity;rt.mult(Qe,rt);var Oe=j.angularVelocity;if(Oe){var Ce=We(1-j.angularDamping,N);Oe.mult(Ce,Oe)}}}for(this.dispatchEvent(S),te=0;te!==$;te++){var j=P[te];j.preStep&&j.preStep.call(j)}B&&(Y=performance.now());var le=G,Pe=J,Ve=this.stepnumber,et=f.DYNAMIC|f.KINEMATIC,Je=Ve%(this.quatNormalizeSkip+1)===0,Te=this.quatNormalizeFast,Ze=N*.5;for(s.types.PLANE,s.types.CONVEXPOLYHEDRON,te=0;te!==$;te++){var Se=P[te],ce=Se.force,ue=Se.torque;if(Se.type&et&&Se.sleepState!==f.SLEEPING){var de=Se.velocity,be=Se.angularVelocity,Ue=Se.position,Re=Se.quaternion,Ge=Se.invMass,ze=Se.invInertiaWorld;de.x+=ce.x*Ge*N,de.y+=ce.y*Ge*N,de.z+=ce.z*Ge*N,Se.angularVelocity&&(ze.vmult(ue,X),X.mult(N,X),X.vadd(be,be)),Ue.x+=de.x*N,Ue.y+=de.y*N,Ue.z+=de.z*N,Se.angularVelocity&&(le.set(be.x,be.y,be.z,0),le.mult(Re,Pe),Re.x+=Ze*Pe.x,Re.y+=Ze*Pe.y,Re.z+=Ze*Pe.z,Re.w+=Ze*Pe.w,Je&&(Te?Re.normalizeFast():Re.normalize())),Se.aabb&&(Se.aabbNeedsUpdate=!0),Se.updateInertiaWorld&&Se.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,B&&(k.integrate=performance.now()-Y),this.time+=N,this.stepnumber+=1,this.dispatchEvent(A),te=0;te!==$;te++){var j=P[te],ve=j.postStep;ve&&ve.call(j)}if(this.allowSleep)for(te=0;te!==$;te++)P[te].sleepTick(this.time)},_.prototype.clearForces=function(){for(var N=this.bodies,U=N.length,O=0;O!==U;O++){var F=N[O];F.force,F.torque,F.force.set(0,0,0),F.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)})})(DA);var Rh=DA.exports,Wx=class{constructor(e){this.group=e,this.app=new Bt,this.helper=new Yt,this.raycaster=new em,this.raycastTargets=[],this.mouseVector=new Me,this.mouseDown=!1,this.gate1=!1,this.start(),this.physics(),this.observer()}observer(){this.observer=new IntersectionObserver((e,t)=>{e.forEach(i=>{i.isIntersecting?this.flashy():this.resetFlashy()})},{root:null,threshold:.7}),this.observer.observe(this.tokenContainer)}start(){this.tokenContainer=document.getElementsByClassName("token__gl")[0],this.rect2=this.tokenContainer.getBoundingClientRect();let e=this.rect2.height/this.app.sizes.height,t=.165,i=this.app.sizes.getVisible(t).y*e;this.geometry=this.app.resources.items.token.scene.children[0].children[0].geometry,this.geometry2=this.app.resources.items.token.scene.children[0].children[1].geometry,this.material=new qh({color:new at("#FF1C70"),emissive:new at("#000000"),emissiveIntensity:100.1,specular:new at("#FF1C70"),shininess:100,side:Kr,depthTest:!0,depthWrite:!0,transparent:!0,envMap:this.app.resources.items.envMap,reflectivity:.2,opacity:.5}),this.material2=new qh({color:new at("#ffffff"),emissive:new at("#000000"),emissiveIntensity:100.1,specular:new at("#FF1C70"),shininess:100,side:Di,depthTest:!0,depthWrite:!0,transparent:!0,envMap:this.app.resources.items.envMap,reflectivity:.5,opacity:1}),this.instance=new wt(this.geometry,this.material),this.instance.name="token",this.instance2=new wt(this.geometry2,this.material2),this.instance2.name="token2",this.group.add(this.instance,this.instance2),this.raycastTargets.push(this.instance,this.instance2),this.mobileScale=this.app.isMobile?.8:1,this.instance.scale.set(i*.6*this.mobileScale,i*.6*this.mobileScale,i*.6*this.mobileScale),this.instance2.scale.set(i*.6*this.mobileScale,i*.6*this.mobileScale,i*.6*this.mobileScale),this.instance.renderOrder=889,this.instance2.renderOrder=890}physics(){this.coinShape=new Rh.Cylinder(1,1,1,4),this.coinBody=new Rh.Body({mass:1,material:new Rh.Material({friction:.5,restitution:.7}),shape:this.coinShape}),this.coinBody.fixedRotation=!0,this.coinBody.updateMassProperties(),this.app.cannon.addBody(this.coinBody)}flashy(){this.app.world.environment.runFlashy()}resetFlashy(){this.app.world.environment.resetFlashy()}update(){this.mouseVector.x=this.helper.lerp(this.mouseVector.x,this.app.mouse.screenPosition.x,.5),this.mouseVector.y=this.helper.lerp(this.mouseVector.y,this.app.mouse.screenPosition.y,.5),this.raycaster.setFromCamera(this.mouseVector,this.app.camera.instance),this.coinBody&&(this.coinBody.angularVelocity.y*=.99,this.instance.quaternion.set(this.coinBody.quaternion.x,this.coinBody.quaternion.y,this.coinBody.quaternion.z,this.coinBody.quaternion.w),this.instance2.quaternion.set(this.coinBody.quaternion.x,this.coinBody.quaternion.y,this.coinBody.quaternion.z,this.coinBody.quaternion.w)),this.raycaster.intersectObjects(this.raycastTargets).length>0&&this.app.mouse.mouseDown&&this.coinBody.angularVelocity.set(0,this.app.mouse.velocity.x*.001,0)}},fm=class{constructor(e,t,i){this.group=e,this.markerElement=t,this.id=i,this.app=new Bt,this.helper=new Yt,this.imageArray=[],this.movement=new Me,this.group.position.y=-30,this.start(),this.addPlane(this.app.resources.items.backView),this.addPlane(this.app.resources.items.midView),this.addPlane(this.app.resources.items.frontView),this.shaderStuff(),this.storedWidth=this.imageArray[0].geometry.parameters.width,this.storedHeight=this.imageArray[0].geometry.parameters.height,this.currentWidth=this.imageArray[0].geometry.parameters.width,this.currentHeight=this.imageArray[0].geometry.parameters.height,this.mouseVelocityLerped=0,this.pulseLerped=0,this.mouseVelocityVecLerped=new Me,this.app.sizes.on("resize",()=>{this.imageArray.forEach(r=>{this.currentWidth=this.app.sizes.pixelsToWorldUnits(this.rect.width,.165)*this.fuckKnowsWhyMultiplier,this.currentHeight=this.app.sizes.pixelsToWorldUnits(this.rect.height,.165)*this.fuckKnowsWhyMultiplier,this.ratioOfScale=this.currentHeight/this.storedHeight,r.scale.x=this.ratioOfScale*.95,r.scale.y=this.ratioOfScale*.95})})}start(){this.rect=this.markerElement.getBoundingClientRect(),this.id===0?this.fuckKnowsWhyMultiplier=1.2:this.fuckKnowsWhyMultiplier=1.27;let e=.165;this.threeWidth=this.app.sizes.pixelsToWorldUnits(this.rect.width,e)*this.fuckKnowsWhyMultiplier,this.threeHeight=this.app.sizes.pixelsToWorldUnits(this.rect.height,e)*this.fuckKnowsWhyMultiplier,this.app.isMobile===!1?this.mask=this.app.resources.items.barA:this.id===0?this.mask=this.app.resources.items.squareMaskOne:this.mask=this.app.resources.items.squareMaskTwo,this.mask.premultiplyAlpha=!0,this.app.isMobile===!1&&this.id===0?this.geometry=new hi(this.threeHeight,this.threeHeight):this.geometry=new hi(this.threeWidth*.95,this.threeHeight*.95)}flicker(){let e=[.05,.04,.065],t=Math.floor(Math.random()*3)+2,i=e[Math.floor(Math.random()*e.length)];this.imageArray.forEach(r=>{lt.to(r.material,{opacity:0,duration:i*2,repeat:t,ease:"none",delay:0,onComplete:()=>{r.material.opacity=1}})})}setOpacity(e){this.imageArray.forEach(t=>{t.material.opacity=e})}addPlane(e){this.plane=new wt(this.geometry,new gr({map:e,color:new at("white"),side:Di,transparent:!0,depthWrite:!1,depthTest:!1,alphaMap:this.mask,opacity:1})),this.plane.position.set(0,0,0),this.plane.renderOrder=15,this.group.add(this.plane),this.imageArray.push(this.plane)}shaderStuff(){this.customUniforms={uTime:{value:0},hitUv:{value:new Me},pulse:{value:0},mouseVelocity:{value:0},mouseVelocityVec:{value:new Me}},this.imageArray.forEach(e=>{e.material.onBeforeCompile=t=>{t.uniforms.uTime=this.customUniforms.uTime,t.vertexShader=t.vertexShader.replace("#include <common>",`
                  #include <common>
                  varying vec2 vUv;

                  uniform vec2 hitUv;
                  uniform float pulse;
                  uniform float mouseVelocity;
                  uniform vec2 mouseVelocityVec;
              `),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`
                  // #include <begin_vertex>
                  vUv = uv;
                  // vec3 pos = position;
                  vec3 transformed = vec3( position );

              `),t.fragmentShader=t.fragmentShader.replace("#include <common>",`
                  #include <common>
                  varying vec2 vUv;
                  uniform float uTime;


                  vec3 mod289(vec3 x) {
                    return x - floor(x * (1.0 / 289.0)) * 289.0;
                  }


                  vec2 mod289(vec2 x) {
                    return x - floor(x * (1.0 / 289.0)) * 289.0;
                  }

                  vec3 permute(vec3 x) {
                    return mod289(((x*34.0)+1.0)*x);
                  }


                  float snoise(vec2 v)
                  {
                  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
                  // First corner
                    vec2 i  = floor(v + dot(v, C.yy) );
                    vec2 x0 = v -   i + dot(i, C.xx);

                  // Other corners
                    vec2 i1;
                    //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
                    //i1.y = 1.0 - i1.x;
                    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
                    // x0 = x0 - 0.0 + 0.0 * C.xx ;
                    // x1 = x0 - i1 + 1.0 * C.xx ;
                    // x2 = x0 - 1.0 + 2.0 * C.xx ;
                    vec4 x12 = x0.xyxy + C.xxzz;
                    x12.xy -= i1;

                  // Permutations
                    i = mod289(i); // Avoid truncation effects in permutation
                    vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
                      + i.x + vec3(0.0, i1.x, 1.0 ));

                    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
                    m = m*m ;
                    m = m*m ;

                  // Gradients: 41 points uniformly over a line, mapped onto a diamond.
                  // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

                    vec3 x = 2.0 * fract(p * C.www) - 1.0;
                    vec3 h = abs(x) - 0.5;
                    vec3 ox = floor(x + 0.5);
                    vec3 a0 = x - ox;

                  // Normalise gradients implicitly by scaling m
                  // Approximation of: m *= inversesqrt( a0*a0 + h*h );
                    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

                  // Compute final noise value at P
                    vec3 g;
                    g.x  = a0.x  * x0.x  + h.x  * x0.y;
                    g.yz = a0.yz * x12.xz + h.yz * x12.yw;
                    return 130.0 * dot(m, g);
                  }

                  float staticV(vec2 uv) {
                    float staticHeight = snoise(vec2(9.0,uTime*1.2+3.0))*0.3+5.0;
                    float staticAmount = snoise(vec2(1.0,uTime*1.2-6.0))*0.1+0.3;
                    float staticStrength = snoise(vec2(-9.75,uTime*0.6-3.0))*2.0+2.0;
                  return (1.0-step(snoise(vec2(5.0*pow(uTime,2.0)+pow(uv.x*7.0,1.2),pow((mod(uTime,100.0)+100.0)*uv.y*0.3+3.0,staticHeight))),staticAmount))*staticStrength;
                }

                vec3 gammaCorrectedColor(vec3 textureColor){
                  return pow(textureColor.rgb, vec3(1.0 / 2.2));
               }

               

                  // change these values to 0.0 to turn off individual effects
                  float vertJerkOpt = 0.02;
                  float vertMovementOpt = 0.01;
                  // noise
                  float bottomStaticOpt = 0.25;
                  //scanlines
                  float scalinesOpt = 0.1;
                  // fucks with the color
                  float rgbOffsetOpt = 0.0;
                  float horzFuzzOpt = 1.0;
          `),t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>",`
              #ifdef USE_MAP

              vec4 sampledDiffuseColor = texture2D( map, vUv );
          
              #ifdef DECODE_VIDEO_TEXTURE
          
                  // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)
          
                  sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
          
              #endif
          
              diffuseColor *= sampledDiffuseColor;
          
          #endif
              `),t.fragmentShader=t.fragmentShader.replace("#include <opaque_fragment>",`
                #include <opaque_fragment>

                #ifdef OPAQUE
                diffuseColor.a = 1.0;
                #endif

                #ifdef USE_TRANSMISSION
                diffuseColor.a *= transmissionAlpha + 0.1;
                #endif

                vec2 newCoords = vUv;


                float jerkOffset = (1.0-step(snoise(vec2(uTime*1.3,5.0)),0.8))*0.05;
  
                float fuzzOffset = snoise(vec2(uTime*15.0,newCoords.y*80.0))*0.003;
                float largeFuzzOffset = snoise(vec2(uTime*1.0,newCoords.y*25.0))*0.004;
                  
                float vertMovementOn = (1.0-step(snoise(vec2(uTime*0.2,8.0)),0.4))*vertMovementOpt;
                float vertJerk = (1.0-step(snoise(vec2(uTime*1.5,5.0)),0.6))*vertJerkOpt;
                float vertJerk2 = (1.0-step(snoise(vec2(uTime*5.5,5.0)),0.2))*vertJerkOpt;
                float yOffset = abs(sin(uTime)*4.0)*vertMovementOn+vertJerk*vertJerk2*0.3;
                float y = mod(newCoords.y+yOffset,1.0);
                  
                
                float xOffset = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt;
                  
                  float staticVal = 0.0;
                 
                  for (float y = -1.0; y <= 1.0; y += 1.0) {
                      float maxDist = 5.0/200.0;
                      float dist = y/200.0;
                    staticVal += staticV(vec2(newCoords.x,newCoords.y+dist))*(maxDist-abs(dist))*1.5;
                  }
                      
                  staticVal *= bottomStaticOpt;
                
                float red   =   texture2D(  map,  vec2(newCoords.x + xOffset -0.01*rgbOffsetOpt,y)).r+staticVal;
                float green =   texture2D(  map,  vec2(newCoords.x + xOffset,   y)).g+staticVal;
                float blue  = texture2D(  map,  vec2(newCoords.x + xOffset +0.01*rgbOffsetOpt,y)).b+staticVal;
                
                vec3 color = vec3(red,green,blue);
                float scanline = sin(newCoords.y*800.0)*0.04*scalinesOpt;
                color -= scanline;
                

                vec4 noiseOut = vec4(gammaCorrectedColor(color.rgb), 1.0);


               gl_FragColor = vec4(outgoingLight * noiseOut.xyz, diffuseColor.a);

                // gl_FragColor = vec4(vUv, 0.0, 1.0);

              `)}})}followTarget(){this.targetPosition=this.helper.update3DObjectPosition(this.markerElement,this.group,this.app.camera.instance),this.group.position.x=this.helper.lerp(this.group.position.x,this.targetPosition.x,_t),this.group.position.y=this.helper.lerp(this.group.position.y,this.targetPosition.y,_t),this.group.position.z=this.helper.lerp(this.group.position.z,this.targetPosition.z,_t)}dispose(){for(this.geometry&&this.geometry.dispose(),this.imageArray.forEach(e=>{e.material&&(e.material.map&&e.material.map.dispose(),e.material.alphaMap&&e.material.alphaMap.dispose(),e.material.dispose())});this.group.children.length>0;){let e=this.group.children[0];this.group.remove(e),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose(),e.texture&&e.texture.dispose()}this.imageArray.forEach(e=>{lt.killTweensOf(e.material)}),this.imageArray=[],this.group=null,this.markerElement=null,this.app=null,this.helper=null,this.plane=null,this.mask=null,this.targetPosition=null,this.movement=null}update(){this.customUniforms.uTime.value=this.app.time.elapsed*.001}},Ja=class{constructor(e,t,i){this.group=e,this.targetHtml=t,this.name=i,this.app=new Bt,this.helper=new Yt,this.currentWidth=this.getElementWidth(),this.currentHeight=this.getElementHeight(),this.start(),this.app.sizes.on("resize",()=>{this.group.scale.x=this.getElementHeight()/this.currentHeight,this.group.scale.y=this.getElementHeight()/this.currentHeight})}start(){this.markerElement=this.targetHtml,this.followTarget()}changeTarget(e){this.markerElement=e}getGroup(){return this.scaleGroup}getElementWidth(){return this.targetHtml.getBoundingClientRect().width}getElementHeight(){return this.targetHtml.getBoundingClientRect().height}followTarget(){this.targetPosition=this.helper.update3DObjectPositionWithOffsetX(this.markerElement,this.group,this.app.camera.instance,0,0),this.group.position.x=this.helper.lerp(this.group.position.x,this.targetPosition.x,_t),this.group.position.y=this.helper.lerp(this.group.position.y,this.targetPosition.y,_t),this.group.position.z=this.helper.lerp(this.group.position.z,this.targetPosition.z,_t)}update(){this.followTarget()}};lt.registerPlugin(mt);var qx=class extends Sn{constructor(){super(),this.app=new Bt,this.helper=new Yt,this.camera=this.app.camera,this.time=this.app.time,this.delta=this.app.time.delta,this.resources=this.app.resources,this.scene=this.app.scene,this.mouse=this.app.mouse,this.sizes=this.app.sizes,this.renderer=this.app.renderer,this.scrollManager=this.app.scrollManager,this.cameraStart=this.camera.instance,this.cameraStartPosition=this.cameraStart.position,this.generalScale=.8,this.windowHeightOnLoad=window.innerHeight,this.windowWidthOnLoad=window.innerWidth,this.widthLastFrame=window.innerWidth,this.heightLastFrame=window.innerHeight,this.mouseMovementVector=new oe,this.currentPosition=0,this.currentPosition2=0,this.spheresArray=[4],this.resources.on("ready",()=>{this.environment=new gx,this.pointerSprite=new vx(this.app.camera.group,this.mouse,this.camera),this.widthRatio=this.sizes.width/1728,this.heightRatio=this.sizes.height/976,this.allScrollersArray=[],this.allGroup=new vt,this.allGroup.name="allGroup",this.scene.add(this.allGroup),this.centeredGroup=new vt,this.centeredGroup.name="centeredGroup",this.scroller=new Ja(this.centeredGroup,document.getElementById("main-logo"),"scroller"),this.allScrollersArray.push(this.scroller),this.allGroup.add(this.centeredGroup),this.spaceGroup=new vt,this.spaceGroup.name="spaceGroup",this.scroller2=new Ja(this.spaceGroup,document.getElementById("gl-space-scene"),"scroller2"),this.allScrollersArray.push(this.scroller2),this.allGroup.add(this.spaceGroup),this.ledGroup=new vt,this.ledGroup.name="ledGroup",this.scroller5=new Ja(this.ledGroup,document.getElementById("gl-lcd"),"scroller5"),this.allScrollersArray.push(this.scroller5),this.allGroup.add(this.ledGroup),this.tokenGroup=new vt,this.tokenGroup.name="tokenGroup",this.scroller4=new Ja(this.tokenGroup,document.getElementsByClassName("token__gl")[0],"scroller4"),this.allScrollersArray.push(this.scroller4),this.allGroup.add(this.tokenGroup),this.sceneHolderGroup=new vt,this.sceneHolderGroup.name="sceneHolderGroup",this.scene.add(this.sceneHolderGroup),this.app.loader.on("loader-finished",()=>{this.viewGroup1=new vt,this.viewGroup1.name="viewGroup1",this.view1=new fm(this.spaceGroup,document.getElementById("gl-space-scene"),0),this.view1.setOpacity(1),this.logoLoader=new Rx(this.centeredGroup),this.trigger("logoLoader-finished"),this.lineShapeCreator=new Px(this.centeredGroup),this.logoText=new Hx(this.centeredGroup),this.backGroundColorChange=new Ux(this.centeredGroup),this.token=new Wx(this.tokenGroup)});let e=document.getElementById("gradient-hero-1");this.backgroundPlane=new Yr(this.sceneHolderGroup,e,e.getAttribute("data-gradient-color"),parseFloat(e.getAttribute("data-gradient-xOffset")),parseFloat(e.getAttribute("data-gradient-yOffset")),parseFloat(e.getAttribute("data-gradient-size"))*.01);let t=document.getElementById("gradient-hero-2");this.backgroundPlane2=new Yr(this.sceneHolderGroup,t,t.getAttribute("data-gradient-color"),parseFloat(t.getAttribute("data-gradient-xOffset")),parseFloat(t.getAttribute("data-gradient-yOffset")),parseFloat(t.getAttribute("data-gradient-size"))*.01);let i=document.getElementById("gradient-emp-1");this.backgroundPlane3=new Yr(this.sceneHolderGroup,i,i.getAttribute("data-gradient-color"),parseFloat(i.getAttribute("data-gradient-xOffset")),parseFloat(i.getAttribute("data-gradient-yOffset")),parseFloat(i.getAttribute("data-gradient-size"))*.01);let r=document.getElementById("gradient-emp-2");this.backgroundPlane4=new Yr(this.sceneHolderGroup,r,r.getAttribute("data-gradient-color"),parseFloat(r.getAttribute("data-gradient-xOffset")),parseFloat(r.getAttribute("data-gradient-yOffset")),parseFloat(r.getAttribute("data-gradient-size"))*.01);let s=document.getElementById("gradient-emp-3");this.backgroundPlane5=new Yr(this.sceneHolderGroup,s,s.getAttribute("data-gradient-color"),parseFloat(s.getAttribute("data-gradient-xOffset")),parseFloat(s.getAttribute("data-gradient-yOffset")),parseFloat(s.getAttribute("data-gradient-size"))*.01);let o=document.getElementById("gradient-vision");this.backgroundPlane6=new Yr(this.sceneHolderGroup,o,o.getAttribute("data-gradient-color"),parseFloat(o.getAttribute("data-gradient-xOffset")),parseFloat(o.getAttribute("data-gradient-yOffset")),parseFloat(o.getAttribute("data-gradient-size"))*.01);let a=document.getElementById("gradient-token");this.backgroundPlane7=new Yr(this.sceneHolderGroup,a,a.getAttribute("data-gradient-color"),parseFloat(a.getAttribute("data-gradient-xOffset")),parseFloat(a.getAttribute("data-gradient-yOffset")),parseFloat(a.getAttribute("data-gradient-size"))*.01);let l=document.getElementById("gradient-ip");this.backgroundPlane8=new Yr(this.sceneHolderGroup,l,l.getAttribute("data-gradient-color"),parseFloat(l.getAttribute("data-gradient-xOffset")),parseFloat(l.getAttribute("data-gradient-yOffset")),parseFloat(l.getAttribute("data-gradient-size"))*.01);let c=document.getElementById("gradient-team-1");this.backgroundPlane9=new Yr(this.sceneHolderGroup,c,c.getAttribute("data-gradient-color"),parseFloat(c.getAttribute("data-gradient-xOffset")),parseFloat(c.getAttribute("data-gradient-yOffset")),parseFloat(c.getAttribute("data-gradient-size"))*.01);let u=document.getElementById("gradient-team-2");this.backgroundPlane10=new Yr(this.sceneHolderGroup,u,u.getAttribute("data-gradient-color"),parseFloat(u.getAttribute("data-gradient-xOffset")),parseFloat(u.getAttribute("data-gradient-yOffset")),parseFloat(u.getAttribute("data-gradient-size"))*.01);let h=document.getElementById("gradient-footer-1");this.backgroundPlane11=new Yr(this.sceneHolderGroup,h,h.getAttribute("data-gradient-color"),parseFloat(h.getAttribute("data-gradient-xOffset")),parseFloat(h.getAttribute("data-gradient-yOffset")),parseFloat(h.getAttribute("data-gradient-size"))*.01);let d=document.getElementById("gradient-footer-2");this.backgroundPlane12=new Yr(this.sceneHolderGroup,d,d.getAttribute("data-gradient-color"),parseFloat(d.getAttribute("data-gradient-xOffset")),parseFloat(d.getAttribute("data-gradient-yOffset")),parseFloat(d.getAttribute("data-gradient-size"))*.01),this.depthMapOne=new yx(this.spaceGroup),this.lift=new Ix(this.spaceGroup),this.ledScreen=new kx(this.ledGroup),this.trigger("world-loaded")})}destroyBarScene(){if(!this.barGroup)return;function e(t){t.geometry&&t.geometry.dispose(),t.material&&(t.material instanceof Array?t.material.forEach(i=>i.dispose()):t.material.dispose()),t.texture&&t.texture.dispose()}this.barGroup.traverse(t=>{e(t)}),this.allGroup.remove(this.barGroup),this.barGroup=null,this.viewGroup2&&(this.allGroup.remove(this.viewGroup2),this.viewGroup2=null),this.view2&&(this.view2.dispose(),this.view2=null),this.depthMapOne2&&(this.depthMapOne2.dispose(),this.depthMapOne2=null)}createBarScene(){this.barGroup=new vt,this.barGroup.name="barGroup",this.scroller3=new Ja(this.barGroup,document.getElementById("gl-bar-scene"),"scroller3"),this.allScrollersArray.push(this.scroller3),this.allGroup.add(this.barGroup),this.viewGroup2=new vt,this.viewGroup2.name="viewGroup2",this.view2=new fm(this.barGroup,document.getElementById("gl-bar-scene"),1),this.view2.setOpacity(0),this.depthMapOne2=new xx(this.barGroup)}update(){this.mouse||(this.mouse=this.app.mouse),this.environment&&this.environment.update(),this.floor&&this.floor.update(),this.floor2&&this.floor2.update(),this.floor3&&this.floor3.update(),this.floor4&&this.floor4.update(),this.floor5&&this.floor5.update(),this.floor6&&this.floor6.update(),this.trident&&this.trident.update(),this.helix&&this.helix.update(),this.mask&&this.mask.update(),this.helixTarget&&this.helixTarget.update(),this.pointerSprite&&this.pointerSprite.update(),this.depthMapOne&&this.depthMapOne.update(),this.depthMapOne2&&this.depthMapOne2.update(),this.lineShapeCreator&&this.lineShapeCreator.update(),this.shapeCreator&&this.shapeCreator.update(),this.backgroundPlane&&this.backgroundPlane.update(),this.backgroundPlane2&&this.backgroundPlane2.update(),this.backgroundPlane3&&this.backgroundPlane3.update(),this.backgroundPlane4&&this.backgroundPlane4.update(),this.backgroundPlane5&&this.backgroundPlane5.update(),this.backgroundPlane6&&this.backgroundPlane6.update(),this.backgroundPlane7&&this.backgroundPlane7.update(),this.backgroundPlane8&&this.backgroundPlane8.update(),this.backgroundPlane9&&this.backgroundPlane9.update(),this.backgroundPlane10&&this.backgroundPlane10.update(),this.backgroundPlane11&&this.backgroundPlane11.update(),this.backgroundPlane12&&this.backgroundPlane12.update(),this.lift&&this.lift.update(),this.ledScreen&&this.ledScreen.update(),this.logoLoader&&this.logoLoader.update(),this.backGroundColorChange&&this.backGroundColorChange.update(),this.logoText&&this.logoText.update(),this.token&&this.token.update(),this.view1&&this.view1.update(),this.view2&&this.view2.update(),this.allScrollersArray&&this.allScrollersArray.length>0&&this.allScrollersArray.forEach(e=>e.update())}};function gM(n,e){if(e===qR)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Gv||e===RM){let t=n.getIndex();if(t===null){let o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}let i=t.count-2,r=[];if(e===Gv)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}var jx=class extends Rs{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Kx(t)}),this.register(function(t){return new s1(t)}),this.register(function(t){return new o1(t)}),this.register(function(t){return new a1(t)}),this.register(function(t){return new Jx(t)}),this.register(function(t){return new Qx(t)}),this.register(function(t){return new e1(t)}),this.register(function(t){return new t1(t)}),this.register(function(t){return new $x(t)}),this.register(function(t){return new i1(t)}),this.register(function(t){return new Zx(t)}),this.register(function(t){return new n1(t)}),this.register(function(t){return new r1(t)}),this.register(function(t){return new Xx(t)}),this.register(function(t){return new l1(t)}),this.register(function(t){return new c1(t)})}load(e,t,i,r){let s=this,o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){let c=al.extractUrlBase(e);o=al.resolveURL(c,this.path)}else o=al.extractUrlBase(e);this.manager.itemStart(e);let a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new ra(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s,o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===PA){try{o[Rt.KHR_BINARY_GLTF]=new u1(e)}catch(u){r&&r(u);return}s=JSON.parse(o[Rt.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let c=new v1(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){let h=this.pluginCallbacks[u](c);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){let h=s.extensionsUsed[u],d=s.extensionsRequired||[];switch(h){case Rt.KHR_MATERIALS_UNLIT:o[h]=new Yx;break;case Rt.KHR_DRACO_MESH_COMPRESSION:o[h]=new h1(s,this.dracoLoader);break;case Rt.KHR_TEXTURE_TRANSFORM:o[h]=new d1;break;case Rt.KHR_MESH_QUANTIZATION:o[h]=new p1;break;default:d.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){let i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}};function XN(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}var Rt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},Xx=class{constructor(e){this.parser=e,this.name=Rt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){let s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){let t=this.parser,i="light:"+e,r=t.cache.get(i);if(r)return r;let s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e],a,l=new at(16777215);o.color!==void 0&&l.setRGB(o.color[0],o.color[1],o.color[2],Ui);let c=o.range!==void 0?o.range:0;switch(o.type){case"directional":a=new Yh(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new Oy(l),a.distance=c;break;case"spot":a=new Ry(l),a.distance=c,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),a.decay=2,ko(a,o),o.intensity!==void 0&&(a.intensity=o.intensity),a.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(a),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,i=this.parser,r=i.json.nodes[e],s=(r.extensions&&r.extensions[this.name]||{}).light;return s===void 0?null:this._loadLight(s).then(function(o){return i._getNodeRef(t.cache,s,o)})}},Yx=class{constructor(){this.name=Rt.KHR_MATERIALS_UNLIT}getMaterialType(){return gr}extendParams(e,t,i){let r=[];e.color=new at(1,1,1),e.opacity=1;let s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){let o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Ui),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,Ht))}return Promise.all(r)}},$x=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let r=i.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}},Kx=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){let a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Me(a,a)}return Promise.all(s)}},Zx=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}},Jx=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_SHEEN}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[];t.sheenColor=new at(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){let a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Ui)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Ht)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}},Qx=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}},e1=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_VOLUME}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new at().setRGB(a[0],a[1],a[2],Ui),Promise.all(s)}},t1=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_IOR}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let r=i.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}},i1=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new at().setRGB(a[0],a[1],a[2],Ui),o.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Ht)),Promise.all(s)}},r1=class{constructor(e){this.parser=e,this.name=Rt.EXT_MATERIALS_BUMP}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}},n1=class{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ds}extendMaterialParams(e,t){let i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}},s1=class{constructor(e){this.parser=e,this.name=Rt.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;let s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}},o1=class{constructor(e){this.parser=e,this.name=Rt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],l=i.textureLoader;if(a.uri){let c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},a1=class{constructor(e){this.parser=e,this.name=Rt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],l=i.textureLoader;if(a.uri){let c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},l1=class{constructor(e){this.name=Rt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){let r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){let l=r.byteOffset||0,c=r.byteLength||0,u=r.count,h=r.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,h,d,r.mode,r.filter).then(function(p){return p.buffer}):o.ready.then(function(){let p=new ArrayBuffer(u*h);return o.decodeGltfBuffer(new Uint8Array(p),u,h,d,r.mode,r.filter),p})})}else return null}},c1=class{constructor(e){this.name=Rt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;let r=t.meshes[i.mesh];for(let l of r.primitives)if(l.mode!==kn.TRIANGLES&&l.mode!==kn.TRIANGLE_STRIP&&l.mode!==kn.TRIANGLE_FAN&&l.mode!==void 0)return null;let s=i.extensions[this.name].attributes,o=[],a={};for(let l in s)o.push(this.parser.getDependency("accessor",s[l]).then(c=>(a[l]=c,a[l])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(l=>{let c=l.pop(),u=c.isGroup?c.children:[c],h=l[0].count,d=[];for(let p of u){let f=new Et,v=new oe,g=new jn,m=new oe(1,1,1),x=new hy(p.geometry,p.material,h);for(let y=0;y<h;y++)a.TRANSLATION&&v.fromBufferAttribute(a.TRANSLATION,y),a.ROTATION&&g.fromBufferAttribute(a.ROTATION,y),a.SCALE&&m.fromBufferAttribute(a.SCALE,y),x.setMatrixAt(y,f.compose(v,g,m));for(let y in a)if(y==="_COLOR_0"){let _=a[y];x.instanceColor=new qc(_.array,_.itemSize,_.normalized)}else y!=="TRANSLATION"&&y!=="ROTATION"&&y!=="SCALE"&&p.geometry.setAttribute(y,a[y]);bi.prototype.copy.call(x,p),this.parser.assignFinalMaterial(x),d.push(x)}return c.isGroup?(c.clear(),c.add(...d),c):d[0]}))}},PA="glTF",sh=12,vM={JSON:1313821514,BIN:5130562},u1=class{constructor(e){this.name=Rt.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,sh),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==PA)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-sh,s=new DataView(e,sh),o=0;for(;o<r;){let a=s.getUint32(o,!0);o+=4;let l=s.getUint32(o,!0);if(o+=4,l===vM.JSON){let c=new Uint8Array(e,sh+o,a);this.content=i.decode(c)}else if(l===vM.BIN){let c=sh+o;this.body=e.slice(c,c+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},h1=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Rt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(let u in o){let h=m1[u]||u.toLowerCase();a[h]=o[u]}for(let u in e.attributes){let h=m1[u]||u.toLowerCase();if(o[u]!==void 0){let d=i.accessors[e.attributes[u]],p=Uc[d.componentType];c[h]=p.name,l[h]=d.normalized===!0}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h,d){r.decodeDracoFile(u,function(p){for(let f in p.attributes){let v=p.attributes[f],g=l[f];g!==void 0&&(v.normalized=g)}h(p)},a,c,Ui,d)})})}},d1=class{constructor(){this.name=Rt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},p1=class{constructor(){this.name=Rt.KHR_MESH_QUANTIZATION}},mm=class extends yl{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=r-t,h=(i-t)/u,d=h*h,p=d*h,f=e*c,v=f-c,g=-2*p+3*d,m=p-d,x=1-g,y=m-d+h;for(let _=0;_!==a;_++){let w=o[v+_+a],b=o[v+_+l]*u,T=o[f+_+a],A=o[f+_]*u;s[_]=x*w+y*b+g*T+m*A}return s}},YN=new jn,f1=class extends mm{interpolate_(e,t,i,r){let s=super.interpolate_(e,t,i,r);return YN.fromArray(s).normalize().toArray(s),s}},kn={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Uc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},yM={9728:ji,9729:fr,9984:Nv,9985:SM,9986:uf,9987:ml},xM={33071:zn,33648:Tf,10497:Nc},Lv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},m1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Io={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},$N={CUBICSPLINE:void 0,LINEAR:Vc,STEP:Oh},Ov={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function KN(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Xc({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Di})),n.DefaultMaterial}function qa(n,e,t){for(let i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function ko(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ZN(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){let h=e[c];if(h.POSITION!==void 0&&(i=!0),h.NORMAL!==void 0&&(r=!0),h.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);let o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){let h=e[c];if(i){let d=h.POSITION!==void 0?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(d)}if(r){let d=h.NORMAL!==void 0?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(d)}if(s){let d=h.COLOR_0!==void 0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){let u=c[0],h=c[1],d=c[2];return i&&(n.morphAttributes.position=u),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}function JN(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function QN(n){let e,t=n.extensions&&n.extensions[Rt.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Iv(t.attributes):e=n.indices+":"+Iv(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+Iv(n.targets[i]);return e}function Iv(n){let e="",t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function g1(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function e5(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}var t5=new Et,v1=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new XN,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new Qf(this.options.manager):this.textureLoader=new ky(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ra(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){let a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return qa(s,a,r),ko(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){let o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){let o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;let r=i.clone(),s=(o,a)=>{let l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(let[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){let r=e(t[i]);if(r)return r}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let i=[];for(let r=0;r<t.length;r++){let s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){let i=e+":"+t,r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){let i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Rt.KHR_BINARY_GLTF].body);let r=this.options;return new Promise(function(s,o){i.load(al.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){let r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){let t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){let o=Lv[r.type],a=Uc[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new wi(c,o,l))}let s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){let a=o[0],l=Lv[r.type],c=Uc[r.componentType],u=c.BYTES_PER_ELEMENT,h=u*l,d=r.byteOffset||0,p=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,f=r.normalized===!0,v,g;if(p&&p!==h){let m=Math.floor(d/p),x="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count,y=t.cache.get(x);y||(v=new c(a,m*p,r.count*p/u),y=new oy(v,p/u),t.cache.add(x,y)),g=new ay(y,l,d%p/u,f)}else a===null?v=new c(r.count*l):v=new c(a,d,r.count*l),g=new wi(v,l,f);if(r.sparse!==void 0){let m=Lv.SCALAR,x=Uc[r.sparse.indices.componentType],y=r.sparse.indices.byteOffset||0,_=r.sparse.values.byteOffset||0,w=new x(o[1],y,r.sparse.count*m),b=new c(o[2],_,r.sparse.count*l);a!==null&&(g=new wi(g.array.slice(),g.itemSize,g.normalized));for(let T=0,A=w.length;T<A;T++){let S=w[T];if(g.setX(S,b[T*l]),l>=2&&g.setY(S,b[T*l+1]),l>=3&&g.setZ(S,b[T*l+2]),l>=4&&g.setW(S,b[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){let t=this.json,i=this.options,r=t.textures[e].source,s=t.images[r],o=this.textureLoader;if(s.uri){let a=i.manager.getHandler(s.uri);a!==null&&(o=a)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,i){let r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];let c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);let h=(s.samplers||{})[o.sampler]||{};return u.magFilter=yM[h.magFilter]||fr,u.minFilter=yM[h.minFilter]||ml,u.wrapS=xM[h.wrapS]||Nc,u.wrapT=xM[h.wrapT]||Nc,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){let i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());let o=r.images[e],a=self.URL||self.webkitURL,l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(h){c=!0;let d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let u=Promise.resolve(l).then(function(h){return new Promise(function(d,p){let f=d;t.isImageBitmapLoader===!0&&(f=function(v){let g=new xr(v);g.needsUpdate=!0,d(g)}),t.load(al.resolveURL(h,s.path),f,void 0,p)})}).then(function(h){return c===!0&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||e5(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){let s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[Rt.KHR_TEXTURE_TRANSFORM]){let a=i.extensions!==void 0?i.extensions[Rt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){let l=s.associations.get(o);o=s.extensions[Rt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){let t=e.geometry,i=e.material,r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){let a="PointsMaterial:"+i.uuid,l=this.cache.get(a);l||(l=new Hf,_n.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){let a="LineBasicMaterial:"+i.uuid,l=this.cache.get(a);l||(l=new jc,_n.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return Xc}loadMaterial(e){let t=this,i=this.json,r=this.extensions,s=i.materials[e],o,a={},l=s.extensions||{},c=[];if(l[Rt.KHR_MATERIALS_UNLIT]){let h=r[Rt.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{let h=s.pbrMetallicRoughness||{};if(a.color=new at(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){let d=h.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],Ui),a.opacity=d[3]}h.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",h.baseColorTexture,Ht)),a.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,a.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Kr);let u=s.alphaMode||Ov.OPAQUE;if(u===Ov.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===Ov.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==gr&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Me(1,1),s.normalTexture.scale!==void 0)){let h=s.normalTexture.scale;a.normalScale.set(h,h)}if(s.occlusionTexture!==void 0&&o!==gr&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==gr){let h=s.emissiveFactor;a.emissive=new at().setRGB(h[0],h[1],h[2],Ui)}return s.emissiveTexture!==void 0&&o!==gr&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Ht)),Promise.all(c).then(function(){let h=new o(a);return s.name&&(h.name=s.name),ko(h,s),t.associations.set(h,{materials:e}),s.extensions&&qa(r,h,s),h})}createUniqueName(e){let t=ei.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[Rt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return _M(l,a,t)})}let o=[];for(let a=0,l=e.length;a<l;a++){let c=e[a],u=QN(c),h=r[u];if(h)o.push(h.promise);else{let d;c.extensions&&c.extensions[Rt.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=_M(new ki,c,t),r[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){let t=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){let u=o[l].material===void 0?KN(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){let c=l.slice(0,l.length-1),u=l[l.length-1],h=[];for(let p=0,f=u.length;p<f;p++){let v=u[p],g=o[p],m,x=c[p];if(g.mode===kn.TRIANGLES||g.mode===kn.TRIANGLE_STRIP||g.mode===kn.TRIANGLE_FAN||g.mode===void 0)m=s.isSkinnedMesh===!0?new ly(v,x):new wt(v,x),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),g.mode===kn.TRIANGLE_STRIP?m.geometry=gM(m.geometry,RM):g.mode===kn.TRIANGLE_FAN&&(m.geometry=gM(m.geometry,Gv));else if(g.mode===kn.LINES)m=new ws(v,x);else if(g.mode===kn.LINE_STRIP)m=new xm(v,x);else if(g.mode===kn.LINE_LOOP)m=new dy(v,x);else if(g.mode===kn.POINTS)m=new fy(v,x);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(m.geometry.morphAttributes).length>0&&JN(m,s),m.name=t.createUniqueName(s.name||"mesh_"+e),ko(m,s),g.extensions&&qa(r,m,g),t.assignFinalMaterial(m),h.push(m)}for(let p=0,f=h.length;p<f;p++)t.associations.set(h[p],{meshes:e,primitives:p});if(h.length===1)return s.extensions&&qa(r,h[0],s),h[0];let d=new vt;s.extensions&&qa(r,d,s),t.associations.set(d,{meshes:e});for(let p=0,f=h.length;p<f;p++)d.add(h[p]);return d})}loadCamera(e){let t,i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new tr(kM.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new zh(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),ko(t,i),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){let s=r.pop(),o=r,a=[],l=[];for(let c=0,u=o.length;c<u;c++){let h=o[c];if(h){a.push(h);let d=new Et;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new uy(a,l)})}loadAnimation(e){let t=this.json,i=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],u=[];for(let h=0,d=r.channels.length;h<d;h++){let p=r.channels[h],f=r.samplers[p.sampler],v=p.target,g=v.node,m=r.parameters!==void 0?r.parameters[f.input]:f.input,x=r.parameters!==void 0?r.parameters[f.output]:f.output;v.node!==void 0&&(o.push(this.getDependency("node",g)),a.push(this.getDependency("accessor",m)),l.push(this.getDependency("accessor",x)),c.push(f),u.push(v))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(h){let d=h[0],p=h[1],f=h[2],v=h[3],g=h[4],m=[];for(let x=0,y=d.length;x<y;x++){let _=d[x],w=p[x],b=f[x],T=v[x],A=g[x];if(_===void 0)continue;_.updateMatrix&&_.updateMatrix();let S=i._createAnimationTracks(_,w,b,T,A);if(S)for(let E=0;E<S.length;E++)m.push(S[E])}return new Ay(s,void 0,m)})}createNodeMesh(e){let t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){let o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){let t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,u=a.length;c<u;c++)o.push(i.getDependency("node",a[c]));let l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){let u=c[0],h=c[1],d=c[2];d!==null&&u.traverse(function(p){p.isSkinnedMesh&&p.bind(d,t5)});for(let p=0,f=h.length;p<f;p++)u.add(h[p]);return u})}_loadNodeShallow(e){let t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(s.isBone===!0?u=new Vf:c.length>1?u=new vt:c.length===1?u=c[0]:u=new bi,u!==c[0])for(let h=0,d=c.length;h<d;h++)u.add(c[h]);if(s.name&&(u.userData.name=s.name,u.name=o),ko(u,s),s.extensions&&qa(i,u,s),s.matrix!==void 0){let h=new Et;h.fromArray(s.matrix),u.applyMatrix4(h)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){let t=this.extensions,i=this.json.scenes[e],r=this,s=new vt;i.name&&(s.name=r.createUniqueName(i.name)),ko(s,i),i.extensions&&qa(t,s,i);let o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,h=l.length;u<h;u++)s.add(l[u]);let c=u=>{let h=new Map;for(let[d,p]of r.associations)(d instanceof _n||d instanceof xr)&&h.set(d,p);return u.traverse(d=>{let p=r.associations.get(d);p!=null&&h.set(d,p)}),h};return r.associations=c(s),s})}_createAnimationTracks(e,t,i,r,s){let o=[],a=e.name?e.name:e.uuid,l=[];Io[s.path]===Io.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let c;switch(Io[s.path]){case Io.weights:c=ea;break;case Io.rotation:c=uo;break;case Io.position:case Io.scale:c=ia;break;default:switch(i.itemSize){case 1:c=ea;break;case 2:case 3:default:c=ia;break}break}let u=r.interpolation!==void 0?$N[r.interpolation]:Vc,h=this._getArrayFromAccessor(i);for(let d=0,p=l.length;d<p;d++){let f=new c(l[d]+"."+Io[s.path],t.array,h,u);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(f),o.push(f)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let i=g1(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(t){let i=this instanceof uo?f1:mm;return new i(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function i5(n,e,t){let i=e.attributes,r=new tn;if(i.POSITION!==void 0){let a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new oe(l[0],l[1],l[2]),new oe(c[0],c[1],c[2])),a.normalized){let u=g1(Uc[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let s=e.targets;if(s!==void 0){let a=new oe,l=new oe;for(let c=0,u=s.length;c<u;c++){let h=s[c];if(h.POSITION!==void 0){let d=t.json.accessors[h.POSITION],p=d.min,f=d.max;if(p!==void 0&&f!==void 0){if(l.setX(Math.max(Math.abs(p[0]),Math.abs(f[0]))),l.setY(Math.max(Math.abs(p[1]),Math.abs(f[1]))),l.setZ(Math.max(Math.abs(p[2]),Math.abs(f[2]))),d.normalized){let v=g1(Uc[d.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;let o=new bn;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}function _M(n,e,t){let i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(let o in i){let a=m1[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!n.index){let o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Ut.workingColorSpace!==Ui&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Ut.workingColorSpace}" not supported.`),ko(n,e),i5(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?ZN(n,e.targets,t):n})}var Fv=new WeakMap,y1=class extends Rs{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){let s=new ra(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},i,r)}parse(e,t,i=()=>{}){this.decodeDracoFile(e,t,null,null,Ht).catch(i)}decodeDracoFile(e,t,i,r,s=Ui,o=()=>{}){let a={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s};return this.decodeGeometry(e,a).then(t).catch(o)}decodeGeometry(e,t){let i=JSON.stringify(t);if(Fv.has(e)){let l=Fv.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r,s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,u)=>{r._callbacks[s]={resolve:c,reject:u},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),Fv.set(e,{key:i,promise:a}),a}_createGeometry(e){let t=new ki;e.index&&t.setIndex(new wi(e.index.array,1));for(let i=0;i<e.attributes.length;i++){let r=e.attributes[i],s=r.name,o=r.array,a=r.itemSize,l=new wi(o,a);s==="color"&&(this._assignVertexColorSpace(l,r.vertexColorSpace),l.normalized=!(o instanceof Float32Array)),t.setAttribute(s,l)}return t}_assignVertexColorSpace(e,t){if(t!==Ht)return;let i=new at;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){let i=new ra(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{let r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);let s=r5.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){let o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function r5(){let n,e;onmessage=function(o){let a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(n)});break;case"decode":let l=a.buffer,c=a.taskConfig;e.then(u=>{let h=u.draco,d=new h.Decoder;try{let p=t(h,d,new Int8Array(l),c),f=p.attributes.map(v=>v.array.buffer);p.index&&f.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},f)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{h.destroy(d)}});break}};function t(o,a,l,c){let u=c.attributeIDs,h=c.attributeTypes,d,p,f=a.GetEncodedGeometryType(l);if(f===o.TRIANGULAR_MESH)d=new o.Mesh,p=a.DecodeArrayToMesh(l,l.byteLength,d);else if(f===o.POINT_CLOUD)d=new o.PointCloud,p=a.DecodeArrayToPointCloud(l,l.byteLength,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());let v={index:null,attributes:[]};for(let g in u){let m=self[h[g]],x,y;if(c.useUniqueIDs)y=u[g],x=a.GetAttributeByUniqueId(d,y);else{if(y=a.GetAttributeId(d,o[u[g]]),y===-1)continue;x=a.GetAttribute(d,y)}let _=r(o,a,d,g,m,x);g==="color"&&(_.vertexColorSpace=c.vertexColorSpace),v.attributes.push(_)}return f===o.TRIANGULAR_MESH&&(v.index=i(o,a,d)),o.destroy(d),v}function i(o,a,l){let c=l.num_faces()*3,u=c*4,h=o._malloc(u);a.GetTrianglesUInt32Array(l,u,h);let d=new Uint32Array(o.HEAPF32.buffer,h,c).slice();return o._free(h),{array:d,itemSize:1}}function r(o,a,l,c,u,h){let d=h.num_components(),p=l.num_points()*d,f=p*u.BYTES_PER_ELEMENT,v=s(o,u),g=o._malloc(f);a.GetAttributeDataArrayForAllPoints(l,h,v,f,g);let m=new u(o.HEAPF32.buffer,g,p).slice();return o._free(g),{name:c,array:m,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var x1=class extends Sn{constructor(e){super(),this.manager=new Zf,this.app=new Bt,this.sources=e,this.items={},this.audio={},this.toLoad=this.sources.length-1,this.loaded=0,this.svg=e.find(t=>t.name==="svg7").path,this.svgSimple=e.find(t=>t.name==="logoSimple").path,this.font=e.find(t=>t.name==="font").path,this.setLoaders(),this.startLoading(),this.burnerScene=new Gf,this.createBurnerScene()}createBurnerScene(){for(let e of this.sources)if(e.type==="texture"){let t=new hi(1,1),i=new gr,r=new wt(t,i);this.burnerScene.add(r)}}setLoaders(){this.loaders={},this.loaders.svgLoader=new Zo,this.loaders.gltfLoader=new jx,this.loaders.textureLoader=new Qf,this.loaders.cubeTextureLoader=new Dy,this.loaders.audio=new zy,this.loaders.dracoLoader=new y1,this.loaders.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.4.1/"),this.loaders.gltfLoader.setDRACOLoader(this.loaders.dracoLoader)}startLoading(){this.allLoaded=!1;for(let e of this.sources)e.type==="svg"?this.loaders.svgLoader.load(e.path,t=>{this.sourceLoaded(e,t)},t=>{}):e.type==="gltfModel"?this.loaders.gltfLoader.load(e.path,t=>{this.sourceLoaded(e,t)},t=>{}):e.type==="texture"?this.loaders.textureLoader.load(e.path,t=>{t.colorSpace=Ht,t.premultiplyAlpha=!0,this.sourceLoaded(e,t)}):e.type==="cubeTexture"?this.loaders.cubeTextureLoader.load(e.path,t=>{this.sourceLoaded(e,t)}):e.type==="audio"&&this.loaders.audio.load(e.path,t=>{this.sourceLoaded(e,t)})}sourceLoaded(e,t){if(this.items[e.name]=t,e.type==="audio"&&(this.items[e.name].style=e.style,this.items[e.name].groupId=e.groupId,this.items[e.name].name=e.name),e.type==="texture"){let i=this.burnerScene.children.find(r=>r.material&&r.material.type==="MeshBasicMaterial");i&&(i.material.map=t,i.material.needsUpdate=!0)}this.loaded++,this.trigger("percentage-loaded",[this.loaded/this.toLoad*100]),this.loaded===this.toLoad&&(this.processBurnerScene(),this.trigger("ready"))}async processBurnerScene(){let e=new Bh({canvas:document.createElement("canvas")});e.render(this.burnerScene,new L1),e.dispose()}},_1=class extends Sn{constructor(e){super(),this.app=new Bt,this.camera=this.app.camera,this.helper=new Yt,this.scrollDetect(),this.scrollY=0,this.scrollScaler=2550/e.height,this.scrollNormalized=0,this.scrolling=!1,this.lastScrollTime=null,this.lastScrollPosition=null,this.scrollVelocity=0,this.scrollingTimeout=null}scrollDetect(){let e=1/(document.documentElement.scrollHeight-window.innerHeight);window.addEventListener("scroll",t=>{this.scrolling=!0,clearTimeout(this.scrollingTimeout),this.scrollingTimeout=setTimeout(()=>{this.scrolling=!1,this.scrollVelocity=0},10),this.trigger("scroll",[t]),this.scrollY=window.scrollY*this.scrollScaler,this.scrollNormalized=window.scrollY*e;let{timeStamp:i,deltaY:r}=t,s=i,o=window.scrollY;if(this.lastScrollTime!==null&&this.lastScrollPosition!==null){let a=s-this.lastScrollTime,l=o-this.lastScrollPosition;this.scrollVelocity=Math.abs(l/a)}this.lastScrollTime=s,this.lastScrollPosition=o})}getScrollPositionFromAnyElement(e){let t=e.getBoundingClientRect(),i=new oe;this.camera||(this.camera=this.app.camera);let r=this.helper.getThreePositionFromScreenPosition(new oe(t.left,t.top,0),this.camera.instance,45,this.camera.instance.position);return i.copy(r)}},w1=class extends Sn{constructor(){super(),this.app=new Bt,this.resources=this.app.resources,this.sizes=this.app.sizes,this.camera=this.app.camera,this.helper=new Yt,this.bufferSize=20,this.mouseCounter=0,this.mouseMovementBuffer=[];for(let e=0;e<this.bufferSize;e++)this.mouseMovementBuffer.push(new Me);this.position={x:0,y:0},this.positionAlt={x:0,y:0},this.screenPosition=new Me,this.screenPositionAlt=new Me,this.screenPositionAlt2=new Me,this.positionTouch={x:0,y:0},this.mouseDown=!1,this.vec1=new oe,this.vec2=new oe,this.vec3=new oe,this.vec4=new oe,this.positionInThreeSpace=new oe,this.positionInThreeSpaceTouch=new oe,this.positionOffTheLeftOfTheScreenInThreeSpace=new oe,this.positionOffTheBottomOfTheScreenInThreeSpace=new oe,this.gamePlanetPosition=new oe,this.distance1=0,this.distance2=0,this.distance3=0,this.distance4=0,this.lastMousePosition={x:0,y:0},this.lastScreenPosition={x:0,y:0},this.lastTime=Date.now(),this.velocity=new Me,this.deltaX=0,this.deltaY=0,this.currentTime=this.app.time.elapsed,this.deltaTime=this.app.time.delta,this.mouseVelocity=0,this.lastMoveTimestamp=0,this.start(),this.resources.on("ready",()=>{this.runScreenResize()})}start(){window.addEventListener("mousemove",e=>{this.position.x=e.clientX,this.position.y=e.clientY,this.positionAlt.x=e.clientX,this.positionAlt.y=window.innerHeight-e.clientY,this.screenPosition.x=e.clientX/window.innerWidth*2-1,this.screenPosition.y=-(e.clientY/window.innerHeight)*2+1,this.screenPositionAlt.x=e.clientX/window.innerWidth,this.screenPositionAlt.y=e.clientY/window.innerHeight,this.screenPositionAlt2.x=e.clientX/window.innerWidth,this.screenPositionAlt2.y=1-e.clientY/window.innerHeight,this.trigger("mouse-move",[e]),this.currentTime=this.app.time.elapsed,this.deltaTime=this.app.time.delta,this.deltaX=this.position.x-this.lastMousePosition.x,this.deltaY=this.position.y-this.lastMousePosition.y,this.velocity.x=this.deltaX/(this.deltaTime/1e3),this.velocity.y=this.deltaY/(this.deltaTime/1e3),this.lastMousePosition.x=this.position.x,this.lastMousePosition.y=this.position.y,this.lastScreenPosition.x=this.screenPosition.x,this.lastScreenPosition.y=this.screenPosition.y,this.lastTime=this.currentTime,this.handleMouseMove(e),setInterval(()=>this.checkMouseStop(),100),this.processing()}),window.addEventListener("mousedown",()=>{this.mouseDown=!0,this.trigger("mouse-click")}),window.addEventListener("mouseup",()=>{this.mouseDown=!1,this.trigger("mouse-up")}),window.addEventListener("touchstart",e=>{e.preventDefault,e.touches&&(this.position.x=e.touches[0].clientX,this.position.y=e.touches[0].clientY,this.positionAlt.x=e.touches[0].clientX,this.positionAlt.y=window.innerHeight-e.touches[0].clientY,this.screenPosition.x=e.touches[0].clientX/window.innerWidth*2-1,this.screenPosition.y=-(e.touches[0].clientY/window.innerHeight)*2+1,this.screenPositionAlt.x=e.touches[0].clientX/window.innerWidth,this.screenPositionAlt.y=e.touches[0].clientY/window.innerHeight,this.screenPositionAlt2.x=e.touches[0].clientX/window.innerWidth,this.screenPositionAlt2.y=1-e.touches[0].clientY/window.innerHeight),this.mouseDown=!0,this.trigger("touch-start"),this.mouseVelocity=0,this.velocity.x=0,this.velocity.y=0,this.processingTouch()}),window.addEventListener("touchmove",e=>{if(e.preventDefault,e.touches){this.position.x=e.touches[0].clientX,this.position.y=e.touches[0].clientY,this.positionAlt.x=e.touches[0].clientX,this.positionAlt.y=window.innerHeight-e.touches[0].clientY,this.screenPosition.x=e.touches[0].clientX/window.innerWidth*2-1,this.screenPosition.y=-(e.touches[0].clientY/window.innerHeight)*2+1,this.screenPositionAlt.x=e.touches[0].clientX/window.innerWidth,this.screenPositionAlt.y=e.touches[0].clientY/window.innerHeight,this.screenPositionAlt2.x=e.touches[0].clientX/window.innerWidth,this.screenPositionAlt2.y=1-e.touches[0].clientY/window.innerHeight,this.trigger("mouse-move",[e]);let t=this.app.time.elapsed,i=this.app.time.delta;this.deltaX=this.position.x-this.lastMousePosition.x,this.deltaY=this.position.y-this.lastMousePosition.y,this.velocity.x=this.deltaX/(i/5),this.velocity.y=this.deltaY/(i/5),this.lastMousePosition.x=this.position.x,this.lastMousePosition.y=this.position.y,this.lastScreenPosition.x=this.screenPosition.x,this.lastScreenPosition.y=this.screenPosition.y,this.lastTime=t,this.mouseVelocity=Math.round(Math.sqrt(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2)))}this.trigger("touch-move"),this.processingTouch()}),window.addEventListener("touchend",()=>{this.mouseDown=!1,this.mouseVelocity=0,this.velocity.x=0,this.velocity.y=0,this.trigger("touch-end")})}handleMouseMove(e){let t=Math.sqrt(Math.pow(e.movementX,2)+Math.pow(e.movementY,2));this.mouseVelocity=Math.round(t),this.lastMoveTimestamp=Date.now()}checkMouseStop(){Date.now()-this.lastMoveTimestamp>50&&(this.mouseVelocity=0)}runScreenResize(){this.checkOffTheScreenLeftPosition(),this.checkOffTheScreenBottomPosition(),this.getGamePlanetPosition(),this.sizes.on("resize",()=>{this.checkOffTheScreenLeftPosition(),this.checkOffTheScreenBottomPosition(),this.getGamePlanetPosition()})}createCube(){return new wt(new(void 0)(1,1,1),new gr)}getGamePlanetPosition(){let e=window.innerWidth*.25;this.vec4.set(e/window.innerWidth*2-1,1,.5),this.vec4.unproject(this.camera.instance),this.vec4.sub(this.camera.instance.position).normalize(),this.distance4=-this.camera.instance.position.z/this.vec4.z,this.gamePlanetPosition.copy(this.camera.instance.position).add(this.vec4.multiplyScalar(this.distance4))}processing(){let e=this.helper.getThreePositionFromScreenPosition(new oe(this.position.x,this.position.y,.5),this.camera.getInstance(),30,this.camera.instance.position);this.positionInThreeSpace.copy(e)}processingTouch(){let e=this.helper.getThreePositionFromScreenPosition(new oe(this.positionTouch.x,this.positionTouch.y,.5),this.camera.getInstance(),30,this.camera.instance.position);this.positionInThreeSpace.copy(e)}checkOffTheScreenLeftPosition(){this.vec2.set(-1,1,.5),this.vec2.unproject(this.camera.instance),this.vec2.sub(this.camera.instance.position).normalize(),this.distance2=-this.camera.instance.position.z/this.vec2.z,this.positionOffTheLeftOfTheScreenInThreeSpace.copy(this.camera.instance.position).add(this.vec2.multiplyScalar(this.distance2))}checkOffTheScreenBottomPosition(){this.vec3.set(0,-1,.5),this.vec3.unproject(this.camera.instance),this.vec3.sub(this.camera.instance.position).normalize(),this.distance3=-this.camera.instance.position.z/this.vec3.z,this.positionOffTheBottomOfTheScreenInThreeSpace.copy(this.camera.instance.position).add(this.vec3.multiplyScalar(this.distance3))}mouseMovementBufferUpdate(){for(let e=this.bufferSize-1;e>0;e--)this.mouseMovementBuffer[e].x=this.mouseMovementBuffer[e-1].x,this.mouseMovementBuffer[e].y=this.mouseMovementBuffer[e-1].y;this.mouseMovementBuffer[0].x=(this.screenPosition.x+1)*.5,this.mouseMovementBuffer[0].y=(this.screenPosition.y+1)*.5}update(){this.mouseMovementBufferUpdate()}},b1=class{constructor(e,t,i,r,s){this.group=e,this.material=t,this.position=i,this.rotation=r,this.length=s,this.app=new Bt,this.resources=this.app.resources,this.sizes=this.app.sizes,this.camera=this.app.camera,this.helper=new Yt,this.start()}start(){let e=new hi(.02,this.length);this.instance=new wt(e,this.material),this.instance.position.set(this.position.x,this.position.y,this.position.z),this.instance.rotation.set(this.rotation.x,this.rotation.y,this.rotation.z),this.instance.renderOrder=900,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.group.add(this.instance)}},S1=class extends Sn{constructor(e){super(),this.group=e,this.app=new Bt,this.resources=this.app.resources,this.sizes=this.app.sizes,this.camera=this.app.camera,this.helper=new Yt,this.loader=new Zo,this.gate1=!1,this.gate2=!1,this.gate3SvgLoaded=!1,this.dynamicScale=.33,this.stopCalculatingLoadingPercentage=!1,this.pointsArrayForNewLogo=[],this.elementLoaderPercentage=document.querySelector(".hud__loader--txt[data-load-number]"),this.element=document.getElementById("gl-space-scene"),this.rect=this.element.getBoundingClientRect();let t=this.rect.width/this.app.sizes.width;this.rect.width/this.app.sizes.width;let i=.165;this.app.isMobile===!1?this.scale=this.app.sizes.getVisible(i).x/.0266*t:this.scale=this.app.sizes.getVisible(i).x/.0166*t,this.svg=this.resources.svg,this.svgSimple=this.resources.svgSimple,this.lineLength=this.scale*4,this.percentageLoaded=0,this.percentageLoadedLerp=0,this.lineArray=[],this.lineCounter=0,this.ratio2=-.009/1074.671875*this.rect.width,this.ratio2A=this.app.sizes.getVisible(i).x/-20.6774*t,this.ratio3=-3.03/1074.671875*this.rect.width,this.ratio3A=this.app.sizes.getVisible(i).x/-.0615*t,this.ratio4=-4.038/1074.671875*this.rect.width,this.ratio4A=this.app.sizes.getVisible(i).x/-.0461*t,this.ratio5=4.047/1074.671875*this.rect.width,this.ratio5A=this.app.sizes.getVisible(i).x/.0459*t,this.ratio6=2.07/1074.671875*this.rect.width,this.ratio6A=this.app.sizes.getVisible(i).x/.09*t,this.ratio7=-1.965/1074.671875*this.rect.width,this.ratio7A=this.app.sizes.getVisible(i).x/-.0947*t,this.ratio8=-4/1074.671875*this.rect.width,this.ratio8A=this.app.sizes.getVisible(i).x/-.0465*t,this.ratio9=.575/1074.671875*this.rect.width,this.ratio9A=this.app.sizes.getVisible(i).x/.3237*t,this.ratio10=-1.5/1074.671875*this.rect.width,this.ratio10A=this.app.sizes.getVisible(i).x/-.1221*t,this.ratio11=-2.45/1074.671875*this.rect.width,this.ratio11A=this.app.sizes.getVisible(i).x/-.075*t,this.ratio12=3/1074.671875*this.rect.width,this.ratio12A=this.app.sizes.getVisible(i).x/.06209*t,this.ratio13=-1.94/1074.671875*this.rect.width,this.ratio13A=this.app.sizes.getVisible(i).x/-.096*t,this.ratio14=-.5/1074.671875*this.rect.width,this.ratio14A=this.app.sizes.getVisible(i).x/-.373*t,this.ratio15=1.565/1074.671875*this.rect.width,this.ratio15A=this.app.sizes.getVisible(i).x/.119*t,this.ratio16=2.05/1074.671875*this.rect.width,this.ratio16A=this.app.sizes.getVisible(i).x/.091*t;let r=this.app.isMobile?1.6:1;this.lineData=[{position:new oe(this.ratio2A*r,0,0),rotation:new oe(0,0,0),length:this.lineLength},{position:new oe(this.ratio3A*r,0,0),rotation:new oe(0,0,0),length:this.lineLength},{position:new oe(this.ratio4A*r,0,0),rotation:new oe(0,0,0),length:this.lineLength},{position:new oe(this.ratio5A*r,0,0),rotation:new oe(0,0,0),length:this.lineLength},{position:new oe(0,this.ratio6A*r,0),rotation:new oe(0,0,Math.PI/2),length:this.lineLength},{position:new oe(0,this.ratio7A*r,0),rotation:new oe(0,0,Math.PI/2),length:this.lineLength},{position:new oe(this.ratio8A*r,this.ratio9A*r,0),rotation:new oe(0,0,-Math.PI/2.85),length:this.lineLength*.25},{position:new oe(this.ratio10A*r,this.ratio11A*r,0),rotation:new oe(0,0,-Math.PI/3.93),length:this.lineLength*.75},{position:new oe(this.ratio12A*r,this.ratio13A*r,0),rotation:new oe(0,0,-Math.PI/3.7),length:this.lineLength*.5},{position:new oe(this.ratio14A*r,this.ratio15A*r,0),rotation:new oe(0,0,Math.PI/4),length:this.lineLength*.75},{position:new oe(this.ratio12A*r,this.ratio16A*r,0),rotation:new oe(0,0,Math.PI/3.85),length:this.lineLength}],this.start(),this.loadingPercentagePercentEvent(),this.scrollControl(),this.setImagesWhenLoaded(),this.on("svg-loaded-loader",()=>{this.gate3SvgLoaded=!0})}start(){this.lineMaterial=new ri({vertexShader:`
      varying vec2 vUv;
      uniform float opacity;
      uniform float grow;

      void main() {
          vUv = uv;

          vec3 updatedPosition = vec3(position.x * grow, position.y * grow, position.z);

          gl_Position = projectionMatrix * modelViewMatrix * vec4(updatedPosition, 1.0);
      }
      `,fragmentShader:`
      varying vec2 vUv;
      uniform float opacity;

      void main()
      {
          float distFromCenter = abs(vUv.x - 0.5);
          
          float alpha = smoothstep(0.0, 0.5, distFromCenter);
          
          alpha *= opacity;

          float aaa = (smoothstep(0.0, 0.8, distFromCenter - 0.2) + 0.01);

          aaa *= opacity;
      
          gl_FragColor = vec4(1.0, 1.0, 1.0, aaa);
      }
      `,transparent:!0,uniforms:{lineWidth:{value:3},direction:{value:null},opacity:{value:1},grow:{value:0}}}),this.lineGroup=new vt,this.lineGroup.name="lineGroup";for(let e=0;e<this.lineData.length;e++){let t=this.lineData[e].position,i=this.lineData[e].rotation,r=this.lineData[e].length;this.line=new b1(this.lineGroup,this.lineMaterial,t,i,r),this.lineArray.push(this.line)}this.scaleLogoGroup=new vt,this.scaleLogoGroup.name="scaleLogoGroup",this.svgGroupLoader=new vt,this.svgGroupLoader.name="svgGroupLoader",this.svgGroupLoader.position.set(0,0,0),this.loadSvg().then(()=>{this.loadSvgSimple()})}async loadSvg(){return new Promise((e,t)=>{this.loader.load(this.svg,i=>{let r=i.paths;for(let s=0;s<r.length;s++){let o=r[s],a=Zo.createShapes(o);for(let l=0;l<a.length;l++){let c=a[l],u=new Wh(c,{depth:0}),h=new $f(u),d=h.attributes.position.array;if(this.pointsArrayForNewLogo)for(let w=0;w<d.length;w+=3){let b=d[w],T=d[w+1],A=d[w+2];this.pointsArrayForNewLogo.push(new oe(b,T,A))}let p=new Float32Array(d.length*2/3),f=new tn().setFromBufferAttribute(h.attributes.position),v=new oe;f.getSize(v);for(let w=0;w<d.length;w+=3){let b=d[w],T=d[w+1];p[w*2/3]=(b-f.min.x)/v.x,p[w*2/3+1]=(T-f.min.y)/v.y}h.setAttribute("uv",new wi(p,2));let g=new ri({transparent:!0,uniforms:{opacity:{value:.2},uColorChange:{value:0},loading:{value:1}},vertexShader:`
            varying vec2 vUv;
            uniform float opacity;
      
            void main() {
                vUv = uv;
          
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
            `,fragmentShader:`
            varying vec2 vUv;
            uniform float opacity;
            uniform float uColorChange;
      
            void main()
            {            
                float mixFactor1 = smoothstep(0.0, 0.05, uColorChange); // Quick transition to texture1
                float mixFactor2 = smoothstep(0.35, 0.40, uColorChange); // Quick transition to texture2
                float mixFactor3 = smoothstep(0.65, 0.70, uColorChange); // Quick transition to texture3
                float mixFactor4 = smoothstep(0.85, 0.90, uColorChange); // Quick transition to texture4
                
                // Color 1: #FF1571 (pink/red)
                vec3 color1 = vec3(1.0, 0.0824, 0.4431);

                // Color 2: #6A25FB (purple)
                vec3 color2 = vec3(0.4157, 0.1451, 0.9843);

                // Color 3: #FF2A21 (red)
                vec3 color3 = vec3(1.0, 0.1647, 0.1294);

                // Color 4: #02CEFE (light blue)
                vec3 color4 = vec3(0.0078, 0.8078, 0.9961);

                vec3 result = mix(
                  mix(mix(mix(vec3(1.0,1.0,1.0), color1, mixFactor1), 
                  color2, mixFactor2),
                  color3, mixFactor3),
                  color4, mixFactor4
              );
                gl_FragColor = vec4(result, opacity);
            }
            `});g.name="wireframeMaterialFound";let m=new ws(h,g),x=h.clone();new ws(x,this.lineMaterial);let y=h.clone();new ws(y,this.lineMaterial);let _=h.clone();new ws(_,this.lineMaterial),this.mainMeshMaterial=new ri({side:Di,transparent:!0,uniforms:{loading:{value:0},opacity:{value:1},whiteOut:{value:0},backdrop1:{value:null},backdrop2:{value:null},backdrop3:{value:null},backdrop4:{value:null},factor:{value:0}},vertexShader:`
            varying vec2 vUv;
            uniform float loading;
        
            void main()
            {
                vec4 modelPosition = modelMatrix * vec4(position, 1.0);
                vUv = position.xy * 0.0004 + 0.5;
                vec4 viewPosition = viewMatrix * modelPosition;
                vec4 projectionPosition = projectionMatrix * viewPosition;
        
                gl_Position = projectionPosition;
            }
            `,fragmentShader:`
            varying vec2 vUv;
            uniform float loading;
            uniform float opacity;
            uniform float whiteOut;
            uniform sampler2D backdrop1;
            uniform sampler2D backdrop2;
            uniform sampler2D backdrop3;
            uniform sampler2D backdrop4;
            uniform float factor;


            vec3 gammaCorrectedColor(vec3 textureColor){
                return pow(textureColor.rgb, vec3(1.0 / 2.2));
            }
            
            void main()
            {
            
                float uvx = smoothstep(0.42, 0.58, vUv.x);
                float uvy = smoothstep(0.5875, 0.412, vUv.y);

                // float uvx = step(0.42, vUv.x);
                // float uvx = step(0.58, vUv.x);

                // float uvy = step(0.412, vUv.y);
                // float uvy = step(0.5875, vUv.y);

                vec2 newUv = vec2(uvx, uvy);

                float zoomFactor = 0.4; // Adjust this value to control the zoom level
                vec2 zoomedUv = (newUv - 0.5) * zoomFactor + 0.5;

                // zoomedUv.y -= 0.04;
                // zoomedUv = clamp(zoomedUv, 0.0, 1.0);

                // Ensure we don't sample outside the texture
                // zoomedUv = clamp(zoomedUv, 0.0, 1.0);

                vec4 texture1 = texture2D(backdrop1, newUv);
                texture1.xyz = gammaCorrectedColor(texture1.xyz);

                vec4 texture2 = texture2D(backdrop2, newUv);
                texture2.xyz = gammaCorrectedColor(texture2.xyz);

                vec4 texture3 = texture2D(backdrop3, newUv);
                texture3.xyz = gammaCorrectedColor(texture3.xyz);

                vec4 texture4 = texture2D(backdrop4, newUv);
                texture4.xyz = gammaCorrectedColor(texture4.xyz);

                float mixFactor1 = smoothstep(0.0, 0.05, factor); // Quick transition to texture1
                float mixFactor2 = smoothstep(0.35, 0.40, factor); // Quick transition to texture2
                float mixFactor3 = smoothstep(0.65, 0.70, factor); // Quick transition to texture3
                float mixFactor4 = smoothstep(0.85, 0.90, factor); // Quick transition to texture4
                      
                float loading2 = smoothstep(0.0, 0.99, loading);
            
                float alpha = step(loading2, (newUv.y));

                float change = smoothstep(0.5, 0.6, loading2);

                alpha += mix(step(loading2, 1.0 - (newUv.y)), 0.0, 1.0 - change);

                alpha += mix(step(1.0 - (loading2 * 0.8), 1.0 - min(0.8, (newUv.y))), 0.0, change);
            
                vec3 colorRed = vec3(1.0, 0.0 + (newUv.x * 0.2), 0.0 + (newUv.x * 0.8));
            
                vec4 colorOpacity = mix(vec4(colorRed, 1.0), vec4(0.0, 0.0, 0.0, 0.0), alpha);

                float newWhiteOut = smoothstep(0.0, 0.99, whiteOut);

                newWhiteOut = 1.0 - step(newWhiteOut, (distance(newUv.y, 0.5)));

                colorOpacity = mix(colorOpacity, vec4(1.0,1.0,1.0, 1.0), newWhiteOut);

                vec4 result = mix(mix(mix(mix(colorOpacity, texture1, mixFactor1), 
                            texture2, mixFactor2),
                        texture3, mixFactor3),
                    texture4, mixFactor4
                );


                gl_FragColor = result;
            
              //  gl_FragColor = colorOpacity;

                 gl_FragColor = vec4(result.xyz, opacity);

                // gl_FragColor = vec4(newUv, 0.0, 1.0);
            }
            `}),this.mainMeshMaterial.name="mainMeshMaterial",this.mainMeshMaterial.uniformsNeedUpdate=!0,this.instance=new wt(u,this.mainMeshMaterial),this.instance.scale.x=.003,this.instance.scale.y=.003,this.instance.scale.z=.003,this.instance.name=`id${s}${l}`,this.instance.name==="id00"&&(this.instance.rotation.x=Math.PI*1,this.instance.material.uniforms.opacity.value=1,this.instance.renderOrder=998,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.scaleLogoGroup.scale.x*=this.scale*.01*this.dynamicScale,this.scaleLogoGroup.scale.y*=this.scale*.01*this.dynamicScale,this.scaleLogoGroup.scale.z*=this.scale*.01*this.dynamicScale,this.scaleLogoGroup.add(this.instance),this.svgGroupLoader.add(this.scaleLogoGroup),m.scale.set(.003,.003,.003),m.rotation.x=Math.PI*1,m.renderOrder=999,m.material.depthTest=!1,m.material.depthWrite=!1,this.scaleLogoGroup.add(m)),this.instance.name==="id10"&&(this.instance.rotation.x=Math.PI*1,this.instance.material.uniforms.opacity.value=1,this.instance.renderOrder=998,this.instance.material.depthTest=!1,this.instance.material.depthWrite=!1,this.scaleLogoGroup.add(this.instance),this.svgGroupLoader.position.z=20,m.scale.set(.003,.003,.003),m.rotation.x=Math.PI*1,m.renderOrder=999,m.material.depthTest=!1,m.material.depthWrite=!1,this.scaleLogoGroup.add(m))}}this.group.add(this.svgGroupLoader),e()})})}loadSvgSimple(){this.loader.load(this.svgSimple,e=>{var t,i,r,s,o,a;let l=e.paths;for(let u=0;u<l.length;u++){let h=l[u],d=Zo.createShapes(h);for(let p=0;p<d.length;p++){let f=d[p],v=new Wh(f,{depth:0}),g=new $f(v),m=g.attributes.position.array;if(this.pointsArrayForNewLogo)for(let D=0;D<m.length;D+=3){let z=m[D],L=m[D+1],G=m[D+2];this.pointsArrayForNewLogo.push(new oe(z,L,G))}let x=new Float32Array(m.length*2/3),y=new tn().setFromBufferAttribute(g.attributes.position),_=new oe;y.getSize(_);for(let D=0;D<m.length;D+=3){let z=m[D],L=m[D+1];x[D*2/3]=(z-y.min.x)/_.x,x[D*2/3+1]=(L-y.min.y)/_.y}g.setAttribute("uv",new wi(x,2)),new jc({color:16777215,linewidth:1,opacity:.2,transparent:!0});let w=g.clone(),b=new ws(w,this.lineMaterial),T=g.clone(),A=new ws(T,this.lineMaterial),S=g.clone(),E=new ws(S,this.lineMaterial),R=new ri({side:Di,transparent:!0,uniforms:{loading:{value:0},opacity:{value:1},whiteOut:{value:0}},vertexShader:`
            varying vec2 vUv;
            uniform float loading;
        
            void main()
            {
                vec4 modelPosition = modelMatrix * vec4(position, 1.0);
                vUv = position.xy * 0.0004 + 0.5;
                vec4 viewPosition = viewMatrix * modelPosition;
                vec4 projectionPosition = projectionMatrix * viewPosition;
        
                gl_Position = projectionPosition;
            }
            `,fragmentShader:`
            varying vec2 vUv;
            uniform float loading;
            uniform float opacity;
            uniform float whiteOut;
            
            void main()
            {
            
                float uvx = smoothstep(0.42, 0.58, vUv.x);
                float uvy = smoothstep(0.5875, 0.412, vUv.y);

                // float uvx = step(0.42, vUv.x);
                // float uvx = step(0.58, vUv.x);

                // float uvy = step(0.412, vUv.y);
                // float uvy = step(0.5875, vUv.y);

            
                vec2 newUv = vec2(uvx, uvy);
            
                float loading2 = smoothstep(0.0, 0.99, loading);
            
                float alpha = step(loading2, (newUv.y));

                float change = smoothstep(0.5, 0.6, loading2);

                alpha += mix(step(loading2, 1.0 - (newUv.y)), 0.0, 1.0 - change);

                alpha += mix(step(1.0 - (loading2 * 0.8), 1.0 - min(0.8, (newUv.y))), 0.0, change);
            
                vec3 colorRed = vec3(1.0, 0.0 + (newUv.x * 0.2), 0.0 + (newUv.x * 0.8));
            
                vec4 colorOpacity = mix(vec4(colorRed, 1.0), vec4(0.0, 0.0, 0.0, 0.0), alpha);

                float newWhiteOut = smoothstep(0.0, 0.99, whiteOut);

                newWhiteOut = 1.0 - step(newWhiteOut, (distance(newUv.y, 0.5)));

                colorOpacity = mix(colorOpacity, vec4(1.0,1.0,1.0, 1.0), newWhiteOut);
            
                gl_FragColor = colorOpacity;

                // gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);

                // gl_FragColor = vec4(newUv, 0.0, opacity);
            }
            `});if(R.uniformsNeedUpdate=!0,this.instance=new wt(v,R),this.instance.scale.x=.003,this.instance.scale.y=.003,this.instance.scale.z=.003,this.instance.name=`id${u}${p}`,this.instance.name==="id00"){let D=new vt;D.name="initialLogo",D.scale.x*=this.scale*.01,D.scale.y*=this.scale*.01,D.scale.z*=this.scale*.01,b.scale.set(.009,.009,.009),b.position.y-=.04,b.rotation.x=Math.PI*1,b.renderOrder=990,b.material.depthTest=!1,b.material.depthWrite=!1,D.add(b),this.svgGroupLoader.add(D),A.scale.set(.015,.015,.015),A.position.y-=.085,A.rotation.x=Math.PI*1,A.renderOrder=990,A.material.depthTest=!1,A.material.depthWrite=!1,D.add(A),E.scale.set(.024,.024,.024),E.rotation.x=Math.PI*1,E.position.y-=.15,E.renderOrder=990,E.material.depthTest=!1,E.material.depthWrite=!1,D.add(E)}if(this.instance.name==="id10"){let D=new vt;D.name="initialLogo2",D.scale.x*=this.scale*.01,D.scale.y*=this.scale*.01,D.scale.z*=this.scale*.01,b.scale.set(.009,.009,.009),b.position.y+=.04,b.rotation.x=Math.PI*1,b.renderOrder=990,b.material.depthTest=!1,b.material.depthWrite=!1,D.add(b),this.svgGroupLoader.add(D),A.scale.set(.015,.015,.015),A.position.y+=.085,A.rotation.x=Math.PI*1,A.renderOrder=990,A.material.depthTest=!1,A.material.depthWrite=!1,D.add(A),E.scale.set(.024,.024,.024),E.rotation.x=Math.PI*1,E.position.y+=.15,E.renderOrder=990,E.material.depthTest=!1,E.material.depthWrite=!1,D.add(E)}}}let c=0;(a=(o=(s=(r=(i=(t=this.svgGroupLoader)==null?void 0:t.children)==null?void 0:i[0])==null?void 0:r.children)==null?void 0:s[0])==null?void 0:o.material.uniforms)!=null&&a.loading||(console.error("SVG loading failed. Please check your SVG file and try again."),window.location.reload(),this.svgGroupLoader.children[0].children[0].material.uniforms.loading={value:1},c=2e3),setTimeout(()=>{this.trigger("svg-loaded-loader")},c)})}setFactorInMaterial(e){this.scaleLogoGroup&&this.scaleLogoGroup.children.length>0&&this.scaleLogoGroup.children.forEach(t=>{t.material&&t.material.uniforms&&t.material.uniforms.factor&&(t.material.uniforms.factor.value=e,t.material.uniformsNeedUpdate=!0)})}setLogoOpacity(e){this.scaleLogoGroup&&this.scaleLogoGroup.children.length>0&&this.scaleLogoGroup.children.forEach(t=>{t.material&&t.material.uniforms&&t.material.uniforms.opacity&&(t.material.uniforms.opacity.value=e,t.material.uniformsNeedUpdate=!0),(t.material&&t.material.opacity||t.material.opacity===0)&&(t.material.opacity=e,t.material.uniformsNeedUpdate=!0)})}loadingPercentagePercentEvent(){this.app.resources.on("percentage-loaded",e=>{this.percentageLoaded=e/100})}setImagesWhenLoaded(){this.app.resources.on("ready",e=>{this.scaleLogoGroup&&this.scaleLogoGroup.children.length>0&&this.scaleLogoGroup.children.forEach(t=>{t.material&&t.material.uniforms&&t.material.name==="mainMeshMaterial"&&(t.material.uniforms.backdrop1.value=this.resources.items.backdrop1,t.material.uniforms.backdrop2.value=this.resources.items.backdrop2,t.material.uniforms.backdrop3.value=this.resources.items.backdrop3,t.material.uniforms.backdrop4.value=this.resources.items.backdrop4,t.material.uniformsNeedUpdate=!0)})})}animate(){lt.fromTo(this.lineMaterial.uniforms.grow,{duration:0,value:0},{duration:4,value:1})}scrollControl(){this.markerElementMainLogo=document.getElementsByClassName("is-taxi-test")[0],this.markerElement=this.markerElementMainLogo,this.rect=this.markerElement.getBoundingClientRect(),this.group.position.x=0,this.group.position.y=0,this.group.position.z=2,this.followTarget()}followTarget(){this.targetPosition=this.helper.update3DObjectPosition(this.markerElement,this.group,this.app.camera.instance),this.group.position.x=this.helper.lerp(this.group.position.x,this.targetPosition.x,_t),this.group.position.y=this.helper.lerp(this.group.position.y,this.targetPosition.y,_t),this.group.position.z=this.helper.lerp(this.group.position.z,this.targetPosition.z,_t)}setLogoToWhite(){lt.fromTo(this.svgGroupLoader.children[0].children[0].material.uniforms.whiteOut,{duration:0,value:0},{duration:.5,value:1}),lt.fromTo(this.svgGroupLoader.children[0].children[2].material.uniforms.whiteOut,{duration:0,value:0},{duration:.5,value:1})}update(){this.gate3SvgLoaded&&(!this.svgGroupLoader||!this.svgGroupLoader.children||!this.svgGroupLoader.children[0]||(this.gate2===!1&&this.svgGroupLoader.children[0]&&this.svgGroupLoader.children[0].children.length>0&&this.svgGroupLoader.children[0].children[0].material&&(this.animate(),this.gate2=!0),this.svgGroupLoader&&this.svgGroupLoader.children&&this.svgGroupLoader.children[0]&&this.svgGroupLoader.children[0].children&&this.svgGroupLoader.children[0].children[0]&&this.svgGroupLoader.children[0].children[0].material&&this.svgGroupLoader.children[0].children[0].material.uniforms&&this.svgGroupLoader.children[0].children[0].material.uniforms.loading&&(this.percentageLoadedLerp=this.helper.lerp(this.percentageLoadedLerp,this.percentageLoaded,.02),this.svgGroupLoader.children[0].children[0].material.uniforms.loading.value=this.percentageLoadedLerp,this.svgGroupLoader.children[0].children[2].material.uniforms.loading.value=this.percentageLoadedLerp,this.gate1===!1&&this.percentageLoadedLerp>=.99&&(this.gate1=!0,lt.fromTo(this.lineMaterial.uniforms.grow,{duration:0,value:1},{duration:.5,value:0}),lt.to(this.lineMaterial.uniforms.grow,{duration:1,value:0}),lt.to(this.lineMaterial.uniforms.grow,{delay:0,duration:2,value:0}),setTimeout(()=>{this.trigger("loader-finished"),setTimeout(()=>{this.group.remove(this.svgGroupLoader),this.svgGroupLoader.position.z=0,this.app.world.logoLoader.group.add(this.svgGroupLoader),setTimeout(()=>{this.lineMaterial.uniforms.opacity.value=0},1),setTimeout(()=>{this.group.remove(this.lineGroup),this.group.remove(this.svgGroupLoader),this.lineMaterial.uniforms.opacity.value=0},1),this.stopCalculatingLoadingPercentage=!0},1e3)},1))),this.stopCalculatingLoadingPercentage===!1&&this.elementLoaderPercentage&&(this.elementLoaderPercentage.textContent=Math.round(this.percentageLoadedLerp*100))))}},E1=class{constructor(){this.timeline=lt.timeline(),this.timeline.pause(),this.timeline.eventCallback("onComplete",()=>{this.timeline.seek(1).play()}),this.scrollingTimeline=lt.timeline({paused:!0}),this.scrollingTimeline2=lt.timeline({paused:!0}),this.scrollingTimeline3=lt.timeline({paused:!0}),this.scrollingTimeline4=lt.timeline({paused:!0}),this.scrollingTimeline5=lt.timeline({paused:!0})}reset(){this.timeline.seek(1).play()}},cf=null,Bt=class n{constructor(e,t){if(cf)return cf;cf=this,this.sourcesObject=t,this.helper=new Yt,this.sceneIn=!1,window.app=this,this.canvas=e,this.isMobile=!1,this.searchBarHeight=0,window.innerWidth<990&&(this.searchBarHeight=0,this.canvas.height=window.innerHeight+this.searchBarHeight,this.isMobile=!0),so.enabled=!0,this.debug=new $y,this.sizes=new Ky(this.searchBarHeight),this.scrollManager=new _1(this.sizes),this.time=new Zy,this.scene=new Gf,this.scene.fog=new sy(new at("#090909"),35,45),this.resources=new x1(this.sourcesObject),this.cameraGroup=new vt,this.cameraGroup.position.x=0,this.cameraGroup.position.z=0,this.cameraGroup.name="camera group",this.scene.add(this.cameraGroup),this.camera=new Qy(this.cameraGroup),this.mouse=new w1,this.renderer=new ex,this.sizes.setVisible(),this.world=new qx,this.cannon=new Rh.World,this.cannon.gravity.set(0,0,0),this.cannon.broadphase=new Rh.NaiveBroadphase,this.cannon.solver.iterations=10,this.createMainLogoTarget(),this.time.on("tick",()=>{this.update()}),this.loaderMasterGroup=new vt,this.loaderMasterGroup.name="loaderMasterGroup",this.scene.add(this.loaderMasterGroup),this.loaderGroup=new vt,this.loaderGroup.name="loaderGroup",this.loader=new S1(this.loaderGroup),this.loaderMasterGroup.add(this.loaderGroup),this.sharedAnimationTimeline=new E1}createMainLogoTarget(){let e=document.createElement("div");e.style.position="relative",e.style.width="100%",e.style.height="0",e.style.zIndex="10";let t=document.createElement("div");t.id="main-logo2",t.style.position="absolute",t.style.top="50vh",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.width="12px",t.style.height="12px",t.style.borderRadius="50%",t.style.border="2px solid transparent",t.style.display="hidden",t.style.justifyContent="center",t.style.alignItems="center",t.style.backgroundColor="transparent",e.appendChild(t),document.body.firstChild?document.body.insertBefore(e,document.body.firstChild):document.body.appendChild(e);let i=document.createElement("div");i.id="main-logo",i.style.position="fixed",i.style.top="50%",i.style.left="50%",i.style.transform="translate(-50%, -50%)",i.style.width="12px",i.style.height="12px",i.style.borderRadius="50%",i.style.border="2px solid transparent",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.backgroundColor="transparent";let r=document.createElement("div");r.style.width="0px",r.style.height="0px",r.style.borderRadius="1%",r.style.backgroundColor="black",r.style.display="hidden",i.appendChild(r),i.style.display="hidden",document.body.appendChild(i)}enableScrolling(){setTimeout(()=>{window.SScroll.start()},700)}slideGradient(e){this.world.backgroundPlane6.colorChange(e)}update(){this.camera.update(),this.world.update(),this.renderer.update(),this.cannon.step(1/60),this.logoLoader&&this.logoLoader.update(),this.mouse&&this.mouse.update(),this.loader&&this.loader.update()}transitionBarSceneIn(){this.world.allGroup&&this.sceneIn===!1&&(this.world.createBarScene(),this.sceneIn=!0,this.world.allGroup.add(this.world.barGroup),this.world.depthMapOne2.flicker(),this.world.view2.setOpacity(1),this.world.view2.flicker())}transitionBarSceneOut(){this.world.allGroup&&this.sceneIn&&(this.sceneIn=!1,this.world.allGroup.remove(this.world.barGroup),this.world.view2.setOpacity(0),this.world.destroyBarScene())}destroy(){this.sizes.off("resize"),this.time.off("tick"),this.resources.off("ready"),this.scrollManager.off("scroll"),this.mouse.off("mouse-move"),this.mouse.off("mouse-click"),this.mouse.off("mouse-up"),this.mouse.off("touch-start"),this.mouse.off("touch-move"),this.mouse.off("touch-end"),this.scene.traverse(e=>{if(e instanceof wt){e.geometry.dispose();for(let t in e.material){let i=e.material[t];i&&typeof i.dispose=="function"&&i.dispose()}}}),this.renderer.instance.dispose(),this.debug.active&&this.debug.ui.destroy(),cf=null,delete this,setTimeout(()=>{new n(document.querySelector("canvas.webgl")).resources.on("ready",()=>{let e=document.getElementById("app");e.style.cssText="display: inherit",window.scrollTo({top:0,left:0,behavior:"instant"})})},100)}};window.onbeforeunload=()=>{window.scroll(0,0)};window.onload=()=>{window.SScroll.stop(),setTimeout(function(){window.scrollTo(0,0)},10);let n=window.appStart;n(Bt)};ES();TS();})();
/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.16.1
 * @author George Michael Brower
 * @license MIT
 */
/*!
 * GSAP 3.11.5
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
 */
/*!
 * CSSPlugin 3.11.5
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
 */
/*!
 * Observer 3.11.5
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
 */
/*!
 * ScrollTrigger 3.11.5
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
 */
/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/
/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/
/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/
/*! Bundled license information:

gsap/gsap-core.js:
  (*!
   * GSAP 3.12.5
   * https://gsap.com
   *
   * @license Copyright 2008-2024, GreenSock. All rights reserved.
   * Subject to the terms at https://gsap.com/standard-license or for
   * Club GSAP members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  *)

gsap/CSSPlugin.js:
  (*!
   * CSSPlugin 3.12.5
   * https://gsap.com
   *
   * Copyright 2008-2024, GreenSock. All rights reserved.
   * Subject to the terms at https://gsap.com/standard-license or for
   * Club GSAP members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  *)

gsap/Observer.js:
  (*!
   * Observer 3.12.5
   * https://gsap.com
   *
   * @license Copyright 2008-2024, GreenSock. All rights reserved.
   * Subject to the terms at https://gsap.com/standard-license or for
   * Club GSAP members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  *)

gsap/ScrollTrigger.js:
  (*!
   * ScrollTrigger 3.12.5
   * https://gsap.com
   *
   * @license Copyright 2008-2024, GreenSock. All rights reserved.
   * Subject to the terms at https://gsap.com/standard-license or for
   * Club GSAP members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  *)

gsap/utils/strings.js:
  (*!
   * strings: 3.12.5
   * https://gsap.com
   *
   * Copyright 2008-2024, GreenSock. All rights reserved.
   * Subject to the terms at https://gsap.com/standard-license or for
   * Club GSAP members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  *)

gsap/ScrambleTextPlugin.js:
  (*!
   * ScrambleTextPlugin 3.12.5
   * https://gsap.com
   *
   * @license Copyright 2008-2024, GreenSock. All rights reserved.
   * Subject to the terms at https://gsap.com/standard-license or for
   * Club GSAP members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  *)
*/
